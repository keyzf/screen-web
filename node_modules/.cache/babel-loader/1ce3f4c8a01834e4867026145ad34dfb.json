{"ast":null,"code":"import axios from 'axios';\nimport { Modal, message } from 'antd';\nimport Env from '../env';\nmessage.config({\n  duration: 2,\n  maxCount: 1\n});\nexport default class Util {\n  static ajax(options) {\n    let path = Env.getPath();\n    const token = sessionStorage.getItem(\"beautifulGirl\");\n    return new Promise((resolve, reject) => {\n      axios({\n        method: 'post',\n        url: path + options.url,\n        data: options.data,\n        headers: {\n          'Content-Type': 'application/json',\n          token\n        }\n      }).then(response => {\n        //console.log(response)\n        if (response.status === 200) {\n          //http返回的200\n          let res = response.data;\n\n          if (res.code === 200) {\n            //code是501的时候请求超时\n            resolve(response.data);\n            sessionStorage.setItem(\"beautifulGirl\", res.token);\n          } else if (res.code === 501) {\n            Modal.info({\n              title: '退出登录',\n              content: res.message,\n              onOk: () => {\n                Util.logOut();\n              }\n            });\n          } else {\n            resolve(response.data);\n          }\n        } else {\n          Util.logOut(); //链接失败\n\n          reject(response.data); //弹窗提示\n\n          Modal.error({\n            title: '网络链接失败',\n            content: response.statusText\n          });\n        }\n      }).catch(function (error) {\n        let content = error.message;\n\n        if (error.response != null) {\n          content = '错误码：' + error.response.status + '-' + error.response.statusText;\n        }\n\n        message.error(content);\n        setTimeout(() => Util.logOut(), 1000);\n      });\n    });\n  }\n\n  static logOut() {\n    sessionStorage.removeItem(\"beautifulGirl\");\n    window.location.reload();\n  }\n\n}","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/src/util/index.js"],"names":["axios","Modal","message","Env","config","duration","maxCount","Util","ajax","options","path","getPath","token","sessionStorage","getItem","Promise","resolve","reject","method","url","data","headers","then","response","status","res","code","setItem","info","title","content","onOk","logOut","error","statusText","catch","setTimeout","removeItem","window","location","reload"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,KAAT,EAAgBC,OAAhB,QAA+B,MAA/B;AACA,OAAOC,GAAP,MAAgB,QAAhB;AAEAD,OAAO,CAACE,MAAR,CAAe;AACXC,EAAAA,QAAQ,EAAE,CADC;AAEXC,EAAAA,QAAQ,EAAE;AAFC,CAAf;AAIA,eAAe,MAAMC,IAAN,CAAW;AACtB,SAAOC,IAAP,CAAYC,OAAZ,EAAoB;AAChB,QAAIC,IAAI,GAAGP,GAAG,CAACQ,OAAJ,EAAX;AACA,UAAMC,KAAK,GAAGC,cAAc,CAACC,OAAf,CAAuB,eAAvB,CAAd;AACA,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAASC,MAAT,KAAkB;AACjCjB,MAAAA,KAAK,CAAC;AACFkB,QAAAA,MAAM,EAAC,MADL;AAEFC,QAAAA,GAAG,EAACT,IAAI,GAACD,OAAO,CAACU,GAFf;AAGFC,QAAAA,IAAI,EAACX,OAAO,CAACW,IAHX;AAIFC,QAAAA,OAAO,EAAC;AACJ,0BAAe,kBADX;AAEJT,UAAAA;AAFI;AAJN,OAAD,CAAL,CAQGU,IARH,CAQSC,QAAD,IAAY;AAChB;AACA,YAAGA,QAAQ,CAACC,MAAT,KAAoB,GAAvB,EAA2B;AAAC;AACxB,cAAIC,GAAG,GAAGF,QAAQ,CAACH,IAAnB;;AACA,cAAGK,GAAG,CAACC,IAAJ,KAAa,GAAhB,EAAoB;AAAC;AACjBV,YAAAA,OAAO,CAACO,QAAQ,CAACH,IAAV,CAAP;AACAP,YAAAA,cAAc,CAACc,OAAf,CAAuB,eAAvB,EAAuCF,GAAG,CAACb,KAA3C;AACH,WAHD,MAGM,IAAGa,GAAG,CAACC,IAAJ,KAAa,GAAhB,EAAoB;AACtBzB,YAAAA,KAAK,CAAC2B,IAAN,CAAW;AACPC,cAAAA,KAAK,EAAE,MADA;AAEPC,cAAAA,OAAO,EAAEL,GAAG,CAACvB,OAFN;AAGP6B,cAAAA,IAAI,EAAC,MAAM;AACPxB,gBAAAA,IAAI,CAACyB,MAAL;AACH;AALM,aAAX;AAOH,WARK,MAQD;AACDhB,YAAAA,OAAO,CAACO,QAAQ,CAACH,IAAV,CAAP;AACH;AACJ,SAhBD,MAgBK;AACDb,UAAAA,IAAI,CAACyB,MAAL,GADC,CAED;;AACAf,UAAAA,MAAM,CAACM,QAAQ,CAACH,IAAV,CAAN,CAHC,CAID;;AACAnB,UAAAA,KAAK,CAACgC,KAAN,CAAY;AACRJ,YAAAA,KAAK,EAAE,QADC;AAERC,YAAAA,OAAO,EAAEP,QAAQ,CAACW;AAFV,WAAZ;AAIH;AACJ,OApCD,EAoCGC,KApCH,CAoCS,UAAUF,KAAV,EAAiB;AACtB,YAAIH,OAAO,GAAGG,KAAK,CAAC/B,OAApB;;AACI,YAAG+B,KAAK,CAACV,QAAN,IAAgB,IAAnB,EAAwB;AACpBO,UAAAA,OAAO,GAAG,SAAOG,KAAK,CAACV,QAAN,CAAeC,MAAtB,GAA6B,GAA7B,GAAiCS,KAAK,CAACV,QAAN,CAAeW,UAA1D;AACH;;AACLhC,QAAAA,OAAO,CAAC+B,KAAR,CAAcH,OAAd;AACAM,QAAAA,UAAU,CAAC,MAAI7B,IAAI,CAACyB,MAAL,EAAL,EAAmB,IAAnB,CAAV;AACH,OA3CD;AA4CH,KA7CM,CAAP;AA8CH;;AAED,SAAOA,MAAP,GAAe;AACXnB,IAAAA,cAAc,CAACwB,UAAf,CAA0B,eAA1B;AACAC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACH;;AAvDqB","sourcesContent":["import axios from 'axios';\nimport { Modal, message } from 'antd';\nimport Env from '../env';\n\nmessage.config({\n    duration: 2,\n    maxCount: 1\n});\nexport default class Util {\n    static ajax(options){\n        let path = Env.getPath();\n        const token = sessionStorage.getItem(\"beautifulGirl\");\n        return new Promise((resolve,reject)=>{\n            axios({\n                method:'post',\n                url:path+options.url,\n                data:options.data,\n                headers:{\n                    'Content-Type':'application/json',\n                    token\n                }\n            }).then((response)=>{\n                //console.log(response)\n                if(response.status === 200){//http返回的200\n                    let res = response.data;\n                    if(res.code === 200){//code是501的时候请求超时\n                        resolve(response.data);\n                        sessionStorage.setItem(\"beautifulGirl\",res.token);\n                    }else if(res.code === 501){\n                        Modal.info({\n                            title: '退出登录',\n                            content: res.message,\n                            onOk:() => {\n                                Util.logOut();\n                            },\n                        })\n                    }else{\n                        resolve(response.data);\n                    }\n                }else{\n                    Util.logOut();\n                    //链接失败\n                    reject(response.data);\n                    //弹窗提示\n                    Modal.error({\n                        title: '网络链接失败',\n                        content: response.statusText,\n                    });\n                }\n            }).catch(function (error) {\n                let content = error.message;\n                    if(error.response!=null){ \n                        content = '错误码：'+error.response.status+'-'+error.response.statusText;\n                    }\n                message.error(content);\n                setTimeout(()=>Util.logOut(),1000)\n            });\n        })\n    }\n\n    static logOut(){\n        sessionStorage.removeItem(\"beautifulGirl\");\n        window.location.reload();\n    }\n}"]},"metadata":{},"sourceType":"module"}