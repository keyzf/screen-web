{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { isUndefinedOrNull } from '../../../base/common/types.js';\nexport var IStorageService = createDecorator('storageService');\nexport var WillSaveStateReason;\n\n(function (WillSaveStateReason) {\n  WillSaveStateReason[WillSaveStateReason[\"NONE\"] = 0] = \"NONE\";\n  WillSaveStateReason[WillSaveStateReason[\"SHUTDOWN\"] = 1] = \"SHUTDOWN\";\n})(WillSaveStateReason || (WillSaveStateReason = {}));\n\nvar InMemoryStorageService =\n/** @class */\nfunction (_super) {\n  __extends(InMemoryStorageService, _super);\n\n  function InMemoryStorageService() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._onDidChangeStorage = _this._register(new Emitter());\n    _this.onDidChangeStorage = _this._onDidChangeStorage.event;\n    _this._onWillSaveState = _this._register(new Emitter());\n    _this.onWillSaveState = _this._onWillSaveState.event;\n    _this.globalCache = new Map();\n    _this.workspaceCache = new Map();\n    return _this;\n  }\n\n  InMemoryStorageService.prototype.getCache = function (scope) {\n    return scope === 0\n    /* GLOBAL */\n    ? this.globalCache : this.workspaceCache;\n  };\n\n  InMemoryStorageService.prototype.get = function (key, scope, fallbackValue) {\n    var value = this.getCache(scope).get(key);\n\n    if (isUndefinedOrNull(value)) {\n      return fallbackValue;\n    }\n\n    return value;\n  };\n\n  InMemoryStorageService.prototype.getBoolean = function (key, scope, fallbackValue) {\n    var value = this.getCache(scope).get(key);\n\n    if (isUndefinedOrNull(value)) {\n      return fallbackValue;\n    }\n\n    return value === 'true';\n  };\n\n  InMemoryStorageService.prototype.store = function (key, value, scope) {\n    // We remove the key for undefined/null values\n    if (isUndefinedOrNull(value)) {\n      return this.remove(key, scope);\n    } // Otherwise, convert to String and store\n\n\n    var valueStr = String(value); // Return early if value already set\n\n    var currentValue = this.getCache(scope).get(key);\n\n    if (currentValue === valueStr) {\n      return Promise.resolve();\n    } // Update in cache\n\n\n    this.getCache(scope).set(key, valueStr); // Events\n\n    this._onDidChangeStorage.fire({\n      scope: scope,\n      key: key\n    });\n\n    return Promise.resolve();\n  };\n\n  InMemoryStorageService.prototype.remove = function (key, scope) {\n    var wasDeleted = this.getCache(scope).delete(key);\n\n    if (!wasDeleted) {\n      return Promise.resolve(); // Return early if value already deleted\n    } // Events\n\n\n    this._onDidChangeStorage.fire({\n      scope: scope,\n      key: key\n    });\n\n    return Promise.resolve();\n  };\n\n  return InMemoryStorageService;\n}(Disposable);\n\nexport { InMemoryStorageService };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/platform/storage/common/storage.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createDecorator","Emitter","Disposable","isUndefinedOrNull","IStorageService","WillSaveStateReason","InMemoryStorageService","_super","_this","apply","arguments","_onDidChangeStorage","_register","onDidChangeStorage","event","_onWillSaveState","onWillSaveState","globalCache","Map","workspaceCache","getCache","scope","get","key","fallbackValue","value","getBoolean","store","remove","valueStr","String","currentValue","Promise","resolve","set","fire","wasDeleted","delete"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { isUndefinedOrNull } from '../../../base/common/types.js';\r\nexport var IStorageService = createDecorator('storageService');\r\nexport var WillSaveStateReason;\r\n(function (WillSaveStateReason) {\r\n    WillSaveStateReason[WillSaveStateReason[\"NONE\"] = 0] = \"NONE\";\r\n    WillSaveStateReason[WillSaveStateReason[\"SHUTDOWN\"] = 1] = \"SHUTDOWN\";\r\n})(WillSaveStateReason || (WillSaveStateReason = {}));\r\nvar InMemoryStorageService = /** @class */ (function (_super) {\r\n    __extends(InMemoryStorageService, _super);\r\n    function InMemoryStorageService() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._onDidChangeStorage = _this._register(new Emitter());\r\n        _this.onDidChangeStorage = _this._onDidChangeStorage.event;\r\n        _this._onWillSaveState = _this._register(new Emitter());\r\n        _this.onWillSaveState = _this._onWillSaveState.event;\r\n        _this.globalCache = new Map();\r\n        _this.workspaceCache = new Map();\r\n        return _this;\r\n    }\r\n    InMemoryStorageService.prototype.getCache = function (scope) {\r\n        return scope === 0 /* GLOBAL */ ? this.globalCache : this.workspaceCache;\r\n    };\r\n    InMemoryStorageService.prototype.get = function (key, scope, fallbackValue) {\r\n        var value = this.getCache(scope).get(key);\r\n        if (isUndefinedOrNull(value)) {\r\n            return fallbackValue;\r\n        }\r\n        return value;\r\n    };\r\n    InMemoryStorageService.prototype.getBoolean = function (key, scope, fallbackValue) {\r\n        var value = this.getCache(scope).get(key);\r\n        if (isUndefinedOrNull(value)) {\r\n            return fallbackValue;\r\n        }\r\n        return value === 'true';\r\n    };\r\n    InMemoryStorageService.prototype.store = function (key, value, scope) {\r\n        // We remove the key for undefined/null values\r\n        if (isUndefinedOrNull(value)) {\r\n            return this.remove(key, scope);\r\n        }\r\n        // Otherwise, convert to String and store\r\n        var valueStr = String(value);\r\n        // Return early if value already set\r\n        var currentValue = this.getCache(scope).get(key);\r\n        if (currentValue === valueStr) {\r\n            return Promise.resolve();\r\n        }\r\n        // Update in cache\r\n        this.getCache(scope).set(key, valueStr);\r\n        // Events\r\n        this._onDidChangeStorage.fire({ scope: scope, key: key });\r\n        return Promise.resolve();\r\n    };\r\n    InMemoryStorageService.prototype.remove = function (key, scope) {\r\n        var wasDeleted = this.getCache(scope).delete(key);\r\n        if (!wasDeleted) {\r\n            return Promise.resolve(); // Return early if value already deleted\r\n        }\r\n        // Events\r\n        this._onDidChangeStorage.fire({ scope: scope, key: key });\r\n        return Promise.resolve();\r\n    };\r\n    return InMemoryStorageService;\r\n}(Disposable));\r\nexport { InMemoryStorageService };\r\n"]},"metadata":{},"sourceType":"module"}