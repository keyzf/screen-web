{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport './media/diffEditor.css';\nimport * as nls from '../../../nls.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\nimport { RunOnceScheduler } from '../../../base/common/async.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as objects from '../../../base/common/objects.js';\nimport { Configuration } from '../config/configuration.js';\nimport { StableEditorScrollState } from '../core/editorState.js';\nimport { ICodeEditorService } from '../services/codeEditorService.js';\nimport { CodeEditorWidget } from './codeEditorWidget.js';\nimport { DiffReview } from './diffReview.js';\nimport { EditorOptions, EditorFontLigatures } from '../../common/config/editorOptions.js';\nimport { Range } from '../../common/core/range.js';\nimport { createStringBuilder } from '../../common/core/stringBuilder.js';\nimport * as editorCommon from '../../common/editorCommon.js';\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\nimport { OverviewRulerZone } from '../../common/view/overviewZoneManager.js';\nimport { LineDecoration } from '../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\nimport { InlineDecoration, ViewLineRenderingData } from '../../common/viewModel/viewModel.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { defaultInsertColor, defaultRemoveColor, diffBorder, diffInserted, diffInsertedOutline, diffRemoved, diffRemovedOutline, scrollbarShadow } from '../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService, getThemeTypeSelector, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\nimport { InlineDiffMargin } from './inlineDiffMargin.js';\nimport { EditorExtensionsRegistry } from '../editorExtensions.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\nimport { ElementSizeObserver } from '../config/elementSizeObserver.js';\n\nvar VisualEditorState =\n/** @class */\nfunction () {\n  function VisualEditorState(_contextMenuService, _clipboardService) {\n    this._contextMenuService = _contextMenuService;\n    this._clipboardService = _clipboardService;\n    this._zones = [];\n    this.inlineDiffMargins = [];\n    this._zonesMap = {};\n    this._decorations = [];\n  }\n\n  VisualEditorState.prototype.getForeignViewZones = function (allViewZones) {\n    var _this = this;\n\n    return allViewZones.filter(function (z) {\n      return !_this._zonesMap[String(z.id)];\n    });\n  };\n\n  VisualEditorState.prototype.clean = function (editor) {\n    var _this = this; // (1) View zones\n\n\n    if (this._zones.length > 0) {\n      editor.changeViewZones(function (viewChangeAccessor) {\n        for (var i = 0, length_1 = _this._zones.length; i < length_1; i++) {\n          viewChangeAccessor.removeZone(_this._zones[i]);\n        }\n      });\n    }\n\n    this._zones = [];\n    this._zonesMap = {}; // (2) Model decorations\n\n    this._decorations = editor.deltaDecorations(this._decorations, []);\n  };\n\n  VisualEditorState.prototype.apply = function (editor, overviewRuler, newDecorations, restoreScrollState) {\n    var _this = this;\n\n    var scrollState = restoreScrollState ? StableEditorScrollState.capture(editor) : null; // view zones\n\n    editor.changeViewZones(function (viewChangeAccessor) {\n      for (var i = 0, length_2 = _this._zones.length; i < length_2; i++) {\n        viewChangeAccessor.removeZone(_this._zones[i]);\n      }\n\n      for (var i = 0, length_3 = _this.inlineDiffMargins.length; i < length_3; i++) {\n        _this.inlineDiffMargins[i].dispose();\n      }\n\n      _this._zones = [];\n      _this._zonesMap = {};\n      _this.inlineDiffMargins = [];\n\n      for (var i = 0, length_4 = newDecorations.zones.length; i < length_4; i++) {\n        var viewZone = newDecorations.zones[i];\n        viewZone.suppressMouseDown = true;\n        var zoneId = viewChangeAccessor.addZone(viewZone);\n\n        _this._zones.push(zoneId);\n\n        _this._zonesMap[String(zoneId)] = true;\n\n        if (newDecorations.zones[i].diff && viewZone.marginDomNode && _this._clipboardService) {\n          viewZone.suppressMouseDown = false;\n\n          _this.inlineDiffMargins.push(new InlineDiffMargin(zoneId, viewZone.marginDomNode, editor, newDecorations.zones[i].diff, _this._contextMenuService, _this._clipboardService));\n        }\n      }\n    });\n\n    if (scrollState) {\n      scrollState.restore(editor);\n    } // decorations\n\n\n    this._decorations = editor.deltaDecorations(this._decorations, newDecorations.decorations); // overview ruler\n\n    if (overviewRuler) {\n      overviewRuler.setZones(newDecorations.overviewZones);\n    }\n  };\n\n  return VisualEditorState;\n}();\n\nvar DIFF_EDITOR_ID = 0;\n\nvar DiffEditorWidget =\n/** @class */\nfunction (_super) {\n  __extends(DiffEditorWidget, _super);\n\n  function DiffEditorWidget(domElement, options, clipboardService, editorWorkerService, contextKeyService, instantiationService, codeEditorService, themeService, notificationService, contextMenuService, _editorProgressService) {\n    var _this = _super.call(this) || this;\n\n    _this._editorProgressService = _editorProgressService;\n    _this._onDidDispose = _this._register(new Emitter());\n    _this.onDidDispose = _this._onDidDispose.event;\n    _this._onDidUpdateDiff = _this._register(new Emitter());\n    _this.onDidUpdateDiff = _this._onDidUpdateDiff.event;\n    _this._lastOriginalWarning = null;\n    _this._lastModifiedWarning = null;\n    _this._editorWorkerService = editorWorkerService;\n    _this._codeEditorService = codeEditorService;\n    _this._contextKeyService = _this._register(contextKeyService.createScoped(domElement));\n\n    _this._contextKeyService.createKey('isInDiffEditor', true);\n\n    _this._themeService = themeService;\n    _this._notificationService = notificationService;\n    _this.id = ++DIFF_EDITOR_ID;\n    _this._state = 0\n    /* Idle */\n    ;\n    _this._updatingDiffProgress = null;\n    _this._domElement = domElement;\n    options = options || {}; // renderSideBySide\n\n    _this._renderSideBySide = true;\n\n    if (typeof options.renderSideBySide !== 'undefined') {\n      _this._renderSideBySide = options.renderSideBySide;\n    } // maxComputationTime\n\n\n    _this._maxComputationTime = 5000;\n\n    if (typeof options.maxComputationTime !== 'undefined') {\n      _this._maxComputationTime = options.maxComputationTime;\n    } // ignoreTrimWhitespace\n\n\n    _this._ignoreTrimWhitespace = true;\n\n    if (typeof options.ignoreTrimWhitespace !== 'undefined') {\n      _this._ignoreTrimWhitespace = options.ignoreTrimWhitespace;\n    } // renderIndicators\n\n\n    _this._renderIndicators = true;\n\n    if (typeof options.renderIndicators !== 'undefined') {\n      _this._renderIndicators = options.renderIndicators;\n    }\n\n    _this._originalIsEditable = false;\n\n    if (typeof options.originalEditable !== 'undefined') {\n      _this._originalIsEditable = Boolean(options.originalEditable);\n    }\n\n    _this._updateDecorationsRunner = _this._register(new RunOnceScheduler(function () {\n      return _this._updateDecorations();\n    }, 0));\n    _this._containerDomElement = document.createElement('div');\n    _this._containerDomElement.className = DiffEditorWidget._getClassName(_this._themeService.getTheme(), _this._renderSideBySide);\n    _this._containerDomElement.style.position = 'relative';\n    _this._containerDomElement.style.height = '100%';\n\n    _this._domElement.appendChild(_this._containerDomElement);\n\n    _this._overviewViewportDomElement = createFastDomNode(document.createElement('div'));\n\n    _this._overviewViewportDomElement.setClassName('diffViewport');\n\n    _this._overviewViewportDomElement.setPosition('absolute');\n\n    _this._overviewDomElement = document.createElement('div');\n    _this._overviewDomElement.className = 'diffOverview';\n    _this._overviewDomElement.style.position = 'absolute';\n\n    _this._overviewDomElement.appendChild(_this._overviewViewportDomElement.domNode);\n\n    _this._register(dom.addStandardDisposableListener(_this._overviewDomElement, 'mousedown', function (e) {\n      _this.modifiedEditor.delegateVerticalScrollbarMouseDown(e);\n    }));\n\n    _this._containerDomElement.appendChild(_this._overviewDomElement); // Create left side\n\n\n    _this._originalDomNode = document.createElement('div');\n    _this._originalDomNode.className = 'editor original';\n    _this._originalDomNode.style.position = 'absolute';\n    _this._originalDomNode.style.height = '100%';\n\n    _this._containerDomElement.appendChild(_this._originalDomNode); // Create right side\n\n\n    _this._modifiedDomNode = document.createElement('div');\n    _this._modifiedDomNode.className = 'editor modified';\n    _this._modifiedDomNode.style.position = 'absolute';\n    _this._modifiedDomNode.style.height = '100%';\n\n    _this._containerDomElement.appendChild(_this._modifiedDomNode);\n\n    _this._beginUpdateDecorationsTimeout = -1;\n    _this._currentlyChangingViewZones = false;\n    _this._diffComputationToken = 0;\n    _this._originalEditorState = new VisualEditorState(contextMenuService, clipboardService);\n    _this._modifiedEditorState = new VisualEditorState(contextMenuService, clipboardService);\n    _this._isVisible = true;\n    _this._isHandlingScrollEvent = false;\n    _this._elementSizeObserver = _this._register(new ElementSizeObserver(_this._containerDomElement, undefined, function () {\n      return _this._onDidContainerSizeChanged();\n    }));\n\n    if (options.automaticLayout) {\n      _this._elementSizeObserver.startObserving();\n    }\n\n    _this._diffComputationResult = null;\n\n    var leftContextKeyService = _this._contextKeyService.createScoped();\n\n    leftContextKeyService.createKey('isInDiffLeftEditor', true);\n    var leftServices = new ServiceCollection();\n    leftServices.set(IContextKeyService, leftContextKeyService);\n    var leftScopedInstantiationService = instantiationService.createChild(leftServices);\n\n    var rightContextKeyService = _this._contextKeyService.createScoped();\n\n    rightContextKeyService.createKey('isInDiffRightEditor', true);\n    var rightServices = new ServiceCollection();\n    rightServices.set(IContextKeyService, rightContextKeyService);\n    var rightScopedInstantiationService = instantiationService.createChild(rightServices);\n    _this.originalEditor = _this._createLeftHandSideEditor(options, leftScopedInstantiationService);\n    _this.modifiedEditor = _this._createRightHandSideEditor(options, rightScopedInstantiationService);\n    _this._originalOverviewRuler = null;\n    _this._modifiedOverviewRuler = null;\n    _this._reviewPane = new DiffReview(_this);\n\n    _this._containerDomElement.appendChild(_this._reviewPane.domNode.domNode);\n\n    _this._containerDomElement.appendChild(_this._reviewPane.shadow.domNode);\n\n    _this._containerDomElement.appendChild(_this._reviewPane.actionBarContainer.domNode); // enableSplitViewResizing\n\n\n    _this._enableSplitViewResizing = true;\n\n    if (typeof options.enableSplitViewResizing !== 'undefined') {\n      _this._enableSplitViewResizing = options.enableSplitViewResizing;\n    }\n\n    if (_this._renderSideBySide) {\n      _this._setStrategy(new DiffEditorWidgetSideBySide(_this._createDataSource(), _this._enableSplitViewResizing));\n    } else {\n      _this._setStrategy(new DiffEditorWidgetInline(_this._createDataSource(), _this._enableSplitViewResizing));\n    }\n\n    _this._register(themeService.onThemeChange(function (t) {\n      if (_this._strategy && _this._strategy.applyColors(t)) {\n        _this._updateDecorationsRunner.schedule();\n      }\n\n      _this._containerDomElement.className = DiffEditorWidget._getClassName(_this._themeService.getTheme(), _this._renderSideBySide);\n    }));\n\n    var contributions = EditorExtensionsRegistry.getDiffEditorContributions();\n\n    for (var _i = 0, contributions_1 = contributions; _i < contributions_1.length; _i++) {\n      var desc = contributions_1[_i];\n\n      try {\n        _this._register(instantiationService.createInstance(desc.ctor, _this));\n      } catch (err) {\n        onUnexpectedError(err);\n      }\n    }\n\n    _this._codeEditorService.addDiffEditor(_this);\n\n    return _this;\n  }\n\n  DiffEditorWidget.prototype._setState = function (newState) {\n    if (this._state === newState) {\n      return;\n    }\n\n    this._state = newState;\n\n    if (this._updatingDiffProgress) {\n      this._updatingDiffProgress.done();\n\n      this._updatingDiffProgress = null;\n    }\n\n    if (this._state === 1\n    /* ComputingDiff */\n    ) {\n        this._updatingDiffProgress = this._editorProgressService.show(true, 1000);\n      }\n  };\n\n  DiffEditorWidget.prototype.hasWidgetFocus = function () {\n    return dom.isAncestor(document.activeElement, this._domElement);\n  };\n\n  DiffEditorWidget.prototype.diffReviewNext = function () {\n    this._reviewPane.next();\n  };\n\n  DiffEditorWidget.prototype.diffReviewPrev = function () {\n    this._reviewPane.prev();\n  };\n\n  DiffEditorWidget._getClassName = function (theme, renderSideBySide) {\n    var result = 'monaco-diff-editor monaco-editor-background ';\n\n    if (renderSideBySide) {\n      result += 'side-by-side ';\n    }\n\n    result += getThemeTypeSelector(theme.type);\n    return result;\n  };\n\n  DiffEditorWidget.prototype._recreateOverviewRulers = function () {\n    if (this._originalOverviewRuler) {\n      this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode());\n\n      this._originalOverviewRuler.dispose();\n    }\n\n    if (this.originalEditor.hasModel()) {\n      this._originalOverviewRuler = this.originalEditor.createOverviewRuler('original diffOverviewRuler');\n\n      this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode());\n    }\n\n    if (this._modifiedOverviewRuler) {\n      this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode());\n\n      this._modifiedOverviewRuler.dispose();\n    }\n\n    if (this.modifiedEditor.hasModel()) {\n      this._modifiedOverviewRuler = this.modifiedEditor.createOverviewRuler('modified diffOverviewRuler');\n\n      this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode());\n    }\n\n    this._layoutOverviewRulers();\n  };\n\n  DiffEditorWidget.prototype._createLeftHandSideEditor = function (options, instantiationService) {\n    var _this = this;\n\n    var editor = this._createInnerEditor(instantiationService, this._originalDomNode, this._adjustOptionsForLeftHandSide(options, this._originalIsEditable));\n\n    this._register(editor.onDidScrollChange(function (e) {\n      if (_this._isHandlingScrollEvent) {\n        return;\n      }\n\n      if (!e.scrollTopChanged && !e.scrollLeftChanged && !e.scrollHeightChanged) {\n        return;\n      }\n\n      _this._isHandlingScrollEvent = true;\n\n      _this.modifiedEditor.setScrollPosition({\n        scrollLeft: e.scrollLeft,\n        scrollTop: e.scrollTop\n      });\n\n      _this._isHandlingScrollEvent = false;\n\n      _this._layoutOverviewViewport();\n    }));\n\n    this._register(editor.onDidChangeViewZones(function () {\n      _this._onViewZonesChanged();\n    }));\n\n    this._register(editor.onDidChangeModelContent(function () {\n      if (_this._isVisible) {\n        _this._beginUpdateDecorationsSoon();\n      }\n    }));\n\n    return editor;\n  };\n\n  DiffEditorWidget.prototype._createRightHandSideEditor = function (options, instantiationService) {\n    var _this = this;\n\n    var editor = this._createInnerEditor(instantiationService, this._modifiedDomNode, this._adjustOptionsForRightHandSide(options));\n\n    this._register(editor.onDidScrollChange(function (e) {\n      if (_this._isHandlingScrollEvent) {\n        return;\n      }\n\n      if (!e.scrollTopChanged && !e.scrollLeftChanged && !e.scrollHeightChanged) {\n        return;\n      }\n\n      _this._isHandlingScrollEvent = true;\n\n      _this.originalEditor.setScrollPosition({\n        scrollLeft: e.scrollLeft,\n        scrollTop: e.scrollTop\n      });\n\n      _this._isHandlingScrollEvent = false;\n\n      _this._layoutOverviewViewport();\n    }));\n\n    this._register(editor.onDidChangeViewZones(function () {\n      _this._onViewZonesChanged();\n    }));\n\n    this._register(editor.onDidChangeConfiguration(function (e) {\n      if (e.hasChanged(34\n      /* fontInfo */\n      ) && editor.getModel()) {\n        _this._onViewZonesChanged();\n      }\n    }));\n\n    this._register(editor.onDidChangeModelContent(function () {\n      if (_this._isVisible) {\n        _this._beginUpdateDecorationsSoon();\n      }\n    }));\n\n    this._register(editor.onDidChangeModelOptions(function (e) {\n      if (e.tabSize) {\n        _this._updateDecorationsRunner.schedule();\n      }\n    }));\n\n    return editor;\n  };\n\n  DiffEditorWidget.prototype._createInnerEditor = function (instantiationService, container, options) {\n    return instantiationService.createInstance(CodeEditorWidget, container, options, {});\n  };\n\n  DiffEditorWidget.prototype.dispose = function () {\n    this._codeEditorService.removeDiffEditor(this);\n\n    if (this._beginUpdateDecorationsTimeout !== -1) {\n      window.clearTimeout(this._beginUpdateDecorationsTimeout);\n      this._beginUpdateDecorationsTimeout = -1;\n    }\n\n    this._cleanViewZonesAndDecorations();\n\n    if (this._originalOverviewRuler) {\n      this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode());\n\n      this._originalOverviewRuler.dispose();\n    }\n\n    if (this._modifiedOverviewRuler) {\n      this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode());\n\n      this._modifiedOverviewRuler.dispose();\n    }\n\n    this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode);\n\n    this._containerDomElement.removeChild(this._overviewDomElement);\n\n    this._containerDomElement.removeChild(this._originalDomNode);\n\n    this.originalEditor.dispose();\n\n    this._containerDomElement.removeChild(this._modifiedDomNode);\n\n    this.modifiedEditor.dispose();\n\n    this._strategy.dispose();\n\n    this._containerDomElement.removeChild(this._reviewPane.domNode.domNode);\n\n    this._containerDomElement.removeChild(this._reviewPane.shadow.domNode);\n\n    this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode);\n\n    this._reviewPane.dispose();\n\n    this._domElement.removeChild(this._containerDomElement);\n\n    this._onDidDispose.fire();\n\n    _super.prototype.dispose.call(this);\n  }; //------------ begin IDiffEditor methods\n\n\n  DiffEditorWidget.prototype.getId = function () {\n    return this.getEditorType() + ':' + this.id;\n  };\n\n  DiffEditorWidget.prototype.getEditorType = function () {\n    return editorCommon.EditorType.IDiffEditor;\n  };\n\n  DiffEditorWidget.prototype.getLineChanges = function () {\n    if (!this._diffComputationResult) {\n      return null;\n    }\n\n    return this._diffComputationResult.changes;\n  };\n\n  DiffEditorWidget.prototype.getOriginalEditor = function () {\n    return this.originalEditor;\n  };\n\n  DiffEditorWidget.prototype.getModifiedEditor = function () {\n    return this.modifiedEditor;\n  };\n\n  DiffEditorWidget.prototype.updateOptions = function (newOptions) {\n    // Handle side by side\n    var renderSideBySideChanged = false;\n\n    if (typeof newOptions.renderSideBySide !== 'undefined') {\n      if (this._renderSideBySide !== newOptions.renderSideBySide) {\n        this._renderSideBySide = newOptions.renderSideBySide;\n        renderSideBySideChanged = true;\n      }\n    }\n\n    if (typeof newOptions.maxComputationTime !== 'undefined') {\n      this._maxComputationTime = newOptions.maxComputationTime;\n\n      if (this._isVisible) {\n        this._beginUpdateDecorationsSoon();\n      }\n    }\n\n    var beginUpdateDecorations = false;\n\n    if (typeof newOptions.ignoreTrimWhitespace !== 'undefined') {\n      if (this._ignoreTrimWhitespace !== newOptions.ignoreTrimWhitespace) {\n        this._ignoreTrimWhitespace = newOptions.ignoreTrimWhitespace; // Begin comparing\n\n        beginUpdateDecorations = true;\n      }\n    }\n\n    if (typeof newOptions.renderIndicators !== 'undefined') {\n      if (this._renderIndicators !== newOptions.renderIndicators) {\n        this._renderIndicators = newOptions.renderIndicators;\n        beginUpdateDecorations = true;\n      }\n    }\n\n    if (beginUpdateDecorations) {\n      this._beginUpdateDecorations();\n    }\n\n    if (typeof newOptions.originalEditable !== 'undefined') {\n      this._originalIsEditable = Boolean(newOptions.originalEditable);\n    }\n\n    this.modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(newOptions));\n    this.originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(newOptions, this._originalIsEditable)); // enableSplitViewResizing\n\n    if (typeof newOptions.enableSplitViewResizing !== 'undefined') {\n      this._enableSplitViewResizing = newOptions.enableSplitViewResizing;\n    }\n\n    this._strategy.setEnableSplitViewResizing(this._enableSplitViewResizing); // renderSideBySide\n\n\n    if (renderSideBySideChanged) {\n      if (this._renderSideBySide) {\n        this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(), this._enableSplitViewResizing));\n      } else {\n        this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(), this._enableSplitViewResizing));\n      } // Update class name\n\n\n      this._containerDomElement.className = DiffEditorWidget._getClassName(this._themeService.getTheme(), this._renderSideBySide);\n    }\n  };\n\n  DiffEditorWidget.prototype.getModel = function () {\n    return {\n      original: this.originalEditor.getModel(),\n      modified: this.modifiedEditor.getModel()\n    };\n  };\n\n  DiffEditorWidget.prototype.setModel = function (model) {\n    // Guard us against partial null model\n    if (model && (!model.original || !model.modified)) {\n      throw new Error(!model.original ? 'DiffEditorWidget.setModel: Original model is null' : 'DiffEditorWidget.setModel: Modified model is null');\n    } // Remove all view zones & decorations\n\n\n    this._cleanViewZonesAndDecorations(); // Update code editor models\n\n\n    this.originalEditor.setModel(model ? model.original : null);\n    this.modifiedEditor.setModel(model ? model.modified : null);\n\n    this._updateDecorationsRunner.cancel(); // this.originalEditor.onDidChangeModelOptions\n\n\n    if (model) {\n      this.originalEditor.setScrollTop(0);\n      this.modifiedEditor.setScrollTop(0);\n    } // Disable any diff computations that will come in\n\n\n    this._diffComputationResult = null;\n    this._diffComputationToken++;\n\n    this._setState(0\n    /* Idle */\n    );\n\n    if (model) {\n      this._recreateOverviewRulers(); // Begin comparing\n\n\n      this._beginUpdateDecorations();\n    }\n\n    this._layoutOverviewViewport();\n  };\n\n  DiffEditorWidget.prototype.getDomNode = function () {\n    return this._domElement;\n  };\n\n  DiffEditorWidget.prototype.getVisibleColumnFromPosition = function (position) {\n    return this.modifiedEditor.getVisibleColumnFromPosition(position);\n  };\n\n  DiffEditorWidget.prototype.getPosition = function () {\n    return this.modifiedEditor.getPosition();\n  };\n\n  DiffEditorWidget.prototype.setPosition = function (position) {\n    this.modifiedEditor.setPosition(position);\n  };\n\n  DiffEditorWidget.prototype.revealLine = function (lineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealLine(lineNumber, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealLineInCenter = function (lineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealLineInCenter(lineNumber, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealLineInCenterIfOutsideViewport = function (lineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealLineInCenterIfOutsideViewport(lineNumber, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealPosition = function (position, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealPosition(position, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealPositionInCenter = function (position, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealPositionInCenter(position, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealPositionInCenterIfOutsideViewport = function (position, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealPositionInCenterIfOutsideViewport(position, scrollType);\n  };\n\n  DiffEditorWidget.prototype.getSelection = function () {\n    return this.modifiedEditor.getSelection();\n  };\n\n  DiffEditorWidget.prototype.getSelections = function () {\n    return this.modifiedEditor.getSelections();\n  };\n\n  DiffEditorWidget.prototype.setSelection = function (something) {\n    this.modifiedEditor.setSelection(something);\n  };\n\n  DiffEditorWidget.prototype.setSelections = function (ranges) {\n    this.modifiedEditor.setSelections(ranges);\n  };\n\n  DiffEditorWidget.prototype.revealLines = function (startLineNumber, endLineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealLines(startLineNumber, endLineNumber, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealLinesInCenter = function (startLineNumber, endLineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealLinesInCenter(startLineNumber, endLineNumber, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealLinesInCenterIfOutsideViewport = function (startLineNumber, endLineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealLinesInCenterIfOutsideViewport(startLineNumber, endLineNumber, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealRange = function (range, scrollType, revealVerticalInCenter, revealHorizontal) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    if (revealVerticalInCenter === void 0) {\n      revealVerticalInCenter = false;\n    }\n\n    if (revealHorizontal === void 0) {\n      revealHorizontal = true;\n    }\n\n    this.modifiedEditor.revealRange(range, scrollType, revealVerticalInCenter, revealHorizontal);\n  };\n\n  DiffEditorWidget.prototype.revealRangeInCenter = function (range, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealRangeInCenter(range, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealRangeInCenterIfOutsideViewport = function (range, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealRangeInCenterIfOutsideViewport(range, scrollType);\n  };\n\n  DiffEditorWidget.prototype.revealRangeAtTop = function (range, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this.modifiedEditor.revealRangeAtTop(range, scrollType);\n  };\n\n  DiffEditorWidget.prototype.getSupportedActions = function () {\n    return this.modifiedEditor.getSupportedActions();\n  };\n\n  DiffEditorWidget.prototype.saveViewState = function () {\n    var originalViewState = this.originalEditor.saveViewState();\n    var modifiedViewState = this.modifiedEditor.saveViewState();\n    return {\n      original: originalViewState,\n      modified: modifiedViewState\n    };\n  };\n\n  DiffEditorWidget.prototype.restoreViewState = function (s) {\n    if (s.original && s.modified) {\n      var diffEditorState = s;\n      this.originalEditor.restoreViewState(diffEditorState.original);\n      this.modifiedEditor.restoreViewState(diffEditorState.modified);\n    }\n  };\n\n  DiffEditorWidget.prototype.layout = function (dimension) {\n    this._elementSizeObserver.observe(dimension);\n  };\n\n  DiffEditorWidget.prototype.focus = function () {\n    this.modifiedEditor.focus();\n  };\n\n  DiffEditorWidget.prototype.hasTextFocus = function () {\n    return this.originalEditor.hasTextFocus() || this.modifiedEditor.hasTextFocus();\n  };\n\n  DiffEditorWidget.prototype.trigger = function (source, handlerId, payload) {\n    this.modifiedEditor.trigger(source, handlerId, payload);\n  };\n\n  DiffEditorWidget.prototype.changeDecorations = function (callback) {\n    return this.modifiedEditor.changeDecorations(callback);\n  }; //------------ end IDiffEditor methods\n  //------------ begin layouting methods\n\n\n  DiffEditorWidget.prototype._onDidContainerSizeChanged = function () {\n    this._doLayout();\n  };\n\n  DiffEditorWidget.prototype._getReviewHeight = function () {\n    return this._reviewPane.isVisible() ? this._elementSizeObserver.getHeight() : 0;\n  };\n\n  DiffEditorWidget.prototype._layoutOverviewRulers = function () {\n    if (!this._originalOverviewRuler || !this._modifiedOverviewRuler) {\n      return;\n    }\n\n    var height = this._elementSizeObserver.getHeight();\n\n    var reviewHeight = this._getReviewHeight();\n\n    var freeSpace = DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH - 2 * DiffEditorWidget.ONE_OVERVIEW_WIDTH;\n    var layoutInfo = this.modifiedEditor.getLayoutInfo();\n\n    if (layoutInfo) {\n      this._originalOverviewRuler.setLayout({\n        top: 0,\n        width: DiffEditorWidget.ONE_OVERVIEW_WIDTH,\n        right: freeSpace + DiffEditorWidget.ONE_OVERVIEW_WIDTH,\n        height: height - reviewHeight\n      });\n\n      this._modifiedOverviewRuler.setLayout({\n        top: 0,\n        right: 0,\n        width: DiffEditorWidget.ONE_OVERVIEW_WIDTH,\n        height: height - reviewHeight\n      });\n    }\n  }; //------------ end layouting methods\n\n\n  DiffEditorWidget.prototype._onViewZonesChanged = function () {\n    if (this._currentlyChangingViewZones) {\n      return;\n    }\n\n    this._updateDecorationsRunner.schedule();\n  };\n\n  DiffEditorWidget.prototype._beginUpdateDecorationsSoon = function () {\n    var _this = this; // Clear previous timeout if necessary\n\n\n    if (this._beginUpdateDecorationsTimeout !== -1) {\n      window.clearTimeout(this._beginUpdateDecorationsTimeout);\n      this._beginUpdateDecorationsTimeout = -1;\n    }\n\n    this._beginUpdateDecorationsTimeout = window.setTimeout(function () {\n      return _this._beginUpdateDecorations();\n    }, DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY);\n  };\n\n  DiffEditorWidget._equals = function (a, b) {\n    if (!a && !b) {\n      return true;\n    }\n\n    if (!a || !b) {\n      return false;\n    }\n\n    return a.toString() === b.toString();\n  };\n\n  DiffEditorWidget.prototype._beginUpdateDecorations = function () {\n    var _this = this;\n\n    this._beginUpdateDecorationsTimeout = -1;\n    var currentOriginalModel = this.originalEditor.getModel();\n    var currentModifiedModel = this.modifiedEditor.getModel();\n\n    if (!currentOriginalModel || !currentModifiedModel) {\n      return;\n    } // Prevent old diff requests to come if a new request has been initiated\n    // The best method would be to call cancel on the Promise, but this is not\n    // yet supported, so using tokens for now.\n\n\n    this._diffComputationToken++;\n    var currentToken = this._diffComputationToken;\n\n    this._setState(1\n    /* ComputingDiff */\n    );\n\n    if (!this._editorWorkerService.canComputeDiff(currentOriginalModel.uri, currentModifiedModel.uri)) {\n      if (!DiffEditorWidget._equals(currentOriginalModel.uri, this._lastOriginalWarning) || !DiffEditorWidget._equals(currentModifiedModel.uri, this._lastModifiedWarning)) {\n        this._lastOriginalWarning = currentOriginalModel.uri;\n        this._lastModifiedWarning = currentModifiedModel.uri;\n\n        this._notificationService.warn(nls.localize(\"diff.tooLarge\", \"Cannot compare files because one file is too large.\"));\n      }\n\n      return;\n    }\n\n    this._editorWorkerService.computeDiff(currentOriginalModel.uri, currentModifiedModel.uri, this._ignoreTrimWhitespace, this._maxComputationTime).then(function (result) {\n      if (currentToken === _this._diffComputationToken && currentOriginalModel === _this.originalEditor.getModel() && currentModifiedModel === _this.modifiedEditor.getModel()) {\n        _this._setState(2\n        /* DiffComputed */\n        );\n\n        _this._diffComputationResult = result;\n\n        _this._updateDecorationsRunner.schedule();\n\n        _this._onDidUpdateDiff.fire();\n      }\n    }, function (error) {\n      if (currentToken === _this._diffComputationToken && currentOriginalModel === _this.originalEditor.getModel() && currentModifiedModel === _this.modifiedEditor.getModel()) {\n        _this._setState(2\n        /* DiffComputed */\n        );\n\n        _this._diffComputationResult = null;\n\n        _this._updateDecorationsRunner.schedule();\n      }\n    });\n  };\n\n  DiffEditorWidget.prototype._cleanViewZonesAndDecorations = function () {\n    this._originalEditorState.clean(this.originalEditor);\n\n    this._modifiedEditorState.clean(this.modifiedEditor);\n  };\n\n  DiffEditorWidget.prototype._updateDecorations = function () {\n    if (!this.originalEditor.getModel() || !this.modifiedEditor.getModel() || !this._originalOverviewRuler || !this._modifiedOverviewRuler) {\n      return;\n    }\n\n    var lineChanges = this._diffComputationResult ? this._diffComputationResult.changes : [];\n\n    var foreignOriginal = this._originalEditorState.getForeignViewZones(this.originalEditor.getWhitespaces());\n\n    var foreignModified = this._modifiedEditorState.getForeignViewZones(this.modifiedEditor.getWhitespaces());\n\n    var diffDecorations = this._strategy.getEditorsDiffDecorations(lineChanges, this._ignoreTrimWhitespace, this._renderIndicators, foreignOriginal, foreignModified, this.originalEditor, this.modifiedEditor);\n\n    try {\n      this._currentlyChangingViewZones = true;\n\n      this._originalEditorState.apply(this.originalEditor, this._originalOverviewRuler, diffDecorations.original, false);\n\n      this._modifiedEditorState.apply(this.modifiedEditor, this._modifiedOverviewRuler, diffDecorations.modified, true);\n    } finally {\n      this._currentlyChangingViewZones = false;\n    }\n  };\n\n  DiffEditorWidget.prototype._adjustOptionsForSubEditor = function (options) {\n    var clonedOptions = objects.deepClone(options || {});\n    clonedOptions.inDiffEditor = true;\n    clonedOptions.wordWrap = 'off';\n    clonedOptions.wordWrapMinified = false;\n    clonedOptions.automaticLayout = false;\n    clonedOptions.scrollbar = clonedOptions.scrollbar || {};\n    clonedOptions.scrollbar.vertical = 'visible';\n    clonedOptions.folding = false;\n    clonedOptions.codeLens = false;\n    clonedOptions.fixedOverflowWidgets = true; // clonedOptions.lineDecorationsWidth = '2ch';\n\n    if (!clonedOptions.minimap) {\n      clonedOptions.minimap = {};\n    }\n\n    clonedOptions.minimap.enabled = false;\n    return clonedOptions;\n  };\n\n  DiffEditorWidget.prototype._adjustOptionsForLeftHandSide = function (options, isEditable) {\n    var result = this._adjustOptionsForSubEditor(options);\n\n    result.readOnly = !isEditable;\n    result.extraEditorClassName = 'original-in-monaco-diff-editor';\n    return result;\n  };\n\n  DiffEditorWidget.prototype._adjustOptionsForRightHandSide = function (options) {\n    var result = this._adjustOptionsForSubEditor(options);\n\n    result.revealHorizontalRightPadding = EditorOptions.revealHorizontalRightPadding.defaultValue + DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\n    result.scrollbar.verticalHasArrows = false;\n    result.extraEditorClassName = 'modified-in-monaco-diff-editor';\n    return result;\n  };\n\n  DiffEditorWidget.prototype.doLayout = function () {\n    this._elementSizeObserver.observe();\n\n    this._doLayout();\n  };\n\n  DiffEditorWidget.prototype._doLayout = function () {\n    var width = this._elementSizeObserver.getWidth();\n\n    var height = this._elementSizeObserver.getHeight();\n\n    var reviewHeight = this._getReviewHeight();\n\n    var splitPoint = this._strategy.layout();\n\n    this._originalDomNode.style.width = splitPoint + 'px';\n    this._originalDomNode.style.left = '0px';\n    this._modifiedDomNode.style.width = width - splitPoint + 'px';\n    this._modifiedDomNode.style.left = splitPoint + 'px';\n    this._overviewDomElement.style.top = '0px';\n    this._overviewDomElement.style.height = height - reviewHeight + 'px';\n    this._overviewDomElement.style.width = DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH + 'px';\n    this._overviewDomElement.style.left = width - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH + 'px';\n\n    this._overviewViewportDomElement.setWidth(DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH);\n\n    this._overviewViewportDomElement.setHeight(30);\n\n    this.originalEditor.layout({\n      width: splitPoint,\n      height: height - reviewHeight\n    });\n    this.modifiedEditor.layout({\n      width: width - splitPoint - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH,\n      height: height - reviewHeight\n    });\n\n    if (this._originalOverviewRuler || this._modifiedOverviewRuler) {\n      this._layoutOverviewRulers();\n    }\n\n    this._reviewPane.layout(height - reviewHeight, width, reviewHeight);\n\n    this._layoutOverviewViewport();\n  };\n\n  DiffEditorWidget.prototype._layoutOverviewViewport = function () {\n    var layout = this._computeOverviewViewport();\n\n    if (!layout) {\n      this._overviewViewportDomElement.setTop(0);\n\n      this._overviewViewportDomElement.setHeight(0);\n    } else {\n      this._overviewViewportDomElement.setTop(layout.top);\n\n      this._overviewViewportDomElement.setHeight(layout.height);\n    }\n  };\n\n  DiffEditorWidget.prototype._computeOverviewViewport = function () {\n    var layoutInfo = this.modifiedEditor.getLayoutInfo();\n\n    if (!layoutInfo) {\n      return null;\n    }\n\n    var scrollTop = this.modifiedEditor.getScrollTop();\n    var scrollHeight = this.modifiedEditor.getScrollHeight();\n    var computedAvailableSize = Math.max(0, layoutInfo.height);\n    var computedRepresentableSize = Math.max(0, computedAvailableSize - 2 * 0);\n    var computedRatio = scrollHeight > 0 ? computedRepresentableSize / scrollHeight : 0;\n    var computedSliderSize = Math.max(0, Math.floor(layoutInfo.height * computedRatio));\n    var computedSliderPosition = Math.floor(scrollTop * computedRatio);\n    return {\n      height: computedSliderSize,\n      top: computedSliderPosition\n    };\n  };\n\n  DiffEditorWidget.prototype._createDataSource = function () {\n    var _this = this;\n\n    return {\n      getWidth: function () {\n        return _this._elementSizeObserver.getWidth();\n      },\n      getHeight: function () {\n        return _this._elementSizeObserver.getHeight() - _this._getReviewHeight();\n      },\n      getContainerDomNode: function () {\n        return _this._containerDomElement;\n      },\n      relayoutEditors: function () {\n        _this._doLayout();\n      },\n      getOriginalEditor: function () {\n        return _this.originalEditor;\n      },\n      getModifiedEditor: function () {\n        return _this.modifiedEditor;\n      }\n    };\n  };\n\n  DiffEditorWidget.prototype._setStrategy = function (newStrategy) {\n    if (this._strategy) {\n      this._strategy.dispose();\n    }\n\n    this._strategy = newStrategy;\n    newStrategy.applyColors(this._themeService.getTheme());\n\n    if (this._diffComputationResult) {\n      this._updateDecorations();\n    } // Just do a layout, the strategy might need it\n\n\n    this._doLayout();\n  };\n\n  DiffEditorWidget.prototype._getLineChangeAtOrBeforeLineNumber = function (lineNumber, startLineNumberExtractor) {\n    var lineChanges = this._diffComputationResult ? this._diffComputationResult.changes : [];\n\n    if (lineChanges.length === 0 || lineNumber < startLineNumberExtractor(lineChanges[0])) {\n      // There are no changes or `lineNumber` is before the first change\n      return null;\n    }\n\n    var min = 0,\n        max = lineChanges.length - 1;\n\n    while (min < max) {\n      var mid = Math.floor((min + max) / 2);\n      var midStart = startLineNumberExtractor(lineChanges[mid]);\n      var midEnd = mid + 1 <= max ? startLineNumberExtractor(lineChanges[mid + 1]) : 1073741824\n      /* MAX_SAFE_SMALL_INTEGER */\n      ;\n\n      if (lineNumber < midStart) {\n        max = mid - 1;\n      } else if (lineNumber >= midEnd) {\n        min = mid + 1;\n      } else {\n        // HIT!\n        min = mid;\n        max = mid;\n      }\n    }\n\n    return lineChanges[min];\n  };\n\n  DiffEditorWidget.prototype._getEquivalentLineForOriginalLineNumber = function (lineNumber) {\n    var lineChange = this._getLineChangeAtOrBeforeLineNumber(lineNumber, function (lineChange) {\n      return lineChange.originalStartLineNumber;\n    });\n\n    if (!lineChange) {\n      return lineNumber;\n    }\n\n    var originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\n    var modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\n    var lineChangeOriginalLength = lineChange.originalEndLineNumber > 0 ? lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1 : 0;\n    var lineChangeModifiedLength = lineChange.modifiedEndLineNumber > 0 ? lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1 : 0;\n    var delta = lineNumber - originalEquivalentLineNumber;\n\n    if (delta <= lineChangeOriginalLength) {\n      return modifiedEquivalentLineNumber + Math.min(delta, lineChangeModifiedLength);\n    }\n\n    return modifiedEquivalentLineNumber + lineChangeModifiedLength - lineChangeOriginalLength + delta;\n  };\n\n  DiffEditorWidget.prototype._getEquivalentLineForModifiedLineNumber = function (lineNumber) {\n    var lineChange = this._getLineChangeAtOrBeforeLineNumber(lineNumber, function (lineChange) {\n      return lineChange.modifiedStartLineNumber;\n    });\n\n    if (!lineChange) {\n      return lineNumber;\n    }\n\n    var originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\n    var modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\n    var lineChangeOriginalLength = lineChange.originalEndLineNumber > 0 ? lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1 : 0;\n    var lineChangeModifiedLength = lineChange.modifiedEndLineNumber > 0 ? lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1 : 0;\n    var delta = lineNumber - modifiedEquivalentLineNumber;\n\n    if (delta <= lineChangeModifiedLength) {\n      return originalEquivalentLineNumber + Math.min(delta, lineChangeOriginalLength);\n    }\n\n    return originalEquivalentLineNumber + lineChangeOriginalLength - lineChangeModifiedLength + delta;\n  };\n\n  DiffEditorWidget.prototype.getDiffLineInformationForOriginal = function (lineNumber) {\n    if (!this._diffComputationResult) {\n      // Cannot answer that which I don't know\n      return null;\n    }\n\n    return {\n      equivalentLineNumber: this._getEquivalentLineForOriginalLineNumber(lineNumber)\n    };\n  };\n\n  DiffEditorWidget.prototype.getDiffLineInformationForModified = function (lineNumber) {\n    if (!this._diffComputationResult) {\n      // Cannot answer that which I don't know\n      return null;\n    }\n\n    return {\n      equivalentLineNumber: this._getEquivalentLineForModifiedLineNumber(lineNumber)\n    };\n  };\n\n  DiffEditorWidget.ONE_OVERVIEW_WIDTH = 15;\n  DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH = 30;\n  DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY = 200; // ms\n\n  DiffEditorWidget = __decorate([__param(3, IEditorWorkerService), __param(4, IContextKeyService), __param(5, IInstantiationService), __param(6, ICodeEditorService), __param(7, IThemeService), __param(8, INotificationService), __param(9, IContextMenuService), __param(10, IEditorProgressService)], DiffEditorWidget);\n  return DiffEditorWidget;\n}(Disposable);\n\nexport { DiffEditorWidget };\n\nvar DiffEditorWidgetStyle =\n/** @class */\nfunction (_super) {\n  __extends(DiffEditorWidgetStyle, _super);\n\n  function DiffEditorWidgetStyle(dataSource) {\n    var _this = _super.call(this) || this;\n\n    _this._dataSource = dataSource;\n    _this._insertColor = null;\n    _this._removeColor = null;\n    return _this;\n  }\n\n  DiffEditorWidgetStyle.prototype.applyColors = function (theme) {\n    var newInsertColor = (theme.getColor(diffInserted) || defaultInsertColor).transparent(2);\n    var newRemoveColor = (theme.getColor(diffRemoved) || defaultRemoveColor).transparent(2);\n    var hasChanges = !newInsertColor.equals(this._insertColor) || !newRemoveColor.equals(this._removeColor);\n    this._insertColor = newInsertColor;\n    this._removeColor = newRemoveColor;\n    return hasChanges;\n  };\n\n  DiffEditorWidgetStyle.prototype.getEditorsDiffDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalWhitespaces, modifiedWhitespaces, originalEditor, modifiedEditor) {\n    // Get view zones\n    modifiedWhitespaces = modifiedWhitespaces.sort(function (a, b) {\n      return a.afterLineNumber - b.afterLineNumber;\n    });\n    originalWhitespaces = originalWhitespaces.sort(function (a, b) {\n      return a.afterLineNumber - b.afterLineNumber;\n    });\n\n    var zones = this._getViewZones(lineChanges, originalWhitespaces, modifiedWhitespaces, originalEditor, modifiedEditor, renderIndicators); // Get decorations & overview ruler zones\n\n\n    var originalDecorations = this._getOriginalEditorDecorations(lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor);\n\n    var modifiedDecorations = this._getModifiedEditorDecorations(lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor);\n\n    return {\n      original: {\n        decorations: originalDecorations.decorations,\n        overviewZones: originalDecorations.overviewZones,\n        zones: zones.original\n      },\n      modified: {\n        decorations: modifiedDecorations.decorations,\n        overviewZones: modifiedDecorations.overviewZones,\n        zones: zones.modified\n      }\n    };\n  };\n\n  return DiffEditorWidgetStyle;\n}(Disposable);\n\nvar ForeignViewZonesIterator =\n/** @class */\nfunction () {\n  function ForeignViewZonesIterator(source) {\n    this._source = source;\n    this._index = -1;\n    this.current = null;\n    this.advance();\n  }\n\n  ForeignViewZonesIterator.prototype.advance = function () {\n    this._index++;\n\n    if (this._index < this._source.length) {\n      this.current = this._source[this._index];\n    } else {\n      this.current = null;\n    }\n  };\n\n  return ForeignViewZonesIterator;\n}();\n\nvar ViewZonesComputer =\n/** @class */\nfunction () {\n  function ViewZonesComputer(lineChanges, originalForeignVZ, originalLineHeight, modifiedForeignVZ, modifiedLineHeight) {\n    this.lineChanges = lineChanges;\n    this.originalForeignVZ = originalForeignVZ;\n    this.originalLineHeight = originalLineHeight;\n    this.modifiedForeignVZ = modifiedForeignVZ;\n    this.modifiedLineHeight = modifiedLineHeight;\n  }\n\n  ViewZonesComputer.prototype.getViewZones = function () {\n    var result = {\n      original: [],\n      modified: []\n    };\n    var lineChangeModifiedLength = 0;\n    var lineChangeOriginalLength = 0;\n    var originalEquivalentLineNumber = 0;\n    var modifiedEquivalentLineNumber = 0;\n    var originalEndEquivalentLineNumber = 0;\n    var modifiedEndEquivalentLineNumber = 0;\n\n    var sortMyViewZones = function (a, b) {\n      return a.afterLineNumber - b.afterLineNumber;\n    };\n\n    var addAndCombineIfPossible = function (destination, item) {\n      if (item.domNode === null && destination.length > 0) {\n        var lastItem = destination[destination.length - 1];\n\n        if (lastItem.afterLineNumber === item.afterLineNumber && lastItem.domNode === null) {\n          lastItem.heightInLines += item.heightInLines;\n          return;\n        }\n      }\n\n      destination.push(item);\n    };\n\n    var modifiedForeignVZ = new ForeignViewZonesIterator(this.modifiedForeignVZ);\n    var originalForeignVZ = new ForeignViewZonesIterator(this.originalForeignVZ); // In order to include foreign view zones after the last line change, the for loop will iterate once more after the end of the `lineChanges` array\n\n    for (var i = 0, length_5 = this.lineChanges.length; i <= length_5; i++) {\n      var lineChange = i < length_5 ? this.lineChanges[i] : null;\n\n      if (lineChange !== null) {\n        originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\n        modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\n        lineChangeOriginalLength = lineChange.originalEndLineNumber > 0 ? lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1 : 0;\n        lineChangeModifiedLength = lineChange.modifiedEndLineNumber > 0 ? lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1 : 0;\n        originalEndEquivalentLineNumber = Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber);\n        modifiedEndEquivalentLineNumber = Math.max(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber);\n      } else {\n        // Increase to very large value to get the producing tests of foreign view zones running\n        originalEquivalentLineNumber += 10000000 + lineChangeOriginalLength;\n        modifiedEquivalentLineNumber += 10000000 + lineChangeModifiedLength;\n        originalEndEquivalentLineNumber = originalEquivalentLineNumber;\n        modifiedEndEquivalentLineNumber = modifiedEquivalentLineNumber;\n      } // Each step produces view zones, and after producing them, we try to cancel them out, to avoid empty-empty view zone cases\n\n\n      var stepOriginal = [];\n      var stepModified = []; // ---------------------------- PRODUCE VIEW ZONES\n      // [PRODUCE] View zone(s) in original-side due to foreign view zone(s) in modified-side\n\n      while (modifiedForeignVZ.current && modifiedForeignVZ.current.afterLineNumber <= modifiedEndEquivalentLineNumber) {\n        var viewZoneLineNumber = void 0;\n\n        if (modifiedForeignVZ.current.afterLineNumber <= modifiedEquivalentLineNumber) {\n          viewZoneLineNumber = originalEquivalentLineNumber - modifiedEquivalentLineNumber + modifiedForeignVZ.current.afterLineNumber;\n        } else {\n          viewZoneLineNumber = originalEndEquivalentLineNumber;\n        }\n\n        var marginDomNode = null;\n\n        if (lineChange && lineChange.modifiedStartLineNumber <= modifiedForeignVZ.current.afterLineNumber && modifiedForeignVZ.current.afterLineNumber <= lineChange.modifiedEndLineNumber) {\n          marginDomNode = this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion();\n        }\n\n        stepOriginal.push({\n          afterLineNumber: viewZoneLineNumber,\n          heightInLines: modifiedForeignVZ.current.height / this.modifiedLineHeight,\n          domNode: null,\n          marginDomNode: marginDomNode\n        });\n        modifiedForeignVZ.advance();\n      } // [PRODUCE] View zone(s) in modified-side due to foreign view zone(s) in original-side\n\n\n      while (originalForeignVZ.current && originalForeignVZ.current.afterLineNumber <= originalEndEquivalentLineNumber) {\n        var viewZoneLineNumber = void 0;\n\n        if (originalForeignVZ.current.afterLineNumber <= originalEquivalentLineNumber) {\n          viewZoneLineNumber = modifiedEquivalentLineNumber - originalEquivalentLineNumber + originalForeignVZ.current.afterLineNumber;\n        } else {\n          viewZoneLineNumber = modifiedEndEquivalentLineNumber;\n        }\n\n        stepModified.push({\n          afterLineNumber: viewZoneLineNumber,\n          heightInLines: originalForeignVZ.current.height / this.originalLineHeight,\n          domNode: null\n        });\n        originalForeignVZ.advance();\n      }\n\n      if (lineChange !== null && isChangeOrInsert(lineChange)) {\n        var r = this._produceOriginalFromDiff(lineChange, lineChangeOriginalLength, lineChangeModifiedLength);\n\n        if (r) {\n          stepOriginal.push(r);\n        }\n      }\n\n      if (lineChange !== null && isChangeOrDelete(lineChange)) {\n        var r = this._produceModifiedFromDiff(lineChange, lineChangeOriginalLength, lineChangeModifiedLength);\n\n        if (r) {\n          stepModified.push(r);\n        }\n      } // ---------------------------- END PRODUCE VIEW ZONES\n      // ---------------------------- EMIT MINIMAL VIEW ZONES\n      // [CANCEL & EMIT] Try to cancel view zones out\n\n\n      var stepOriginalIndex = 0;\n      var stepModifiedIndex = 0;\n      stepOriginal = stepOriginal.sort(sortMyViewZones);\n      stepModified = stepModified.sort(sortMyViewZones);\n\n      while (stepOriginalIndex < stepOriginal.length && stepModifiedIndex < stepModified.length) {\n        var original = stepOriginal[stepOriginalIndex];\n        var modified = stepModified[stepModifiedIndex];\n        var originalDelta = original.afterLineNumber - originalEquivalentLineNumber;\n        var modifiedDelta = modified.afterLineNumber - modifiedEquivalentLineNumber;\n\n        if (originalDelta < modifiedDelta) {\n          addAndCombineIfPossible(result.original, original);\n          stepOriginalIndex++;\n        } else if (modifiedDelta < originalDelta) {\n          addAndCombineIfPossible(result.modified, modified);\n          stepModifiedIndex++;\n        } else if (original.shouldNotShrink) {\n          addAndCombineIfPossible(result.original, original);\n          stepOriginalIndex++;\n        } else if (modified.shouldNotShrink) {\n          addAndCombineIfPossible(result.modified, modified);\n          stepModifiedIndex++;\n        } else {\n          if (original.heightInLines >= modified.heightInLines) {\n            // modified view zone gets removed\n            original.heightInLines -= modified.heightInLines;\n            stepModifiedIndex++;\n          } else {\n            // original view zone gets removed\n            modified.heightInLines -= original.heightInLines;\n            stepOriginalIndex++;\n          }\n        }\n      } // [EMIT] Remaining original view zones\n\n\n      while (stepOriginalIndex < stepOriginal.length) {\n        addAndCombineIfPossible(result.original, stepOriginal[stepOriginalIndex]);\n        stepOriginalIndex++;\n      } // [EMIT] Remaining modified view zones\n\n\n      while (stepModifiedIndex < stepModified.length) {\n        addAndCombineIfPossible(result.modified, stepModified[stepModifiedIndex]);\n        stepModifiedIndex++;\n      } // ---------------------------- END EMIT MINIMAL VIEW ZONES\n\n    }\n\n    return {\n      original: ViewZonesComputer._ensureDomNodes(result.original),\n      modified: ViewZonesComputer._ensureDomNodes(result.modified)\n    };\n  };\n\n  ViewZonesComputer._ensureDomNodes = function (zones) {\n    return zones.map(function (z) {\n      if (!z.domNode) {\n        z.domNode = createFakeLinesDiv();\n      }\n\n      return z;\n    });\n  };\n\n  return ViewZonesComputer;\n}();\n\nfunction createDecoration(startLineNumber, startColumn, endLineNumber, endColumn, options) {\n  return {\n    range: new Range(startLineNumber, startColumn, endLineNumber, endColumn),\n    options: options\n  };\n}\n\nvar DECORATIONS = {\n  charDelete: ModelDecorationOptions.register({\n    className: 'char-delete'\n  }),\n  charDeleteWholeLine: ModelDecorationOptions.register({\n    className: 'char-delete',\n    isWholeLine: true\n  }),\n  charInsert: ModelDecorationOptions.register({\n    className: 'char-insert'\n  }),\n  charInsertWholeLine: ModelDecorationOptions.register({\n    className: 'char-insert',\n    isWholeLine: true\n  }),\n  lineInsert: ModelDecorationOptions.register({\n    className: 'line-insert',\n    marginClassName: 'line-insert',\n    isWholeLine: true\n  }),\n  lineInsertWithSign: ModelDecorationOptions.register({\n    className: 'line-insert',\n    linesDecorationsClassName: 'insert-sign codicon codicon-add',\n    marginClassName: 'line-insert',\n    isWholeLine: true\n  }),\n  lineDelete: ModelDecorationOptions.register({\n    className: 'line-delete',\n    marginClassName: 'line-delete',\n    isWholeLine: true\n  }),\n  lineDeleteWithSign: ModelDecorationOptions.register({\n    className: 'line-delete',\n    linesDecorationsClassName: 'delete-sign codicon codicon-remove',\n    marginClassName: 'line-delete',\n    isWholeLine: true\n  }),\n  lineDeleteMargin: ModelDecorationOptions.register({\n    marginClassName: 'line-delete'\n  })\n};\n\nvar DiffEditorWidgetSideBySide =\n/** @class */\nfunction (_super) {\n  __extends(DiffEditorWidgetSideBySide, _super);\n\n  function DiffEditorWidgetSideBySide(dataSource, enableSplitViewResizing) {\n    var _this = _super.call(this, dataSource) || this;\n\n    _this._disableSash = enableSplitViewResizing === false;\n    _this._sashRatio = null;\n    _this._sashPosition = null;\n    _this._startSashPosition = null;\n    _this._sash = _this._register(new Sash(_this._dataSource.getContainerDomNode(), _this));\n\n    if (_this._disableSash) {\n      _this._sash.state = 0\n      /* Disabled */\n      ;\n    }\n\n    _this._sash.onDidStart(function () {\n      return _this.onSashDragStart();\n    });\n\n    _this._sash.onDidChange(function (e) {\n      return _this.onSashDrag(e);\n    });\n\n    _this._sash.onDidEnd(function () {\n      return _this.onSashDragEnd();\n    });\n\n    _this._sash.onDidReset(function () {\n      return _this.onSashReset();\n    });\n\n    return _this;\n  }\n\n  DiffEditorWidgetSideBySide.prototype.setEnableSplitViewResizing = function (enableSplitViewResizing) {\n    var newDisableSash = enableSplitViewResizing === false;\n\n    if (this._disableSash !== newDisableSash) {\n      this._disableSash = newDisableSash;\n      this._sash.state = this._disableSash ? 0\n      /* Disabled */\n      : 3\n      /* Enabled */\n      ;\n    }\n  };\n\n  DiffEditorWidgetSideBySide.prototype.layout = function (sashRatio) {\n    if (sashRatio === void 0) {\n      sashRatio = this._sashRatio;\n    }\n\n    var w = this._dataSource.getWidth();\n\n    var contentWidth = w - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\n    var sashPosition = Math.floor((sashRatio || 0.5) * contentWidth);\n    var midPoint = Math.floor(0.5 * contentWidth);\n    sashPosition = this._disableSash ? midPoint : sashPosition || midPoint;\n\n    if (contentWidth > DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH * 2) {\n      if (sashPosition < DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH) {\n        sashPosition = DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH;\n      }\n\n      if (sashPosition > contentWidth - DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH) {\n        sashPosition = contentWidth - DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH;\n      }\n    } else {\n      sashPosition = midPoint;\n    }\n\n    if (this._sashPosition !== sashPosition) {\n      this._sashPosition = sashPosition;\n\n      this._sash.layout();\n    }\n\n    return this._sashPosition;\n  };\n\n  DiffEditorWidgetSideBySide.prototype.onSashDragStart = function () {\n    this._startSashPosition = this._sashPosition;\n  };\n\n  DiffEditorWidgetSideBySide.prototype.onSashDrag = function (e) {\n    var w = this._dataSource.getWidth();\n\n    var contentWidth = w - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\n    var sashPosition = this.layout((this._startSashPosition + (e.currentX - e.startX)) / contentWidth);\n    this._sashRatio = sashPosition / contentWidth;\n\n    this._dataSource.relayoutEditors();\n  };\n\n  DiffEditorWidgetSideBySide.prototype.onSashDragEnd = function () {\n    this._sash.layout();\n  };\n\n  DiffEditorWidgetSideBySide.prototype.onSashReset = function () {\n    this._sashRatio = 0.5;\n\n    this._dataSource.relayoutEditors();\n\n    this._sash.layout();\n  };\n\n  DiffEditorWidgetSideBySide.prototype.getVerticalSashTop = function (sash) {\n    return 0;\n  };\n\n  DiffEditorWidgetSideBySide.prototype.getVerticalSashLeft = function (sash) {\n    return this._sashPosition;\n  };\n\n  DiffEditorWidgetSideBySide.prototype.getVerticalSashHeight = function (sash) {\n    return this._dataSource.getHeight();\n  };\n\n  DiffEditorWidgetSideBySide.prototype._getViewZones = function (lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor) {\n    var c = new SideBySideViewZonesComputer(lineChanges, originalForeignVZ, originalEditor.getOption(49\n    /* lineHeight */\n    ), modifiedForeignVZ, modifiedEditor.getOption(49\n    /* lineHeight */\n    ));\n    return c.getViewZones();\n  };\n\n  DiffEditorWidgetSideBySide.prototype._getOriginalEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\n    var overviewZoneColor = String(this._removeColor);\n    var result = {\n      decorations: [],\n      overviewZones: []\n    };\n    var originalModel = originalEditor.getModel();\n\n    for (var i = 0, length_6 = lineChanges.length; i < length_6; i++) {\n      var lineChange = lineChanges[i];\n\n      if (isChangeOrDelete(lineChange)) {\n        result.decorations.push({\n          range: new Range(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, 1073741824\n          /* MAX_SAFE_SMALL_INTEGER */\n          ),\n          options: renderIndicators ? DECORATIONS.lineDeleteWithSign : DECORATIONS.lineDelete\n        });\n\n        if (!isChangeOrInsert(lineChange) || !lineChange.charChanges) {\n          result.decorations.push(createDecoration(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, 1073741824\n          /* MAX_SAFE_SMALL_INTEGER */\n          , DECORATIONS.charDeleteWholeLine));\n        }\n\n        result.overviewZones.push(new OverviewRulerZone(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber, overviewZoneColor));\n\n        if (lineChange.charChanges) {\n          for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\n            var charChange = lineChange.charChanges[j];\n\n            if (isChangeOrDelete(charChange)) {\n              if (ignoreTrimWhitespace) {\n                for (var lineNumber = charChange.originalStartLineNumber; lineNumber <= charChange.originalEndLineNumber; lineNumber++) {\n                  var startColumn = void 0;\n                  var endColumn = void 0;\n\n                  if (lineNumber === charChange.originalStartLineNumber) {\n                    startColumn = charChange.originalStartColumn;\n                  } else {\n                    startColumn = originalModel.getLineFirstNonWhitespaceColumn(lineNumber);\n                  }\n\n                  if (lineNumber === charChange.originalEndLineNumber) {\n                    endColumn = charChange.originalEndColumn;\n                  } else {\n                    endColumn = originalModel.getLineLastNonWhitespaceColumn(lineNumber);\n                  }\n\n                  result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charDelete));\n                }\n              } else {\n                result.decorations.push(createDecoration(charChange.originalStartLineNumber, charChange.originalStartColumn, charChange.originalEndLineNumber, charChange.originalEndColumn, DECORATIONS.charDelete));\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return result;\n  };\n\n  DiffEditorWidgetSideBySide.prototype._getModifiedEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\n    var overviewZoneColor = String(this._insertColor);\n    var result = {\n      decorations: [],\n      overviewZones: []\n    };\n    var modifiedModel = modifiedEditor.getModel();\n\n    for (var i = 0, length_7 = lineChanges.length; i < length_7; i++) {\n      var lineChange = lineChanges[i];\n\n      if (isChangeOrInsert(lineChange)) {\n        result.decorations.push({\n          range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824\n          /* MAX_SAFE_SMALL_INTEGER */\n          ),\n          options: renderIndicators ? DECORATIONS.lineInsertWithSign : DECORATIONS.lineInsert\n        });\n\n        if (!isChangeOrDelete(lineChange) || !lineChange.charChanges) {\n          result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824\n          /* MAX_SAFE_SMALL_INTEGER */\n          , DECORATIONS.charInsertWholeLine));\n        }\n\n        result.overviewZones.push(new OverviewRulerZone(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber, overviewZoneColor));\n\n        if (lineChange.charChanges) {\n          for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\n            var charChange = lineChange.charChanges[j];\n\n            if (isChangeOrInsert(charChange)) {\n              if (ignoreTrimWhitespace) {\n                for (var lineNumber = charChange.modifiedStartLineNumber; lineNumber <= charChange.modifiedEndLineNumber; lineNumber++) {\n                  var startColumn = void 0;\n                  var endColumn = void 0;\n\n                  if (lineNumber === charChange.modifiedStartLineNumber) {\n                    startColumn = charChange.modifiedStartColumn;\n                  } else {\n                    startColumn = modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber);\n                  }\n\n                  if (lineNumber === charChange.modifiedEndLineNumber) {\n                    endColumn = charChange.modifiedEndColumn;\n                  } else {\n                    endColumn = modifiedModel.getLineLastNonWhitespaceColumn(lineNumber);\n                  }\n\n                  result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charInsert));\n                }\n              } else {\n                result.decorations.push(createDecoration(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn, DECORATIONS.charInsert));\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return result;\n  };\n\n  DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH = 100;\n  return DiffEditorWidgetSideBySide;\n}(DiffEditorWidgetStyle);\n\nvar SideBySideViewZonesComputer =\n/** @class */\nfunction (_super) {\n  __extends(SideBySideViewZonesComputer, _super);\n\n  function SideBySideViewZonesComputer(lineChanges, originalForeignVZ, originalLineHeight, modifiedForeignVZ, modifiedLineHeight) {\n    return _super.call(this, lineChanges, originalForeignVZ, originalLineHeight, modifiedForeignVZ, modifiedLineHeight) || this;\n  }\n\n  SideBySideViewZonesComputer.prototype._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion = function () {\n    return null;\n  };\n\n  SideBySideViewZonesComputer.prototype._produceOriginalFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\n    if (lineChangeModifiedLength > lineChangeOriginalLength) {\n      return {\n        afterLineNumber: Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber),\n        heightInLines: lineChangeModifiedLength - lineChangeOriginalLength,\n        domNode: null\n      };\n    }\n\n    return null;\n  };\n\n  SideBySideViewZonesComputer.prototype._produceModifiedFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\n    if (lineChangeOriginalLength > lineChangeModifiedLength) {\n      return {\n        afterLineNumber: Math.max(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber),\n        heightInLines: lineChangeOriginalLength - lineChangeModifiedLength,\n        domNode: null\n      };\n    }\n\n    return null;\n  };\n\n  return SideBySideViewZonesComputer;\n}(ViewZonesComputer);\n\nvar DiffEditorWidgetInline =\n/** @class */\nfunction (_super) {\n  __extends(DiffEditorWidgetInline, _super);\n\n  function DiffEditorWidgetInline(dataSource, enableSplitViewResizing) {\n    var _this = _super.call(this, dataSource) || this;\n\n    _this.decorationsLeft = dataSource.getOriginalEditor().getLayoutInfo().decorationsLeft;\n\n    _this._register(dataSource.getOriginalEditor().onDidLayoutChange(function (layoutInfo) {\n      if (_this.decorationsLeft !== layoutInfo.decorationsLeft) {\n        _this.decorationsLeft = layoutInfo.decorationsLeft;\n        dataSource.relayoutEditors();\n      }\n    }));\n\n    return _this;\n  }\n\n  DiffEditorWidgetInline.prototype.setEnableSplitViewResizing = function (enableSplitViewResizing) {// Nothing to do..\n  };\n\n  DiffEditorWidgetInline.prototype._getViewZones = function (lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators) {\n    var computer = new InlineViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators);\n    return computer.getViewZones();\n  };\n\n  DiffEditorWidgetInline.prototype._getOriginalEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\n    var overviewZoneColor = String(this._removeColor);\n    var result = {\n      decorations: [],\n      overviewZones: []\n    };\n\n    for (var i = 0, length_8 = lineChanges.length; i < length_8; i++) {\n      var lineChange = lineChanges[i]; // Add overview zones in the overview ruler\n\n      if (isChangeOrDelete(lineChange)) {\n        result.decorations.push({\n          range: new Range(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, 1073741824\n          /* MAX_SAFE_SMALL_INTEGER */\n          ),\n          options: DECORATIONS.lineDeleteMargin\n        });\n        result.overviewZones.push(new OverviewRulerZone(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber, overviewZoneColor));\n      }\n    }\n\n    return result;\n  };\n\n  DiffEditorWidgetInline.prototype._getModifiedEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\n    var overviewZoneColor = String(this._insertColor);\n    var result = {\n      decorations: [],\n      overviewZones: []\n    };\n    var modifiedModel = modifiedEditor.getModel();\n\n    for (var i = 0, length_9 = lineChanges.length; i < length_9; i++) {\n      var lineChange = lineChanges[i]; // Add decorations & overview zones\n\n      if (isChangeOrInsert(lineChange)) {\n        result.decorations.push({\n          range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824\n          /* MAX_SAFE_SMALL_INTEGER */\n          ),\n          options: renderIndicators ? DECORATIONS.lineInsertWithSign : DECORATIONS.lineInsert\n        });\n        result.overviewZones.push(new OverviewRulerZone(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber, overviewZoneColor));\n\n        if (lineChange.charChanges) {\n          for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\n            var charChange = lineChange.charChanges[j];\n\n            if (isChangeOrInsert(charChange)) {\n              if (ignoreTrimWhitespace) {\n                for (var lineNumber = charChange.modifiedStartLineNumber; lineNumber <= charChange.modifiedEndLineNumber; lineNumber++) {\n                  var startColumn = void 0;\n                  var endColumn = void 0;\n\n                  if (lineNumber === charChange.modifiedStartLineNumber) {\n                    startColumn = charChange.modifiedStartColumn;\n                  } else {\n                    startColumn = modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber);\n                  }\n\n                  if (lineNumber === charChange.modifiedEndLineNumber) {\n                    endColumn = charChange.modifiedEndColumn;\n                  } else {\n                    endColumn = modifiedModel.getLineLastNonWhitespaceColumn(lineNumber);\n                  }\n\n                  result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charInsert));\n                }\n              } else {\n                result.decorations.push(createDecoration(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn, DECORATIONS.charInsert));\n              }\n            }\n          }\n        } else {\n          result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824\n          /* MAX_SAFE_SMALL_INTEGER */\n          , DECORATIONS.charInsertWholeLine));\n        }\n      }\n    }\n\n    return result;\n  };\n\n  DiffEditorWidgetInline.prototype.layout = function () {\n    // An editor should not be smaller than 5px\n    return Math.max(5, this.decorationsLeft);\n  };\n\n  return DiffEditorWidgetInline;\n}(DiffEditorWidgetStyle);\n\nvar InlineViewZonesComputer =\n/** @class */\nfunction (_super) {\n  __extends(InlineViewZonesComputer, _super);\n\n  function InlineViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators) {\n    var _this = _super.call(this, lineChanges, originalForeignVZ, originalEditor.getOption(49\n    /* lineHeight */\n    ), modifiedForeignVZ, modifiedEditor.getOption(49\n    /* lineHeight */\n    )) || this;\n\n    _this.originalModel = originalEditor.getModel();\n    _this.modifiedEditorOptions = modifiedEditor.getOptions();\n    _this.modifiedEditorTabSize = modifiedEditor.getModel().getOptions().tabSize;\n    _this.renderIndicators = renderIndicators;\n    return _this;\n  }\n\n  InlineViewZonesComputer.prototype._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion = function () {\n    var result = document.createElement('div');\n    result.className = 'inline-added-margin-view-zone';\n    return result;\n  };\n\n  InlineViewZonesComputer.prototype._produceOriginalFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\n    var marginDomNode = document.createElement('div');\n    marginDomNode.className = 'inline-added-margin-view-zone';\n    return {\n      afterLineNumber: Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber),\n      heightInLines: lineChangeModifiedLength,\n      domNode: document.createElement('div'),\n      marginDomNode: marginDomNode\n    };\n  };\n\n  InlineViewZonesComputer.prototype._produceModifiedFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\n    var decorations = [];\n\n    if (lineChange.charChanges) {\n      for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\n        var charChange = lineChange.charChanges[j];\n\n        if (isChangeOrDelete(charChange)) {\n          decorations.push(new InlineDecoration(new Range(charChange.originalStartLineNumber, charChange.originalStartColumn, charChange.originalEndLineNumber, charChange.originalEndColumn), 'char-delete', 0\n          /* Regular */\n          ));\n        }\n      }\n    }\n\n    var sb = createStringBuilder(10000);\n    var marginHTML = [];\n    var layoutInfo = this.modifiedEditorOptions.get(107\n    /* layoutInfo */\n    );\n    var fontInfo = this.modifiedEditorOptions.get(34\n    /* fontInfo */\n    );\n    var lineDecorationsWidth = layoutInfo.decorationsWidth;\n    var lineHeight = this.modifiedEditorOptions.get(49\n    /* lineHeight */\n    );\n    var typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n    var maxCharsPerLine = 0;\n    var originalContent = [];\n\n    for (var lineNumber = lineChange.originalStartLineNumber; lineNumber <= lineChange.originalEndLineNumber; lineNumber++) {\n      maxCharsPerLine = Math.max(maxCharsPerLine, this._renderOriginalLine(lineNumber - lineChange.originalStartLineNumber, this.originalModel, this.modifiedEditorOptions, this.modifiedEditorTabSize, lineNumber, decorations, sb));\n      originalContent.push(this.originalModel.getLineContent(lineNumber));\n\n      if (this.renderIndicators) {\n        var index = lineNumber - lineChange.originalStartLineNumber;\n        marginHTML = marginHTML.concat([\"<div class=\\\"delete-sign codicon codicon-remove\\\" style=\\\"position:absolute;top:\" + index * lineHeight + \"px;width:\" + lineDecorationsWidth + \"px;height:\" + lineHeight + \"px;right:0;\\\"></div>\"]);\n      }\n    }\n\n    maxCharsPerLine += this.modifiedEditorOptions.get(79\n    /* scrollBeyondLastColumn */\n    );\n    var domNode = document.createElement('div');\n    domNode.className = 'view-lines line-delete';\n    domNode.innerHTML = sb.build();\n    Configuration.applyFontInfoSlow(domNode, fontInfo);\n    var marginDomNode = document.createElement('div');\n    marginDomNode.className = 'inline-deleted-margin-view-zone';\n    marginDomNode.innerHTML = marginHTML.join('');\n    Configuration.applyFontInfoSlow(marginDomNode, fontInfo);\n    return {\n      shouldNotShrink: true,\n      afterLineNumber: lineChange.modifiedEndLineNumber === 0 ? lineChange.modifiedStartLineNumber : lineChange.modifiedStartLineNumber - 1,\n      heightInLines: lineChangeOriginalLength,\n      minWidthInPx: maxCharsPerLine * typicalHalfwidthCharacterWidth,\n      domNode: domNode,\n      marginDomNode: marginDomNode,\n      diff: {\n        originalStartLineNumber: lineChange.originalStartLineNumber,\n        originalEndLineNumber: lineChange.originalEndLineNumber,\n        modifiedStartLineNumber: lineChange.modifiedStartLineNumber,\n        modifiedEndLineNumber: lineChange.modifiedEndLineNumber,\n        originalContent: originalContent\n      }\n    };\n  };\n\n  InlineViewZonesComputer.prototype._renderOriginalLine = function (count, originalModel, options, tabSize, lineNumber, decorations, sb) {\n    var lineTokens = originalModel.getLineTokens(lineNumber);\n    var lineContent = lineTokens.getLineContent();\n    var fontInfo = options.get(34\n    /* fontInfo */\n    );\n    var actualDecorations = LineDecoration.filter(decorations, lineNumber, 1, lineContent.length + 1);\n    sb.appendASCIIString('<div class=\"view-line');\n\n    if (decorations.length === 0) {\n      // No char changes\n      sb.appendASCIIString(' char-delete');\n    }\n\n    sb.appendASCIIString('\" style=\"top:');\n    sb.appendASCIIString(String(count * options.get(49\n    /* lineHeight */\n    )));\n    sb.appendASCIIString('px;width:1000000px;\">');\n    var isBasicASCII = ViewLineRenderingData.isBasicASCII(lineContent, originalModel.mightContainNonBasicASCII());\n    var containsRTL = ViewLineRenderingData.containsRTL(lineContent, isBasicASCII, originalModel.mightContainRTL());\n    var output = renderViewLine(new RenderLineInput(fontInfo.isMonospace && !options.get(23\n    /* disableMonospaceOptimizations */\n    ), fontInfo.canUseHalfwidthRightwardsArrow, lineContent, false, isBasicASCII, containsRTL, 0, lineTokens, actualDecorations, tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, options.get(88\n    /* stopRenderingLineAfter */\n    ), options.get(74\n    /* renderWhitespace */\n    ), options.get(69\n    /* renderControlCharacters */\n    ), options.get(35\n    /* fontLigatures */\n    ) !== EditorFontLigatures.OFF, null // Send no selections, original line cannot be selected\n    ), sb);\n    sb.appendASCIIString('</div>');\n    var absoluteOffsets = output.characterMapping.getAbsoluteOffsets();\n    return absoluteOffsets.length > 0 ? absoluteOffsets[absoluteOffsets.length - 1] : 0;\n  };\n\n  return InlineViewZonesComputer;\n}(ViewZonesComputer);\n\nfunction isChangeOrInsert(lineChange) {\n  return lineChange.modifiedEndLineNumber > 0;\n}\n\nfunction isChangeOrDelete(lineChange) {\n  return lineChange.originalEndLineNumber > 0;\n}\n\nfunction createFakeLinesDiv() {\n  var r = document.createElement('div');\n  r.className = 'diagonal-fill';\n  return r;\n}\n\nregisterThemingParticipant(function (theme, collector) {\n  var added = theme.getColor(diffInserted);\n\n  if (added) {\n    collector.addRule(\".monaco-editor .line-insert, .monaco-editor .char-insert { background-color: \" + added + \"; }\");\n    collector.addRule(\".monaco-diff-editor .line-insert, .monaco-diff-editor .char-insert { background-color: \" + added + \"; }\");\n    collector.addRule(\".monaco-editor .inline-added-margin-view-zone { background-color: \" + added + \"; }\");\n  }\n\n  var removed = theme.getColor(diffRemoved);\n\n  if (removed) {\n    collector.addRule(\".monaco-editor .line-delete, .monaco-editor .char-delete { background-color: \" + removed + \"; }\");\n    collector.addRule(\".monaco-diff-editor .line-delete, .monaco-diff-editor .char-delete { background-color: \" + removed + \"; }\");\n    collector.addRule(\".monaco-editor .inline-deleted-margin-view-zone { background-color: \" + removed + \"; }\");\n  }\n\n  var addedOutline = theme.getColor(diffInsertedOutline);\n\n  if (addedOutline) {\n    collector.addRule(\".monaco-editor .line-insert, .monaco-editor .char-insert { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + addedOutline + \"; }\");\n  }\n\n  var removedOutline = theme.getColor(diffRemovedOutline);\n\n  if (removedOutline) {\n    collector.addRule(\".monaco-editor .line-delete, .monaco-editor .char-delete { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + removedOutline + \"; }\");\n  }\n\n  var shadow = theme.getColor(scrollbarShadow);\n\n  if (shadow) {\n    collector.addRule(\".monaco-diff-editor.side-by-side .editor.modified { box-shadow: -6px 0 5px -5px \" + shadow + \"; }\");\n  }\n\n  var border = theme.getColor(diffBorder);\n\n  if (border) {\n    collector.addRule(\".monaco-diff-editor.side-by-side .editor.modified { border-left: 1px solid \" + border + \"; }\");\n  }\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/browser/widget/diffEditorWidget.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","nls","dom","createFastDomNode","Sash","RunOnceScheduler","Emitter","Disposable","objects","Configuration","StableEditorScrollState","ICodeEditorService","CodeEditorWidget","DiffReview","EditorOptions","EditorFontLigatures","Range","createStringBuilder","editorCommon","ModelDecorationOptions","IEditorWorkerService","OverviewRulerZone","LineDecoration","RenderLineInput","renderViewLine","InlineDecoration","ViewLineRenderingData","IContextKeyService","IInstantiationService","ServiceCollection","INotificationService","defaultInsertColor","defaultRemoveColor","diffBorder","diffInserted","diffInsertedOutline","diffRemoved","diffRemovedOutline","scrollbarShadow","IThemeService","getThemeTypeSelector","registerThemingParticipant","IContextMenuService","InlineDiffMargin","EditorExtensionsRegistry","onUnexpectedError","IEditorProgressService","ElementSizeObserver","VisualEditorState","_contextMenuService","_clipboardService","_zones","inlineDiffMargins","_zonesMap","_decorations","getForeignViewZones","allViewZones","_this","filter","z","String","id","clean","editor","changeViewZones","viewChangeAccessor","length_1","removeZone","deltaDecorations","apply","overviewRuler","newDecorations","restoreScrollState","scrollState","capture","length_2","length_3","dispose","length_4","zones","viewZone","suppressMouseDown","zoneId","addZone","push","diff","marginDomNode","restore","decorations","setZones","overviewZones","DIFF_EDITOR_ID","DiffEditorWidget","_super","domElement","options","clipboardService","editorWorkerService","contextKeyService","instantiationService","codeEditorService","themeService","notificationService","contextMenuService","_editorProgressService","call","_onDidDispose","_register","onDidDispose","event","_onDidUpdateDiff","onDidUpdateDiff","_lastOriginalWarning","_lastModifiedWarning","_editorWorkerService","_codeEditorService","_contextKeyService","createScoped","createKey","_themeService","_notificationService","_state","_updatingDiffProgress","_domElement","_renderSideBySide","renderSideBySide","_maxComputationTime","maxComputationTime","_ignoreTrimWhitespace","ignoreTrimWhitespace","_renderIndicators","renderIndicators","_originalIsEditable","originalEditable","Boolean","_updateDecorationsRunner","_updateDecorations","_containerDomElement","document","createElement","className","_getClassName","getTheme","style","position","height","appendChild","_overviewViewportDomElement","setClassName","setPosition","_overviewDomElement","domNode","addStandardDisposableListener","e","modifiedEditor","delegateVerticalScrollbarMouseDown","_originalDomNode","_modifiedDomNode","_beginUpdateDecorationsTimeout","_currentlyChangingViewZones","_diffComputationToken","_originalEditorState","_modifiedEditorState","_isVisible","_isHandlingScrollEvent","_elementSizeObserver","undefined","_onDidContainerSizeChanged","automaticLayout","startObserving","_diffComputationResult","leftContextKeyService","leftServices","set","leftScopedInstantiationService","createChild","rightContextKeyService","rightServices","rightScopedInstantiationService","originalEditor","_createLeftHandSideEditor","_createRightHandSideEditor","_originalOverviewRuler","_modifiedOverviewRuler","_reviewPane","shadow","actionBarContainer","_enableSplitViewResizing","enableSplitViewResizing","_setStrategy","DiffEditorWidgetSideBySide","_createDataSource","DiffEditorWidgetInline","onThemeChange","t","_strategy","applyColors","schedule","contributions","getDiffEditorContributions","_i","contributions_1","createInstance","ctor","err","addDiffEditor","_setState","newState","done","show","hasWidgetFocus","isAncestor","activeElement","diffReviewNext","next","diffReviewPrev","prev","theme","result","type","_recreateOverviewRulers","removeChild","getDomNode","hasModel","createOverviewRuler","_layoutOverviewRulers","_createInnerEditor","_adjustOptionsForLeftHandSide","onDidScrollChange","scrollTopChanged","scrollLeftChanged","scrollHeightChanged","setScrollPosition","scrollLeft","scrollTop","_layoutOverviewViewport","onDidChangeViewZones","_onViewZonesChanged","onDidChangeModelContent","_beginUpdateDecorationsSoon","_adjustOptionsForRightHandSide","onDidChangeConfiguration","hasChanged","getModel","onDidChangeModelOptions","tabSize","container","removeDiffEditor","window","clearTimeout","_cleanViewZonesAndDecorations","fire","getId","getEditorType","EditorType","IDiffEditor","getLineChanges","changes","getOriginalEditor","getModifiedEditor","updateOptions","newOptions","renderSideBySideChanged","beginUpdateDecorations","_beginUpdateDecorations","setEnableSplitViewResizing","original","modified","setModel","model","Error","cancel","setScrollTop","getVisibleColumnFromPosition","getPosition","revealLine","lineNumber","scrollType","revealLineInCenter","revealLineInCenterIfOutsideViewport","revealPosition","revealPositionInCenter","revealPositionInCenterIfOutsideViewport","getSelection","getSelections","setSelection","something","setSelections","ranges","revealLines","startLineNumber","endLineNumber","revealLinesInCenter","revealLinesInCenterIfOutsideViewport","revealRange","range","revealVerticalInCenter","revealHorizontal","revealRangeInCenter","revealRangeInCenterIfOutsideViewport","revealRangeAtTop","getSupportedActions","saveViewState","originalViewState","modifiedViewState","restoreViewState","s","diffEditorState","layout","dimension","observe","focus","hasTextFocus","trigger","source","handlerId","payload","changeDecorations","callback","_doLayout","_getReviewHeight","isVisible","getHeight","reviewHeight","freeSpace","ENTIRE_DIFF_OVERVIEW_WIDTH","ONE_OVERVIEW_WIDTH","layoutInfo","getLayoutInfo","setLayout","top","width","right","setTimeout","UPDATE_DIFF_DECORATIONS_DELAY","_equals","a","toString","currentOriginalModel","currentModifiedModel","currentToken","canComputeDiff","uri","warn","localize","computeDiff","then","error","lineChanges","foreignOriginal","getWhitespaces","foreignModified","diffDecorations","getEditorsDiffDecorations","_adjustOptionsForSubEditor","clonedOptions","deepClone","inDiffEditor","wordWrap","wordWrapMinified","scrollbar","vertical","folding","codeLens","fixedOverflowWidgets","minimap","enabled","isEditable","readOnly","extraEditorClassName","revealHorizontalRightPadding","defaultValue","verticalHasArrows","doLayout","getWidth","splitPoint","left","setWidth","setHeight","_computeOverviewViewport","setTop","getScrollTop","scrollHeight","getScrollHeight","computedAvailableSize","Math","max","computedRepresentableSize","computedRatio","computedSliderSize","floor","computedSliderPosition","getContainerDomNode","relayoutEditors","newStrategy","_getLineChangeAtOrBeforeLineNumber","startLineNumberExtractor","min","mid","midStart","midEnd","_getEquivalentLineForOriginalLineNumber","lineChange","originalStartLineNumber","originalEquivalentLineNumber","originalEndLineNumber","modifiedEquivalentLineNumber","modifiedStartLineNumber","modifiedEndLineNumber","lineChangeOriginalLength","lineChangeModifiedLength","delta","_getEquivalentLineForModifiedLineNumber","getDiffLineInformationForOriginal","equivalentLineNumber","getDiffLineInformationForModified","DiffEditorWidgetStyle","dataSource","_dataSource","_insertColor","_removeColor","newInsertColor","getColor","transparent","newRemoveColor","hasChanges","equals","originalWhitespaces","modifiedWhitespaces","sort","afterLineNumber","_getViewZones","originalDecorations","_getOriginalEditorDecorations","modifiedDecorations","_getModifiedEditorDecorations","ForeignViewZonesIterator","_source","_index","current","advance","ViewZonesComputer","originalForeignVZ","originalLineHeight","modifiedForeignVZ","modifiedLineHeight","getViewZones","originalEndEquivalentLineNumber","modifiedEndEquivalentLineNumber","sortMyViewZones","addAndCombineIfPossible","destination","item","lastItem","heightInLines","length_5","stepOriginal","stepModified","viewZoneLineNumber","_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion","isChangeOrInsert","_produceOriginalFromDiff","isChangeOrDelete","_produceModifiedFromDiff","stepOriginalIndex","stepModifiedIndex","originalDelta","modifiedDelta","shouldNotShrink","_ensureDomNodes","map","createFakeLinesDiv","createDecoration","startColumn","endColumn","DECORATIONS","charDelete","register","charDeleteWholeLine","isWholeLine","charInsert","charInsertWholeLine","lineInsert","marginClassName","lineInsertWithSign","linesDecorationsClassName","lineDelete","lineDeleteWithSign","lineDeleteMargin","_disableSash","_sashRatio","_sashPosition","_startSashPosition","_sash","state","onDidStart","onSashDragStart","onDidChange","onSashDrag","onDidEnd","onSashDragEnd","onDidReset","onSashReset","newDisableSash","sashRatio","w","contentWidth","sashPosition","midPoint","MINIMUM_EDITOR_WIDTH","currentX","startX","getVerticalSashTop","sash","getVerticalSashLeft","getVerticalSashHeight","SideBySideViewZonesComputer","getOption","overviewZoneColor","originalModel","length_6","charChanges","j","lengthJ","charChange","originalStartColumn","getLineFirstNonWhitespaceColumn","originalEndColumn","getLineLastNonWhitespaceColumn","modifiedModel","length_7","modifiedStartColumn","modifiedEndColumn","decorationsLeft","onDidLayoutChange","computer","InlineViewZonesComputer","length_8","length_9","modifiedEditorOptions","getOptions","modifiedEditorTabSize","sb","marginHTML","get","fontInfo","lineDecorationsWidth","decorationsWidth","lineHeight","typicalHalfwidthCharacterWidth","maxCharsPerLine","originalContent","_renderOriginalLine","getLineContent","index","concat","innerHTML","build","applyFontInfoSlow","join","minWidthInPx","count","lineTokens","getLineTokens","lineContent","actualDecorations","appendASCIIString","isBasicASCII","mightContainNonBasicASCII","containsRTL","mightContainRTL","output","isMonospace","canUseHalfwidthRightwardsArrow","spaceWidth","middotWidth","OFF","absoluteOffsets","characterMapping","getAbsoluteOffsets","collector","added","addRule","removed","addedOutline","removedOutline","border"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/diffEditor.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { StableEditorScrollState } from '../core/editorState.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { CodeEditorWidget } from './codeEditorWidget.js';\r\nimport { DiffReview } from './diffReview.js';\r\nimport { EditorOptions, EditorFontLigatures } from '../../common/config/editorOptions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { createStringBuilder } from '../../common/core/stringBuilder.js';\r\nimport * as editorCommon from '../../common/editorCommon.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { OverviewRulerZone } from '../../common/view/overviewZoneManager.js';\r\nimport { LineDecoration } from '../../common/viewLayout/lineDecorations.js';\r\nimport { RenderLineInput, renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\r\nimport { InlineDecoration, ViewLineRenderingData } from '../../common/viewModel/viewModel.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { defaultInsertColor, defaultRemoveColor, diffBorder, diffInserted, diffInsertedOutline, diffRemoved, diffRemovedOutline, scrollbarShadow } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, getThemeTypeSelector, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { InlineDiffMargin } from './inlineDiffMargin.js';\r\nimport { EditorExtensionsRegistry } from '../editorExtensions.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { ElementSizeObserver } from '../config/elementSizeObserver.js';\r\nvar VisualEditorState = /** @class */ (function () {\r\n    function VisualEditorState(_contextMenuService, _clipboardService) {\r\n        this._contextMenuService = _contextMenuService;\r\n        this._clipboardService = _clipboardService;\r\n        this._zones = [];\r\n        this.inlineDiffMargins = [];\r\n        this._zonesMap = {};\r\n        this._decorations = [];\r\n    }\r\n    VisualEditorState.prototype.getForeignViewZones = function (allViewZones) {\r\n        var _this = this;\r\n        return allViewZones.filter(function (z) { return !_this._zonesMap[String(z.id)]; });\r\n    };\r\n    VisualEditorState.prototype.clean = function (editor) {\r\n        var _this = this;\r\n        // (1) View zones\r\n        if (this._zones.length > 0) {\r\n            editor.changeViewZones(function (viewChangeAccessor) {\r\n                for (var i = 0, length_1 = _this._zones.length; i < length_1; i++) {\r\n                    viewChangeAccessor.removeZone(_this._zones[i]);\r\n                }\r\n            });\r\n        }\r\n        this._zones = [];\r\n        this._zonesMap = {};\r\n        // (2) Model decorations\r\n        this._decorations = editor.deltaDecorations(this._decorations, []);\r\n    };\r\n    VisualEditorState.prototype.apply = function (editor, overviewRuler, newDecorations, restoreScrollState) {\r\n        var _this = this;\r\n        var scrollState = restoreScrollState ? StableEditorScrollState.capture(editor) : null;\r\n        // view zones\r\n        editor.changeViewZones(function (viewChangeAccessor) {\r\n            for (var i = 0, length_2 = _this._zones.length; i < length_2; i++) {\r\n                viewChangeAccessor.removeZone(_this._zones[i]);\r\n            }\r\n            for (var i = 0, length_3 = _this.inlineDiffMargins.length; i < length_3; i++) {\r\n                _this.inlineDiffMargins[i].dispose();\r\n            }\r\n            _this._zones = [];\r\n            _this._zonesMap = {};\r\n            _this.inlineDiffMargins = [];\r\n            for (var i = 0, length_4 = newDecorations.zones.length; i < length_4; i++) {\r\n                var viewZone = newDecorations.zones[i];\r\n                viewZone.suppressMouseDown = true;\r\n                var zoneId = viewChangeAccessor.addZone(viewZone);\r\n                _this._zones.push(zoneId);\r\n                _this._zonesMap[String(zoneId)] = true;\r\n                if (newDecorations.zones[i].diff && viewZone.marginDomNode && _this._clipboardService) {\r\n                    viewZone.suppressMouseDown = false;\r\n                    _this.inlineDiffMargins.push(new InlineDiffMargin(zoneId, viewZone.marginDomNode, editor, newDecorations.zones[i].diff, _this._contextMenuService, _this._clipboardService));\r\n                }\r\n            }\r\n        });\r\n        if (scrollState) {\r\n            scrollState.restore(editor);\r\n        }\r\n        // decorations\r\n        this._decorations = editor.deltaDecorations(this._decorations, newDecorations.decorations);\r\n        // overview ruler\r\n        if (overviewRuler) {\r\n            overviewRuler.setZones(newDecorations.overviewZones);\r\n        }\r\n    };\r\n    return VisualEditorState;\r\n}());\r\nvar DIFF_EDITOR_ID = 0;\r\nvar DiffEditorWidget = /** @class */ (function (_super) {\r\n    __extends(DiffEditorWidget, _super);\r\n    function DiffEditorWidget(domElement, options, clipboardService, editorWorkerService, contextKeyService, instantiationService, codeEditorService, themeService, notificationService, contextMenuService, _editorProgressService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editorProgressService = _editorProgressService;\r\n        _this._onDidDispose = _this._register(new Emitter());\r\n        _this.onDidDispose = _this._onDidDispose.event;\r\n        _this._onDidUpdateDiff = _this._register(new Emitter());\r\n        _this.onDidUpdateDiff = _this._onDidUpdateDiff.event;\r\n        _this._lastOriginalWarning = null;\r\n        _this._lastModifiedWarning = null;\r\n        _this._editorWorkerService = editorWorkerService;\r\n        _this._codeEditorService = codeEditorService;\r\n        _this._contextKeyService = _this._register(contextKeyService.createScoped(domElement));\r\n        _this._contextKeyService.createKey('isInDiffEditor', true);\r\n        _this._themeService = themeService;\r\n        _this._notificationService = notificationService;\r\n        _this.id = (++DIFF_EDITOR_ID);\r\n        _this._state = 0 /* Idle */;\r\n        _this._updatingDiffProgress = null;\r\n        _this._domElement = domElement;\r\n        options = options || {};\r\n        // renderSideBySide\r\n        _this._renderSideBySide = true;\r\n        if (typeof options.renderSideBySide !== 'undefined') {\r\n            _this._renderSideBySide = options.renderSideBySide;\r\n        }\r\n        // maxComputationTime\r\n        _this._maxComputationTime = 5000;\r\n        if (typeof options.maxComputationTime !== 'undefined') {\r\n            _this._maxComputationTime = options.maxComputationTime;\r\n        }\r\n        // ignoreTrimWhitespace\r\n        _this._ignoreTrimWhitespace = true;\r\n        if (typeof options.ignoreTrimWhitespace !== 'undefined') {\r\n            _this._ignoreTrimWhitespace = options.ignoreTrimWhitespace;\r\n        }\r\n        // renderIndicators\r\n        _this._renderIndicators = true;\r\n        if (typeof options.renderIndicators !== 'undefined') {\r\n            _this._renderIndicators = options.renderIndicators;\r\n        }\r\n        _this._originalIsEditable = false;\r\n        if (typeof options.originalEditable !== 'undefined') {\r\n            _this._originalIsEditable = Boolean(options.originalEditable);\r\n        }\r\n        _this._updateDecorationsRunner = _this._register(new RunOnceScheduler(function () { return _this._updateDecorations(); }, 0));\r\n        _this._containerDomElement = document.createElement('div');\r\n        _this._containerDomElement.className = DiffEditorWidget._getClassName(_this._themeService.getTheme(), _this._renderSideBySide);\r\n        _this._containerDomElement.style.position = 'relative';\r\n        _this._containerDomElement.style.height = '100%';\r\n        _this._domElement.appendChild(_this._containerDomElement);\r\n        _this._overviewViewportDomElement = createFastDomNode(document.createElement('div'));\r\n        _this._overviewViewportDomElement.setClassName('diffViewport');\r\n        _this._overviewViewportDomElement.setPosition('absolute');\r\n        _this._overviewDomElement = document.createElement('div');\r\n        _this._overviewDomElement.className = 'diffOverview';\r\n        _this._overviewDomElement.style.position = 'absolute';\r\n        _this._overviewDomElement.appendChild(_this._overviewViewportDomElement.domNode);\r\n        _this._register(dom.addStandardDisposableListener(_this._overviewDomElement, 'mousedown', function (e) {\r\n            _this.modifiedEditor.delegateVerticalScrollbarMouseDown(e);\r\n        }));\r\n        _this._containerDomElement.appendChild(_this._overviewDomElement);\r\n        // Create left side\r\n        _this._originalDomNode = document.createElement('div');\r\n        _this._originalDomNode.className = 'editor original';\r\n        _this._originalDomNode.style.position = 'absolute';\r\n        _this._originalDomNode.style.height = '100%';\r\n        _this._containerDomElement.appendChild(_this._originalDomNode);\r\n        // Create right side\r\n        _this._modifiedDomNode = document.createElement('div');\r\n        _this._modifiedDomNode.className = 'editor modified';\r\n        _this._modifiedDomNode.style.position = 'absolute';\r\n        _this._modifiedDomNode.style.height = '100%';\r\n        _this._containerDomElement.appendChild(_this._modifiedDomNode);\r\n        _this._beginUpdateDecorationsTimeout = -1;\r\n        _this._currentlyChangingViewZones = false;\r\n        _this._diffComputationToken = 0;\r\n        _this._originalEditorState = new VisualEditorState(contextMenuService, clipboardService);\r\n        _this._modifiedEditorState = new VisualEditorState(contextMenuService, clipboardService);\r\n        _this._isVisible = true;\r\n        _this._isHandlingScrollEvent = false;\r\n        _this._elementSizeObserver = _this._register(new ElementSizeObserver(_this._containerDomElement, undefined, function () { return _this._onDidContainerSizeChanged(); }));\r\n        if (options.automaticLayout) {\r\n            _this._elementSizeObserver.startObserving();\r\n        }\r\n        _this._diffComputationResult = null;\r\n        var leftContextKeyService = _this._contextKeyService.createScoped();\r\n        leftContextKeyService.createKey('isInDiffLeftEditor', true);\r\n        var leftServices = new ServiceCollection();\r\n        leftServices.set(IContextKeyService, leftContextKeyService);\r\n        var leftScopedInstantiationService = instantiationService.createChild(leftServices);\r\n        var rightContextKeyService = _this._contextKeyService.createScoped();\r\n        rightContextKeyService.createKey('isInDiffRightEditor', true);\r\n        var rightServices = new ServiceCollection();\r\n        rightServices.set(IContextKeyService, rightContextKeyService);\r\n        var rightScopedInstantiationService = instantiationService.createChild(rightServices);\r\n        _this.originalEditor = _this._createLeftHandSideEditor(options, leftScopedInstantiationService);\r\n        _this.modifiedEditor = _this._createRightHandSideEditor(options, rightScopedInstantiationService);\r\n        _this._originalOverviewRuler = null;\r\n        _this._modifiedOverviewRuler = null;\r\n        _this._reviewPane = new DiffReview(_this);\r\n        _this._containerDomElement.appendChild(_this._reviewPane.domNode.domNode);\r\n        _this._containerDomElement.appendChild(_this._reviewPane.shadow.domNode);\r\n        _this._containerDomElement.appendChild(_this._reviewPane.actionBarContainer.domNode);\r\n        // enableSplitViewResizing\r\n        _this._enableSplitViewResizing = true;\r\n        if (typeof options.enableSplitViewResizing !== 'undefined') {\r\n            _this._enableSplitViewResizing = options.enableSplitViewResizing;\r\n        }\r\n        if (_this._renderSideBySide) {\r\n            _this._setStrategy(new DiffEditorWidgetSideBySide(_this._createDataSource(), _this._enableSplitViewResizing));\r\n        }\r\n        else {\r\n            _this._setStrategy(new DiffEditorWidgetInline(_this._createDataSource(), _this._enableSplitViewResizing));\r\n        }\r\n        _this._register(themeService.onThemeChange(function (t) {\r\n            if (_this._strategy && _this._strategy.applyColors(t)) {\r\n                _this._updateDecorationsRunner.schedule();\r\n            }\r\n            _this._containerDomElement.className = DiffEditorWidget._getClassName(_this._themeService.getTheme(), _this._renderSideBySide);\r\n        }));\r\n        var contributions = EditorExtensionsRegistry.getDiffEditorContributions();\r\n        for (var _i = 0, contributions_1 = contributions; _i < contributions_1.length; _i++) {\r\n            var desc = contributions_1[_i];\r\n            try {\r\n                _this._register(instantiationService.createInstance(desc.ctor, _this));\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n        }\r\n        _this._codeEditorService.addDiffEditor(_this);\r\n        return _this;\r\n    }\r\n    DiffEditorWidget.prototype._setState = function (newState) {\r\n        if (this._state === newState) {\r\n            return;\r\n        }\r\n        this._state = newState;\r\n        if (this._updatingDiffProgress) {\r\n            this._updatingDiffProgress.done();\r\n            this._updatingDiffProgress = null;\r\n        }\r\n        if (this._state === 1 /* ComputingDiff */) {\r\n            this._updatingDiffProgress = this._editorProgressService.show(true, 1000);\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype.hasWidgetFocus = function () {\r\n        return dom.isAncestor(document.activeElement, this._domElement);\r\n    };\r\n    DiffEditorWidget.prototype.diffReviewNext = function () {\r\n        this._reviewPane.next();\r\n    };\r\n    DiffEditorWidget.prototype.diffReviewPrev = function () {\r\n        this._reviewPane.prev();\r\n    };\r\n    DiffEditorWidget._getClassName = function (theme, renderSideBySide) {\r\n        var result = 'monaco-diff-editor monaco-editor-background ';\r\n        if (renderSideBySide) {\r\n            result += 'side-by-side ';\r\n        }\r\n        result += getThemeTypeSelector(theme.type);\r\n        return result;\r\n    };\r\n    DiffEditorWidget.prototype._recreateOverviewRulers = function () {\r\n        if (this._originalOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode());\r\n            this._originalOverviewRuler.dispose();\r\n        }\r\n        if (this.originalEditor.hasModel()) {\r\n            this._originalOverviewRuler = this.originalEditor.createOverviewRuler('original diffOverviewRuler');\r\n            this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode());\r\n        }\r\n        if (this._modifiedOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode());\r\n            this._modifiedOverviewRuler.dispose();\r\n        }\r\n        if (this.modifiedEditor.hasModel()) {\r\n            this._modifiedOverviewRuler = this.modifiedEditor.createOverviewRuler('modified diffOverviewRuler');\r\n            this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode());\r\n        }\r\n        this._layoutOverviewRulers();\r\n    };\r\n    DiffEditorWidget.prototype._createLeftHandSideEditor = function (options, instantiationService) {\r\n        var _this = this;\r\n        var editor = this._createInnerEditor(instantiationService, this._originalDomNode, this._adjustOptionsForLeftHandSide(options, this._originalIsEditable));\r\n        this._register(editor.onDidScrollChange(function (e) {\r\n            if (_this._isHandlingScrollEvent) {\r\n                return;\r\n            }\r\n            if (!e.scrollTopChanged && !e.scrollLeftChanged && !e.scrollHeightChanged) {\r\n                return;\r\n            }\r\n            _this._isHandlingScrollEvent = true;\r\n            _this.modifiedEditor.setScrollPosition({\r\n                scrollLeft: e.scrollLeft,\r\n                scrollTop: e.scrollTop\r\n            });\r\n            _this._isHandlingScrollEvent = false;\r\n            _this._layoutOverviewViewport();\r\n        }));\r\n        this._register(editor.onDidChangeViewZones(function () {\r\n            _this._onViewZonesChanged();\r\n        }));\r\n        this._register(editor.onDidChangeModelContent(function () {\r\n            if (_this._isVisible) {\r\n                _this._beginUpdateDecorationsSoon();\r\n            }\r\n        }));\r\n        return editor;\r\n    };\r\n    DiffEditorWidget.prototype._createRightHandSideEditor = function (options, instantiationService) {\r\n        var _this = this;\r\n        var editor = this._createInnerEditor(instantiationService, this._modifiedDomNode, this._adjustOptionsForRightHandSide(options));\r\n        this._register(editor.onDidScrollChange(function (e) {\r\n            if (_this._isHandlingScrollEvent) {\r\n                return;\r\n            }\r\n            if (!e.scrollTopChanged && !e.scrollLeftChanged && !e.scrollHeightChanged) {\r\n                return;\r\n            }\r\n            _this._isHandlingScrollEvent = true;\r\n            _this.originalEditor.setScrollPosition({\r\n                scrollLeft: e.scrollLeft,\r\n                scrollTop: e.scrollTop\r\n            });\r\n            _this._isHandlingScrollEvent = false;\r\n            _this._layoutOverviewViewport();\r\n        }));\r\n        this._register(editor.onDidChangeViewZones(function () {\r\n            _this._onViewZonesChanged();\r\n        }));\r\n        this._register(editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(34 /* fontInfo */) && editor.getModel()) {\r\n                _this._onViewZonesChanged();\r\n            }\r\n        }));\r\n        this._register(editor.onDidChangeModelContent(function () {\r\n            if (_this._isVisible) {\r\n                _this._beginUpdateDecorationsSoon();\r\n            }\r\n        }));\r\n        this._register(editor.onDidChangeModelOptions(function (e) {\r\n            if (e.tabSize) {\r\n                _this._updateDecorationsRunner.schedule();\r\n            }\r\n        }));\r\n        return editor;\r\n    };\r\n    DiffEditorWidget.prototype._createInnerEditor = function (instantiationService, container, options) {\r\n        return instantiationService.createInstance(CodeEditorWidget, container, options, {});\r\n    };\r\n    DiffEditorWidget.prototype.dispose = function () {\r\n        this._codeEditorService.removeDiffEditor(this);\r\n        if (this._beginUpdateDecorationsTimeout !== -1) {\r\n            window.clearTimeout(this._beginUpdateDecorationsTimeout);\r\n            this._beginUpdateDecorationsTimeout = -1;\r\n        }\r\n        this._cleanViewZonesAndDecorations();\r\n        if (this._originalOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode());\r\n            this._originalOverviewRuler.dispose();\r\n        }\r\n        if (this._modifiedOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode());\r\n            this._modifiedOverviewRuler.dispose();\r\n        }\r\n        this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode);\r\n        this._containerDomElement.removeChild(this._overviewDomElement);\r\n        this._containerDomElement.removeChild(this._originalDomNode);\r\n        this.originalEditor.dispose();\r\n        this._containerDomElement.removeChild(this._modifiedDomNode);\r\n        this.modifiedEditor.dispose();\r\n        this._strategy.dispose();\r\n        this._containerDomElement.removeChild(this._reviewPane.domNode.domNode);\r\n        this._containerDomElement.removeChild(this._reviewPane.shadow.domNode);\r\n        this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode);\r\n        this._reviewPane.dispose();\r\n        this._domElement.removeChild(this._containerDomElement);\r\n        this._onDidDispose.fire();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    //------------ begin IDiffEditor methods\r\n    DiffEditorWidget.prototype.getId = function () {\r\n        return this.getEditorType() + ':' + this.id;\r\n    };\r\n    DiffEditorWidget.prototype.getEditorType = function () {\r\n        return editorCommon.EditorType.IDiffEditor;\r\n    };\r\n    DiffEditorWidget.prototype.getLineChanges = function () {\r\n        if (!this._diffComputationResult) {\r\n            return null;\r\n        }\r\n        return this._diffComputationResult.changes;\r\n    };\r\n    DiffEditorWidget.prototype.getOriginalEditor = function () {\r\n        return this.originalEditor;\r\n    };\r\n    DiffEditorWidget.prototype.getModifiedEditor = function () {\r\n        return this.modifiedEditor;\r\n    };\r\n    DiffEditorWidget.prototype.updateOptions = function (newOptions) {\r\n        // Handle side by side\r\n        var renderSideBySideChanged = false;\r\n        if (typeof newOptions.renderSideBySide !== 'undefined') {\r\n            if (this._renderSideBySide !== newOptions.renderSideBySide) {\r\n                this._renderSideBySide = newOptions.renderSideBySide;\r\n                renderSideBySideChanged = true;\r\n            }\r\n        }\r\n        if (typeof newOptions.maxComputationTime !== 'undefined') {\r\n            this._maxComputationTime = newOptions.maxComputationTime;\r\n            if (this._isVisible) {\r\n                this._beginUpdateDecorationsSoon();\r\n            }\r\n        }\r\n        var beginUpdateDecorations = false;\r\n        if (typeof newOptions.ignoreTrimWhitespace !== 'undefined') {\r\n            if (this._ignoreTrimWhitespace !== newOptions.ignoreTrimWhitespace) {\r\n                this._ignoreTrimWhitespace = newOptions.ignoreTrimWhitespace;\r\n                // Begin comparing\r\n                beginUpdateDecorations = true;\r\n            }\r\n        }\r\n        if (typeof newOptions.renderIndicators !== 'undefined') {\r\n            if (this._renderIndicators !== newOptions.renderIndicators) {\r\n                this._renderIndicators = newOptions.renderIndicators;\r\n                beginUpdateDecorations = true;\r\n            }\r\n        }\r\n        if (beginUpdateDecorations) {\r\n            this._beginUpdateDecorations();\r\n        }\r\n        if (typeof newOptions.originalEditable !== 'undefined') {\r\n            this._originalIsEditable = Boolean(newOptions.originalEditable);\r\n        }\r\n        this.modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(newOptions));\r\n        this.originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(newOptions, this._originalIsEditable));\r\n        // enableSplitViewResizing\r\n        if (typeof newOptions.enableSplitViewResizing !== 'undefined') {\r\n            this._enableSplitViewResizing = newOptions.enableSplitViewResizing;\r\n        }\r\n        this._strategy.setEnableSplitViewResizing(this._enableSplitViewResizing);\r\n        // renderSideBySide\r\n        if (renderSideBySideChanged) {\r\n            if (this._renderSideBySide) {\r\n                this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(), this._enableSplitViewResizing));\r\n            }\r\n            else {\r\n                this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(), this._enableSplitViewResizing));\r\n            }\r\n            // Update class name\r\n            this._containerDomElement.className = DiffEditorWidget._getClassName(this._themeService.getTheme(), this._renderSideBySide);\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype.getModel = function () {\r\n        return {\r\n            original: this.originalEditor.getModel(),\r\n            modified: this.modifiedEditor.getModel()\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype.setModel = function (model) {\r\n        // Guard us against partial null model\r\n        if (model && (!model.original || !model.modified)) {\r\n            throw new Error(!model.original ? 'DiffEditorWidget.setModel: Original model is null' : 'DiffEditorWidget.setModel: Modified model is null');\r\n        }\r\n        // Remove all view zones & decorations\r\n        this._cleanViewZonesAndDecorations();\r\n        // Update code editor models\r\n        this.originalEditor.setModel(model ? model.original : null);\r\n        this.modifiedEditor.setModel(model ? model.modified : null);\r\n        this._updateDecorationsRunner.cancel();\r\n        // this.originalEditor.onDidChangeModelOptions\r\n        if (model) {\r\n            this.originalEditor.setScrollTop(0);\r\n            this.modifiedEditor.setScrollTop(0);\r\n        }\r\n        // Disable any diff computations that will come in\r\n        this._diffComputationResult = null;\r\n        this._diffComputationToken++;\r\n        this._setState(0 /* Idle */);\r\n        if (model) {\r\n            this._recreateOverviewRulers();\r\n            // Begin comparing\r\n            this._beginUpdateDecorations();\r\n        }\r\n        this._layoutOverviewViewport();\r\n    };\r\n    DiffEditorWidget.prototype.getDomNode = function () {\r\n        return this._domElement;\r\n    };\r\n    DiffEditorWidget.prototype.getVisibleColumnFromPosition = function (position) {\r\n        return this.modifiedEditor.getVisibleColumnFromPosition(position);\r\n    };\r\n    DiffEditorWidget.prototype.getPosition = function () {\r\n        return this.modifiedEditor.getPosition();\r\n    };\r\n    DiffEditorWidget.prototype.setPosition = function (position) {\r\n        this.modifiedEditor.setPosition(position);\r\n    };\r\n    DiffEditorWidget.prototype.revealLine = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLine(lineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLineInCenter = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLineInCenter(lineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLineInCenterIfOutsideViewport = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLineInCenterIfOutsideViewport(lineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealPosition = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealPosition(position, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealPositionInCenter = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealPositionInCenter(position, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealPositionInCenterIfOutsideViewport = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealPositionInCenterIfOutsideViewport(position, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.getSelection = function () {\r\n        return this.modifiedEditor.getSelection();\r\n    };\r\n    DiffEditorWidget.prototype.getSelections = function () {\r\n        return this.modifiedEditor.getSelections();\r\n    };\r\n    DiffEditorWidget.prototype.setSelection = function (something) {\r\n        this.modifiedEditor.setSelection(something);\r\n    };\r\n    DiffEditorWidget.prototype.setSelections = function (ranges) {\r\n        this.modifiedEditor.setSelections(ranges);\r\n    };\r\n    DiffEditorWidget.prototype.revealLines = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLines(startLineNumber, endLineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLinesInCenter = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLinesInCenter(startLineNumber, endLineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLinesInCenterIfOutsideViewport = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLinesInCenterIfOutsideViewport(startLineNumber, endLineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealRange = function (range, scrollType, revealVerticalInCenter, revealHorizontal) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        if (revealVerticalInCenter === void 0) { revealVerticalInCenter = false; }\r\n        if (revealHorizontal === void 0) { revealHorizontal = true; }\r\n        this.modifiedEditor.revealRange(range, scrollType, revealVerticalInCenter, revealHorizontal);\r\n    };\r\n    DiffEditorWidget.prototype.revealRangeInCenter = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealRangeInCenter(range, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealRangeInCenterIfOutsideViewport = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealRangeInCenterIfOutsideViewport(range, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealRangeAtTop = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealRangeAtTop(range, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.getSupportedActions = function () {\r\n        return this.modifiedEditor.getSupportedActions();\r\n    };\r\n    DiffEditorWidget.prototype.saveViewState = function () {\r\n        var originalViewState = this.originalEditor.saveViewState();\r\n        var modifiedViewState = this.modifiedEditor.saveViewState();\r\n        return {\r\n            original: originalViewState,\r\n            modified: modifiedViewState\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype.restoreViewState = function (s) {\r\n        if (s.original && s.modified) {\r\n            var diffEditorState = s;\r\n            this.originalEditor.restoreViewState(diffEditorState.original);\r\n            this.modifiedEditor.restoreViewState(diffEditorState.modified);\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype.layout = function (dimension) {\r\n        this._elementSizeObserver.observe(dimension);\r\n    };\r\n    DiffEditorWidget.prototype.focus = function () {\r\n        this.modifiedEditor.focus();\r\n    };\r\n    DiffEditorWidget.prototype.hasTextFocus = function () {\r\n        return this.originalEditor.hasTextFocus() || this.modifiedEditor.hasTextFocus();\r\n    };\r\n    DiffEditorWidget.prototype.trigger = function (source, handlerId, payload) {\r\n        this.modifiedEditor.trigger(source, handlerId, payload);\r\n    };\r\n    DiffEditorWidget.prototype.changeDecorations = function (callback) {\r\n        return this.modifiedEditor.changeDecorations(callback);\r\n    };\r\n    //------------ end IDiffEditor methods\r\n    //------------ begin layouting methods\r\n    DiffEditorWidget.prototype._onDidContainerSizeChanged = function () {\r\n        this._doLayout();\r\n    };\r\n    DiffEditorWidget.prototype._getReviewHeight = function () {\r\n        return this._reviewPane.isVisible() ? this._elementSizeObserver.getHeight() : 0;\r\n    };\r\n    DiffEditorWidget.prototype._layoutOverviewRulers = function () {\r\n        if (!this._originalOverviewRuler || !this._modifiedOverviewRuler) {\r\n            return;\r\n        }\r\n        var height = this._elementSizeObserver.getHeight();\r\n        var reviewHeight = this._getReviewHeight();\r\n        var freeSpace = DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH - 2 * DiffEditorWidget.ONE_OVERVIEW_WIDTH;\r\n        var layoutInfo = this.modifiedEditor.getLayoutInfo();\r\n        if (layoutInfo) {\r\n            this._originalOverviewRuler.setLayout({\r\n                top: 0,\r\n                width: DiffEditorWidget.ONE_OVERVIEW_WIDTH,\r\n                right: freeSpace + DiffEditorWidget.ONE_OVERVIEW_WIDTH,\r\n                height: (height - reviewHeight)\r\n            });\r\n            this._modifiedOverviewRuler.setLayout({\r\n                top: 0,\r\n                right: 0,\r\n                width: DiffEditorWidget.ONE_OVERVIEW_WIDTH,\r\n                height: (height - reviewHeight)\r\n            });\r\n        }\r\n    };\r\n    //------------ end layouting methods\r\n    DiffEditorWidget.prototype._onViewZonesChanged = function () {\r\n        if (this._currentlyChangingViewZones) {\r\n            return;\r\n        }\r\n        this._updateDecorationsRunner.schedule();\r\n    };\r\n    DiffEditorWidget.prototype._beginUpdateDecorationsSoon = function () {\r\n        var _this = this;\r\n        // Clear previous timeout if necessary\r\n        if (this._beginUpdateDecorationsTimeout !== -1) {\r\n            window.clearTimeout(this._beginUpdateDecorationsTimeout);\r\n            this._beginUpdateDecorationsTimeout = -1;\r\n        }\r\n        this._beginUpdateDecorationsTimeout = window.setTimeout(function () { return _this._beginUpdateDecorations(); }, DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY);\r\n    };\r\n    DiffEditorWidget._equals = function (a, b) {\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        if (!a || !b) {\r\n            return false;\r\n        }\r\n        return (a.toString() === b.toString());\r\n    };\r\n    DiffEditorWidget.prototype._beginUpdateDecorations = function () {\r\n        var _this = this;\r\n        this._beginUpdateDecorationsTimeout = -1;\r\n        var currentOriginalModel = this.originalEditor.getModel();\r\n        var currentModifiedModel = this.modifiedEditor.getModel();\r\n        if (!currentOriginalModel || !currentModifiedModel) {\r\n            return;\r\n        }\r\n        // Prevent old diff requests to come if a new request has been initiated\r\n        // The best method would be to call cancel on the Promise, but this is not\r\n        // yet supported, so using tokens for now.\r\n        this._diffComputationToken++;\r\n        var currentToken = this._diffComputationToken;\r\n        this._setState(1 /* ComputingDiff */);\r\n        if (!this._editorWorkerService.canComputeDiff(currentOriginalModel.uri, currentModifiedModel.uri)) {\r\n            if (!DiffEditorWidget._equals(currentOriginalModel.uri, this._lastOriginalWarning)\r\n                || !DiffEditorWidget._equals(currentModifiedModel.uri, this._lastModifiedWarning)) {\r\n                this._lastOriginalWarning = currentOriginalModel.uri;\r\n                this._lastModifiedWarning = currentModifiedModel.uri;\r\n                this._notificationService.warn(nls.localize(\"diff.tooLarge\", \"Cannot compare files because one file is too large.\"));\r\n            }\r\n            return;\r\n        }\r\n        this._editorWorkerService.computeDiff(currentOriginalModel.uri, currentModifiedModel.uri, this._ignoreTrimWhitespace, this._maxComputationTime).then(function (result) {\r\n            if (currentToken === _this._diffComputationToken\r\n                && currentOriginalModel === _this.originalEditor.getModel()\r\n                && currentModifiedModel === _this.modifiedEditor.getModel()) {\r\n                _this._setState(2 /* DiffComputed */);\r\n                _this._diffComputationResult = result;\r\n                _this._updateDecorationsRunner.schedule();\r\n                _this._onDidUpdateDiff.fire();\r\n            }\r\n        }, function (error) {\r\n            if (currentToken === _this._diffComputationToken\r\n                && currentOriginalModel === _this.originalEditor.getModel()\r\n                && currentModifiedModel === _this.modifiedEditor.getModel()) {\r\n                _this._setState(2 /* DiffComputed */);\r\n                _this._diffComputationResult = null;\r\n                _this._updateDecorationsRunner.schedule();\r\n            }\r\n        });\r\n    };\r\n    DiffEditorWidget.prototype._cleanViewZonesAndDecorations = function () {\r\n        this._originalEditorState.clean(this.originalEditor);\r\n        this._modifiedEditorState.clean(this.modifiedEditor);\r\n    };\r\n    DiffEditorWidget.prototype._updateDecorations = function () {\r\n        if (!this.originalEditor.getModel() || !this.modifiedEditor.getModel() || !this._originalOverviewRuler || !this._modifiedOverviewRuler) {\r\n            return;\r\n        }\r\n        var lineChanges = (this._diffComputationResult ? this._diffComputationResult.changes : []);\r\n        var foreignOriginal = this._originalEditorState.getForeignViewZones(this.originalEditor.getWhitespaces());\r\n        var foreignModified = this._modifiedEditorState.getForeignViewZones(this.modifiedEditor.getWhitespaces());\r\n        var diffDecorations = this._strategy.getEditorsDiffDecorations(lineChanges, this._ignoreTrimWhitespace, this._renderIndicators, foreignOriginal, foreignModified, this.originalEditor, this.modifiedEditor);\r\n        try {\r\n            this._currentlyChangingViewZones = true;\r\n            this._originalEditorState.apply(this.originalEditor, this._originalOverviewRuler, diffDecorations.original, false);\r\n            this._modifiedEditorState.apply(this.modifiedEditor, this._modifiedOverviewRuler, diffDecorations.modified, true);\r\n        }\r\n        finally {\r\n            this._currentlyChangingViewZones = false;\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype._adjustOptionsForSubEditor = function (options) {\r\n        var clonedOptions = objects.deepClone(options || {});\r\n        clonedOptions.inDiffEditor = true;\r\n        clonedOptions.wordWrap = 'off';\r\n        clonedOptions.wordWrapMinified = false;\r\n        clonedOptions.automaticLayout = false;\r\n        clonedOptions.scrollbar = clonedOptions.scrollbar || {};\r\n        clonedOptions.scrollbar.vertical = 'visible';\r\n        clonedOptions.folding = false;\r\n        clonedOptions.codeLens = false;\r\n        clonedOptions.fixedOverflowWidgets = true;\r\n        // clonedOptions.lineDecorationsWidth = '2ch';\r\n        if (!clonedOptions.minimap) {\r\n            clonedOptions.minimap = {};\r\n        }\r\n        clonedOptions.minimap.enabled = false;\r\n        return clonedOptions;\r\n    };\r\n    DiffEditorWidget.prototype._adjustOptionsForLeftHandSide = function (options, isEditable) {\r\n        var result = this._adjustOptionsForSubEditor(options);\r\n        result.readOnly = !isEditable;\r\n        result.extraEditorClassName = 'original-in-monaco-diff-editor';\r\n        return result;\r\n    };\r\n    DiffEditorWidget.prototype._adjustOptionsForRightHandSide = function (options) {\r\n        var result = this._adjustOptionsForSubEditor(options);\r\n        result.revealHorizontalRightPadding = EditorOptions.revealHorizontalRightPadding.defaultValue + DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\r\n        result.scrollbar.verticalHasArrows = false;\r\n        result.extraEditorClassName = 'modified-in-monaco-diff-editor';\r\n        return result;\r\n    };\r\n    DiffEditorWidget.prototype.doLayout = function () {\r\n        this._elementSizeObserver.observe();\r\n        this._doLayout();\r\n    };\r\n    DiffEditorWidget.prototype._doLayout = function () {\r\n        var width = this._elementSizeObserver.getWidth();\r\n        var height = this._elementSizeObserver.getHeight();\r\n        var reviewHeight = this._getReviewHeight();\r\n        var splitPoint = this._strategy.layout();\r\n        this._originalDomNode.style.width = splitPoint + 'px';\r\n        this._originalDomNode.style.left = '0px';\r\n        this._modifiedDomNode.style.width = (width - splitPoint) + 'px';\r\n        this._modifiedDomNode.style.left = splitPoint + 'px';\r\n        this._overviewDomElement.style.top = '0px';\r\n        this._overviewDomElement.style.height = (height - reviewHeight) + 'px';\r\n        this._overviewDomElement.style.width = DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH + 'px';\r\n        this._overviewDomElement.style.left = (width - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH) + 'px';\r\n        this._overviewViewportDomElement.setWidth(DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH);\r\n        this._overviewViewportDomElement.setHeight(30);\r\n        this.originalEditor.layout({ width: splitPoint, height: (height - reviewHeight) });\r\n        this.modifiedEditor.layout({ width: width - splitPoint - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH, height: (height - reviewHeight) });\r\n        if (this._originalOverviewRuler || this._modifiedOverviewRuler) {\r\n            this._layoutOverviewRulers();\r\n        }\r\n        this._reviewPane.layout(height - reviewHeight, width, reviewHeight);\r\n        this._layoutOverviewViewport();\r\n    };\r\n    DiffEditorWidget.prototype._layoutOverviewViewport = function () {\r\n        var layout = this._computeOverviewViewport();\r\n        if (!layout) {\r\n            this._overviewViewportDomElement.setTop(0);\r\n            this._overviewViewportDomElement.setHeight(0);\r\n        }\r\n        else {\r\n            this._overviewViewportDomElement.setTop(layout.top);\r\n            this._overviewViewportDomElement.setHeight(layout.height);\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype._computeOverviewViewport = function () {\r\n        var layoutInfo = this.modifiedEditor.getLayoutInfo();\r\n        if (!layoutInfo) {\r\n            return null;\r\n        }\r\n        var scrollTop = this.modifiedEditor.getScrollTop();\r\n        var scrollHeight = this.modifiedEditor.getScrollHeight();\r\n        var computedAvailableSize = Math.max(0, layoutInfo.height);\r\n        var computedRepresentableSize = Math.max(0, computedAvailableSize - 2 * 0);\r\n        var computedRatio = scrollHeight > 0 ? (computedRepresentableSize / scrollHeight) : 0;\r\n        var computedSliderSize = Math.max(0, Math.floor(layoutInfo.height * computedRatio));\r\n        var computedSliderPosition = Math.floor(scrollTop * computedRatio);\r\n        return {\r\n            height: computedSliderSize,\r\n            top: computedSliderPosition\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype._createDataSource = function () {\r\n        var _this = this;\r\n        return {\r\n            getWidth: function () {\r\n                return _this._elementSizeObserver.getWidth();\r\n            },\r\n            getHeight: function () {\r\n                return (_this._elementSizeObserver.getHeight() - _this._getReviewHeight());\r\n            },\r\n            getContainerDomNode: function () {\r\n                return _this._containerDomElement;\r\n            },\r\n            relayoutEditors: function () {\r\n                _this._doLayout();\r\n            },\r\n            getOriginalEditor: function () {\r\n                return _this.originalEditor;\r\n            },\r\n            getModifiedEditor: function () {\r\n                return _this.modifiedEditor;\r\n            }\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype._setStrategy = function (newStrategy) {\r\n        if (this._strategy) {\r\n            this._strategy.dispose();\r\n        }\r\n        this._strategy = newStrategy;\r\n        newStrategy.applyColors(this._themeService.getTheme());\r\n        if (this._diffComputationResult) {\r\n            this._updateDecorations();\r\n        }\r\n        // Just do a layout, the strategy might need it\r\n        this._doLayout();\r\n    };\r\n    DiffEditorWidget.prototype._getLineChangeAtOrBeforeLineNumber = function (lineNumber, startLineNumberExtractor) {\r\n        var lineChanges = (this._diffComputationResult ? this._diffComputationResult.changes : []);\r\n        if (lineChanges.length === 0 || lineNumber < startLineNumberExtractor(lineChanges[0])) {\r\n            // There are no changes or `lineNumber` is before the first change\r\n            return null;\r\n        }\r\n        var min = 0, max = lineChanges.length - 1;\r\n        while (min < max) {\r\n            var mid = Math.floor((min + max) / 2);\r\n            var midStart = startLineNumberExtractor(lineChanges[mid]);\r\n            var midEnd = (mid + 1 <= max ? startLineNumberExtractor(lineChanges[mid + 1]) : 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n            if (lineNumber < midStart) {\r\n                max = mid - 1;\r\n            }\r\n            else if (lineNumber >= midEnd) {\r\n                min = mid + 1;\r\n            }\r\n            else {\r\n                // HIT!\r\n                min = mid;\r\n                max = mid;\r\n            }\r\n        }\r\n        return lineChanges[min];\r\n    };\r\n    DiffEditorWidget.prototype._getEquivalentLineForOriginalLineNumber = function (lineNumber) {\r\n        var lineChange = this._getLineChangeAtOrBeforeLineNumber(lineNumber, function (lineChange) { return lineChange.originalStartLineNumber; });\r\n        if (!lineChange) {\r\n            return lineNumber;\r\n        }\r\n        var originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\r\n        var modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\r\n        var lineChangeOriginalLength = (lineChange.originalEndLineNumber > 0 ? (lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1) : 0);\r\n        var lineChangeModifiedLength = (lineChange.modifiedEndLineNumber > 0 ? (lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1) : 0);\r\n        var delta = lineNumber - originalEquivalentLineNumber;\r\n        if (delta <= lineChangeOriginalLength) {\r\n            return modifiedEquivalentLineNumber + Math.min(delta, lineChangeModifiedLength);\r\n        }\r\n        return modifiedEquivalentLineNumber + lineChangeModifiedLength - lineChangeOriginalLength + delta;\r\n    };\r\n    DiffEditorWidget.prototype._getEquivalentLineForModifiedLineNumber = function (lineNumber) {\r\n        var lineChange = this._getLineChangeAtOrBeforeLineNumber(lineNumber, function (lineChange) { return lineChange.modifiedStartLineNumber; });\r\n        if (!lineChange) {\r\n            return lineNumber;\r\n        }\r\n        var originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\r\n        var modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\r\n        var lineChangeOriginalLength = (lineChange.originalEndLineNumber > 0 ? (lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1) : 0);\r\n        var lineChangeModifiedLength = (lineChange.modifiedEndLineNumber > 0 ? (lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1) : 0);\r\n        var delta = lineNumber - modifiedEquivalentLineNumber;\r\n        if (delta <= lineChangeModifiedLength) {\r\n            return originalEquivalentLineNumber + Math.min(delta, lineChangeOriginalLength);\r\n        }\r\n        return originalEquivalentLineNumber + lineChangeOriginalLength - lineChangeModifiedLength + delta;\r\n    };\r\n    DiffEditorWidget.prototype.getDiffLineInformationForOriginal = function (lineNumber) {\r\n        if (!this._diffComputationResult) {\r\n            // Cannot answer that which I don't know\r\n            return null;\r\n        }\r\n        return {\r\n            equivalentLineNumber: this._getEquivalentLineForOriginalLineNumber(lineNumber)\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype.getDiffLineInformationForModified = function (lineNumber) {\r\n        if (!this._diffComputationResult) {\r\n            // Cannot answer that which I don't know\r\n            return null;\r\n        }\r\n        return {\r\n            equivalentLineNumber: this._getEquivalentLineForModifiedLineNumber(lineNumber)\r\n        };\r\n    };\r\n    DiffEditorWidget.ONE_OVERVIEW_WIDTH = 15;\r\n    DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH = 30;\r\n    DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY = 200; // ms\r\n    DiffEditorWidget = __decorate([\r\n        __param(3, IEditorWorkerService),\r\n        __param(4, IContextKeyService),\r\n        __param(5, IInstantiationService),\r\n        __param(6, ICodeEditorService),\r\n        __param(7, IThemeService),\r\n        __param(8, INotificationService),\r\n        __param(9, IContextMenuService),\r\n        __param(10, IEditorProgressService)\r\n    ], DiffEditorWidget);\r\n    return DiffEditorWidget;\r\n}(Disposable));\r\nexport { DiffEditorWidget };\r\nvar DiffEditorWidgetStyle = /** @class */ (function (_super) {\r\n    __extends(DiffEditorWidgetStyle, _super);\r\n    function DiffEditorWidgetStyle(dataSource) {\r\n        var _this = _super.call(this) || this;\r\n        _this._dataSource = dataSource;\r\n        _this._insertColor = null;\r\n        _this._removeColor = null;\r\n        return _this;\r\n    }\r\n    DiffEditorWidgetStyle.prototype.applyColors = function (theme) {\r\n        var newInsertColor = (theme.getColor(diffInserted) || defaultInsertColor).transparent(2);\r\n        var newRemoveColor = (theme.getColor(diffRemoved) || defaultRemoveColor).transparent(2);\r\n        var hasChanges = !newInsertColor.equals(this._insertColor) || !newRemoveColor.equals(this._removeColor);\r\n        this._insertColor = newInsertColor;\r\n        this._removeColor = newRemoveColor;\r\n        return hasChanges;\r\n    };\r\n    DiffEditorWidgetStyle.prototype.getEditorsDiffDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalWhitespaces, modifiedWhitespaces, originalEditor, modifiedEditor) {\r\n        // Get view zones\r\n        modifiedWhitespaces = modifiedWhitespaces.sort(function (a, b) {\r\n            return a.afterLineNumber - b.afterLineNumber;\r\n        });\r\n        originalWhitespaces = originalWhitespaces.sort(function (a, b) {\r\n            return a.afterLineNumber - b.afterLineNumber;\r\n        });\r\n        var zones = this._getViewZones(lineChanges, originalWhitespaces, modifiedWhitespaces, originalEditor, modifiedEditor, renderIndicators);\r\n        // Get decorations & overview ruler zones\r\n        var originalDecorations = this._getOriginalEditorDecorations(lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor);\r\n        var modifiedDecorations = this._getModifiedEditorDecorations(lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor);\r\n        return {\r\n            original: {\r\n                decorations: originalDecorations.decorations,\r\n                overviewZones: originalDecorations.overviewZones,\r\n                zones: zones.original\r\n            },\r\n            modified: {\r\n                decorations: modifiedDecorations.decorations,\r\n                overviewZones: modifiedDecorations.overviewZones,\r\n                zones: zones.modified\r\n            }\r\n        };\r\n    };\r\n    return DiffEditorWidgetStyle;\r\n}(Disposable));\r\nvar ForeignViewZonesIterator = /** @class */ (function () {\r\n    function ForeignViewZonesIterator(source) {\r\n        this._source = source;\r\n        this._index = -1;\r\n        this.current = null;\r\n        this.advance();\r\n    }\r\n    ForeignViewZonesIterator.prototype.advance = function () {\r\n        this._index++;\r\n        if (this._index < this._source.length) {\r\n            this.current = this._source[this._index];\r\n        }\r\n        else {\r\n            this.current = null;\r\n        }\r\n    };\r\n    return ForeignViewZonesIterator;\r\n}());\r\nvar ViewZonesComputer = /** @class */ (function () {\r\n    function ViewZonesComputer(lineChanges, originalForeignVZ, originalLineHeight, modifiedForeignVZ, modifiedLineHeight) {\r\n        this.lineChanges = lineChanges;\r\n        this.originalForeignVZ = originalForeignVZ;\r\n        this.originalLineHeight = originalLineHeight;\r\n        this.modifiedForeignVZ = modifiedForeignVZ;\r\n        this.modifiedLineHeight = modifiedLineHeight;\r\n    }\r\n    ViewZonesComputer.prototype.getViewZones = function () {\r\n        var result = {\r\n            original: [],\r\n            modified: []\r\n        };\r\n        var lineChangeModifiedLength = 0;\r\n        var lineChangeOriginalLength = 0;\r\n        var originalEquivalentLineNumber = 0;\r\n        var modifiedEquivalentLineNumber = 0;\r\n        var originalEndEquivalentLineNumber = 0;\r\n        var modifiedEndEquivalentLineNumber = 0;\r\n        var sortMyViewZones = function (a, b) {\r\n            return a.afterLineNumber - b.afterLineNumber;\r\n        };\r\n        var addAndCombineIfPossible = function (destination, item) {\r\n            if (item.domNode === null && destination.length > 0) {\r\n                var lastItem = destination[destination.length - 1];\r\n                if (lastItem.afterLineNumber === item.afterLineNumber && lastItem.domNode === null) {\r\n                    lastItem.heightInLines += item.heightInLines;\r\n                    return;\r\n                }\r\n            }\r\n            destination.push(item);\r\n        };\r\n        var modifiedForeignVZ = new ForeignViewZonesIterator(this.modifiedForeignVZ);\r\n        var originalForeignVZ = new ForeignViewZonesIterator(this.originalForeignVZ);\r\n        // In order to include foreign view zones after the last line change, the for loop will iterate once more after the end of the `lineChanges` array\r\n        for (var i = 0, length_5 = this.lineChanges.length; i <= length_5; i++) {\r\n            var lineChange = (i < length_5 ? this.lineChanges[i] : null);\r\n            if (lineChange !== null) {\r\n                originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\r\n                modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\r\n                lineChangeOriginalLength = (lineChange.originalEndLineNumber > 0 ? (lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1) : 0);\r\n                lineChangeModifiedLength = (lineChange.modifiedEndLineNumber > 0 ? (lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1) : 0);\r\n                originalEndEquivalentLineNumber = Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber);\r\n                modifiedEndEquivalentLineNumber = Math.max(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber);\r\n            }\r\n            else {\r\n                // Increase to very large value to get the producing tests of foreign view zones running\r\n                originalEquivalentLineNumber += 10000000 + lineChangeOriginalLength;\r\n                modifiedEquivalentLineNumber += 10000000 + lineChangeModifiedLength;\r\n                originalEndEquivalentLineNumber = originalEquivalentLineNumber;\r\n                modifiedEndEquivalentLineNumber = modifiedEquivalentLineNumber;\r\n            }\r\n            // Each step produces view zones, and after producing them, we try to cancel them out, to avoid empty-empty view zone cases\r\n            var stepOriginal = [];\r\n            var stepModified = [];\r\n            // ---------------------------- PRODUCE VIEW ZONES\r\n            // [PRODUCE] View zone(s) in original-side due to foreign view zone(s) in modified-side\r\n            while (modifiedForeignVZ.current && modifiedForeignVZ.current.afterLineNumber <= modifiedEndEquivalentLineNumber) {\r\n                var viewZoneLineNumber = void 0;\r\n                if (modifiedForeignVZ.current.afterLineNumber <= modifiedEquivalentLineNumber) {\r\n                    viewZoneLineNumber = originalEquivalentLineNumber - modifiedEquivalentLineNumber + modifiedForeignVZ.current.afterLineNumber;\r\n                }\r\n                else {\r\n                    viewZoneLineNumber = originalEndEquivalentLineNumber;\r\n                }\r\n                var marginDomNode = null;\r\n                if (lineChange && lineChange.modifiedStartLineNumber <= modifiedForeignVZ.current.afterLineNumber && modifiedForeignVZ.current.afterLineNumber <= lineChange.modifiedEndLineNumber) {\r\n                    marginDomNode = this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion();\r\n                }\r\n                stepOriginal.push({\r\n                    afterLineNumber: viewZoneLineNumber,\r\n                    heightInLines: modifiedForeignVZ.current.height / this.modifiedLineHeight,\r\n                    domNode: null,\r\n                    marginDomNode: marginDomNode\r\n                });\r\n                modifiedForeignVZ.advance();\r\n            }\r\n            // [PRODUCE] View zone(s) in modified-side due to foreign view zone(s) in original-side\r\n            while (originalForeignVZ.current && originalForeignVZ.current.afterLineNumber <= originalEndEquivalentLineNumber) {\r\n                var viewZoneLineNumber = void 0;\r\n                if (originalForeignVZ.current.afterLineNumber <= originalEquivalentLineNumber) {\r\n                    viewZoneLineNumber = modifiedEquivalentLineNumber - originalEquivalentLineNumber + originalForeignVZ.current.afterLineNumber;\r\n                }\r\n                else {\r\n                    viewZoneLineNumber = modifiedEndEquivalentLineNumber;\r\n                }\r\n                stepModified.push({\r\n                    afterLineNumber: viewZoneLineNumber,\r\n                    heightInLines: originalForeignVZ.current.height / this.originalLineHeight,\r\n                    domNode: null\r\n                });\r\n                originalForeignVZ.advance();\r\n            }\r\n            if (lineChange !== null && isChangeOrInsert(lineChange)) {\r\n                var r = this._produceOriginalFromDiff(lineChange, lineChangeOriginalLength, lineChangeModifiedLength);\r\n                if (r) {\r\n                    stepOriginal.push(r);\r\n                }\r\n            }\r\n            if (lineChange !== null && isChangeOrDelete(lineChange)) {\r\n                var r = this._produceModifiedFromDiff(lineChange, lineChangeOriginalLength, lineChangeModifiedLength);\r\n                if (r) {\r\n                    stepModified.push(r);\r\n                }\r\n            }\r\n            // ---------------------------- END PRODUCE VIEW ZONES\r\n            // ---------------------------- EMIT MINIMAL VIEW ZONES\r\n            // [CANCEL & EMIT] Try to cancel view zones out\r\n            var stepOriginalIndex = 0;\r\n            var stepModifiedIndex = 0;\r\n            stepOriginal = stepOriginal.sort(sortMyViewZones);\r\n            stepModified = stepModified.sort(sortMyViewZones);\r\n            while (stepOriginalIndex < stepOriginal.length && stepModifiedIndex < stepModified.length) {\r\n                var original = stepOriginal[stepOriginalIndex];\r\n                var modified = stepModified[stepModifiedIndex];\r\n                var originalDelta = original.afterLineNumber - originalEquivalentLineNumber;\r\n                var modifiedDelta = modified.afterLineNumber - modifiedEquivalentLineNumber;\r\n                if (originalDelta < modifiedDelta) {\r\n                    addAndCombineIfPossible(result.original, original);\r\n                    stepOriginalIndex++;\r\n                }\r\n                else if (modifiedDelta < originalDelta) {\r\n                    addAndCombineIfPossible(result.modified, modified);\r\n                    stepModifiedIndex++;\r\n                }\r\n                else if (original.shouldNotShrink) {\r\n                    addAndCombineIfPossible(result.original, original);\r\n                    stepOriginalIndex++;\r\n                }\r\n                else if (modified.shouldNotShrink) {\r\n                    addAndCombineIfPossible(result.modified, modified);\r\n                    stepModifiedIndex++;\r\n                }\r\n                else {\r\n                    if (original.heightInLines >= modified.heightInLines) {\r\n                        // modified view zone gets removed\r\n                        original.heightInLines -= modified.heightInLines;\r\n                        stepModifiedIndex++;\r\n                    }\r\n                    else {\r\n                        // original view zone gets removed\r\n                        modified.heightInLines -= original.heightInLines;\r\n                        stepOriginalIndex++;\r\n                    }\r\n                }\r\n            }\r\n            // [EMIT] Remaining original view zones\r\n            while (stepOriginalIndex < stepOriginal.length) {\r\n                addAndCombineIfPossible(result.original, stepOriginal[stepOriginalIndex]);\r\n                stepOriginalIndex++;\r\n            }\r\n            // [EMIT] Remaining modified view zones\r\n            while (stepModifiedIndex < stepModified.length) {\r\n                addAndCombineIfPossible(result.modified, stepModified[stepModifiedIndex]);\r\n                stepModifiedIndex++;\r\n            }\r\n            // ---------------------------- END EMIT MINIMAL VIEW ZONES\r\n        }\r\n        return {\r\n            original: ViewZonesComputer._ensureDomNodes(result.original),\r\n            modified: ViewZonesComputer._ensureDomNodes(result.modified),\r\n        };\r\n    };\r\n    ViewZonesComputer._ensureDomNodes = function (zones) {\r\n        return zones.map(function (z) {\r\n            if (!z.domNode) {\r\n                z.domNode = createFakeLinesDiv();\r\n            }\r\n            return z;\r\n        });\r\n    };\r\n    return ViewZonesComputer;\r\n}());\r\nfunction createDecoration(startLineNumber, startColumn, endLineNumber, endColumn, options) {\r\n    return {\r\n        range: new Range(startLineNumber, startColumn, endLineNumber, endColumn),\r\n        options: options\r\n    };\r\n}\r\nvar DECORATIONS = {\r\n    charDelete: ModelDecorationOptions.register({\r\n        className: 'char-delete'\r\n    }),\r\n    charDeleteWholeLine: ModelDecorationOptions.register({\r\n        className: 'char-delete',\r\n        isWholeLine: true\r\n    }),\r\n    charInsert: ModelDecorationOptions.register({\r\n        className: 'char-insert'\r\n    }),\r\n    charInsertWholeLine: ModelDecorationOptions.register({\r\n        className: 'char-insert',\r\n        isWholeLine: true\r\n    }),\r\n    lineInsert: ModelDecorationOptions.register({\r\n        className: 'line-insert',\r\n        marginClassName: 'line-insert',\r\n        isWholeLine: true\r\n    }),\r\n    lineInsertWithSign: ModelDecorationOptions.register({\r\n        className: 'line-insert',\r\n        linesDecorationsClassName: 'insert-sign codicon codicon-add',\r\n        marginClassName: 'line-insert',\r\n        isWholeLine: true\r\n    }),\r\n    lineDelete: ModelDecorationOptions.register({\r\n        className: 'line-delete',\r\n        marginClassName: 'line-delete',\r\n        isWholeLine: true\r\n    }),\r\n    lineDeleteWithSign: ModelDecorationOptions.register({\r\n        className: 'line-delete',\r\n        linesDecorationsClassName: 'delete-sign codicon codicon-remove',\r\n        marginClassName: 'line-delete',\r\n        isWholeLine: true\r\n    }),\r\n    lineDeleteMargin: ModelDecorationOptions.register({\r\n        marginClassName: 'line-delete',\r\n    })\r\n};\r\nvar DiffEditorWidgetSideBySide = /** @class */ (function (_super) {\r\n    __extends(DiffEditorWidgetSideBySide, _super);\r\n    function DiffEditorWidgetSideBySide(dataSource, enableSplitViewResizing) {\r\n        var _this = _super.call(this, dataSource) || this;\r\n        _this._disableSash = (enableSplitViewResizing === false);\r\n        _this._sashRatio = null;\r\n        _this._sashPosition = null;\r\n        _this._startSashPosition = null;\r\n        _this._sash = _this._register(new Sash(_this._dataSource.getContainerDomNode(), _this));\r\n        if (_this._disableSash) {\r\n            _this._sash.state = 0 /* Disabled */;\r\n        }\r\n        _this._sash.onDidStart(function () { return _this.onSashDragStart(); });\r\n        _this._sash.onDidChange(function (e) { return _this.onSashDrag(e); });\r\n        _this._sash.onDidEnd(function () { return _this.onSashDragEnd(); });\r\n        _this._sash.onDidReset(function () { return _this.onSashReset(); });\r\n        return _this;\r\n    }\r\n    DiffEditorWidgetSideBySide.prototype.setEnableSplitViewResizing = function (enableSplitViewResizing) {\r\n        var newDisableSash = (enableSplitViewResizing === false);\r\n        if (this._disableSash !== newDisableSash) {\r\n            this._disableSash = newDisableSash;\r\n            this._sash.state = this._disableSash ? 0 /* Disabled */ : 3 /* Enabled */;\r\n        }\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.layout = function (sashRatio) {\r\n        if (sashRatio === void 0) { sashRatio = this._sashRatio; }\r\n        var w = this._dataSource.getWidth();\r\n        var contentWidth = w - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\r\n        var sashPosition = Math.floor((sashRatio || 0.5) * contentWidth);\r\n        var midPoint = Math.floor(0.5 * contentWidth);\r\n        sashPosition = this._disableSash ? midPoint : sashPosition || midPoint;\r\n        if (contentWidth > DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH * 2) {\r\n            if (sashPosition < DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH) {\r\n                sashPosition = DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH;\r\n            }\r\n            if (sashPosition > contentWidth - DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH) {\r\n                sashPosition = contentWidth - DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH;\r\n            }\r\n        }\r\n        else {\r\n            sashPosition = midPoint;\r\n        }\r\n        if (this._sashPosition !== sashPosition) {\r\n            this._sashPosition = sashPosition;\r\n            this._sash.layout();\r\n        }\r\n        return this._sashPosition;\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.onSashDragStart = function () {\r\n        this._startSashPosition = this._sashPosition;\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.onSashDrag = function (e) {\r\n        var w = this._dataSource.getWidth();\r\n        var contentWidth = w - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\r\n        var sashPosition = this.layout((this._startSashPosition + (e.currentX - e.startX)) / contentWidth);\r\n        this._sashRatio = sashPosition / contentWidth;\r\n        this._dataSource.relayoutEditors();\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.onSashDragEnd = function () {\r\n        this._sash.layout();\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.onSashReset = function () {\r\n        this._sashRatio = 0.5;\r\n        this._dataSource.relayoutEditors();\r\n        this._sash.layout();\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.getVerticalSashTop = function (sash) {\r\n        return 0;\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.getVerticalSashLeft = function (sash) {\r\n        return this._sashPosition;\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype.getVerticalSashHeight = function (sash) {\r\n        return this._dataSource.getHeight();\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype._getViewZones = function (lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor) {\r\n        var c = new SideBySideViewZonesComputer(lineChanges, originalForeignVZ, originalEditor.getOption(49 /* lineHeight */), modifiedForeignVZ, modifiedEditor.getOption(49 /* lineHeight */));\r\n        return c.getViewZones();\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype._getOriginalEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = String(this._removeColor);\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        var originalModel = originalEditor.getModel();\r\n        for (var i = 0, length_6 = lineChanges.length; i < length_6; i++) {\r\n            var lineChange = lineChanges[i];\r\n            if (isChangeOrDelete(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n                    options: (renderIndicators ? DECORATIONS.lineDeleteWithSign : DECORATIONS.lineDelete)\r\n                });\r\n                if (!isChangeOrInsert(lineChange) || !lineChange.charChanges) {\r\n                    result.decorations.push(createDecoration(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */, DECORATIONS.charDeleteWholeLine));\r\n                }\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber, overviewZoneColor));\r\n                if (lineChange.charChanges) {\r\n                    for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                        var charChange = lineChange.charChanges[j];\r\n                        if (isChangeOrDelete(charChange)) {\r\n                            if (ignoreTrimWhitespace) {\r\n                                for (var lineNumber = charChange.originalStartLineNumber; lineNumber <= charChange.originalEndLineNumber; lineNumber++) {\r\n                                    var startColumn = void 0;\r\n                                    var endColumn = void 0;\r\n                                    if (lineNumber === charChange.originalStartLineNumber) {\r\n                                        startColumn = charChange.originalStartColumn;\r\n                                    }\r\n                                    else {\r\n                                        startColumn = originalModel.getLineFirstNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    if (lineNumber === charChange.originalEndLineNumber) {\r\n                                        endColumn = charChange.originalEndColumn;\r\n                                    }\r\n                                    else {\r\n                                        endColumn = originalModel.getLineLastNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charDelete));\r\n                                }\r\n                            }\r\n                            else {\r\n                                result.decorations.push(createDecoration(charChange.originalStartLineNumber, charChange.originalStartColumn, charChange.originalEndLineNumber, charChange.originalEndColumn, DECORATIONS.charDelete));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEditorWidgetSideBySide.prototype._getModifiedEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = String(this._insertColor);\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        var modifiedModel = modifiedEditor.getModel();\r\n        for (var i = 0, length_7 = lineChanges.length; i < length_7; i++) {\r\n            var lineChange = lineChanges[i];\r\n            if (isChangeOrInsert(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n                    options: (renderIndicators ? DECORATIONS.lineInsertWithSign : DECORATIONS.lineInsert)\r\n                });\r\n                if (!isChangeOrDelete(lineChange) || !lineChange.charChanges) {\r\n                    result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */, DECORATIONS.charInsertWholeLine));\r\n                }\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber, overviewZoneColor));\r\n                if (lineChange.charChanges) {\r\n                    for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                        var charChange = lineChange.charChanges[j];\r\n                        if (isChangeOrInsert(charChange)) {\r\n                            if (ignoreTrimWhitespace) {\r\n                                for (var lineNumber = charChange.modifiedStartLineNumber; lineNumber <= charChange.modifiedEndLineNumber; lineNumber++) {\r\n                                    var startColumn = void 0;\r\n                                    var endColumn = void 0;\r\n                                    if (lineNumber === charChange.modifiedStartLineNumber) {\r\n                                        startColumn = charChange.modifiedStartColumn;\r\n                                    }\r\n                                    else {\r\n                                        startColumn = modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    if (lineNumber === charChange.modifiedEndLineNumber) {\r\n                                        endColumn = charChange.modifiedEndColumn;\r\n                                    }\r\n                                    else {\r\n                                        endColumn = modifiedModel.getLineLastNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charInsert));\r\n                                }\r\n                            }\r\n                            else {\r\n                                result.decorations.push(createDecoration(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn, DECORATIONS.charInsert));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH = 100;\r\n    return DiffEditorWidgetSideBySide;\r\n}(DiffEditorWidgetStyle));\r\nvar SideBySideViewZonesComputer = /** @class */ (function (_super) {\r\n    __extends(SideBySideViewZonesComputer, _super);\r\n    function SideBySideViewZonesComputer(lineChanges, originalForeignVZ, originalLineHeight, modifiedForeignVZ, modifiedLineHeight) {\r\n        return _super.call(this, lineChanges, originalForeignVZ, originalLineHeight, modifiedForeignVZ, modifiedLineHeight) || this;\r\n    }\r\n    SideBySideViewZonesComputer.prototype._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion = function () {\r\n        return null;\r\n    };\r\n    SideBySideViewZonesComputer.prototype._produceOriginalFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        if (lineChangeModifiedLength > lineChangeOriginalLength) {\r\n            return {\r\n                afterLineNumber: Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber),\r\n                heightInLines: (lineChangeModifiedLength - lineChangeOriginalLength),\r\n                domNode: null\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    SideBySideViewZonesComputer.prototype._produceModifiedFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        if (lineChangeOriginalLength > lineChangeModifiedLength) {\r\n            return {\r\n                afterLineNumber: Math.max(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber),\r\n                heightInLines: (lineChangeOriginalLength - lineChangeModifiedLength),\r\n                domNode: null\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    return SideBySideViewZonesComputer;\r\n}(ViewZonesComputer));\r\nvar DiffEditorWidgetInline = /** @class */ (function (_super) {\r\n    __extends(DiffEditorWidgetInline, _super);\r\n    function DiffEditorWidgetInline(dataSource, enableSplitViewResizing) {\r\n        var _this = _super.call(this, dataSource) || this;\r\n        _this.decorationsLeft = dataSource.getOriginalEditor().getLayoutInfo().decorationsLeft;\r\n        _this._register(dataSource.getOriginalEditor().onDidLayoutChange(function (layoutInfo) {\r\n            if (_this.decorationsLeft !== layoutInfo.decorationsLeft) {\r\n                _this.decorationsLeft = layoutInfo.decorationsLeft;\r\n                dataSource.relayoutEditors();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    DiffEditorWidgetInline.prototype.setEnableSplitViewResizing = function (enableSplitViewResizing) {\r\n        // Nothing to do..\r\n    };\r\n    DiffEditorWidgetInline.prototype._getViewZones = function (lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators) {\r\n        var computer = new InlineViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators);\r\n        return computer.getViewZones();\r\n    };\r\n    DiffEditorWidgetInline.prototype._getOriginalEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = String(this._removeColor);\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        for (var i = 0, length_8 = lineChanges.length; i < length_8; i++) {\r\n            var lineChange = lineChanges[i];\r\n            // Add overview zones in the overview ruler\r\n            if (isChangeOrDelete(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n                    options: DECORATIONS.lineDeleteMargin\r\n                });\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber, overviewZoneColor));\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEditorWidgetInline.prototype._getModifiedEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = String(this._insertColor);\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        var modifiedModel = modifiedEditor.getModel();\r\n        for (var i = 0, length_9 = lineChanges.length; i < length_9; i++) {\r\n            var lineChange = lineChanges[i];\r\n            // Add decorations & overview zones\r\n            if (isChangeOrInsert(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n                    options: (renderIndicators ? DECORATIONS.lineInsertWithSign : DECORATIONS.lineInsert)\r\n                });\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber, overviewZoneColor));\r\n                if (lineChange.charChanges) {\r\n                    for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                        var charChange = lineChange.charChanges[j];\r\n                        if (isChangeOrInsert(charChange)) {\r\n                            if (ignoreTrimWhitespace) {\r\n                                for (var lineNumber = charChange.modifiedStartLineNumber; lineNumber <= charChange.modifiedEndLineNumber; lineNumber++) {\r\n                                    var startColumn = void 0;\r\n                                    var endColumn = void 0;\r\n                                    if (lineNumber === charChange.modifiedStartLineNumber) {\r\n                                        startColumn = charChange.modifiedStartColumn;\r\n                                    }\r\n                                    else {\r\n                                        startColumn = modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    if (lineNumber === charChange.modifiedEndLineNumber) {\r\n                                        endColumn = charChange.modifiedEndColumn;\r\n                                    }\r\n                                    else {\r\n                                        endColumn = modifiedModel.getLineLastNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charInsert));\r\n                                }\r\n                            }\r\n                            else {\r\n                                result.decorations.push(createDecoration(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn, DECORATIONS.charInsert));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */, DECORATIONS.charInsertWholeLine));\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEditorWidgetInline.prototype.layout = function () {\r\n        // An editor should not be smaller than 5px\r\n        return Math.max(5, this.decorationsLeft);\r\n    };\r\n    return DiffEditorWidgetInline;\r\n}(DiffEditorWidgetStyle));\r\nvar InlineViewZonesComputer = /** @class */ (function (_super) {\r\n    __extends(InlineViewZonesComputer, _super);\r\n    function InlineViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators) {\r\n        var _this = _super.call(this, lineChanges, originalForeignVZ, originalEditor.getOption(49 /* lineHeight */), modifiedForeignVZ, modifiedEditor.getOption(49 /* lineHeight */)) || this;\r\n        _this.originalModel = originalEditor.getModel();\r\n        _this.modifiedEditorOptions = modifiedEditor.getOptions();\r\n        _this.modifiedEditorTabSize = modifiedEditor.getModel().getOptions().tabSize;\r\n        _this.renderIndicators = renderIndicators;\r\n        return _this;\r\n    }\r\n    InlineViewZonesComputer.prototype._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion = function () {\r\n        var result = document.createElement('div');\r\n        result.className = 'inline-added-margin-view-zone';\r\n        return result;\r\n    };\r\n    InlineViewZonesComputer.prototype._produceOriginalFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        var marginDomNode = document.createElement('div');\r\n        marginDomNode.className = 'inline-added-margin-view-zone';\r\n        return {\r\n            afterLineNumber: Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber),\r\n            heightInLines: lineChangeModifiedLength,\r\n            domNode: document.createElement('div'),\r\n            marginDomNode: marginDomNode\r\n        };\r\n    };\r\n    InlineViewZonesComputer.prototype._produceModifiedFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        var decorations = [];\r\n        if (lineChange.charChanges) {\r\n            for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                var charChange = lineChange.charChanges[j];\r\n                if (isChangeOrDelete(charChange)) {\r\n                    decorations.push(new InlineDecoration(new Range(charChange.originalStartLineNumber, charChange.originalStartColumn, charChange.originalEndLineNumber, charChange.originalEndColumn), 'char-delete', 0 /* Regular */));\r\n                }\r\n            }\r\n        }\r\n        var sb = createStringBuilder(10000);\r\n        var marginHTML = [];\r\n        var layoutInfo = this.modifiedEditorOptions.get(107 /* layoutInfo */);\r\n        var fontInfo = this.modifiedEditorOptions.get(34 /* fontInfo */);\r\n        var lineDecorationsWidth = layoutInfo.decorationsWidth;\r\n        var lineHeight = this.modifiedEditorOptions.get(49 /* lineHeight */);\r\n        var typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\r\n        var maxCharsPerLine = 0;\r\n        var originalContent = [];\r\n        for (var lineNumber = lineChange.originalStartLineNumber; lineNumber <= lineChange.originalEndLineNumber; lineNumber++) {\r\n            maxCharsPerLine = Math.max(maxCharsPerLine, this._renderOriginalLine(lineNumber - lineChange.originalStartLineNumber, this.originalModel, this.modifiedEditorOptions, this.modifiedEditorTabSize, lineNumber, decorations, sb));\r\n            originalContent.push(this.originalModel.getLineContent(lineNumber));\r\n            if (this.renderIndicators) {\r\n                var index = lineNumber - lineChange.originalStartLineNumber;\r\n                marginHTML = marginHTML.concat([\r\n                    \"<div class=\\\"delete-sign codicon codicon-remove\\\" style=\\\"position:absolute;top:\" + index * lineHeight + \"px;width:\" + lineDecorationsWidth + \"px;height:\" + lineHeight + \"px;right:0;\\\"></div>\"\r\n                ]);\r\n            }\r\n        }\r\n        maxCharsPerLine += this.modifiedEditorOptions.get(79 /* scrollBeyondLastColumn */);\r\n        var domNode = document.createElement('div');\r\n        domNode.className = 'view-lines line-delete';\r\n        domNode.innerHTML = sb.build();\r\n        Configuration.applyFontInfoSlow(domNode, fontInfo);\r\n        var marginDomNode = document.createElement('div');\r\n        marginDomNode.className = 'inline-deleted-margin-view-zone';\r\n        marginDomNode.innerHTML = marginHTML.join('');\r\n        Configuration.applyFontInfoSlow(marginDomNode, fontInfo);\r\n        return {\r\n            shouldNotShrink: true,\r\n            afterLineNumber: (lineChange.modifiedEndLineNumber === 0 ? lineChange.modifiedStartLineNumber : lineChange.modifiedStartLineNumber - 1),\r\n            heightInLines: lineChangeOriginalLength,\r\n            minWidthInPx: (maxCharsPerLine * typicalHalfwidthCharacterWidth),\r\n            domNode: domNode,\r\n            marginDomNode: marginDomNode,\r\n            diff: {\r\n                originalStartLineNumber: lineChange.originalStartLineNumber,\r\n                originalEndLineNumber: lineChange.originalEndLineNumber,\r\n                modifiedStartLineNumber: lineChange.modifiedStartLineNumber,\r\n                modifiedEndLineNumber: lineChange.modifiedEndLineNumber,\r\n                originalContent: originalContent\r\n            }\r\n        };\r\n    };\r\n    InlineViewZonesComputer.prototype._renderOriginalLine = function (count, originalModel, options, tabSize, lineNumber, decorations, sb) {\r\n        var lineTokens = originalModel.getLineTokens(lineNumber);\r\n        var lineContent = lineTokens.getLineContent();\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        var actualDecorations = LineDecoration.filter(decorations, lineNumber, 1, lineContent.length + 1);\r\n        sb.appendASCIIString('<div class=\"view-line');\r\n        if (decorations.length === 0) {\r\n            // No char changes\r\n            sb.appendASCIIString(' char-delete');\r\n        }\r\n        sb.appendASCIIString('\" style=\"top:');\r\n        sb.appendASCIIString(String(count * options.get(49 /* lineHeight */)));\r\n        sb.appendASCIIString('px;width:1000000px;\">');\r\n        var isBasicASCII = ViewLineRenderingData.isBasicASCII(lineContent, originalModel.mightContainNonBasicASCII());\r\n        var containsRTL = ViewLineRenderingData.containsRTL(lineContent, isBasicASCII, originalModel.mightContainRTL());\r\n        var output = renderViewLine(new RenderLineInput((fontInfo.isMonospace && !options.get(23 /* disableMonospaceOptimizations */)), fontInfo.canUseHalfwidthRightwardsArrow, lineContent, false, isBasicASCII, containsRTL, 0, lineTokens, actualDecorations, tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, options.get(88 /* stopRenderingLineAfter */), options.get(74 /* renderWhitespace */), options.get(69 /* renderControlCharacters */), options.get(35 /* fontLigatures */) !== EditorFontLigatures.OFF, null // Send no selections, original line cannot be selected\r\n        ), sb);\r\n        sb.appendASCIIString('</div>');\r\n        var absoluteOffsets = output.characterMapping.getAbsoluteOffsets();\r\n        return absoluteOffsets.length > 0 ? absoluteOffsets[absoluteOffsets.length - 1] : 0;\r\n    };\r\n    return InlineViewZonesComputer;\r\n}(ViewZonesComputer));\r\nfunction isChangeOrInsert(lineChange) {\r\n    return lineChange.modifiedEndLineNumber > 0;\r\n}\r\nfunction isChangeOrDelete(lineChange) {\r\n    return lineChange.originalEndLineNumber > 0;\r\n}\r\nfunction createFakeLinesDiv() {\r\n    var r = document.createElement('div');\r\n    r.className = 'diagonal-fill';\r\n    return r;\r\n}\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var added = theme.getColor(diffInserted);\r\n    if (added) {\r\n        collector.addRule(\".monaco-editor .line-insert, .monaco-editor .char-insert { background-color: \" + added + \"; }\");\r\n        collector.addRule(\".monaco-diff-editor .line-insert, .monaco-diff-editor .char-insert { background-color: \" + added + \"; }\");\r\n        collector.addRule(\".monaco-editor .inline-added-margin-view-zone { background-color: \" + added + \"; }\");\r\n    }\r\n    var removed = theme.getColor(diffRemoved);\r\n    if (removed) {\r\n        collector.addRule(\".monaco-editor .line-delete, .monaco-editor .char-delete { background-color: \" + removed + \"; }\");\r\n        collector.addRule(\".monaco-diff-editor .line-delete, .monaco-diff-editor .char-delete { background-color: \" + removed + \"; }\");\r\n        collector.addRule(\".monaco-editor .inline-deleted-margin-view-zone { background-color: \" + removed + \"; }\");\r\n    }\r\n    var addedOutline = theme.getColor(diffInsertedOutline);\r\n    if (addedOutline) {\r\n        collector.addRule(\".monaco-editor .line-insert, .monaco-editor .char-insert { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + addedOutline + \"; }\");\r\n    }\r\n    var removedOutline = theme.getColor(diffRemovedOutline);\r\n    if (removedOutline) {\r\n        collector.addRule(\".monaco-editor .line-delete, .monaco-editor .char-delete { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + removedOutline + \"; }\");\r\n    }\r\n    var shadow = theme.getColor(scrollbarShadow);\r\n    if (shadow) {\r\n        collector.addRule(\".monaco-diff-editor.side-by-side .editor.modified { box-shadow: -6px 0 5px -5px \" + shadow + \"; }\");\r\n    }\r\n    var border = theme.getColor(diffBorder);\r\n    if (border) {\r\n        collector.addRule(\".monaco-diff-editor.side-by-side .editor.modified { border-left: 1px solid \" + border + \"; }\");\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}