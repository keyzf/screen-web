{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar _a;\n\nimport { isWindows } from './platform.js';\nvar _schemePattern = /^\\w[\\w\\d+.-]*$/;\nvar _singleSlashStart = /^\\//;\nvar _doubleSlashStart = /^\\/\\//;\n\nfunction _validateUri(ret, _strict) {\n  // scheme, must be set\n  if (!ret.scheme && _strict) {\n    throw new Error(\"[UriError]: Scheme is missing: {scheme: \\\"\\\", authority: \\\"\" + ret.authority + \"\\\", path: \\\"\" + ret.path + \"\\\", query: \\\"\" + ret.query + \"\\\", fragment: \\\"\" + ret.fragment + \"\\\"}\");\n  } // scheme, https://tools.ietf.org/html/rfc3986#section-3.1\n  // ALPHA *( ALPHA / DIGIT / \"+\" / \"-\" / \".\" )\n\n\n  if (ret.scheme && !_schemePattern.test(ret.scheme)) {\n    throw new Error('[UriError]: Scheme contains illegal characters.');\n  } // path, http://tools.ietf.org/html/rfc3986#section-3.3\n  // If a URI contains an authority component, then the path component\n  // must either be empty or begin with a slash (\"/\") character.  If a URI\n  // does not contain an authority component, then the path cannot begin\n  // with two slash characters (\"//\").\n\n\n  if (ret.path) {\n    if (ret.authority) {\n      if (!_singleSlashStart.test(ret.path)) {\n        throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash (\"/\") character');\n      }\n    } else {\n      if (_doubleSlashStart.test(ret.path)) {\n        throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters (\"//\")');\n      }\n    }\n  }\n} // for a while we allowed uris *without* schemes and this is the migration\n// for them, e.g. an uri without scheme and without strict-mode warns and falls\n// back to the file-scheme. that should cause the least carnage and still be a\n// clear warning\n\n\nfunction _schemeFix(scheme, _strict) {\n  if (!scheme && !_strict) {\n    return 'file';\n  }\n\n  return scheme;\n} // implements a bit of https://tools.ietf.org/html/rfc3986#section-5\n\n\nfunction _referenceResolution(scheme, path) {\n  // the slash-character is our 'default base' as we don't\n  // support constructing URIs relative to other URIs. This\n  // also means that we alter and potentially break paths.\n  // see https://tools.ietf.org/html/rfc3986#section-5.1.4\n  switch (scheme) {\n    case 'https':\n    case 'http':\n    case 'file':\n      if (!path) {\n        path = _slash;\n      } else if (path[0] !== _slash) {\n        path = _slash + path;\n      }\n\n      break;\n  }\n\n  return path;\n}\n\nvar _empty = '';\nvar _slash = '/';\nvar _regexp = /^(([^:/?#]+?):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?/;\n/**\r\n * Uniform Resource Identifier (URI) http://tools.ietf.org/html/rfc3986.\r\n * This class is a simple parser which creates the basic component parts\r\n * (http://tools.ietf.org/html/rfc3986#section-3) with minimal validation\r\n * and encoding.\r\n *\r\n *       foo://example.com:8042/over/there?name=ferret#nose\r\n *       \\_/   \\______________/\\_________/ \\_________/ \\__/\r\n *        |           |            |            |        |\r\n *     scheme     authority       path        query   fragment\r\n *        |   _____________________|__\r\n *       / \\ /                        \\\r\n *       urn:example:animal:ferret:nose\r\n */\n\nvar URI =\n/** @class */\nfunction () {\n  /**\r\n   * @internal\r\n   */\n  function URI(schemeOrData, authority, path, query, fragment, _strict) {\n    if (_strict === void 0) {\n      _strict = false;\n    }\n\n    if (typeof schemeOrData === 'object') {\n      this.scheme = schemeOrData.scheme || _empty;\n      this.authority = schemeOrData.authority || _empty;\n      this.path = schemeOrData.path || _empty;\n      this.query = schemeOrData.query || _empty;\n      this.fragment = schemeOrData.fragment || _empty; // no validation because it's this URI\n      // that creates uri components.\n      // _validateUri(this);\n    } else {\n      this.scheme = _schemeFix(schemeOrData, _strict);\n      this.authority = authority || _empty;\n      this.path = _referenceResolution(this.scheme, path || _empty);\n      this.query = query || _empty;\n      this.fragment = fragment || _empty;\n\n      _validateUri(this, _strict);\n    }\n  }\n\n  URI.isUri = function (thing) {\n    if (thing instanceof URI) {\n      return true;\n    }\n\n    if (!thing) {\n      return false;\n    }\n\n    return typeof thing.authority === 'string' && typeof thing.fragment === 'string' && typeof thing.path === 'string' && typeof thing.query === 'string' && typeof thing.scheme === 'string' && typeof thing.fsPath === 'function' && typeof thing.with === 'function' && typeof thing.toString === 'function';\n  };\n\n  Object.defineProperty(URI.prototype, \"fsPath\", {\n    // ---- filesystem path -----------------------\n\n    /**\r\n     * Returns a string representing the corresponding file system path of this URI.\r\n     * Will handle UNC paths, normalizes windows drive letters to lower-case, and uses the\r\n     * platform specific path separator.\r\n     *\r\n     * * Will *not* validate the path for invalid characters and semantics.\r\n     * * Will *not* look at the scheme of this URI.\r\n     * * The result shall *not* be used for display purposes but for accessing a file on disk.\r\n     *\r\n     *\r\n     * The *difference* to `URI#path` is the use of the platform specific separator and the handling\r\n     * of UNC paths. See the below sample of a file-uri with an authority (UNC path).\r\n     *\r\n     * ```ts\r\n        const u = URI.parse('file://server/c$/folder/file.txt')\r\n        u.authority === 'server'\r\n        u.path === '/shares/c$/file.txt'\r\n        u.fsPath === '\\\\server\\c$\\folder\\file.txt'\r\n    ```\r\n     *\r\n     * Using `URI#path` to read a file (using fs-apis) would not be enough because parts of the path,\r\n     * namely the server name, would be missing. Therefore `URI#fsPath` exists - it's sugar to ease working\r\n     * with URIs that represent files on disk (`file` scheme).\r\n     */\n    get: function () {\n      // if (this.scheme !== 'file') {\n      // \tconsole.warn(`[UriError] calling fsPath with scheme ${this.scheme}`);\n      // }\n      return _makeFsPath(this);\n    },\n    enumerable: true,\n    configurable: true\n  }); // ---- modify to new -------------------------\n\n  URI.prototype.with = function (change) {\n    if (!change) {\n      return this;\n    }\n\n    var scheme = change.scheme,\n        authority = change.authority,\n        path = change.path,\n        query = change.query,\n        fragment = change.fragment;\n\n    if (scheme === undefined) {\n      scheme = this.scheme;\n    } else if (scheme === null) {\n      scheme = _empty;\n    }\n\n    if (authority === undefined) {\n      authority = this.authority;\n    } else if (authority === null) {\n      authority = _empty;\n    }\n\n    if (path === undefined) {\n      path = this.path;\n    } else if (path === null) {\n      path = _empty;\n    }\n\n    if (query === undefined) {\n      query = this.query;\n    } else if (query === null) {\n      query = _empty;\n    }\n\n    if (fragment === undefined) {\n      fragment = this.fragment;\n    } else if (fragment === null) {\n      fragment = _empty;\n    }\n\n    if (scheme === this.scheme && authority === this.authority && path === this.path && query === this.query && fragment === this.fragment) {\n      return this;\n    }\n\n    return new _URI(scheme, authority, path, query, fragment);\n  }; // ---- parse & validate ------------------------\n\n  /**\r\n   * Creates a new URI from a string, e.g. `http://www.msft.com/some/path`,\r\n   * `file:///usr/home`, or `scheme:with/path`.\r\n   *\r\n   * @param value A string which represents an URI (see `URI#toString`).\r\n   */\n\n\n  URI.parse = function (value, _strict) {\n    if (_strict === void 0) {\n      _strict = false;\n    }\n\n    var match = _regexp.exec(value);\n\n    if (!match) {\n      return new _URI(_empty, _empty, _empty, _empty, _empty);\n    }\n\n    return new _URI(match[2] || _empty, percentDecode(match[4] || _empty), percentDecode(match[5] || _empty), percentDecode(match[7] || _empty), percentDecode(match[9] || _empty), _strict);\n  };\n  /**\r\n   * Creates a new URI from a file system path, e.g. `c:\\my\\files`,\r\n   * `/usr/home`, or `\\\\server\\share\\some\\path`.\r\n   *\r\n   * The *difference* between `URI#parse` and `URI#file` is that the latter treats the argument\r\n   * as path, not as stringified-uri. E.g. `URI.file(path)` is **not the same as**\r\n   * `URI.parse('file://' + path)` because the path might contain characters that are\r\n   * interpreted (# and ?). See the following sample:\r\n   * ```ts\r\n  const good = URI.file('/coding/c#/project1');\r\n  good.scheme === 'file';\r\n  good.path === '/coding/c#/project1';\r\n  good.fragment === '';\r\n  const bad = URI.parse('file://' + '/coding/c#/project1');\r\n  bad.scheme === 'file';\r\n  bad.path === '/coding/c'; // path is now broken\r\n  bad.fragment === '/project1';\r\n  ```\r\n   *\r\n   * @param path A file system path (see `URI#fsPath`)\r\n   */\n\n\n  URI.file = function (path) {\n    var authority = _empty; // normalize to fwd-slashes on windows,\n    // on other systems bwd-slashes are valid\n    // filename character, eg /f\\oo/ba\\r.txt\n\n    if (isWindows) {\n      path = path.replace(/\\\\/g, _slash);\n    } // check for authority as used in UNC shares\n    // or use the path as given\n\n\n    if (path[0] === _slash && path[1] === _slash) {\n      var idx = path.indexOf(_slash, 2);\n\n      if (idx === -1) {\n        authority = path.substring(2);\n        path = _slash;\n      } else {\n        authority = path.substring(2, idx);\n        path = path.substring(idx) || _slash;\n      }\n    }\n\n    return new _URI('file', authority, path, _empty, _empty);\n  };\n\n  URI.from = function (components) {\n    return new _URI(components.scheme, components.authority, components.path, components.query, components.fragment);\n  }; // ---- printing/externalize ---------------------------\n\n  /**\r\n   * Creates a string representation for this URI. It's guaranteed that calling\r\n   * `URI.parse` with the result of this function creates an URI which is equal\r\n   * to this URI.\r\n   *\r\n   * * The result shall *not* be used for display purposes but for externalization or transport.\r\n   * * The result will be encoded using the percentage encoding and encoding happens mostly\r\n   * ignore the scheme-specific encoding rules.\r\n   *\r\n   * @param skipEncoding Do not encode the result, default is `false`\r\n   */\n\n\n  URI.prototype.toString = function (skipEncoding) {\n    if (skipEncoding === void 0) {\n      skipEncoding = false;\n    }\n\n    return _asFormatted(this, skipEncoding);\n  };\n\n  URI.prototype.toJSON = function () {\n    return this;\n  };\n\n  URI.revive = function (data) {\n    if (!data) {\n      return data;\n    } else if (data instanceof URI) {\n      return data;\n    } else {\n      var result = new _URI(data);\n      result._formatted = data.external;\n      result._fsPath = data._sep === _pathSepMarker ? data.fsPath : null;\n      return result;\n    }\n  };\n\n  return URI;\n}();\n\nexport { URI };\n\nvar _pathSepMarker = isWindows ? 1 : undefined; // eslint-disable-next-line @typescript-eslint/class-name-casing\n\n\nvar _URI =\n/** @class */\nfunction (_super) {\n  __extends(_URI, _super);\n\n  function _URI() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._formatted = null;\n    _this._fsPath = null;\n    return _this;\n  }\n\n  Object.defineProperty(_URI.prototype, \"fsPath\", {\n    get: function () {\n      if (!this._fsPath) {\n        this._fsPath = _makeFsPath(this);\n      }\n\n      return this._fsPath;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  _URI.prototype.toString = function (skipEncoding) {\n    if (skipEncoding === void 0) {\n      skipEncoding = false;\n    }\n\n    if (!skipEncoding) {\n      if (!this._formatted) {\n        this._formatted = _asFormatted(this, false);\n      }\n\n      return this._formatted;\n    } else {\n      // we don't cache that\n      return _asFormatted(this, true);\n    }\n  };\n\n  _URI.prototype.toJSON = function () {\n    var res = {\n      $mid: 1\n    }; // cached state\n\n    if (this._fsPath) {\n      res.fsPath = this._fsPath;\n      res._sep = _pathSepMarker;\n    }\n\n    if (this._formatted) {\n      res.external = this._formatted;\n    } // uri components\n\n\n    if (this.path) {\n      res.path = this.path;\n    }\n\n    if (this.scheme) {\n      res.scheme = this.scheme;\n    }\n\n    if (this.authority) {\n      res.authority = this.authority;\n    }\n\n    if (this.query) {\n      res.query = this.query;\n    }\n\n    if (this.fragment) {\n      res.fragment = this.fragment;\n    }\n\n    return res;\n  };\n\n  return _URI;\n}(URI); // reserved characters: https://tools.ietf.org/html/rfc3986#section-2.2\n\n\nvar encodeTable = (_a = {}, _a[58\n/* Colon */\n] = '%3A', _a[47\n/* Slash */\n] = '%2F', _a[63\n/* QuestionMark */\n] = '%3F', _a[35\n/* Hash */\n] = '%23', _a[91\n/* OpenSquareBracket */\n] = '%5B', _a[93\n/* CloseSquareBracket */\n] = '%5D', _a[64\n/* AtSign */\n] = '%40', _a[33\n/* ExclamationMark */\n] = '%21', _a[36\n/* DollarSign */\n] = '%24', _a[38\n/* Ampersand */\n] = '%26', _a[39\n/* SingleQuote */\n] = '%27', _a[40\n/* OpenParen */\n] = '%28', _a[41\n/* CloseParen */\n] = '%29', _a[42\n/* Asterisk */\n] = '%2A', _a[43\n/* Plus */\n] = '%2B', _a[44\n/* Comma */\n] = '%2C', _a[59\n/* Semicolon */\n] = '%3B', _a[61\n/* Equals */\n] = '%3D', _a[32\n/* Space */\n] = '%20', _a);\n\nfunction encodeURIComponentFast(uriComponent, allowSlash) {\n  var res = undefined;\n  var nativeEncodePos = -1;\n\n  for (var pos = 0; pos < uriComponent.length; pos++) {\n    var code = uriComponent.charCodeAt(pos); // unreserved characters: https://tools.ietf.org/html/rfc3986#section-2.3\n\n    if (code >= 97\n    /* a */\n    && code <= 122\n    /* z */\n    || code >= 65\n    /* A */\n    && code <= 90\n    /* Z */\n    || code >= 48\n    /* Digit0 */\n    && code <= 57\n    /* Digit9 */\n    || code === 45\n    /* Dash */\n    || code === 46\n    /* Period */\n    || code === 95\n    /* Underline */\n    || code === 126\n    /* Tilde */\n    || allowSlash && code === 47\n    /* Slash */\n    ) {\n      // check if we are delaying native encode\n      if (nativeEncodePos !== -1) {\n        res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\n        nativeEncodePos = -1;\n      } // check if we write into a new string (by default we try to return the param)\n\n\n      if (res !== undefined) {\n        res += uriComponent.charAt(pos);\n      }\n    } else {\n      // encoding needed, we need to allocate a new string\n      if (res === undefined) {\n        res = uriComponent.substr(0, pos);\n      } // check with default table first\n\n\n      var escaped = encodeTable[code];\n\n      if (escaped !== undefined) {\n        // check if we are delaying native encode\n        if (nativeEncodePos !== -1) {\n          res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\n          nativeEncodePos = -1;\n        } // append escaped variant to result\n\n\n        res += escaped;\n      } else if (nativeEncodePos === -1) {\n        // use native encode only when needed\n        nativeEncodePos = pos;\n      }\n    }\n  }\n\n  if (nativeEncodePos !== -1) {\n    res += encodeURIComponent(uriComponent.substring(nativeEncodePos));\n  }\n\n  return res !== undefined ? res : uriComponent;\n}\n\nfunction encodeURIComponentMinimal(path) {\n  var res = undefined;\n\n  for (var pos = 0; pos < path.length; pos++) {\n    var code = path.charCodeAt(pos);\n\n    if (code === 35\n    /* Hash */\n    || code === 63\n    /* QuestionMark */\n    ) {\n        if (res === undefined) {\n          res = path.substr(0, pos);\n        }\n\n        res += encodeTable[code];\n      } else {\n      if (res !== undefined) {\n        res += path[pos];\n      }\n    }\n  }\n\n  return res !== undefined ? res : path;\n}\n/**\r\n * Compute `fsPath` for the given uri\r\n */\n\n\nfunction _makeFsPath(uri) {\n  var value;\n\n  if (uri.authority && uri.path.length > 1 && uri.scheme === 'file') {\n    // unc path: file://shares/c$/far/boo\n    value = \"//\" + uri.authority + uri.path;\n  } else if (uri.path.charCodeAt(0) === 47\n  /* Slash */\n  && (uri.path.charCodeAt(1) >= 65\n  /* A */\n  && uri.path.charCodeAt(1) <= 90\n  /* Z */\n  || uri.path.charCodeAt(1) >= 97\n  /* a */\n  && uri.path.charCodeAt(1) <= 122\n  /* z */\n  ) && uri.path.charCodeAt(2) === 58\n  /* Colon */\n  ) {\n      // windows drive letter: file:///c:/far/boo\n      value = uri.path[1].toLowerCase() + uri.path.substr(2);\n    } else {\n    // other path\n    value = uri.path;\n  }\n\n  if (isWindows) {\n    value = value.replace(/\\//g, '\\\\');\n  }\n\n  return value;\n}\n/**\r\n * Create the external version of a uri\r\n */\n\n\nfunction _asFormatted(uri, skipEncoding) {\n  var encoder = !skipEncoding ? encodeURIComponentFast : encodeURIComponentMinimal;\n  var res = '';\n  var scheme = uri.scheme,\n      authority = uri.authority,\n      path = uri.path,\n      query = uri.query,\n      fragment = uri.fragment;\n\n  if (scheme) {\n    res += scheme;\n    res += ':';\n  }\n\n  if (authority || scheme === 'file') {\n    res += _slash;\n    res += _slash;\n  }\n\n  if (authority) {\n    var idx = authority.indexOf('@');\n\n    if (idx !== -1) {\n      // <user>@<auth>\n      var userinfo = authority.substr(0, idx);\n      authority = authority.substr(idx + 1);\n      idx = userinfo.indexOf(':');\n\n      if (idx === -1) {\n        res += encoder(userinfo, false);\n      } else {\n        // <user>:<pass>@<auth>\n        res += encoder(userinfo.substr(0, idx), false);\n        res += ':';\n        res += encoder(userinfo.substr(idx + 1), false);\n      }\n\n      res += '@';\n    }\n\n    authority = authority.toLowerCase();\n    idx = authority.indexOf(':');\n\n    if (idx === -1) {\n      res += encoder(authority, false);\n    } else {\n      // <auth>:<port>\n      res += encoder(authority.substr(0, idx), false);\n      res += authority.substr(idx);\n    }\n  }\n\n  if (path) {\n    // lower-case windows drive letters in /C:/fff or C:/fff\n    if (path.length >= 3 && path.charCodeAt(0) === 47\n    /* Slash */\n    && path.charCodeAt(2) === 58\n    /* Colon */\n    ) {\n        var code = path.charCodeAt(1);\n\n        if (code >= 65\n        /* A */\n        && code <= 90\n        /* Z */\n        ) {\n            path = \"/\" + String.fromCharCode(code + 32) + \":\" + path.substr(3); // \"/c:\".length === 3\n          }\n      } else if (path.length >= 2 && path.charCodeAt(1) === 58\n    /* Colon */\n    ) {\n        var code = path.charCodeAt(0);\n\n        if (code >= 65\n        /* A */\n        && code <= 90\n        /* Z */\n        ) {\n            path = String.fromCharCode(code + 32) + \":\" + path.substr(2); // \"/c:\".length === 3\n          }\n      } // encode the rest of the path\n\n\n    res += encoder(path, true);\n  }\n\n  if (query) {\n    res += '?';\n    res += encoder(query, false);\n  }\n\n  if (fragment) {\n    res += '#';\n    res += !skipEncoding ? encodeURIComponentFast(fragment, false) : fragment;\n  }\n\n  return res;\n} // --- decode\n\n\nfunction decodeURIComponentGraceful(str) {\n  try {\n    return decodeURIComponent(str);\n  } catch (_a) {\n    if (str.length > 3) {\n      return str.substr(0, 3) + decodeURIComponentGraceful(str.substr(3));\n    } else {\n      return str;\n    }\n  }\n}\n\nvar _rEncodedAsHex = /(%[0-9A-Za-z][0-9A-Za-z])+/g;\n\nfunction percentDecode(str) {\n  if (!str.match(_rEncodedAsHex)) {\n    return str;\n  }\n\n  return str.replace(_rEncodedAsHex, function (match) {\n    return decodeURIComponentGraceful(match);\n  });\n}","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/base/common/uri.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","_a","isWindows","_schemePattern","_singleSlashStart","_doubleSlashStart","_validateUri","ret","_strict","scheme","Error","authority","path","query","fragment","test","_schemeFix","_referenceResolution","_slash","_empty","_regexp","URI","schemeOrData","isUri","thing","fsPath","with","toString","defineProperty","get","_makeFsPath","enumerable","configurable","change","undefined","_URI","parse","value","match","exec","percentDecode","file","replace","idx","indexOf","substring","from","components","skipEncoding","_asFormatted","toJSON","revive","data","result","_formatted","external","_fsPath","_sep","_pathSepMarker","_super","_this","apply","arguments","res","$mid","encodeTable","encodeURIComponentFast","uriComponent","allowSlash","nativeEncodePos","pos","length","code","charCodeAt","encodeURIComponent","charAt","substr","escaped","encodeURIComponentMinimal","uri","toLowerCase","encoder","userinfo","String","fromCharCode","decodeURIComponentGraceful","str","decodeURIComponent","_rEncodedAsHex"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar _a;\r\nimport { isWindows } from './platform.js';\r\nvar _schemePattern = /^\\w[\\w\\d+.-]*$/;\r\nvar _singleSlashStart = /^\\//;\r\nvar _doubleSlashStart = /^\\/\\//;\r\nfunction _validateUri(ret, _strict) {\r\n    // scheme, must be set\r\n    if (!ret.scheme && _strict) {\r\n        throw new Error(\"[UriError]: Scheme is missing: {scheme: \\\"\\\", authority: \\\"\" + ret.authority + \"\\\", path: \\\"\" + ret.path + \"\\\", query: \\\"\" + ret.query + \"\\\", fragment: \\\"\" + ret.fragment + \"\\\"}\");\r\n    }\r\n    // scheme, https://tools.ietf.org/html/rfc3986#section-3.1\r\n    // ALPHA *( ALPHA / DIGIT / \"+\" / \"-\" / \".\" )\r\n    if (ret.scheme && !_schemePattern.test(ret.scheme)) {\r\n        throw new Error('[UriError]: Scheme contains illegal characters.');\r\n    }\r\n    // path, http://tools.ietf.org/html/rfc3986#section-3.3\r\n    // If a URI contains an authority component, then the path component\r\n    // must either be empty or begin with a slash (\"/\") character.  If a URI\r\n    // does not contain an authority component, then the path cannot begin\r\n    // with two slash characters (\"//\").\r\n    if (ret.path) {\r\n        if (ret.authority) {\r\n            if (!_singleSlashStart.test(ret.path)) {\r\n                throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash (\"/\") character');\r\n            }\r\n        }\r\n        else {\r\n            if (_doubleSlashStart.test(ret.path)) {\r\n                throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters (\"//\")');\r\n            }\r\n        }\r\n    }\r\n}\r\n// for a while we allowed uris *without* schemes and this is the migration\r\n// for them, e.g. an uri without scheme and without strict-mode warns and falls\r\n// back to the file-scheme. that should cause the least carnage and still be a\r\n// clear warning\r\nfunction _schemeFix(scheme, _strict) {\r\n    if (!scheme && !_strict) {\r\n        return 'file';\r\n    }\r\n    return scheme;\r\n}\r\n// implements a bit of https://tools.ietf.org/html/rfc3986#section-5\r\nfunction _referenceResolution(scheme, path) {\r\n    // the slash-character is our 'default base' as we don't\r\n    // support constructing URIs relative to other URIs. This\r\n    // also means that we alter and potentially break paths.\r\n    // see https://tools.ietf.org/html/rfc3986#section-5.1.4\r\n    switch (scheme) {\r\n        case 'https':\r\n        case 'http':\r\n        case 'file':\r\n            if (!path) {\r\n                path = _slash;\r\n            }\r\n            else if (path[0] !== _slash) {\r\n                path = _slash + path;\r\n            }\r\n            break;\r\n    }\r\n    return path;\r\n}\r\nvar _empty = '';\r\nvar _slash = '/';\r\nvar _regexp = /^(([^:/?#]+?):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?/;\r\n/**\r\n * Uniform Resource Identifier (URI) http://tools.ietf.org/html/rfc3986.\r\n * This class is a simple parser which creates the basic component parts\r\n * (http://tools.ietf.org/html/rfc3986#section-3) with minimal validation\r\n * and encoding.\r\n *\r\n *       foo://example.com:8042/over/there?name=ferret#nose\r\n *       \\_/   \\______________/\\_________/ \\_________/ \\__/\r\n *        |           |            |            |        |\r\n *     scheme     authority       path        query   fragment\r\n *        |   _____________________|__\r\n *       / \\ /                        \\\r\n *       urn:example:animal:ferret:nose\r\n */\r\nvar URI = /** @class */ (function () {\r\n    /**\r\n     * @internal\r\n     */\r\n    function URI(schemeOrData, authority, path, query, fragment, _strict) {\r\n        if (_strict === void 0) { _strict = false; }\r\n        if (typeof schemeOrData === 'object') {\r\n            this.scheme = schemeOrData.scheme || _empty;\r\n            this.authority = schemeOrData.authority || _empty;\r\n            this.path = schemeOrData.path || _empty;\r\n            this.query = schemeOrData.query || _empty;\r\n            this.fragment = schemeOrData.fragment || _empty;\r\n            // no validation because it's this URI\r\n            // that creates uri components.\r\n            // _validateUri(this);\r\n        }\r\n        else {\r\n            this.scheme = _schemeFix(schemeOrData, _strict);\r\n            this.authority = authority || _empty;\r\n            this.path = _referenceResolution(this.scheme, path || _empty);\r\n            this.query = query || _empty;\r\n            this.fragment = fragment || _empty;\r\n            _validateUri(this, _strict);\r\n        }\r\n    }\r\n    URI.isUri = function (thing) {\r\n        if (thing instanceof URI) {\r\n            return true;\r\n        }\r\n        if (!thing) {\r\n            return false;\r\n        }\r\n        return typeof thing.authority === 'string'\r\n            && typeof thing.fragment === 'string'\r\n            && typeof thing.path === 'string'\r\n            && typeof thing.query === 'string'\r\n            && typeof thing.scheme === 'string'\r\n            && typeof thing.fsPath === 'function'\r\n            && typeof thing.with === 'function'\r\n            && typeof thing.toString === 'function';\r\n    };\r\n    Object.defineProperty(URI.prototype, \"fsPath\", {\r\n        // ---- filesystem path -----------------------\r\n        /**\r\n         * Returns a string representing the corresponding file system path of this URI.\r\n         * Will handle UNC paths, normalizes windows drive letters to lower-case, and uses the\r\n         * platform specific path separator.\r\n         *\r\n         * * Will *not* validate the path for invalid characters and semantics.\r\n         * * Will *not* look at the scheme of this URI.\r\n         * * The result shall *not* be used for display purposes but for accessing a file on disk.\r\n         *\r\n         *\r\n         * The *difference* to `URI#path` is the use of the platform specific separator and the handling\r\n         * of UNC paths. See the below sample of a file-uri with an authority (UNC path).\r\n         *\r\n         * ```ts\r\n            const u = URI.parse('file://server/c$/folder/file.txt')\r\n            u.authority === 'server'\r\n            u.path === '/shares/c$/file.txt'\r\n            u.fsPath === '\\\\server\\c$\\folder\\file.txt'\r\n        ```\r\n         *\r\n         * Using `URI#path` to read a file (using fs-apis) would not be enough because parts of the path,\r\n         * namely the server name, would be missing. Therefore `URI#fsPath` exists - it's sugar to ease working\r\n         * with URIs that represent files on disk (`file` scheme).\r\n         */\r\n        get: function () {\r\n            // if (this.scheme !== 'file') {\r\n            // \tconsole.warn(`[UriError] calling fsPath with scheme ${this.scheme}`);\r\n            // }\r\n            return _makeFsPath(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // ---- modify to new -------------------------\r\n    URI.prototype.with = function (change) {\r\n        if (!change) {\r\n            return this;\r\n        }\r\n        var scheme = change.scheme, authority = change.authority, path = change.path, query = change.query, fragment = change.fragment;\r\n        if (scheme === undefined) {\r\n            scheme = this.scheme;\r\n        }\r\n        else if (scheme === null) {\r\n            scheme = _empty;\r\n        }\r\n        if (authority === undefined) {\r\n            authority = this.authority;\r\n        }\r\n        else if (authority === null) {\r\n            authority = _empty;\r\n        }\r\n        if (path === undefined) {\r\n            path = this.path;\r\n        }\r\n        else if (path === null) {\r\n            path = _empty;\r\n        }\r\n        if (query === undefined) {\r\n            query = this.query;\r\n        }\r\n        else if (query === null) {\r\n            query = _empty;\r\n        }\r\n        if (fragment === undefined) {\r\n            fragment = this.fragment;\r\n        }\r\n        else if (fragment === null) {\r\n            fragment = _empty;\r\n        }\r\n        if (scheme === this.scheme\r\n            && authority === this.authority\r\n            && path === this.path\r\n            && query === this.query\r\n            && fragment === this.fragment) {\r\n            return this;\r\n        }\r\n        return new _URI(scheme, authority, path, query, fragment);\r\n    };\r\n    // ---- parse & validate ------------------------\r\n    /**\r\n     * Creates a new URI from a string, e.g. `http://www.msft.com/some/path`,\r\n     * `file:///usr/home`, or `scheme:with/path`.\r\n     *\r\n     * @param value A string which represents an URI (see `URI#toString`).\r\n     */\r\n    URI.parse = function (value, _strict) {\r\n        if (_strict === void 0) { _strict = false; }\r\n        var match = _regexp.exec(value);\r\n        if (!match) {\r\n            return new _URI(_empty, _empty, _empty, _empty, _empty);\r\n        }\r\n        return new _URI(match[2] || _empty, percentDecode(match[4] || _empty), percentDecode(match[5] || _empty), percentDecode(match[7] || _empty), percentDecode(match[9] || _empty), _strict);\r\n    };\r\n    /**\r\n     * Creates a new URI from a file system path, e.g. `c:\\my\\files`,\r\n     * `/usr/home`, or `\\\\server\\share\\some\\path`.\r\n     *\r\n     * The *difference* between `URI#parse` and `URI#file` is that the latter treats the argument\r\n     * as path, not as stringified-uri. E.g. `URI.file(path)` is **not the same as**\r\n     * `URI.parse('file://' + path)` because the path might contain characters that are\r\n     * interpreted (# and ?). See the following sample:\r\n     * ```ts\r\n    const good = URI.file('/coding/c#/project1');\r\n    good.scheme === 'file';\r\n    good.path === '/coding/c#/project1';\r\n    good.fragment === '';\r\n    const bad = URI.parse('file://' + '/coding/c#/project1');\r\n    bad.scheme === 'file';\r\n    bad.path === '/coding/c'; // path is now broken\r\n    bad.fragment === '/project1';\r\n    ```\r\n     *\r\n     * @param path A file system path (see `URI#fsPath`)\r\n     */\r\n    URI.file = function (path) {\r\n        var authority = _empty;\r\n        // normalize to fwd-slashes on windows,\r\n        // on other systems bwd-slashes are valid\r\n        // filename character, eg /f\\oo/ba\\r.txt\r\n        if (isWindows) {\r\n            path = path.replace(/\\\\/g, _slash);\r\n        }\r\n        // check for authority as used in UNC shares\r\n        // or use the path as given\r\n        if (path[0] === _slash && path[1] === _slash) {\r\n            var idx = path.indexOf(_slash, 2);\r\n            if (idx === -1) {\r\n                authority = path.substring(2);\r\n                path = _slash;\r\n            }\r\n            else {\r\n                authority = path.substring(2, idx);\r\n                path = path.substring(idx) || _slash;\r\n            }\r\n        }\r\n        return new _URI('file', authority, path, _empty, _empty);\r\n    };\r\n    URI.from = function (components) {\r\n        return new _URI(components.scheme, components.authority, components.path, components.query, components.fragment);\r\n    };\r\n    // ---- printing/externalize ---------------------------\r\n    /**\r\n     * Creates a string representation for this URI. It's guaranteed that calling\r\n     * `URI.parse` with the result of this function creates an URI which is equal\r\n     * to this URI.\r\n     *\r\n     * * The result shall *not* be used for display purposes but for externalization or transport.\r\n     * * The result will be encoded using the percentage encoding and encoding happens mostly\r\n     * ignore the scheme-specific encoding rules.\r\n     *\r\n     * @param skipEncoding Do not encode the result, default is `false`\r\n     */\r\n    URI.prototype.toString = function (skipEncoding) {\r\n        if (skipEncoding === void 0) { skipEncoding = false; }\r\n        return _asFormatted(this, skipEncoding);\r\n    };\r\n    URI.prototype.toJSON = function () {\r\n        return this;\r\n    };\r\n    URI.revive = function (data) {\r\n        if (!data) {\r\n            return data;\r\n        }\r\n        else if (data instanceof URI) {\r\n            return data;\r\n        }\r\n        else {\r\n            var result = new _URI(data);\r\n            result._formatted = data.external;\r\n            result._fsPath = data._sep === _pathSepMarker ? data.fsPath : null;\r\n            return result;\r\n        }\r\n    };\r\n    return URI;\r\n}());\r\nexport { URI };\r\nvar _pathSepMarker = isWindows ? 1 : undefined;\r\n// eslint-disable-next-line @typescript-eslint/class-name-casing\r\nvar _URI = /** @class */ (function (_super) {\r\n    __extends(_URI, _super);\r\n    function _URI() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._formatted = null;\r\n        _this._fsPath = null;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(_URI.prototype, \"fsPath\", {\r\n        get: function () {\r\n            if (!this._fsPath) {\r\n                this._fsPath = _makeFsPath(this);\r\n            }\r\n            return this._fsPath;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    _URI.prototype.toString = function (skipEncoding) {\r\n        if (skipEncoding === void 0) { skipEncoding = false; }\r\n        if (!skipEncoding) {\r\n            if (!this._formatted) {\r\n                this._formatted = _asFormatted(this, false);\r\n            }\r\n            return this._formatted;\r\n        }\r\n        else {\r\n            // we don't cache that\r\n            return _asFormatted(this, true);\r\n        }\r\n    };\r\n    _URI.prototype.toJSON = function () {\r\n        var res = {\r\n            $mid: 1\r\n        };\r\n        // cached state\r\n        if (this._fsPath) {\r\n            res.fsPath = this._fsPath;\r\n            res._sep = _pathSepMarker;\r\n        }\r\n        if (this._formatted) {\r\n            res.external = this._formatted;\r\n        }\r\n        // uri components\r\n        if (this.path) {\r\n            res.path = this.path;\r\n        }\r\n        if (this.scheme) {\r\n            res.scheme = this.scheme;\r\n        }\r\n        if (this.authority) {\r\n            res.authority = this.authority;\r\n        }\r\n        if (this.query) {\r\n            res.query = this.query;\r\n        }\r\n        if (this.fragment) {\r\n            res.fragment = this.fragment;\r\n        }\r\n        return res;\r\n    };\r\n    return _URI;\r\n}(URI));\r\n// reserved characters: https://tools.ietf.org/html/rfc3986#section-2.2\r\nvar encodeTable = (_a = {},\r\n    _a[58 /* Colon */] = '%3A',\r\n    _a[47 /* Slash */] = '%2F',\r\n    _a[63 /* QuestionMark */] = '%3F',\r\n    _a[35 /* Hash */] = '%23',\r\n    _a[91 /* OpenSquareBracket */] = '%5B',\r\n    _a[93 /* CloseSquareBracket */] = '%5D',\r\n    _a[64 /* AtSign */] = '%40',\r\n    _a[33 /* ExclamationMark */] = '%21',\r\n    _a[36 /* DollarSign */] = '%24',\r\n    _a[38 /* Ampersand */] = '%26',\r\n    _a[39 /* SingleQuote */] = '%27',\r\n    _a[40 /* OpenParen */] = '%28',\r\n    _a[41 /* CloseParen */] = '%29',\r\n    _a[42 /* Asterisk */] = '%2A',\r\n    _a[43 /* Plus */] = '%2B',\r\n    _a[44 /* Comma */] = '%2C',\r\n    _a[59 /* Semicolon */] = '%3B',\r\n    _a[61 /* Equals */] = '%3D',\r\n    _a[32 /* Space */] = '%20',\r\n    _a);\r\nfunction encodeURIComponentFast(uriComponent, allowSlash) {\r\n    var res = undefined;\r\n    var nativeEncodePos = -1;\r\n    for (var pos = 0; pos < uriComponent.length; pos++) {\r\n        var code = uriComponent.charCodeAt(pos);\r\n        // unreserved characters: https://tools.ietf.org/html/rfc3986#section-2.3\r\n        if ((code >= 97 /* a */ && code <= 122 /* z */)\r\n            || (code >= 65 /* A */ && code <= 90 /* Z */)\r\n            || (code >= 48 /* Digit0 */ && code <= 57 /* Digit9 */)\r\n            || code === 45 /* Dash */\r\n            || code === 46 /* Period */\r\n            || code === 95 /* Underline */\r\n            || code === 126 /* Tilde */\r\n            || (allowSlash && code === 47 /* Slash */)) {\r\n            // check if we are delaying native encode\r\n            if (nativeEncodePos !== -1) {\r\n                res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\r\n                nativeEncodePos = -1;\r\n            }\r\n            // check if we write into a new string (by default we try to return the param)\r\n            if (res !== undefined) {\r\n                res += uriComponent.charAt(pos);\r\n            }\r\n        }\r\n        else {\r\n            // encoding needed, we need to allocate a new string\r\n            if (res === undefined) {\r\n                res = uriComponent.substr(0, pos);\r\n            }\r\n            // check with default table first\r\n            var escaped = encodeTable[code];\r\n            if (escaped !== undefined) {\r\n                // check if we are delaying native encode\r\n                if (nativeEncodePos !== -1) {\r\n                    res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\r\n                    nativeEncodePos = -1;\r\n                }\r\n                // append escaped variant to result\r\n                res += escaped;\r\n            }\r\n            else if (nativeEncodePos === -1) {\r\n                // use native encode only when needed\r\n                nativeEncodePos = pos;\r\n            }\r\n        }\r\n    }\r\n    if (nativeEncodePos !== -1) {\r\n        res += encodeURIComponent(uriComponent.substring(nativeEncodePos));\r\n    }\r\n    return res !== undefined ? res : uriComponent;\r\n}\r\nfunction encodeURIComponentMinimal(path) {\r\n    var res = undefined;\r\n    for (var pos = 0; pos < path.length; pos++) {\r\n        var code = path.charCodeAt(pos);\r\n        if (code === 35 /* Hash */ || code === 63 /* QuestionMark */) {\r\n            if (res === undefined) {\r\n                res = path.substr(0, pos);\r\n            }\r\n            res += encodeTable[code];\r\n        }\r\n        else {\r\n            if (res !== undefined) {\r\n                res += path[pos];\r\n            }\r\n        }\r\n    }\r\n    return res !== undefined ? res : path;\r\n}\r\n/**\r\n * Compute `fsPath` for the given uri\r\n */\r\nfunction _makeFsPath(uri) {\r\n    var value;\r\n    if (uri.authority && uri.path.length > 1 && uri.scheme === 'file') {\r\n        // unc path: file://shares/c$/far/boo\r\n        value = \"//\" + uri.authority + uri.path;\r\n    }\r\n    else if (uri.path.charCodeAt(0) === 47 /* Slash */\r\n        && (uri.path.charCodeAt(1) >= 65 /* A */ && uri.path.charCodeAt(1) <= 90 /* Z */ || uri.path.charCodeAt(1) >= 97 /* a */ && uri.path.charCodeAt(1) <= 122 /* z */)\r\n        && uri.path.charCodeAt(2) === 58 /* Colon */) {\r\n        // windows drive letter: file:///c:/far/boo\r\n        value = uri.path[1].toLowerCase() + uri.path.substr(2);\r\n    }\r\n    else {\r\n        // other path\r\n        value = uri.path;\r\n    }\r\n    if (isWindows) {\r\n        value = value.replace(/\\//g, '\\\\');\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Create the external version of a uri\r\n */\r\nfunction _asFormatted(uri, skipEncoding) {\r\n    var encoder = !skipEncoding\r\n        ? encodeURIComponentFast\r\n        : encodeURIComponentMinimal;\r\n    var res = '';\r\n    var scheme = uri.scheme, authority = uri.authority, path = uri.path, query = uri.query, fragment = uri.fragment;\r\n    if (scheme) {\r\n        res += scheme;\r\n        res += ':';\r\n    }\r\n    if (authority || scheme === 'file') {\r\n        res += _slash;\r\n        res += _slash;\r\n    }\r\n    if (authority) {\r\n        var idx = authority.indexOf('@');\r\n        if (idx !== -1) {\r\n            // <user>@<auth>\r\n            var userinfo = authority.substr(0, idx);\r\n            authority = authority.substr(idx + 1);\r\n            idx = userinfo.indexOf(':');\r\n            if (idx === -1) {\r\n                res += encoder(userinfo, false);\r\n            }\r\n            else {\r\n                // <user>:<pass>@<auth>\r\n                res += encoder(userinfo.substr(0, idx), false);\r\n                res += ':';\r\n                res += encoder(userinfo.substr(idx + 1), false);\r\n            }\r\n            res += '@';\r\n        }\r\n        authority = authority.toLowerCase();\r\n        idx = authority.indexOf(':');\r\n        if (idx === -1) {\r\n            res += encoder(authority, false);\r\n        }\r\n        else {\r\n            // <auth>:<port>\r\n            res += encoder(authority.substr(0, idx), false);\r\n            res += authority.substr(idx);\r\n        }\r\n    }\r\n    if (path) {\r\n        // lower-case windows drive letters in /C:/fff or C:/fff\r\n        if (path.length >= 3 && path.charCodeAt(0) === 47 /* Slash */ && path.charCodeAt(2) === 58 /* Colon */) {\r\n            var code = path.charCodeAt(1);\r\n            if (code >= 65 /* A */ && code <= 90 /* Z */) {\r\n                path = \"/\" + String.fromCharCode(code + 32) + \":\" + path.substr(3); // \"/c:\".length === 3\r\n            }\r\n        }\r\n        else if (path.length >= 2 && path.charCodeAt(1) === 58 /* Colon */) {\r\n            var code = path.charCodeAt(0);\r\n            if (code >= 65 /* A */ && code <= 90 /* Z */) {\r\n                path = String.fromCharCode(code + 32) + \":\" + path.substr(2); // \"/c:\".length === 3\r\n            }\r\n        }\r\n        // encode the rest of the path\r\n        res += encoder(path, true);\r\n    }\r\n    if (query) {\r\n        res += '?';\r\n        res += encoder(query, false);\r\n    }\r\n    if (fragment) {\r\n        res += '#';\r\n        res += !skipEncoding ? encodeURIComponentFast(fragment, false) : fragment;\r\n    }\r\n    return res;\r\n}\r\n// --- decode\r\nfunction decodeURIComponentGraceful(str) {\r\n    try {\r\n        return decodeURIComponent(str);\r\n    }\r\n    catch (_a) {\r\n        if (str.length > 3) {\r\n            return str.substr(0, 3) + decodeURIComponentGraceful(str.substr(3));\r\n        }\r\n        else {\r\n            return str;\r\n        }\r\n    }\r\n}\r\nvar _rEncodedAsHex = /(%[0-9A-Za-z][0-9A-Za-z])+/g;\r\nfunction percentDecode(str) {\r\n    if (!str.match(_rEncodedAsHex)) {\r\n        return str;\r\n    }\r\n    return str.replace(_rEncodedAsHex, function (match) { return decodeURIComponentGraceful(match); });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}