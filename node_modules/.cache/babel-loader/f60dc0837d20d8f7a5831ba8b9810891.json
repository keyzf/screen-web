{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport * as nls from '../../../nls.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\nimport { Range } from '../../common/core/range.js';\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nimport { compare } from '../../../base/common/strings.js';\nimport { binarySearch, find } from '../../../base/common/arrays.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\nimport { Action } from '../../../base/common/actions.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { isEqual } from '../../../base/common/resources.js';\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\n\nvar MarkerModel =\n/** @class */\nfunction () {\n  function MarkerModel(editor, markers) {\n    var _this = this;\n\n    this._toUnbind = new DisposableStore();\n    this._editor = editor;\n    this._markers = [];\n    this._nextIdx = -1;\n    this._ignoreSelectionChange = false;\n    this._onCurrentMarkerChanged = new Emitter();\n    this._onMarkerSetChanged = new Emitter();\n    this.setMarkers(markers); // listen on editor\n\n    this._toUnbind.add(this._editor.onDidDispose(function () {\n      return _this.dispose();\n    }));\n\n    this._toUnbind.add(this._editor.onDidChangeCursorPosition(function () {\n      if (_this._ignoreSelectionChange) {\n        return;\n      }\n\n      if (_this.currentMarker && _this._editor.getPosition() && Range.containsPosition(_this.currentMarker, _this._editor.getPosition())) {\n        return;\n      }\n\n      _this._nextIdx = -1;\n    }));\n  }\n\n  Object.defineProperty(MarkerModel.prototype, \"onCurrentMarkerChanged\", {\n    get: function () {\n      return this._onCurrentMarkerChanged.event;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MarkerModel.prototype, \"onMarkerSetChanged\", {\n    get: function () {\n      return this._onMarkerSetChanged.event;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  MarkerModel.prototype.setMarkers = function (markers) {\n    var oldMarker = this._nextIdx >= 0 ? this._markers[this._nextIdx] : undefined;\n    this._markers = markers || [];\n\n    this._markers.sort(MarkerNavigationAction.compareMarker);\n\n    if (!oldMarker) {\n      this._nextIdx = -1;\n    } else {\n      this._nextIdx = Math.max(-1, binarySearch(this._markers, oldMarker, MarkerNavigationAction.compareMarker));\n    }\n\n    this._onMarkerSetChanged.fire(this);\n  };\n\n  MarkerModel.prototype.withoutWatchingEditorPosition = function (callback) {\n    this._ignoreSelectionChange = true;\n\n    try {\n      callback();\n    } finally {\n      this._ignoreSelectionChange = false;\n    }\n  };\n\n  MarkerModel.prototype._initIdx = function (fwd) {\n    var found = false;\n\n    var position = this._editor.getPosition();\n\n    for (var i = 0; i < this._markers.length; i++) {\n      var range = Range.lift(this._markers[i]);\n\n      if (range.isEmpty() && this._editor.getModel()) {\n        var word = this._editor.getModel().getWordAtPosition(range.getStartPosition());\n\n        if (word) {\n          range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n        }\n      }\n\n      if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n        this._nextIdx = i;\n        found = true;\n        break;\n      }\n    }\n\n    if (!found) {\n      // after the last change\n      this._nextIdx = fwd ? 0 : this._markers.length - 1;\n    }\n\n    if (this._nextIdx < 0) {\n      this._nextIdx = this._markers.length - 1;\n    }\n  };\n\n  Object.defineProperty(MarkerModel.prototype, \"currentMarker\", {\n    get: function () {\n      return this.canNavigate() ? this._markers[this._nextIdx] : undefined;\n    },\n    set: function (marker) {\n      var idx = this._nextIdx;\n      this._nextIdx = -1;\n\n      if (marker) {\n        this._nextIdx = this.indexOf(marker);\n      }\n\n      if (this._nextIdx !== idx) {\n        this._onCurrentMarkerChanged.fire(marker);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  MarkerModel.prototype.move = function (fwd, inCircles) {\n    if (!this.canNavigate()) {\n      this._onCurrentMarkerChanged.fire(undefined);\n\n      return !inCircles;\n    }\n\n    var oldIdx = this._nextIdx;\n    var atEdge = false;\n\n    if (this._nextIdx === -1) {\n      this._initIdx(fwd);\n    } else if (fwd) {\n      if (inCircles || this._nextIdx + 1 < this._markers.length) {\n        this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n      } else {\n        atEdge = true;\n      }\n    } else if (!fwd) {\n      if (inCircles || this._nextIdx > 0) {\n        this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n      } else {\n        atEdge = true;\n      }\n    }\n\n    if (oldIdx !== this._nextIdx) {\n      var marker = this._markers[this._nextIdx];\n\n      this._onCurrentMarkerChanged.fire(marker);\n    }\n\n    return atEdge;\n  };\n\n  MarkerModel.prototype.canNavigate = function () {\n    return this._markers.length > 0;\n  };\n\n  MarkerModel.prototype.findMarkerAtPosition = function (pos) {\n    return find(this._markers, function (marker) {\n      return Range.containsPosition(marker, pos);\n    });\n  };\n\n  Object.defineProperty(MarkerModel.prototype, \"total\", {\n    get: function () {\n      return this._markers.length;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  MarkerModel.prototype.indexOf = function (marker) {\n    return 1 + this._markers.indexOf(marker);\n  };\n\n  MarkerModel.prototype.dispose = function () {\n    this._toUnbind.dispose();\n  };\n\n  return MarkerModel;\n}();\n\nvar MarkerController =\n/** @class */\nfunction () {\n  function MarkerController(editor, _markerService, _contextKeyService, _themeService, _editorService, _keybindingService, _openerService) {\n    this._markerService = _markerService;\n    this._contextKeyService = _contextKeyService;\n    this._themeService = _themeService;\n    this._editorService = _editorService;\n    this._keybindingService = _keybindingService;\n    this._openerService = _openerService;\n    this._model = null;\n    this._widget = null;\n    this._disposeOnClose = new DisposableStore();\n    this._editor = editor;\n    this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n  }\n\n  MarkerController.get = function (editor) {\n    return editor.getContribution(MarkerController.ID);\n  };\n\n  MarkerController.prototype.dispose = function () {\n    this._cleanUp();\n\n    this._disposeOnClose.dispose();\n  };\n\n  MarkerController.prototype._cleanUp = function () {\n    this._widgetVisible.reset();\n\n    this._disposeOnClose.clear();\n\n    this._widget = null;\n    this._model = null;\n  };\n\n  MarkerController.prototype.getOrCreateModel = function () {\n    var _this = this;\n\n    if (this._model) {\n      return this._model;\n    }\n\n    var markers = this._getMarkers();\n\n    this._model = new MarkerModel(this._editor, markers);\n\n    this._markerService.onMarkerChanged(this._onMarkerChanged, this, this._disposeOnClose);\n\n    var prevMarkerKeybinding = this._keybindingService.lookupKeybinding(PrevMarkerAction.ID);\n\n    var nextMarkerKeybinding = this._keybindingService.lookupKeybinding(NextMarkerAction.ID);\n\n    var actions = [new Action(NextMarkerAction.ID, NextMarkerAction.LABEL + (nextMarkerKeybinding ? \" (\" + nextMarkerKeybinding.getLabel() + \")\" : ''), 'show-next-problem codicon-chevron-down', this._model.canNavigate(), function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          if (this._model) {\n            this._model.move(true, true);\n          }\n\n          return [2\n          /*return*/\n          ];\n        });\n      });\n    }), new Action(PrevMarkerAction.ID, PrevMarkerAction.LABEL + (prevMarkerKeybinding ? \" (\" + prevMarkerKeybinding.getLabel() + \")\" : ''), 'show-previous-problem codicon-chevron-up', this._model.canNavigate(), function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          if (this._model) {\n            this._model.move(false, true);\n          }\n\n          return [2\n          /*return*/\n          ];\n        });\n      });\n    })];\n    this._widget = new MarkerNavigationWidget(this._editor, actions, this._themeService, this._openerService);\n\n    this._widgetVisible.set(true);\n\n    this._widget.onDidClose(function () {\n      return _this.closeMarkersNavigation();\n    }, this, this._disposeOnClose);\n\n    this._disposeOnClose.add(this._model);\n\n    this._disposeOnClose.add(this._widget);\n\n    for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\n      var action = actions_1[_i];\n\n      this._disposeOnClose.add(action);\n    }\n\n    this._disposeOnClose.add(this._widget.onDidSelectRelatedInformation(function (related) {\n      _this._editorService.openCodeEditor({\n        resource: related.resource,\n        options: {\n          pinned: true,\n          revealIfOpened: true,\n          selection: Range.lift(related).collapseToStart()\n        }\n      }, _this._editor).then(undefined, onUnexpectedError);\n\n      _this.closeMarkersNavigation(false);\n    }));\n\n    this._disposeOnClose.add(this._editor.onDidChangeModel(function () {\n      return _this._cleanUp();\n    }));\n\n    this._disposeOnClose.add(this._model.onCurrentMarkerChanged(function (marker) {\n      if (!marker || !_this._model) {\n        _this._cleanUp();\n      } else {\n        _this._model.withoutWatchingEditorPosition(function () {\n          if (!_this._widget || !_this._model) {\n            return;\n          }\n\n          _this._widget.showAtMarker(marker, _this._model.indexOf(marker), _this._model.total);\n        });\n      }\n    }));\n\n    this._disposeOnClose.add(this._model.onMarkerSetChanged(function () {\n      if (!_this._widget || !_this._widget.position || !_this._model) {\n        return;\n      }\n\n      var marker = _this._model.findMarkerAtPosition(_this._widget.position);\n\n      if (marker) {\n        _this._widget.updateMarker(marker);\n      } else {\n        _this._widget.showStale();\n      }\n    }));\n\n    return this._model;\n  };\n\n  MarkerController.prototype.closeMarkersNavigation = function (focusEditor) {\n    if (focusEditor === void 0) {\n      focusEditor = true;\n    }\n\n    this._cleanUp();\n\n    if (focusEditor) {\n      this._editor.focus();\n    }\n  };\n\n  MarkerController.prototype.show = function (marker) {\n    var model = this.getOrCreateModel();\n    model.currentMarker = marker;\n  };\n\n  MarkerController.prototype._onMarkerChanged = function (changedResources) {\n    var editorModel = this._editor.getModel();\n\n    if (!editorModel) {\n      return;\n    }\n\n    if (!this._model) {\n      return;\n    }\n\n    if (!changedResources.some(function (r) {\n      return isEqual(editorModel.uri, r);\n    })) {\n      return;\n    }\n\n    this._model.setMarkers(this._getMarkers());\n  };\n\n  MarkerController.prototype._getMarkers = function () {\n    var model = this._editor.getModel();\n\n    if (!model) {\n      return [];\n    }\n\n    return this._markerService.read({\n      resource: model.uri,\n      severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n    });\n  };\n\n  MarkerController.ID = 'editor.contrib.markerController';\n  MarkerController = __decorate([__param(1, IMarkerService), __param(2, IContextKeyService), __param(3, IThemeService), __param(4, ICodeEditorService), __param(5, IKeybindingService), __param(6, IOpenerService)], MarkerController);\n  return MarkerController;\n}();\n\nexport { MarkerController };\n\nvar MarkerNavigationAction =\n/** @class */\nfunction (_super) {\n  __extends(MarkerNavigationAction, _super);\n\n  function MarkerNavigationAction(next, multiFile, opts) {\n    var _this = _super.call(this, opts) || this;\n\n    _this._isNext = next;\n    _this._multiFile = multiFile;\n    return _this;\n  }\n\n  MarkerNavigationAction.prototype.run = function (accessor, editor) {\n    var _this = this;\n\n    var markerService = accessor.get(IMarkerService);\n    var editorService = accessor.get(ICodeEditorService);\n    var controller = MarkerController.get(editor);\n\n    if (!controller) {\n      return Promise.resolve(undefined);\n    }\n\n    var model = controller.getOrCreateModel();\n    var atEdge = model.move(this._isNext, !this._multiFile);\n\n    if (!atEdge || !this._multiFile) {\n      return Promise.resolve(undefined);\n    } // try with the next/prev file\n\n\n    var markers = markerService.read({\n      severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n    }).sort(MarkerNavigationAction.compareMarker);\n\n    if (markers.length === 0) {\n      return Promise.resolve(undefined);\n    }\n\n    var editorModel = editor.getModel();\n\n    if (!editorModel) {\n      return Promise.resolve(undefined);\n    }\n\n    var oldMarker = model.currentMarker || {\n      resource: editorModel.uri,\n      severity: MarkerSeverity.Error,\n      startLineNumber: 1,\n      startColumn: 1,\n      endLineNumber: 1,\n      endColumn: 1\n    };\n    var idx = binarySearch(markers, oldMarker, MarkerNavigationAction.compareMarker);\n\n    if (idx < 0) {\n      // find best match...\n      idx = ~idx;\n      idx %= markers.length;\n    } else if (this._isNext) {\n      idx = (idx + 1) % markers.length;\n    } else {\n      idx = (idx + markers.length - 1) % markers.length;\n    }\n\n    var newMarker = markers[idx];\n\n    if (isEqual(newMarker.resource, editorModel.uri)) {\n      // the next `resource` is this resource which\n      // means we cycle within this file\n      model.move(this._isNext, true);\n      return Promise.resolve(undefined);\n    } // close the widget for this editor-instance, open the resource\n    // for the next marker and re-start marker navigation in there\n\n\n    controller.closeMarkersNavigation();\n    return editorService.openCodeEditor({\n      resource: newMarker.resource,\n      options: {\n        pinned: false,\n        revealIfOpened: true,\n        revealInCenterIfOutsideViewport: true,\n        selection: newMarker\n      }\n    }, editor).then(function (editor) {\n      if (!editor) {\n        return undefined;\n      }\n\n      return editor.getAction(_this.id).run();\n    });\n  };\n\n  MarkerNavigationAction.compareMarker = function (a, b) {\n    var res = compare(a.resource.toString(), b.resource.toString());\n\n    if (res === 0) {\n      res = MarkerSeverity.compare(a.severity, b.severity);\n    }\n\n    if (res === 0) {\n      res = Range.compareRangesUsingStarts(a, b);\n    }\n\n    return res;\n  };\n\n  return MarkerNavigationAction;\n}(EditorAction);\n\nvar NextMarkerAction =\n/** @class */\nfunction (_super) {\n  __extends(NextMarkerAction, _super);\n\n  function NextMarkerAction() {\n    return _super.call(this, true, false, {\n      id: NextMarkerAction.ID,\n      label: NextMarkerAction.LABEL,\n      alias: 'Go to Next Problem (Error, Warning, Info)',\n      precondition: EditorContextKeys.writable,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 512\n        /* Alt */\n        | 66\n        /* F8 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  NextMarkerAction.ID = 'editor.action.marker.next';\n  NextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\n  return NextMarkerAction;\n}(MarkerNavigationAction);\n\nexport { NextMarkerAction };\n\nvar PrevMarkerAction =\n/** @class */\nfunction (_super) {\n  __extends(PrevMarkerAction, _super);\n\n  function PrevMarkerAction() {\n    return _super.call(this, false, false, {\n      id: PrevMarkerAction.ID,\n      label: PrevMarkerAction.LABEL,\n      alias: 'Go to Previous Problem (Error, Warning, Info)',\n      precondition: EditorContextKeys.writable,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 1024\n        /* Shift */\n        | 512\n        /* Alt */\n        | 66\n        /* F8 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  PrevMarkerAction.ID = 'editor.action.marker.prev';\n  PrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\n  return PrevMarkerAction;\n}(MarkerNavigationAction);\n\nvar NextMarkerInFilesAction =\n/** @class */\nfunction (_super) {\n  __extends(NextMarkerInFilesAction, _super);\n\n  function NextMarkerInFilesAction() {\n    return _super.call(this, true, true, {\n      id: 'editor.action.marker.nextInFiles',\n      label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n      alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n      precondition: EditorContextKeys.writable,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 66\n        /* F8 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  return NextMarkerInFilesAction;\n}(MarkerNavigationAction);\n\nvar PrevMarkerInFilesAction =\n/** @class */\nfunction (_super) {\n  __extends(PrevMarkerInFilesAction, _super);\n\n  function PrevMarkerInFilesAction() {\n    return _super.call(this, false, true, {\n      id: 'editor.action.marker.prevInFiles',\n      label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n      alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n      precondition: EditorContextKeys.writable,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 1024\n        /* Shift */\n        | 66\n        /* F8 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  return PrevMarkerInFilesAction;\n}(MarkerNavigationAction);\n\nregisterEditorContribution(MarkerController.ID, MarkerController);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nvar CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nvar MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n  id: 'closeMarkersNavigation',\n  precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n  handler: function (x) {\n    return x.closeMarkersNavigation();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 50,\n    kbExpr: EditorContextKeys.focus,\n    primary: 9\n    /* Escape */\n    ,\n    secondary: [1024\n    /* Shift */\n    | 9\n    /* Escape */\n    ]\n  }\n})); // Go to menu\n\nMenuRegistry.appendMenuItem(19\n/* MenubarGoMenu */\n, {\n  group: '6_problem_nav',\n  command: {\n    id: 'editor.action.marker.nextInFiles',\n    title: nls.localize({\n      key: 'miGotoNextProblem',\n      comment: ['&& denotes a mnemonic']\n    }, \"Next &&Problem\")\n  },\n  order: 1\n});\nMenuRegistry.appendMenuItem(19\n/* MenubarGoMenu */\n, {\n  group: '6_problem_nav',\n  command: {\n    id: 'editor.action.marker.prevInFiles',\n    title: nls.localize({\n      key: 'miGotoPreviousProblem',\n      comment: ['&& denotes a mnemonic']\n    }, \"Previous &&Problem\")\n  },\n  order: 2\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoError.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","push","nls","Emitter","DisposableStore","RawContextKey","IContextKeyService","IMarkerService","MarkerSeverity","Range","registerEditorAction","registerEditorContribution","EditorAction","EditorCommand","registerEditorCommand","IThemeService","EditorContextKeys","MarkerNavigationWidget","compare","binarySearch","find","ICodeEditorService","onUnexpectedError","MenuRegistry","Action","IKeybindingService","isEqual","IOpenerService","MarkerModel","editor","markers","_this","_toUnbind","_editor","_markers","_nextIdx","_ignoreSelectionChange","_onCurrentMarkerChanged","_onMarkerSetChanged","setMarkers","add","onDidDispose","dispose","onDidChangeCursorPosition","currentMarker","getPosition","containsPosition","get","event","enumerable","configurable","oldMarker","undefined","sort","MarkerNavigationAction","compareMarker","Math","max","fire","withoutWatchingEditorPosition","callback","_initIdx","fwd","found","position","range","lift","isEmpty","getModel","word","getWordAtPosition","getStartPosition","startLineNumber","startColumn","endColumn","isBeforeOrEqual","canNavigate","set","marker","idx","indexOf","move","inCircles","oldIdx","atEdge","findMarkerAtPosition","pos","MarkerController","_markerService","_contextKeyService","_themeService","_editorService","_keybindingService","_openerService","_model","_widget","_disposeOnClose","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","bindTo","getContribution","ID","_cleanUp","reset","clear","getOrCreateModel","_getMarkers","onMarkerChanged","_onMarkerChanged","prevMarkerKeybinding","lookupKeybinding","PrevMarkerAction","nextMarkerKeybinding","NextMarkerAction","actions","LABEL","getLabel","_a","onDidClose","closeMarkersNavigation","_i","actions_1","action","onDidSelectRelatedInformation","related","openCodeEditor","resource","options","pinned","revealIfOpened","selection","collapseToStart","onDidChangeModel","onCurrentMarkerChanged","showAtMarker","total","onMarkerSetChanged","updateMarker","showStale","focusEditor","focus","show","model","changedResources","editorModel","some","uri","read","severities","Error","Warning","Info","_super","multiFile","opts","_isNext","_multiFile","run","accessor","markerService","editorService","controller","severity","endLineNumber","newMarker","revealInCenterIfOutsideViewport","getAction","id","a","res","toString","compareRangesUsingStarts","alias","precondition","writable","kbOpts","kbExpr","primary","weight","localize","NextMarkerInFilesAction","PrevMarkerInFilesAction","MarkerCommand","bindToContribution","handler","x","secondary","appendMenuItem","group","command","title","comment","order"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\r\nimport { compare } from '../../../base/common/strings.js';\r\nimport { binarySearch, find } from '../../../base/common/arrays.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nvar MarkerModel = /** @class */ (function () {\r\n    function MarkerModel(editor, markers) {\r\n        var _this = this;\r\n        this._toUnbind = new DisposableStore();\r\n        this._editor = editor;\r\n        this._markers = [];\r\n        this._nextIdx = -1;\r\n        this._ignoreSelectionChange = false;\r\n        this._onCurrentMarkerChanged = new Emitter();\r\n        this._onMarkerSetChanged = new Emitter();\r\n        this.setMarkers(markers);\r\n        // listen on editor\r\n        this._toUnbind.add(this._editor.onDidDispose(function () { return _this.dispose(); }));\r\n        this._toUnbind.add(this._editor.onDidChangeCursorPosition(function () {\r\n            if (_this._ignoreSelectionChange) {\r\n                return;\r\n            }\r\n            if (_this.currentMarker && _this._editor.getPosition() && Range.containsPosition(_this.currentMarker, _this._editor.getPosition())) {\r\n                return;\r\n            }\r\n            _this._nextIdx = -1;\r\n        }));\r\n    }\r\n    Object.defineProperty(MarkerModel.prototype, \"onCurrentMarkerChanged\", {\r\n        get: function () {\r\n            return this._onCurrentMarkerChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MarkerModel.prototype, \"onMarkerSetChanged\", {\r\n        get: function () {\r\n            return this._onMarkerSetChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.setMarkers = function (markers) {\r\n        var oldMarker = this._nextIdx >= 0 ? this._markers[this._nextIdx] : undefined;\r\n        this._markers = markers || [];\r\n        this._markers.sort(MarkerNavigationAction.compareMarker);\r\n        if (!oldMarker) {\r\n            this._nextIdx = -1;\r\n        }\r\n        else {\r\n            this._nextIdx = Math.max(-1, binarySearch(this._markers, oldMarker, MarkerNavigationAction.compareMarker));\r\n        }\r\n        this._onMarkerSetChanged.fire(this);\r\n    };\r\n    MarkerModel.prototype.withoutWatchingEditorPosition = function (callback) {\r\n        this._ignoreSelectionChange = true;\r\n        try {\r\n            callback();\r\n        }\r\n        finally {\r\n            this._ignoreSelectionChange = false;\r\n        }\r\n    };\r\n    MarkerModel.prototype._initIdx = function (fwd) {\r\n        var found = false;\r\n        var position = this._editor.getPosition();\r\n        for (var i = 0; i < this._markers.length; i++) {\r\n            var range = Range.lift(this._markers[i]);\r\n            if (range.isEmpty() && this._editor.getModel()) {\r\n                var word = this._editor.getModel().getWordAtPosition(range.getStartPosition());\r\n                if (word) {\r\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\r\n                }\r\n            }\r\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\r\n                this._nextIdx = i;\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!found) {\r\n            // after the last change\r\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\r\n        }\r\n        if (this._nextIdx < 0) {\r\n            this._nextIdx = this._markers.length - 1;\r\n        }\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"currentMarker\", {\r\n        get: function () {\r\n            return this.canNavigate() ? this._markers[this._nextIdx] : undefined;\r\n        },\r\n        set: function (marker) {\r\n            var idx = this._nextIdx;\r\n            this._nextIdx = -1;\r\n            if (marker) {\r\n                this._nextIdx = this.indexOf(marker);\r\n            }\r\n            if (this._nextIdx !== idx) {\r\n                this._onCurrentMarkerChanged.fire(marker);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.move = function (fwd, inCircles) {\r\n        if (!this.canNavigate()) {\r\n            this._onCurrentMarkerChanged.fire(undefined);\r\n            return !inCircles;\r\n        }\r\n        var oldIdx = this._nextIdx;\r\n        var atEdge = false;\r\n        if (this._nextIdx === -1) {\r\n            this._initIdx(fwd);\r\n        }\r\n        else if (fwd) {\r\n            if (inCircles || this._nextIdx + 1 < this._markers.length) {\r\n                this._nextIdx = (this._nextIdx + 1) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        else if (!fwd) {\r\n            if (inCircles || this._nextIdx > 0) {\r\n                this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        if (oldIdx !== this._nextIdx) {\r\n            var marker = this._markers[this._nextIdx];\r\n            this._onCurrentMarkerChanged.fire(marker);\r\n        }\r\n        return atEdge;\r\n    };\r\n    MarkerModel.prototype.canNavigate = function () {\r\n        return this._markers.length > 0;\r\n    };\r\n    MarkerModel.prototype.findMarkerAtPosition = function (pos) {\r\n        return find(this._markers, function (marker) { return Range.containsPosition(marker, pos); });\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"total\", {\r\n        get: function () {\r\n            return this._markers.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.indexOf = function (marker) {\r\n        return 1 + this._markers.indexOf(marker);\r\n    };\r\n    MarkerModel.prototype.dispose = function () {\r\n        this._toUnbind.dispose();\r\n    };\r\n    return MarkerModel;\r\n}());\r\nvar MarkerController = /** @class */ (function () {\r\n    function MarkerController(editor, _markerService, _contextKeyService, _themeService, _editorService, _keybindingService, _openerService) {\r\n        this._markerService = _markerService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._themeService = _themeService;\r\n        this._editorService = _editorService;\r\n        this._keybindingService = _keybindingService;\r\n        this._openerService = _openerService;\r\n        this._model = null;\r\n        this._widget = null;\r\n        this._disposeOnClose = new DisposableStore();\r\n        this._editor = editor;\r\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\r\n    }\r\n    MarkerController.get = function (editor) {\r\n        return editor.getContribution(MarkerController.ID);\r\n    };\r\n    MarkerController.prototype.dispose = function () {\r\n        this._cleanUp();\r\n        this._disposeOnClose.dispose();\r\n    };\r\n    MarkerController.prototype._cleanUp = function () {\r\n        this._widgetVisible.reset();\r\n        this._disposeOnClose.clear();\r\n        this._widget = null;\r\n        this._model = null;\r\n    };\r\n    MarkerController.prototype.getOrCreateModel = function () {\r\n        var _this = this;\r\n        if (this._model) {\r\n            return this._model;\r\n        }\r\n        var markers = this._getMarkers();\r\n        this._model = new MarkerModel(this._editor, markers);\r\n        this._markerService.onMarkerChanged(this._onMarkerChanged, this, this._disposeOnClose);\r\n        var prevMarkerKeybinding = this._keybindingService.lookupKeybinding(PrevMarkerAction.ID);\r\n        var nextMarkerKeybinding = this._keybindingService.lookupKeybinding(NextMarkerAction.ID);\r\n        var actions = [\r\n            new Action(NextMarkerAction.ID, NextMarkerAction.LABEL + (nextMarkerKeybinding ? \" (\" + nextMarkerKeybinding.getLabel() + \")\" : ''), 'show-next-problem codicon-chevron-down', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(true, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); }),\r\n            new Action(PrevMarkerAction.ID, PrevMarkerAction.LABEL + (prevMarkerKeybinding ? \" (\" + prevMarkerKeybinding.getLabel() + \")\" : ''), 'show-previous-problem codicon-chevron-up', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(false, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); })\r\n        ];\r\n        this._widget = new MarkerNavigationWidget(this._editor, actions, this._themeService, this._openerService);\r\n        this._widgetVisible.set(true);\r\n        this._widget.onDidClose(function () { return _this.closeMarkersNavigation(); }, this, this._disposeOnClose);\r\n        this._disposeOnClose.add(this._model);\r\n        this._disposeOnClose.add(this._widget);\r\n        for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\r\n            var action = actions_1[_i];\r\n            this._disposeOnClose.add(action);\r\n        }\r\n        this._disposeOnClose.add(this._widget.onDidSelectRelatedInformation(function (related) {\r\n            _this._editorService.openCodeEditor({\r\n                resource: related.resource,\r\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\r\n            }, _this._editor).then(undefined, onUnexpectedError);\r\n            _this.closeMarkersNavigation(false);\r\n        }));\r\n        this._disposeOnClose.add(this._editor.onDidChangeModel(function () { return _this._cleanUp(); }));\r\n        this._disposeOnClose.add(this._model.onCurrentMarkerChanged(function (marker) {\r\n            if (!marker || !_this._model) {\r\n                _this._cleanUp();\r\n            }\r\n            else {\r\n                _this._model.withoutWatchingEditorPosition(function () {\r\n                    if (!_this._widget || !_this._model) {\r\n                        return;\r\n                    }\r\n                    _this._widget.showAtMarker(marker, _this._model.indexOf(marker), _this._model.total);\r\n                });\r\n            }\r\n        }));\r\n        this._disposeOnClose.add(this._model.onMarkerSetChanged(function () {\r\n            if (!_this._widget || !_this._widget.position || !_this._model) {\r\n                return;\r\n            }\r\n            var marker = _this._model.findMarkerAtPosition(_this._widget.position);\r\n            if (marker) {\r\n                _this._widget.updateMarker(marker);\r\n            }\r\n            else {\r\n                _this._widget.showStale();\r\n            }\r\n        }));\r\n        return this._model;\r\n    };\r\n    MarkerController.prototype.closeMarkersNavigation = function (focusEditor) {\r\n        if (focusEditor === void 0) { focusEditor = true; }\r\n        this._cleanUp();\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n    };\r\n    MarkerController.prototype.show = function (marker) {\r\n        var model = this.getOrCreateModel();\r\n        model.currentMarker = marker;\r\n    };\r\n    MarkerController.prototype._onMarkerChanged = function (changedResources) {\r\n        var editorModel = this._editor.getModel();\r\n        if (!editorModel) {\r\n            return;\r\n        }\r\n        if (!this._model) {\r\n            return;\r\n        }\r\n        if (!changedResources.some(function (r) { return isEqual(editorModel.uri, r); })) {\r\n            return;\r\n        }\r\n        this._model.setMarkers(this._getMarkers());\r\n    };\r\n    MarkerController.prototype._getMarkers = function () {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return [];\r\n        }\r\n        return this._markerService.read({\r\n            resource: model.uri,\r\n            severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\r\n        });\r\n    };\r\n    MarkerController.ID = 'editor.contrib.markerController';\r\n    MarkerController = __decorate([\r\n        __param(1, IMarkerService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IThemeService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, IKeybindingService),\r\n        __param(6, IOpenerService)\r\n    ], MarkerController);\r\n    return MarkerController;\r\n}());\r\nexport { MarkerController };\r\nvar MarkerNavigationAction = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationAction, _super);\r\n    function MarkerNavigationAction(next, multiFile, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._isNext = next;\r\n        _this._multiFile = multiFile;\r\n        return _this;\r\n    }\r\n    MarkerNavigationAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        var markerService = accessor.get(IMarkerService);\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var controller = MarkerController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var model = controller.getOrCreateModel();\r\n        var atEdge = model.move(this._isNext, !this._multiFile);\r\n        if (!atEdge || !this._multiFile) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // try with the next/prev file\r\n        var markers = markerService.read({ severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info }).sort(MarkerNavigationAction.compareMarker);\r\n        if (markers.length === 0) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var editorModel = editor.getModel();\r\n        if (!editorModel) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var oldMarker = model.currentMarker || { resource: editorModel.uri, severity: MarkerSeverity.Error, startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 };\r\n        var idx = binarySearch(markers, oldMarker, MarkerNavigationAction.compareMarker);\r\n        if (idx < 0) {\r\n            // find best match...\r\n            idx = ~idx;\r\n            idx %= markers.length;\r\n        }\r\n        else if (this._isNext) {\r\n            idx = (idx + 1) % markers.length;\r\n        }\r\n        else {\r\n            idx = (idx + markers.length - 1) % markers.length;\r\n        }\r\n        var newMarker = markers[idx];\r\n        if (isEqual(newMarker.resource, editorModel.uri)) {\r\n            // the next `resource` is this resource which\r\n            // means we cycle within this file\r\n            model.move(this._isNext, true);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // close the widget for this editor-instance, open the resource\r\n        // for the next marker and re-start marker navigation in there\r\n        controller.closeMarkersNavigation();\r\n        return editorService.openCodeEditor({\r\n            resource: newMarker.resource,\r\n            options: { pinned: false, revealIfOpened: true, revealInCenterIfOutsideViewport: true, selection: newMarker }\r\n        }, editor).then(function (editor) {\r\n            if (!editor) {\r\n                return undefined;\r\n            }\r\n            return editor.getAction(_this.id).run();\r\n        });\r\n    };\r\n    MarkerNavigationAction.compareMarker = function (a, b) {\r\n        var res = compare(a.resource.toString(), b.resource.toString());\r\n        if (res === 0) {\r\n            res = MarkerSeverity.compare(a.severity, b.severity);\r\n        }\r\n        if (res === 0) {\r\n            res = Range.compareRangesUsingStarts(a, b);\r\n        }\r\n        return res;\r\n    };\r\n    return MarkerNavigationAction;\r\n}(EditorAction));\r\nvar NextMarkerAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerAction, _super);\r\n    function NextMarkerAction() {\r\n        return _super.call(this, true, false, {\r\n            id: NextMarkerAction.ID,\r\n            label: NextMarkerAction.LABEL,\r\n            alias: 'Go to Next Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.focus, primary: 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    NextMarkerAction.ID = 'editor.action.marker.next';\r\n    NextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\r\n    return NextMarkerAction;\r\n}(MarkerNavigationAction));\r\nexport { NextMarkerAction };\r\nvar PrevMarkerAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerAction, _super);\r\n    function PrevMarkerAction() {\r\n        return _super.call(this, false, false, {\r\n            id: PrevMarkerAction.ID,\r\n            label: PrevMarkerAction.LABEL,\r\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.focus, primary: 1024 /* Shift */ | 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    PrevMarkerAction.ID = 'editor.action.marker.prev';\r\n    PrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\r\n    return PrevMarkerAction;\r\n}(MarkerNavigationAction));\r\nvar NextMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerInFilesAction, _super);\r\n    function NextMarkerInFilesAction() {\r\n        return _super.call(this, true, true, {\r\n            id: 'editor.action.marker.nextInFiles',\r\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return NextMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nvar PrevMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerInFilesAction, _super);\r\n    function PrevMarkerInFilesAction() {\r\n        return _super.call(this, false, true, {\r\n            id: 'editor.action.marker.prevInFiles',\r\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return PrevMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nregisterEditorContribution(MarkerController.ID, MarkerController);\r\nregisterEditorAction(NextMarkerAction);\r\nregisterEditorAction(PrevMarkerAction);\r\nregisterEditorAction(NextMarkerInFilesAction);\r\nregisterEditorAction(PrevMarkerInFilesAction);\r\nvar CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\r\nvar MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\r\nregisterEditorCommand(new MarkerCommand({\r\n    id: 'closeMarkersNavigation',\r\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\r\n    handler: function (x) { return x.closeMarkersNavigation(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 50,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// Go to menu\r\nMenuRegistry.appendMenuItem(19 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.nextInFiles',\r\n        title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\")\r\n    },\r\n    order: 1\r\n});\r\nMenuRegistry.appendMenuItem(19 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.prevInFiles',\r\n        title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\")\r\n    },\r\n    order: 2\r\n});\r\n"]},"metadata":{},"sourceType":"module"}