{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport * as browser from '../../../../base/browser/browser.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport * as platform from '../../../../base/common/platform.js';\n\nfunction hasModifier(e, modifier) {\n  return !!e[modifier];\n}\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\n\n\nvar ClickLinkMouseEvent =\n/** @class */\nfunction () {\n  function ClickLinkMouseEvent(source, opts) {\n    this.target = source.target;\n    this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n    this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n    this.isNoneOrSingleMouseDown = browser.isIE || source.event.detail <= 1; // IE does not support event.detail properly\n  }\n\n  return ClickLinkMouseEvent;\n}();\n\nexport { ClickLinkMouseEvent };\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\n\nvar ClickLinkKeyboardEvent =\n/** @class */\nfunction () {\n  function ClickLinkKeyboardEvent(source, opts) {\n    this.keyCodeIsTriggerKey = source.keyCode === opts.triggerKey;\n    this.keyCodeIsSideBySideKey = source.keyCode === opts.triggerSideBySideKey;\n    this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n  }\n\n  return ClickLinkKeyboardEvent;\n}();\n\nexport { ClickLinkKeyboardEvent };\n\nvar ClickLinkOptions =\n/** @class */\nfunction () {\n  function ClickLinkOptions(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n    this.triggerKey = triggerKey;\n    this.triggerModifier = triggerModifier;\n    this.triggerSideBySideKey = triggerSideBySideKey;\n    this.triggerSideBySideModifier = triggerSideBySideModifier;\n  }\n\n  ClickLinkOptions.prototype.equals = function (other) {\n    return this.triggerKey === other.triggerKey && this.triggerModifier === other.triggerModifier && this.triggerSideBySideKey === other.triggerSideBySideKey && this.triggerSideBySideModifier === other.triggerSideBySideModifier;\n  };\n\n  return ClickLinkOptions;\n}();\n\nexport { ClickLinkOptions };\n\nfunction createOptions(multiCursorModifier) {\n  if (multiCursorModifier === 'altKey') {\n    if (platform.isMacintosh) {\n      return new ClickLinkOptions(57\n      /* Meta */\n      , 'metaKey', 6\n      /* Alt */\n      , 'altKey');\n    }\n\n    return new ClickLinkOptions(5\n    /* Ctrl */\n    , 'ctrlKey', 6\n    /* Alt */\n    , 'altKey');\n  }\n\n  if (platform.isMacintosh) {\n    return new ClickLinkOptions(6\n    /* Alt */\n    , 'altKey', 57\n    /* Meta */\n    , 'metaKey');\n  }\n\n  return new ClickLinkOptions(6\n  /* Alt */\n  , 'altKey', 5\n  /* Ctrl */\n  , 'ctrlKey');\n}\n\nvar ClickLinkGesture =\n/** @class */\nfunction (_super) {\n  __extends(ClickLinkGesture, _super);\n\n  function ClickLinkGesture(editor) {\n    var _this = _super.call(this) || this;\n\n    _this._onMouseMoveOrRelevantKeyDown = _this._register(new Emitter());\n    _this.onMouseMoveOrRelevantKeyDown = _this._onMouseMoveOrRelevantKeyDown.event;\n    _this._onExecute = _this._register(new Emitter());\n    _this.onExecute = _this._onExecute.event;\n    _this._onCancel = _this._register(new Emitter());\n    _this.onCancel = _this._onCancel.event;\n    _this._editor = editor;\n    _this._opts = createOptions(_this._editor.getOption(59\n    /* multiCursorModifier */\n    ));\n    _this.lastMouseMoveEvent = null;\n    _this.hasTriggerKeyOnMouseDown = false;\n\n    _this._register(_this._editor.onDidChangeConfiguration(function (e) {\n      if (e.hasChanged(59\n      /* multiCursorModifier */\n      )) {\n        var newOpts = createOptions(_this._editor.getOption(59\n        /* multiCursorModifier */\n        ));\n\n        if (_this._opts.equals(newOpts)) {\n          return;\n        }\n\n        _this._opts = newOpts;\n        _this.lastMouseMoveEvent = null;\n        _this.hasTriggerKeyOnMouseDown = false;\n\n        _this._onCancel.fire();\n      }\n    }));\n\n    _this._register(_this._editor.onMouseMove(function (e) {\n      return _this.onEditorMouseMove(new ClickLinkMouseEvent(e, _this._opts));\n    }));\n\n    _this._register(_this._editor.onMouseDown(function (e) {\n      return _this.onEditorMouseDown(new ClickLinkMouseEvent(e, _this._opts));\n    }));\n\n    _this._register(_this._editor.onMouseUp(function (e) {\n      return _this.onEditorMouseUp(new ClickLinkMouseEvent(e, _this._opts));\n    }));\n\n    _this._register(_this._editor.onKeyDown(function (e) {\n      return _this.onEditorKeyDown(new ClickLinkKeyboardEvent(e, _this._opts));\n    }));\n\n    _this._register(_this._editor.onKeyUp(function (e) {\n      return _this.onEditorKeyUp(new ClickLinkKeyboardEvent(e, _this._opts));\n    }));\n\n    _this._register(_this._editor.onMouseDrag(function () {\n      return _this.resetHandler();\n    }));\n\n    _this._register(_this._editor.onDidChangeCursorSelection(function (e) {\n      return _this.onDidChangeCursorSelection(e);\n    }));\n\n    _this._register(_this._editor.onDidChangeModel(function (e) {\n      return _this.resetHandler();\n    }));\n\n    _this._register(_this._editor.onDidChangeModelContent(function () {\n      return _this.resetHandler();\n    }));\n\n    _this._register(_this._editor.onDidScrollChange(function (e) {\n      if (e.scrollTopChanged || e.scrollLeftChanged) {\n        _this.resetHandler();\n      }\n    }));\n\n    return _this;\n  }\n\n  ClickLinkGesture.prototype.onDidChangeCursorSelection = function (e) {\n    if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n      this.resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/Microsoft/vscode/issues/7827)\n    }\n  };\n\n  ClickLinkGesture.prototype.onEditorMouseMove = function (mouseEvent) {\n    this.lastMouseMoveEvent = mouseEvent;\n\n    this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n  };\n\n  ClickLinkGesture.prototype.onEditorMouseDown = function (mouseEvent) {\n    // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n    // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n    // release the mouse button without wanting to do the navigation.\n    // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n    this.hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n  };\n\n  ClickLinkGesture.prototype.onEditorMouseUp = function (mouseEvent) {\n    if (this.hasTriggerKeyOnMouseDown) {\n      this._onExecute.fire(mouseEvent);\n    }\n  };\n\n  ClickLinkGesture.prototype.onEditorKeyDown = function (e) {\n    if (this.lastMouseMoveEvent && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n    || e.keyCodeIsSideBySideKey && e.hasTriggerModifier // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n    )) {\n      this._onMouseMoveOrRelevantKeyDown.fire([this.lastMouseMoveEvent, e]);\n    } else if (e.hasTriggerModifier) {\n      this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n\n    }\n  };\n\n  ClickLinkGesture.prototype.onEditorKeyUp = function (e) {\n    if (e.keyCodeIsTriggerKey) {\n      this._onCancel.fire();\n    }\n  };\n\n  ClickLinkGesture.prototype.resetHandler = function () {\n    this.lastMouseMoveEvent = null;\n    this.hasTriggerKeyOnMouseDown = false;\n\n    this._onCancel.fire();\n  };\n\n  return ClickLinkGesture;\n}(Disposable);\n\nexport { ClickLinkGesture };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/clickLinkGesture.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","browser","Disposable","Emitter","platform","hasModifier","e","modifier","ClickLinkMouseEvent","source","opts","target","hasTriggerModifier","event","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","isIE","detail","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","equals","other","createOptions","multiCursorModifier","isMacintosh","ClickLinkGesture","_super","editor","_this","call","_onMouseMoveOrRelevantKeyDown","_register","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","_editor","_opts","getOption","lastMouseMoveEvent","hasTriggerKeyOnMouseDown","onDidChangeConfiguration","hasChanged","newOpts","fire","onMouseMove","onEditorMouseMove","onMouseDown","onEditorMouseDown","onMouseUp","onEditorMouseUp","onKeyDown","onEditorKeyDown","onKeyUp","onEditorKeyUp","onMouseDrag","resetHandler","onDidChangeCursorSelection","onDidChangeModel","onDidChangeModelContent","onDidScrollChange","scrollTopChanged","scrollLeftChanged","selection","startColumn","endColumn","mouseEvent"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../../base/common/event.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nfunction hasModifier(e, modifier) {\r\n    return !!e[modifier];\r\n}\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkMouseEvent = /** @class */ (function () {\r\n    function ClickLinkMouseEvent(source, opts) {\r\n        this.target = source.target;\r\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\r\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\r\n        this.isNoneOrSingleMouseDown = (browser.isIE || source.event.detail <= 1); // IE does not support event.detail properly\r\n    }\r\n    return ClickLinkMouseEvent;\r\n}());\r\nexport { ClickLinkMouseEvent };\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkKeyboardEvent = /** @class */ (function () {\r\n    function ClickLinkKeyboardEvent(source, opts) {\r\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\r\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\r\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\r\n    }\r\n    return ClickLinkKeyboardEvent;\r\n}());\r\nexport { ClickLinkKeyboardEvent };\r\nvar ClickLinkOptions = /** @class */ (function () {\r\n    function ClickLinkOptions(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\r\n        this.triggerKey = triggerKey;\r\n        this.triggerModifier = triggerModifier;\r\n        this.triggerSideBySideKey = triggerSideBySideKey;\r\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\r\n    }\r\n    ClickLinkOptions.prototype.equals = function (other) {\r\n        return (this.triggerKey === other.triggerKey\r\n            && this.triggerModifier === other.triggerModifier\r\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\r\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\r\n    };\r\n    return ClickLinkOptions;\r\n}());\r\nexport { ClickLinkOptions };\r\nfunction createOptions(multiCursorModifier) {\r\n    if (multiCursorModifier === 'altKey') {\r\n        if (platform.isMacintosh) {\r\n            return new ClickLinkOptions(57 /* Meta */, 'metaKey', 6 /* Alt */, 'altKey');\r\n        }\r\n        return new ClickLinkOptions(5 /* Ctrl */, 'ctrlKey', 6 /* Alt */, 'altKey');\r\n    }\r\n    if (platform.isMacintosh) {\r\n        return new ClickLinkOptions(6 /* Alt */, 'altKey', 57 /* Meta */, 'metaKey');\r\n    }\r\n    return new ClickLinkOptions(6 /* Alt */, 'altKey', 5 /* Ctrl */, 'ctrlKey');\r\n}\r\nvar ClickLinkGesture = /** @class */ (function (_super) {\r\n    __extends(ClickLinkGesture, _super);\r\n    function ClickLinkGesture(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onMouseMoveOrRelevantKeyDown = _this._register(new Emitter());\r\n        _this.onMouseMoveOrRelevantKeyDown = _this._onMouseMoveOrRelevantKeyDown.event;\r\n        _this._onExecute = _this._register(new Emitter());\r\n        _this.onExecute = _this._onExecute.event;\r\n        _this._onCancel = _this._register(new Emitter());\r\n        _this.onCancel = _this._onCancel.event;\r\n        _this._editor = editor;\r\n        _this._opts = createOptions(_this._editor.getOption(59 /* multiCursorModifier */));\r\n        _this.lastMouseMoveEvent = null;\r\n        _this.hasTriggerKeyOnMouseDown = false;\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(59 /* multiCursorModifier */)) {\r\n                var newOpts = createOptions(_this._editor.getOption(59 /* multiCursorModifier */));\r\n                if (_this._opts.equals(newOpts)) {\r\n                    return;\r\n                }\r\n                _this._opts = newOpts;\r\n                _this.lastMouseMoveEvent = null;\r\n                _this.hasTriggerKeyOnMouseDown = false;\r\n                _this._onCancel.fire();\r\n            }\r\n        }));\r\n        _this._register(_this._editor.onMouseMove(function (e) { return _this.onEditorMouseMove(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDown(function (e) { return _this.onEditorMouseDown(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseUp(function (e) { return _this.onEditorMouseUp(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyDown(function (e) { return _this.onEditorKeyDown(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyUp(function (e) { return _this.onEditorKeyUp(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDrag(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeCursorSelection(function (e) { return _this.onDidChangeCursorSelection(e); }));\r\n        _this._register(_this._editor.onDidChangeModel(function (e) { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeModelContent(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n                _this.resetHandler();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ClickLinkGesture.prototype.onDidChangeCursorSelection = function (e) {\r\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\r\n            this.resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/Microsoft/vscode/issues/7827)\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseMove = function (mouseEvent) {\r\n        this.lastMouseMoveEvent = mouseEvent;\r\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseDown = function (mouseEvent) {\r\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\r\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\r\n        // release the mouse button without wanting to do the navigation.\r\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\r\n        this.hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseUp = function (mouseEvent) {\r\n        if (this.hasTriggerKeyOnMouseDown) {\r\n            this._onExecute.fire(mouseEvent);\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyDown = function (e) {\r\n        if (this.lastMouseMoveEvent\r\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\r\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\r\n            )) {\r\n            this._onMouseMoveOrRelevantKeyDown.fire([this.lastMouseMoveEvent, e]);\r\n        }\r\n        else if (e.hasTriggerModifier) {\r\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyUp = function (e) {\r\n        if (e.keyCodeIsTriggerKey) {\r\n            this._onCancel.fire();\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.resetHandler = function () {\r\n        this.lastMouseMoveEvent = null;\r\n        this.hasTriggerKeyOnMouseDown = false;\r\n        this._onCancel.fire();\r\n    };\r\n    return ClickLinkGesture;\r\n}(Disposable));\r\nexport { ClickLinkGesture };\r\n"]},"metadata":{},"sourceType":"module"}