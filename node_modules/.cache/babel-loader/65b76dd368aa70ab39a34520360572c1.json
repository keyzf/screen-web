{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../base/common/errors.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { Selection } from '../../common/core/selection.js';\nimport { DocumentFormattingEditProviderRegistry, DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\nimport { IModelService } from '../../common/services/modelService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../nls.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\nimport { assertType } from '../../../base/common/types.js';\nexport function alertFormattingEdits(edits) {\n  edits = edits.filter(function (edit) {\n    return edit.range;\n  });\n\n  if (!edits.length) {\n    return;\n  }\n\n  var range = edits[0].range;\n\n  for (var i = 1; i < edits.length; i++) {\n    range = Range.plusRange(range, edits[i].range);\n  }\n\n  var startLineNumber = range.startLineNumber,\n      endLineNumber = range.endLineNumber;\n\n  if (startLineNumber === endLineNumber) {\n    if (edits.length === 1) {\n      alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\n    } else {\n      alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\n    }\n  } else {\n    if (edits.length === 1) {\n      alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\n    } else {\n      alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\n    }\n  }\n}\nexport function getRealAndSyntheticDocumentFormattersOrdered(model) {\n  var result = [];\n  var seen = new Set(); // (1) add all document formatter\n\n  var docFormatter = DocumentFormattingEditProviderRegistry.ordered(model);\n\n  for (var _i = 0, docFormatter_1 = docFormatter; _i < docFormatter_1.length; _i++) {\n    var formatter = docFormatter_1[_i];\n    result.push(formatter);\n\n    if (formatter.extensionId) {\n      seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\n    }\n  } // (2) add all range formatter as document formatter (unless the same extension already did that)\n\n\n  var rangeFormatter = DocumentRangeFormattingEditProviderRegistry.ordered(model);\n\n  var _loop_1 = function (formatter) {\n    if (formatter.extensionId) {\n      if (seen.has(ExtensionIdentifier.toKey(formatter.extensionId))) {\n        return \"continue\";\n      }\n\n      seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\n    }\n\n    result.push({\n      displayName: formatter.displayName,\n      extensionId: formatter.extensionId,\n      provideDocumentFormattingEdits: function (model, options, token) {\n        return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n      }\n    });\n  };\n\n  for (var _a = 0, rangeFormatter_1 = rangeFormatter; _a < rangeFormatter_1.length; _a++) {\n    var formatter = rangeFormatter_1[_a];\n\n    _loop_1(formatter);\n  }\n\n  return result;\n}\n\nvar FormattingConflicts =\n/** @class */\nfunction () {\n  function FormattingConflicts() {}\n\n  FormattingConflicts.select = function (formatter, document, mode) {\n    return __awaiter(this, void 0, void 0, function () {\n      var selector;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (formatter.length === 0) {\n              return [2\n              /*return*/\n              , undefined];\n            }\n\n            selector = FormattingConflicts._selectors.iterator().next().value;\n            if (!selector) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , selector(formatter, document, mode)];\n\n          case 1:\n            return [2\n            /*return*/\n            , _a.sent()];\n\n          case 2:\n            return [2\n            /*return*/\n            , formatter[0]];\n        }\n      });\n    });\n  };\n\n  FormattingConflicts._selectors = new LinkedList();\n  return FormattingConflicts;\n}();\n\nexport { FormattingConflicts };\nexport function formatDocumentRangeWithSelectedProvider(accessor, editorOrModel, range, mode, token) {\n  return __awaiter(this, void 0, void 0, function () {\n    var instaService, model, provider, selected;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          instaService = accessor.get(IInstantiationService);\n          model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n          provider = DocumentRangeFormattingEditProviderRegistry.ordered(model);\n          return [4\n          /*yield*/\n          , FormattingConflicts.select(provider, model, mode)];\n\n        case 1:\n          selected = _a.sent();\n          if (!selected) return [3\n          /*break*/\n          , 3];\n          return [4\n          /*yield*/\n          , instaService.invokeFunction(formatDocumentRangeWithProvider, selected, editorOrModel, range, token)];\n\n        case 2:\n          _a.sent();\n\n          _a.label = 3;\n\n        case 3:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\nexport function formatDocumentRangeWithProvider(accessor, provider, editorOrModel, range, token) {\n  return __awaiter(this, void 0, void 0, function () {\n    var workerService, model, cts, edits, rawEdits, range_1, initialSelection_1;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          workerService = accessor.get(IEditorWorkerService);\n\n          if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1\n            /* Value */\n            | 4\n            /* Position */\n            , token);\n          } else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n          }\n\n          _a.label = 1;\n\n        case 1:\n          _a.trys.push([1,, 4, 5]);\n\n          return [4\n          /*yield*/\n          , provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)];\n\n        case 2:\n          rawEdits = _a.sent();\n          return [4\n          /*yield*/\n          , workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\n\n        case 3:\n          edits = _a.sent();\n\n          if (cts.token.isCancellationRequested) {\n            return [2\n            /*return*/\n            , true];\n          }\n\n          return [3\n          /*break*/\n          , 5];\n\n        case 4:\n          cts.dispose();\n          return [7\n          /*endfinally*/\n          ];\n\n        case 5:\n          if (!edits || edits.length === 0) {\n            return [2\n            /*return*/\n            , false];\n          }\n\n          if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, edits);\n            alertFormattingEdits(edits);\n            editorOrModel.pushUndoStop();\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1\n            /* Immediate */\n            );\n          } else {\n            range_1 = edits[0].range;\n            initialSelection_1 = new Selection(range_1.startLineNumber, range_1.startColumn, range_1.endLineNumber, range_1.endColumn);\n            model.pushEditOperations([initialSelection_1], edits.map(function (edit) {\n              return {\n                text: edit.text,\n                range: Range.lift(edit.range),\n                forceMoveMarkers: true\n              };\n            }), function (undoEdits) {\n              for (var _i = 0, undoEdits_1 = undoEdits; _i < undoEdits_1.length; _i++) {\n                var range_2 = undoEdits_1[_i].range;\n\n                if (Range.areIntersectingOrTouching(range_2, initialSelection_1)) {\n                  return [new Selection(range_2.startLineNumber, range_2.startColumn, range_2.endLineNumber, range_2.endColumn)];\n                }\n              }\n\n              return null;\n            });\n          }\n\n          return [2\n          /*return*/\n          , true];\n      }\n    });\n  });\n}\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, token) {\n  return __awaiter(this, void 0, void 0, function () {\n    var instaService, model, provider, selected;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          instaService = accessor.get(IInstantiationService);\n          model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n          provider = getRealAndSyntheticDocumentFormattersOrdered(model);\n          return [4\n          /*yield*/\n          , FormattingConflicts.select(provider, model, mode)];\n\n        case 1:\n          selected = _a.sent();\n          if (!selected) return [3\n          /*break*/\n          , 3];\n          return [4\n          /*yield*/\n          , instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token)];\n\n        case 2:\n          _a.sent();\n\n          _a.label = 3;\n\n        case 3:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\n  return __awaiter(this, void 0, void 0, function () {\n    var workerService, model, cts, edits, rawEdits, range, initialSelection_2;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          workerService = accessor.get(IEditorWorkerService);\n\n          if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1\n            /* Value */\n            | 4\n            /* Position */\n            , token);\n          } else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n          }\n\n          _a.label = 1;\n\n        case 1:\n          _a.trys.push([1,, 4, 5]);\n\n          return [4\n          /*yield*/\n          , provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token)];\n\n        case 2:\n          rawEdits = _a.sent();\n          return [4\n          /*yield*/\n          , workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\n\n        case 3:\n          edits = _a.sent();\n\n          if (cts.token.isCancellationRequested) {\n            return [2\n            /*return*/\n            , true];\n          }\n\n          return [3\n          /*break*/\n          , 5];\n\n        case 4:\n          cts.dispose();\n          return [7\n          /*endfinally*/\n          ];\n\n        case 5:\n          if (!edits || edits.length === 0) {\n            return [2\n            /*return*/\n            , false];\n          }\n\n          if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, edits);\n\n            if (mode !== 2\n            /* Silent */\n            ) {\n                alertFormattingEdits(edits);\n                editorOrModel.pushUndoStop();\n                editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1\n                /* Immediate */\n                );\n              }\n          } else {\n            range = edits[0].range;\n            initialSelection_2 = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection_2], edits.map(function (edit) {\n              return {\n                text: edit.text,\n                range: Range.lift(edit.range),\n                forceMoveMarkers: true\n              };\n            }), function (undoEdits) {\n              for (var _i = 0, undoEdits_2 = undoEdits; _i < undoEdits_2.length; _i++) {\n                var range_3 = undoEdits_2[_i].range;\n\n                if (Range.areIntersectingOrTouching(range_3, initialSelection_2)) {\n                  return [new Selection(range_3.startLineNumber, range_3.startColumn, range_3.endLineNumber, range_3.endColumn)];\n                }\n              }\n\n              return null;\n            });\n          }\n\n          return [2\n          /*return*/\n          , true];\n      }\n    });\n  });\n}\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, model, range, options, token) {\n  return __awaiter(this, void 0, void 0, function () {\n    var providers, _i, providers_1, provider, rawEdits;\n\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          providers = DocumentRangeFormattingEditProviderRegistry.ordered(model);\n          _i = 0, providers_1 = providers;\n          _a.label = 1;\n\n        case 1:\n          if (!(_i < providers_1.length)) return [3\n          /*break*/\n          , 5];\n          provider = providers_1[_i];\n          return [4\n          /*yield*/\n          , Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError)];\n\n        case 2:\n          rawEdits = _a.sent();\n          if (!isNonEmptyArray(rawEdits)) return [3\n          /*break*/\n          , 4];\n          return [4\n          /*yield*/\n          , workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\n\n        case 3:\n          return [2\n          /*return*/\n          , _a.sent()];\n\n        case 4:\n          _i++;\n          return [3\n          /*break*/\n          , 1];\n\n        case 5:\n          return [2\n          /*return*/\n          , undefined];\n      }\n    });\n  });\n}\nexport function getDocumentFormattingEditsUntilResult(workerService, model, options, token) {\n  return __awaiter(this, void 0, void 0, function () {\n    var providers, _i, providers_2, provider, rawEdits;\n\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          providers = getRealAndSyntheticDocumentFormattersOrdered(model);\n          _i = 0, providers_2 = providers;\n          _a.label = 1;\n\n        case 1:\n          if (!(_i < providers_2.length)) return [3\n          /*break*/\n          , 5];\n          provider = providers_2[_i];\n          return [4\n          /*yield*/\n          , Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError)];\n\n        case 2:\n          rawEdits = _a.sent();\n          if (!isNonEmptyArray(rawEdits)) return [3\n          /*break*/\n          , 4];\n          return [4\n          /*yield*/\n          , workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\n\n        case 3:\n          return [2\n          /*return*/\n          , _a.sent()];\n\n        case 4:\n          _i++;\n          return [3\n          /*break*/\n          , 1];\n\n        case 5:\n          return [2\n          /*return*/\n          , undefined];\n      }\n    });\n  });\n}\nexport function getOnTypeFormattingEdits(workerService, model, position, ch, options) {\n  var providers = OnTypeFormattingEditProviderRegistry.ordered(model);\n\n  if (providers.length === 0) {\n    return Promise.resolve(undefined);\n  }\n\n  if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n    return Promise.resolve(undefined);\n  }\n\n  return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, CancellationToken.None)).catch(onUnexpectedExternalError).then(function (edits) {\n    return workerService.computeMoreMinimalEdits(model.uri, edits);\n  });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor) {\n  var args = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    args[_i - 1] = arguments[_i];\n  }\n\n  var resource = args[0],\n      range = args[1],\n      options = args[2];\n  assertType(URI.isUri(resource));\n  assertType(Range.isIRange(range));\n  var model = accessor.get(IModelService).getModel(resource);\n\n  if (!model) {\n    throw illegalArgument('resource');\n  }\n\n  return getDocumentRangeFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, Range.lift(range), options, CancellationToken.None);\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor) {\n  var args = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    args[_i - 1] = arguments[_i];\n  }\n\n  var resource = args[0],\n      options = args[1];\n  assertType(URI.isUri(resource));\n  var model = accessor.get(IModelService).getModel(resource);\n\n  if (!model) {\n    throw illegalArgument('resource');\n  }\n\n  return getDocumentFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, options, CancellationToken.None);\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor) {\n  var args = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    args[_i - 1] = arguments[_i];\n  }\n\n  var resource = args[0],\n      position = args[1],\n      ch = args[2],\n      options = args[3];\n  assertType(URI.isUri(resource));\n  assertType(Position.isIPosition(position));\n  assertType(typeof ch === 'string');\n  var model = accessor.get(IModelService).getModel(resource);\n\n  if (!model) {\n    throw illegalArgument('resource');\n  }\n\n  return getOnTypeFormattingEdits(accessor.get(IEditorWorkerService), model, Position.lift(position), ch, options);\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/contrib/format/format.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","alert","isNonEmptyArray","CancellationToken","illegalArgument","onUnexpectedExternalError","URI","EditorStateCancellationTokenSource","TextModelCancellationTokenSource","isCodeEditor","Position","Range","Selection","DocumentFormattingEditProviderRegistry","DocumentRangeFormattingEditProviderRegistry","OnTypeFormattingEditProviderRegistry","IEditorWorkerService","IModelService","FormattingEdit","nls","ExtensionIdentifier","IInstantiationService","LinkedList","CommandsRegistry","assertType","alertFormattingEdits","edits","filter","edit","range","i","plusRange","startLineNumber","endLineNumber","localize","getRealAndSyntheticDocumentFormattersOrdered","model","seen","Set","docFormatter","ordered","_i","docFormatter_1","formatter","extensionId","add","toKey","rangeFormatter","_loop_1","has","displayName","provideDocumentFormattingEdits","options","token","provideDocumentRangeFormattingEdits","getFullModelRange","_a","rangeFormatter_1","FormattingConflicts","select","document","mode","selector","undefined","_selectors","formatDocumentRangeWithSelectedProvider","accessor","editorOrModel","instaService","provider","selected","get","getModel","invokeFunction","formatDocumentRangeWithProvider","workerService","cts","rawEdits","range_1","initialSelection_1","getFormattingOptions","computeMoreMinimalEdits","uri","isCancellationRequested","dispose","execute","pushUndoStop","revealPositionInCenterIfOutsideViewport","getPosition","startColumn","endColumn","pushEditOperations","map","text","lift","forceMoveMarkers","undoEdits","undoEdits_1","range_2","areIntersectingOrTouching","formatDocumentWithSelectedProvider","formatDocumentWithProvider","initialSelection_2","undoEdits_2","range_3","getDocumentRangeFormattingEditsUntilResult","providers","providers_1","catch","getDocumentFormattingEditsUntilResult","providers_2","getOnTypeFormattingEdits","position","ch","autoFormatTriggerCharacters","indexOf","provideOnTypeFormattingEdits","None","registerCommand","args","arguments","resource","isUri","isIRange","isIPosition"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { DocumentFormattingEditProviderRegistry, DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nexport function alertFormattingEdits(edits) {\r\n    edits = edits.filter(function (edit) { return edit.range; });\r\n    if (!edits.length) {\r\n        return;\r\n    }\r\n    var range = edits[0].range;\r\n    for (var i = 1; i < edits.length; i++) {\r\n        range = Range.plusRange(range, edits[i].range);\r\n    }\r\n    var startLineNumber = range.startLineNumber, endLineNumber = range.endLineNumber;\r\n    if (startLineNumber === endLineNumber) {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\r\n        }\r\n    }\r\n    else {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\r\n        }\r\n    }\r\n}\r\nexport function getRealAndSyntheticDocumentFormattersOrdered(model) {\r\n    var result = [];\r\n    var seen = new Set();\r\n    // (1) add all document formatter\r\n    var docFormatter = DocumentFormattingEditProviderRegistry.ordered(model);\r\n    for (var _i = 0, docFormatter_1 = docFormatter; _i < docFormatter_1.length; _i++) {\r\n        var formatter = docFormatter_1[_i];\r\n        result.push(formatter);\r\n        if (formatter.extensionId) {\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n    }\r\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\r\n    var rangeFormatter = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n    var _loop_1 = function (formatter) {\r\n        if (formatter.extensionId) {\r\n            if (seen.has(ExtensionIdentifier.toKey(formatter.extensionId))) {\r\n                return \"continue\";\r\n            }\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n        result.push({\r\n            displayName: formatter.displayName,\r\n            extensionId: formatter.extensionId,\r\n            provideDocumentFormattingEdits: function (model, options, token) {\r\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\r\n            }\r\n        });\r\n    };\r\n    for (var _a = 0, rangeFormatter_1 = rangeFormatter; _a < rangeFormatter_1.length; _a++) {\r\n        var formatter = rangeFormatter_1[_a];\r\n        _loop_1(formatter);\r\n    }\r\n    return result;\r\n}\r\nvar FormattingConflicts = /** @class */ (function () {\r\n    function FormattingConflicts() {\r\n    }\r\n    FormattingConflicts.select = function (formatter, document, mode) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var selector;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (formatter.length === 0) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        selector = FormattingConflicts._selectors.iterator().next().value;\r\n                        if (!selector) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, selector(formatter, document, mode)];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/, formatter[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FormattingConflicts._selectors = new LinkedList();\r\n    return FormattingConflicts;\r\n}());\r\nexport { FormattingConflicts };\r\nexport function formatDocumentRangeWithSelectedProvider(accessor, editorOrModel, range, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentRangeWithProvider, selected, editorOrModel, range, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentRangeWithProvider(accessor, provider, editorOrModel, range, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range_1, initialSelection_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        alertFormattingEdits(edits);\r\n                        editorOrModel.pushUndoStop();\r\n                        editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                    }\r\n                    else {\r\n                        range_1 = edits[0].range;\r\n                        initialSelection_1 = new Selection(range_1.startLineNumber, range_1.startColumn, range_1.endLineNumber, range_1.endColumn);\r\n                        model.pushEditOperations([initialSelection_1], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_1 = undoEdits; _i < undoEdits_1.length; _i++) {\r\n                                var range_2 = undoEdits_1[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_2, initialSelection_1)) {\r\n                                    return [new Selection(range_2.startLineNumber, range_2.startColumn, range_2.endLineNumber, range_2.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range, initialSelection_2;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        if (mode !== 2 /* Silent */) {\r\n                            alertFormattingEdits(edits);\r\n                            editorOrModel.pushUndoStop();\r\n                            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                        }\r\n                    }\r\n                    else {\r\n                        range = edits[0].range;\r\n                        initialSelection_2 = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n                        model.pushEditOperations([initialSelection_2], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_2 = undoEdits; _i < undoEdits_2.length; _i++) {\r\n                                var range_3 = undoEdits_2[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_3, initialSelection_2)) {\r\n                                    return [new Selection(range_3.startLineNumber, range_3.startColumn, range_3.endLineNumber, range_3.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, model, range, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_1, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    _i = 0, providers_1 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_1.length)) return [3 /*break*/, 5];\r\n                    provider = providers_1[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentFormattingEditsUntilResult(workerService, model, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_2, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    _i = 0, providers_2 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_2.length)) return [3 /*break*/, 5];\r\n                    provider = providers_2[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getOnTypeFormattingEdits(workerService, model, position, ch, options) {\r\n    var providers = OnTypeFormattingEditProviderRegistry.ordered(model);\r\n    if (providers.length === 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, CancellationToken.None)).catch(onUnexpectedExternalError).then(function (edits) {\r\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], range = args[1], options = args[2];\r\n    assertType(URI.isUri(resource));\r\n    assertType(Range.isIRange(range));\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentRangeFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, Range.lift(range), options, CancellationToken.None);\r\n});\r\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], options = args[1];\r\n    assertType(URI.isUri(resource));\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, options, CancellationToken.None);\r\n});\r\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], position = args[1], ch = args[2], options = args[3];\r\n    assertType(URI.isUri(resource));\r\n    assertType(Position.isIPosition(position));\r\n    assertType(typeof ch === 'string');\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getOnTypeFormattingEdits(accessor.get(IEditorWorkerService), model, Position.lift(position), ch, options);\r\n});\r\n"]},"metadata":{},"sourceType":"module"}