{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../base/common/event.js';\nimport { toDisposable } from '../../../base/common/lifecycle.js';\nimport { withUndefinedAsNull } from '../../../base/common/types.js';\nimport { keys } from '../../../base/common/map.js';\n\nvar TokenizationRegistryImpl =\n/** @class */\nfunction () {\n  function TokenizationRegistryImpl() {\n    this._map = new Map();\n    this._promises = new Map();\n    this._onDidChange = new Emitter();\n    this.onDidChange = this._onDidChange.event;\n    this._colorMap = null;\n  }\n\n  TokenizationRegistryImpl.prototype.fire = function (languages) {\n    this._onDidChange.fire({\n      changedLanguages: languages,\n      changedColorMap: false\n    });\n  };\n\n  TokenizationRegistryImpl.prototype.register = function (language, support) {\n    var _this = this;\n\n    this._map.set(language, support);\n\n    this.fire([language]);\n    return toDisposable(function () {\n      if (_this._map.get(language) !== support) {\n        return;\n      }\n\n      _this._map.delete(language);\n\n      _this.fire([language]);\n    });\n  };\n\n  TokenizationRegistryImpl.prototype.registerPromise = function (language, supportPromise) {\n    var _this = this;\n\n    var registration = null;\n    var isDisposed = false;\n\n    this._promises.set(language, supportPromise.then(function (support) {\n      _this._promises.delete(language);\n\n      if (isDisposed || !support) {\n        return;\n      }\n\n      registration = _this.register(language, support);\n    }));\n\n    return toDisposable(function () {\n      isDisposed = true;\n\n      if (registration) {\n        registration.dispose();\n      }\n    });\n  };\n\n  TokenizationRegistryImpl.prototype.getPromise = function (language) {\n    var _this = this;\n\n    var support = this.get(language);\n\n    if (support) {\n      return Promise.resolve(support);\n    }\n\n    var promise = this._promises.get(language);\n\n    if (promise) {\n      return promise.then(function (_) {\n        return _this.get(language);\n      });\n    }\n\n    return null;\n  };\n\n  TokenizationRegistryImpl.prototype.get = function (language) {\n    return withUndefinedAsNull(this._map.get(language));\n  };\n\n  TokenizationRegistryImpl.prototype.setColorMap = function (colorMap) {\n    this._colorMap = colorMap;\n\n    this._onDidChange.fire({\n      changedLanguages: keys(this._map),\n      changedColorMap: true\n    });\n  };\n\n  TokenizationRegistryImpl.prototype.getColorMap = function () {\n    return this._colorMap;\n  };\n\n  TokenizationRegistryImpl.prototype.getDefaultBackground = function () {\n    if (this._colorMap && this._colorMap.length > 2\n    /* DefaultBackground */\n    ) {\n        return this._colorMap[2\n        /* DefaultBackground */\n        ];\n      }\n\n    return null;\n  };\n\n  return TokenizationRegistryImpl;\n}();\n\nexport { TokenizationRegistryImpl };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/common/modes/tokenizationRegistry.js"],"names":["Emitter","toDisposable","withUndefinedAsNull","keys","TokenizationRegistryImpl","_map","Map","_promises","_onDidChange","onDidChange","event","_colorMap","prototype","fire","languages","changedLanguages","changedColorMap","register","language","support","_this","set","get","delete","registerPromise","supportPromise","registration","isDisposed","then","dispose","getPromise","Promise","resolve","promise","_","setColorMap","colorMap","getColorMap","getDefaultBackground","length"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { withUndefinedAsNull } from '../../../base/common/types.js';\r\nimport { keys } from '../../../base/common/map.js';\r\nvar TokenizationRegistryImpl = /** @class */ (function () {\r\n    function TokenizationRegistryImpl() {\r\n        this._map = new Map();\r\n        this._promises = new Map();\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._colorMap = null;\r\n    }\r\n    TokenizationRegistryImpl.prototype.fire = function (languages) {\r\n        this._onDidChange.fire({\r\n            changedLanguages: languages,\r\n            changedColorMap: false\r\n        });\r\n    };\r\n    TokenizationRegistryImpl.prototype.register = function (language, support) {\r\n        var _this = this;\r\n        this._map.set(language, support);\r\n        this.fire([language]);\r\n        return toDisposable(function () {\r\n            if (_this._map.get(language) !== support) {\r\n                return;\r\n            }\r\n            _this._map.delete(language);\r\n            _this.fire([language]);\r\n        });\r\n    };\r\n    TokenizationRegistryImpl.prototype.registerPromise = function (language, supportPromise) {\r\n        var _this = this;\r\n        var registration = null;\r\n        var isDisposed = false;\r\n        this._promises.set(language, supportPromise.then(function (support) {\r\n            _this._promises.delete(language);\r\n            if (isDisposed || !support) {\r\n                return;\r\n            }\r\n            registration = _this.register(language, support);\r\n        }));\r\n        return toDisposable(function () {\r\n            isDisposed = true;\r\n            if (registration) {\r\n                registration.dispose();\r\n            }\r\n        });\r\n    };\r\n    TokenizationRegistryImpl.prototype.getPromise = function (language) {\r\n        var _this = this;\r\n        var support = this.get(language);\r\n        if (support) {\r\n            return Promise.resolve(support);\r\n        }\r\n        var promise = this._promises.get(language);\r\n        if (promise) {\r\n            return promise.then(function (_) { return _this.get(language); });\r\n        }\r\n        return null;\r\n    };\r\n    TokenizationRegistryImpl.prototype.get = function (language) {\r\n        return withUndefinedAsNull(this._map.get(language));\r\n    };\r\n    TokenizationRegistryImpl.prototype.setColorMap = function (colorMap) {\r\n        this._colorMap = colorMap;\r\n        this._onDidChange.fire({\r\n            changedLanguages: keys(this._map),\r\n            changedColorMap: true\r\n        });\r\n    };\r\n    TokenizationRegistryImpl.prototype.getColorMap = function () {\r\n        return this._colorMap;\r\n    };\r\n    TokenizationRegistryImpl.prototype.getDefaultBackground = function () {\r\n        if (this._colorMap && this._colorMap.length > 2 /* DefaultBackground */) {\r\n            return this._colorMap[2 /* DefaultBackground */];\r\n        }\r\n        return null;\r\n    };\r\n    return TokenizationRegistryImpl;\r\n}());\r\nexport { TokenizationRegistryImpl };\r\n"]},"metadata":{},"sourceType":"module"}