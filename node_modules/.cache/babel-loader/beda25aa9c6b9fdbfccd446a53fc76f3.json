{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nimport './list.css';\nimport { localize } from '../../../../nls.js';\nimport { dispose, DisposableStore } from '../../../common/lifecycle.js';\nimport { isNumber } from '../../../common/types.js';\nimport { range, firstIndex, binarySearch } from '../../../common/arrays.js';\nimport { memoize } from '../../../common/decorators.js';\nimport * as DOM from '../../dom.js';\nimport * as platform from '../../../common/platform.js';\nimport { Gesture } from '../../touch.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Event, Emitter, EventBufferer } from '../../../common/event.js';\nimport { domEvent } from '../../event.js';\nimport { ListAriaRootRole, ListError } from './list.js';\nimport { ListView } from './listView.js';\nimport { Color } from '../../../common/color.js';\nimport { mixin } from '../../../common/objects.js';\nimport { CombinedSpliceable } from './splice.js';\nimport { clamp } from '../../../common/numbers.js';\nimport { matchesPrefix } from '../../../common/filters.js';\n\nvar TraitRenderer =\n/** @class */\nfunction () {\n  function TraitRenderer(trait) {\n    this.trait = trait;\n    this.renderedElements = [];\n  }\n\n  Object.defineProperty(TraitRenderer.prototype, \"templateId\", {\n    get: function () {\n      return \"template:\" + this.trait.trait;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  TraitRenderer.prototype.renderTemplate = function (container) {\n    return container;\n  };\n\n  TraitRenderer.prototype.renderElement = function (element, index, templateData) {\n    var renderedElementIndex = firstIndex(this.renderedElements, function (el) {\n      return el.templateData === templateData;\n    });\n\n    if (renderedElementIndex >= 0) {\n      var rendered = this.renderedElements[renderedElementIndex];\n      this.trait.unrender(templateData);\n      rendered.index = index;\n    } else {\n      var rendered = {\n        index: index,\n        templateData: templateData\n      };\n      this.renderedElements.push(rendered);\n    }\n\n    this.trait.renderIndex(index, templateData);\n  };\n\n  TraitRenderer.prototype.splice = function (start, deleteCount, insertCount) {\n    var rendered = [];\n\n    for (var _i = 0, _a = this.renderedElements; _i < _a.length; _i++) {\n      var renderedElement = _a[_i];\n\n      if (renderedElement.index < start) {\n        rendered.push(renderedElement);\n      } else if (renderedElement.index >= start + deleteCount) {\n        rendered.push({\n          index: renderedElement.index + insertCount - deleteCount,\n          templateData: renderedElement.templateData\n        });\n      }\n    }\n\n    this.renderedElements = rendered;\n  };\n\n  TraitRenderer.prototype.renderIndexes = function (indexes) {\n    for (var _i = 0, _a = this.renderedElements; _i < _a.length; _i++) {\n      var _b = _a[_i],\n          index = _b.index,\n          templateData = _b.templateData;\n\n      if (indexes.indexOf(index) > -1) {\n        this.trait.renderIndex(index, templateData);\n      }\n    }\n  };\n\n  TraitRenderer.prototype.disposeTemplate = function (templateData) {\n    var index = firstIndex(this.renderedElements, function (el) {\n      return el.templateData === templateData;\n    });\n\n    if (index < 0) {\n      return;\n    }\n\n    this.renderedElements.splice(index, 1);\n  };\n\n  return TraitRenderer;\n}();\n\nvar Trait =\n/** @class */\nfunction () {\n  function Trait(_trait) {\n    this._trait = _trait;\n    this.indexes = [];\n    this.sortedIndexes = [];\n    this._onChange = new Emitter();\n    this.onChange = this._onChange.event;\n  }\n\n  Object.defineProperty(Trait.prototype, \"trait\", {\n    get: function () {\n      return this._trait;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Trait.prototype, \"renderer\", {\n    get: function () {\n      return new TraitRenderer(this);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Trait.prototype.splice = function (start, deleteCount, elements) {\n    var diff = elements.length - deleteCount;\n    var end = start + deleteCount;\n\n    var indexes = __spreadArrays(this.sortedIndexes.filter(function (i) {\n      return i < start;\n    }), elements.map(function (hasTrait, i) {\n      return hasTrait ? i + start : -1;\n    }).filter(function (i) {\n      return i !== -1;\n    }), this.sortedIndexes.filter(function (i) {\n      return i >= end;\n    }).map(function (i) {\n      return i + diff;\n    }));\n\n    this.renderer.splice(start, deleteCount, elements.length);\n\n    this._set(indexes, indexes);\n  };\n\n  Trait.prototype.renderIndex = function (index, container) {\n    DOM.toggleClass(container, this._trait, this.contains(index));\n  };\n\n  Trait.prototype.unrender = function (container) {\n    DOM.removeClass(container, this._trait);\n  };\n  /**\r\n   * Sets the indexes which should have this trait.\r\n   *\r\n   * @param indexes Indexes which should have this trait.\r\n   * @return The old indexes which had this trait.\r\n   */\n\n\n  Trait.prototype.set = function (indexes, browserEvent) {\n    return this._set(indexes, __spreadArrays(indexes).sort(numericSort), browserEvent);\n  };\n\n  Trait.prototype._set = function (indexes, sortedIndexes, browserEvent) {\n    var result = this.indexes;\n    var sortedResult = this.sortedIndexes;\n    this.indexes = indexes;\n    this.sortedIndexes = sortedIndexes;\n    var toRender = disjunction(sortedResult, indexes);\n    this.renderer.renderIndexes(toRender);\n\n    this._onChange.fire({\n      indexes: indexes,\n      browserEvent: browserEvent\n    });\n\n    return result;\n  };\n\n  Trait.prototype.get = function () {\n    return this.indexes;\n  };\n\n  Trait.prototype.contains = function (index) {\n    return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n  };\n\n  Trait.prototype.dispose = function () {\n    dispose(this._onChange);\n  };\n\n  __decorate([memoize], Trait.prototype, \"renderer\", null);\n\n  return Trait;\n}();\n\nvar FocusTrait =\n/** @class */\nfunction (_super) {\n  __extends(FocusTrait, _super);\n\n  function FocusTrait() {\n    return _super.call(this, 'focused') || this;\n  }\n\n  FocusTrait.prototype.renderIndex = function (index, container) {\n    _super.prototype.renderIndex.call(this, index, container);\n\n    if (this.contains(index)) {\n      container.setAttribute('aria-selected', 'true');\n    } else {\n      container.removeAttribute('aria-selected');\n    }\n  };\n\n  return FocusTrait;\n}(Trait);\n/**\r\n * The TraitSpliceable is used as a util class to be able\r\n * to preserve traits across splice calls, given an identity\r\n * provider.\r\n */\n\n\nvar TraitSpliceable =\n/** @class */\nfunction () {\n  function TraitSpliceable(trait, view, identityProvider) {\n    this.trait = trait;\n    this.view = view;\n    this.identityProvider = identityProvider;\n  }\n\n  TraitSpliceable.prototype.splice = function (start, deleteCount, elements) {\n    var _this = this;\n\n    if (!this.identityProvider) {\n      return this.trait.splice(start, deleteCount, elements.map(function () {\n        return false;\n      }));\n    }\n\n    var pastElementsWithTrait = this.trait.get().map(function (i) {\n      return _this.identityProvider.getId(_this.view.element(i)).toString();\n    });\n    var elementsWithTrait = elements.map(function (e) {\n      return pastElementsWithTrait.indexOf(_this.identityProvider.getId(e).toString()) > -1;\n    });\n    this.trait.splice(start, deleteCount, elementsWithTrait);\n  };\n\n  return TraitSpliceable;\n}();\n\nfunction isInputElement(e) {\n  return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\n\nvar KeyboardController =\n/** @class */\nfunction () {\n  function KeyboardController(list, view, options) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    var multipleSelectionSupport = options.multipleSelectionSupport !== false;\n    this.openController = options.openController || DefaultOpenController;\n    var onKeyDown = Event.chain(domEvent(view.domNode, 'keydown')).filter(function (e) {\n      return !isInputElement(e.target);\n    }).map(function (e) {\n      return new StandardKeyboardEvent(e);\n    });\n    onKeyDown.filter(function (e) {\n      return e.keyCode === 3\n      /* Enter */\n      ;\n    }).on(this.onEnter, this, this.disposables);\n    onKeyDown.filter(function (e) {\n      return e.keyCode === 16\n      /* UpArrow */\n      ;\n    }).on(this.onUpArrow, this, this.disposables);\n    onKeyDown.filter(function (e) {\n      return e.keyCode === 18\n      /* DownArrow */\n      ;\n    }).on(this.onDownArrow, this, this.disposables);\n    onKeyDown.filter(function (e) {\n      return e.keyCode === 11\n      /* PageUp */\n      ;\n    }).on(this.onPageUpArrow, this, this.disposables);\n    onKeyDown.filter(function (e) {\n      return e.keyCode === 12\n      /* PageDown */\n      ;\n    }).on(this.onPageDownArrow, this, this.disposables);\n    onKeyDown.filter(function (e) {\n      return e.keyCode === 9\n      /* Escape */\n      ;\n    }).on(this.onEscape, this, this.disposables);\n\n    if (multipleSelectionSupport) {\n      onKeyDown.filter(function (e) {\n        return (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31\n        /* KEY_A */\n        ;\n      }).on(this.onCtrlA, this, this.disposables);\n    }\n  }\n\n  KeyboardController.prototype.onEnter = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(this.list.getFocus(), e.browserEvent);\n\n    if (this.openController.shouldOpen(e.browserEvent)) {\n      this.list.open(this.list.getFocus(), e.browserEvent);\n    }\n  };\n\n  KeyboardController.prototype.onUpArrow = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPrevious(1, false, e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  };\n\n  KeyboardController.prototype.onDownArrow = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNext(1, false, e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  };\n\n  KeyboardController.prototype.onPageUpArrow = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPreviousPage(e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  };\n\n  KeyboardController.prototype.onPageDownArrow = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNextPage(e.browserEvent);\n    this.list.reveal(this.list.getFocus()[0]);\n    this.view.domNode.focus();\n  };\n\n  KeyboardController.prototype.onCtrlA = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(range(this.list.length), e.browserEvent);\n    this.view.domNode.focus();\n  };\n\n  KeyboardController.prototype.onEscape = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection([], e.browserEvent);\n    this.view.domNode.focus();\n  };\n\n  KeyboardController.prototype.dispose = function () {\n    this.disposables.dispose();\n  };\n\n  return KeyboardController;\n}();\n\nvar TypeLabelControllerState;\n\n(function (TypeLabelControllerState) {\n  TypeLabelControllerState[TypeLabelControllerState[\"Idle\"] = 0] = \"Idle\";\n  TypeLabelControllerState[TypeLabelControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeLabelControllerState || (TypeLabelControllerState = {}));\n\nexport var DefaultKeyboardNavigationDelegate = new (\n/** @class */\nfunction () {\n  function class_1() {}\n\n  class_1.prototype.mightProducePrintableCharacter = function (event) {\n    if (event.ctrlKey || event.metaKey || event.altKey) {\n      return false;\n    }\n\n    return event.keyCode >= 31\n    /* KEY_A */\n    && event.keyCode <= 56\n    /* KEY_Z */\n    || event.keyCode >= 21\n    /* KEY_0 */\n    && event.keyCode <= 30\n    /* KEY_9 */\n    || event.keyCode >= 93\n    /* NUMPAD_0 */\n    && event.keyCode <= 102\n    /* NUMPAD_9 */\n    || event.keyCode >= 80\n    /* US_SEMICOLON */\n    && event.keyCode <= 90\n    /* US_QUOTE */\n    ;\n  };\n\n  return class_1;\n}())();\n\nvar TypeLabelController =\n/** @class */\nfunction () {\n  function TypeLabelController(list, view, keyboardNavigationLabelProvider, delegate) {\n    this.list = list;\n    this.view = view;\n    this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n    this.delegate = delegate;\n    this.enabled = false;\n    this.state = TypeLabelControllerState.Idle;\n    this.automaticKeyboardNavigation = true;\n    this.triggered = false;\n    this.enabledDisposables = new DisposableStore();\n    this.disposables = new DisposableStore();\n    this.updateOptions(list.options);\n  }\n\n  TypeLabelController.prototype.updateOptions = function (options) {\n    var enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\n\n    if (enableKeyboardNavigation) {\n      this.enable();\n    } else {\n      this.disable();\n    }\n\n    if (typeof options.automaticKeyboardNavigation !== 'undefined') {\n      this.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\n    }\n  };\n\n  TypeLabelController.prototype.enable = function () {\n    var _this = this;\n\n    if (this.enabled) {\n      return;\n    }\n\n    var onChar = Event.chain(domEvent(this.view.domNode, 'keydown')).filter(function (e) {\n      return !isInputElement(e.target);\n    }).filter(function () {\n      return _this.automaticKeyboardNavigation || _this.triggered;\n    }).map(function (event) {\n      return new StandardKeyboardEvent(event);\n    }).filter(function (e) {\n      return _this.delegate.mightProducePrintableCharacter(e);\n    }).forEach(function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    }).map(function (event) {\n      return event.browserEvent.key;\n    }).event;\n    var onClear = Event.debounce(onChar, function () {\n      return null;\n    }, 800);\n    var onInput = Event.reduce(Event.any(onChar, onClear), function (r, i) {\n      return i === null ? null : (r || '') + i;\n    });\n    onInput(this.onInput, this, this.enabledDisposables);\n    this.enabled = true;\n    this.triggered = false;\n  };\n\n  TypeLabelController.prototype.disable = function () {\n    if (!this.enabled) {\n      return;\n    }\n\n    this.enabledDisposables.clear();\n    this.enabled = false;\n    this.triggered = false;\n  };\n\n  TypeLabelController.prototype.onInput = function (word) {\n    if (!word) {\n      this.state = TypeLabelControllerState.Idle;\n      this.triggered = false;\n      return;\n    }\n\n    var focus = this.list.getFocus();\n    var start = focus.length > 0 ? focus[0] : 0;\n    var delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\n    this.state = TypeLabelControllerState.Typing;\n\n    for (var i = 0; i < this.list.length; i++) {\n      var index = (start + i + delta) % this.list.length;\n      var label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n      var labelStr = label && label.toString();\n\n      if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n        this.list.setFocus([index]);\n        this.list.reveal(index);\n        return;\n      }\n    }\n  };\n\n  TypeLabelController.prototype.dispose = function () {\n    this.disable();\n    this.enabledDisposables.dispose();\n    this.disposables.dispose();\n  };\n\n  return TypeLabelController;\n}();\n\nvar DOMFocusController =\n/** @class */\nfunction () {\n  function DOMFocusController(list, view) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    var onKeyDown = Event.chain(domEvent(view.domNode, 'keydown')).filter(function (e) {\n      return !isInputElement(e.target);\n    }).map(function (e) {\n      return new StandardKeyboardEvent(e);\n    });\n    onKeyDown.filter(function (e) {\n      return e.keyCode === 2\n      /* Tab */\n      && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey;\n    }).on(this.onTab, this, this.disposables);\n  }\n\n  DOMFocusController.prototype.onTab = function (e) {\n    if (e.target !== this.view.domNode) {\n      return;\n    }\n\n    var focus = this.list.getFocus();\n\n    if (focus.length === 0) {\n      return;\n    }\n\n    var focusedDomElement = this.view.domElement(focus[0]);\n\n    if (!focusedDomElement) {\n      return;\n    }\n\n    var tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n\n    if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\n      return;\n    }\n\n    var style = window.getComputedStyle(tabIndexElement);\n\n    if (style.visibility === 'hidden' || style.display === 'none') {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n    tabIndexElement.focus();\n  };\n\n  DOMFocusController.prototype.dispose = function () {\n    this.disposables.dispose();\n  };\n\n  return DOMFocusController;\n}();\n\nexport function isSelectionSingleChangeEvent(event) {\n  return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexport function isSelectionRangeChangeEvent(event) {\n  return event.browserEvent.shiftKey;\n}\n\nfunction isMouseRightClick(event) {\n  return event instanceof MouseEvent && event.button === 2;\n}\n\nvar DefaultMultipleSelectionController = {\n  isSelectionSingleChangeEvent: isSelectionSingleChangeEvent,\n  isSelectionRangeChangeEvent: isSelectionRangeChangeEvent\n};\nvar DefaultOpenController = {\n  shouldOpen: function (event) {\n    if (event instanceof MouseEvent) {\n      return !isMouseRightClick(event);\n    }\n\n    return true;\n  }\n};\n\nvar MouseController =\n/** @class */\nfunction () {\n  function MouseController(list) {\n    this.list = list;\n    this.disposables = new DisposableStore();\n    this.multipleSelectionSupport = !(list.options.multipleSelectionSupport === false);\n\n    if (this.multipleSelectionSupport) {\n      this.multipleSelectionController = list.options.multipleSelectionController || DefaultMultipleSelectionController;\n    }\n\n    this.openController = list.options.openController || DefaultOpenController;\n    this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n\n    if (this.mouseSupport) {\n      list.onMouseDown(this.onMouseDown, this, this.disposables);\n      list.onContextMenu(this.onContextMenu, this, this.disposables);\n      list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n      list.onTouchStart(this.onMouseDown, this, this.disposables);\n      this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\n    }\n\n    list.onMouseClick(this.onPointer, this, this.disposables);\n    list.onMouseMiddleClick(this.onPointer, this, this.disposables);\n    list.onTap(this.onPointer, this, this.disposables);\n  }\n\n  MouseController.prototype.isSelectionSingleChangeEvent = function (event) {\n    if (this.multipleSelectionController) {\n      return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n    }\n\n    return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n  };\n\n  MouseController.prototype.isSelectionRangeChangeEvent = function (event) {\n    if (this.multipleSelectionController) {\n      return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n    }\n\n    return event.browserEvent.shiftKey;\n  };\n\n  MouseController.prototype.isSelectionChangeEvent = function (event) {\n    return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n  };\n\n  MouseController.prototype.onMouseDown = function (e) {\n    if (document.activeElement !== e.browserEvent.target) {\n      this.list.domFocus();\n    }\n  };\n\n  MouseController.prototype.onContextMenu = function (e) {\n    var focus = typeof e.index === 'undefined' ? [] : [e.index];\n    this.list.setFocus(focus, e.browserEvent);\n  };\n\n  MouseController.prototype.onPointer = function (e) {\n    if (!this.mouseSupport) {\n      return;\n    }\n\n    if (isInputElement(e.browserEvent.target)) {\n      return;\n    }\n\n    var reference = this.list.getFocus()[0];\n    var selection = this.list.getSelection();\n    reference = reference === undefined ? selection[0] : reference;\n    var focus = e.index;\n\n    if (typeof focus === 'undefined') {\n      this.list.setFocus([], e.browserEvent);\n      this.list.setSelection([], e.browserEvent);\n      return;\n    }\n\n    if (this.multipleSelectionSupport && this.isSelectionRangeChangeEvent(e)) {\n      return this.changeSelection(e, reference);\n    }\n\n    if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n      return this.changeSelection(e, reference);\n    }\n\n    this.list.setFocus([focus], e.browserEvent);\n\n    if (!isMouseRightClick(e.browserEvent)) {\n      this.list.setSelection([focus], e.browserEvent);\n\n      if (this.openController.shouldOpen(e.browserEvent)) {\n        this.list.open([focus], e.browserEvent);\n      }\n    }\n  };\n\n  MouseController.prototype.onDoubleClick = function (e) {\n    if (isInputElement(e.browserEvent.target)) {\n      return;\n    }\n\n    if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n      return;\n    }\n\n    var focus = this.list.getFocus();\n    this.list.setSelection(focus, e.browserEvent);\n    this.list.pin(focus);\n  };\n\n  MouseController.prototype.changeSelection = function (e, reference) {\n    var focus = e.index;\n\n    if (this.isSelectionRangeChangeEvent(e) && reference !== undefined) {\n      var min = Math.min(reference, focus);\n      var max = Math.max(reference, focus);\n      var rangeSelection = range(min, max + 1);\n      var selection = this.list.getSelection();\n      var contiguousRange = getContiguousRangeContaining(disjunction(selection, [reference]), reference);\n\n      if (contiguousRange.length === 0) {\n        return;\n      }\n\n      var newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n      this.list.setSelection(newSelection, e.browserEvent);\n    } else if (this.isSelectionSingleChangeEvent(e)) {\n      var selection = this.list.getSelection();\n      var newSelection = selection.filter(function (i) {\n        return i !== focus;\n      });\n      this.list.setFocus([focus]);\n\n      if (selection.length === newSelection.length) {\n        this.list.setSelection(__spreadArrays(newSelection, [focus]), e.browserEvent);\n      } else {\n        this.list.setSelection(newSelection, e.browserEvent);\n      }\n    }\n  };\n\n  MouseController.prototype.dispose = function () {\n    this.disposables.dispose();\n  };\n\n  return MouseController;\n}();\n\nexport { MouseController };\n\nvar DefaultStyleController =\n/** @class */\nfunction () {\n  function DefaultStyleController(styleElement, selectorSuffix) {\n    this.styleElement = styleElement;\n    this.selectorSuffix = selectorSuffix;\n  }\n\n  DefaultStyleController.prototype.style = function (styles) {\n    var suffix = this.selectorSuffix && \".\" + this.selectorSuffix;\n    var content = [];\n\n    if (styles.listBackground) {\n      if (styles.listBackground.isOpaque()) {\n        content.push(\".monaco-list\" + suffix + \" .monaco-list-rows { background: \" + styles.listBackground + \"; }\");\n      } else if (!platform.isMacintosh) {\n        // subpixel AA doesn't exist in macOS\n        console.warn(\"List with id '\" + this.selectorSuffix + \"' was styled with a non-opaque background color. This will break sub-pixel antialiasing.\");\n      }\n    }\n\n    if (styles.listFocusBackground) {\n      content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused { background-color: \" + styles.listFocusBackground + \"; }\");\n      content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused:hover { background-color: \" + styles.listFocusBackground + \"; }\"); // overwrite :hover style in this case!\n    }\n\n    if (styles.listFocusForeground) {\n      content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused { color: \" + styles.listFocusForeground + \"; }\");\n    }\n\n    if (styles.listActiveSelectionBackground) {\n      content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected { background-color: \" + styles.listActiveSelectionBackground + \"; }\");\n      content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected:hover { background-color: \" + styles.listActiveSelectionBackground + \"; }\"); // overwrite :hover style in this case!\n    }\n\n    if (styles.listActiveSelectionForeground) {\n      content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected { color: \" + styles.listActiveSelectionForeground + \"; }\");\n    }\n\n    if (styles.listFocusAndSelectionBackground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.selected.focused { background-color: \" + styles.listFocusAndSelectionBackground + \"; }\\n\\t\\t\\t\");\n    }\n\n    if (styles.listFocusAndSelectionForeground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.selected.focused { color: \" + styles.listFocusAndSelectionForeground + \"; }\\n\\t\\t\\t\");\n    }\n\n    if (styles.listInactiveFocusBackground) {\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused { background-color:  \" + styles.listInactiveFocusBackground + \"; }\");\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused:hover { background-color:  \" + styles.listInactiveFocusBackground + \"; }\"); // overwrite :hover style in this case!\n    }\n\n    if (styles.listInactiveSelectionBackground) {\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { background-color:  \" + styles.listInactiveSelectionBackground + \"; }\");\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected:hover { background-color:  \" + styles.listInactiveSelectionBackground + \"; }\"); // overwrite :hover style in this case!\n    }\n\n    if (styles.listInactiveSelectionForeground) {\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { color: \" + styles.listInactiveSelectionForeground + \"; }\");\n    }\n\n    if (styles.listHoverBackground) {\n      content.push(\".monaco-list\" + suffix + \":not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  \" + styles.listHoverBackground + \"; }\");\n    }\n\n    if (styles.listHoverForeground) {\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row:hover:not(.selected):not(.focused) { color:  \" + styles.listHoverForeground + \"; }\");\n    }\n\n    if (styles.listSelectionOutline) {\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { outline: 1px dotted \" + styles.listSelectionOutline + \"; outline-offset: -1px; }\");\n    }\n\n    if (styles.listFocusOutline) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.focused { outline: 1px solid \" + styles.listFocusOutline + \"; outline-offset: -1px; }\\n\\t\\t\\t\");\n    }\n\n    if (styles.listInactiveFocusOutline) {\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused { outline: 1px dotted \" + styles.listInactiveFocusOutline + \"; outline-offset: -1px; }\");\n    }\n\n    if (styles.listHoverOutline) {\n      content.push(\".monaco-list\" + suffix + \" .monaco-list-row:hover { outline: 1px dashed \" + styles.listHoverOutline + \"; outline-offset: -1px; }\");\n    }\n\n    if (styles.listDropBackground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-list\" + suffix + \".drop-target,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \" .monaco-list-rows.drop-target,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \" .monaco-list-row.drop-target { background-color: \" + styles.listDropBackground + \" !important; color: inherit !important; }\\n\\t\\t\\t\");\n    }\n\n    if (styles.listFilterWidgetBackground) {\n      content.push(\".monaco-list-type-filter { background-color: \" + styles.listFilterWidgetBackground + \" }\");\n    }\n\n    if (styles.listFilterWidgetOutline) {\n      content.push(\".monaco-list-type-filter { border: 1px solid \" + styles.listFilterWidgetOutline + \"; }\");\n    }\n\n    if (styles.listFilterWidgetNoMatchesOutline) {\n      content.push(\".monaco-list-type-filter.no-matches { border: 1px solid \" + styles.listFilterWidgetNoMatchesOutline + \"; }\");\n    }\n\n    if (styles.listMatchesShadow) {\n      content.push(\".monaco-list-type-filter { box-shadow: 1px 1px 1px \" + styles.listMatchesShadow + \"; }\");\n    }\n\n    var newStyles = content.join('\\n');\n\n    if (newStyles !== this.styleElement.innerHTML) {\n      this.styleElement.innerHTML = newStyles;\n    }\n  };\n\n  return DefaultStyleController;\n}();\n\nexport { DefaultStyleController };\nvar defaultStyles = {\n  listFocusBackground: Color.fromHex('#7FB0D0'),\n  listActiveSelectionBackground: Color.fromHex('#0E639C'),\n  listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\n  listFocusAndSelectionBackground: Color.fromHex('#094771'),\n  listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\n  listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\n  listHoverBackground: Color.fromHex('#2A2D2E'),\n  listDropBackground: Color.fromHex('#383B3D'),\n  treeIndentGuidesStroke: Color.fromHex('#a9a9a9')\n};\nvar DefaultOptions = {\n  keyboardSupport: true,\n  mouseSupport: true,\n  multipleSelectionSupport: true,\n  dnd: {\n    getDragURI: function () {\n      return null;\n    },\n    onDragStart: function () {},\n    onDragOver: function () {\n      return false;\n    },\n    drop: function () {}\n  },\n  ariaRootRole: ListAriaRootRole.TREE\n}; // TODO@Joao: move these utils into a SortedArray class\n\nfunction getContiguousRangeContaining(range, value) {\n  var index = range.indexOf(value);\n\n  if (index === -1) {\n    return [];\n  }\n\n  var result = [];\n  var i = index - 1;\n\n  while (i >= 0 && range[i] === value - (index - i)) {\n    result.push(range[i--]);\n  }\n\n  result.reverse();\n  i = index;\n\n  while (i < range.length && range[i] === value + (i - index)) {\n    result.push(range[i++]);\n  }\n\n  return result;\n}\n/**\r\n * Given two sorted collections of numbers, returns the intersection\r\n * between them (OR).\r\n */\n\n\nfunction disjunction(one, other) {\n  var result = [];\n  var i = 0,\n      j = 0;\n\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      result.push(one[i]);\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      result.push(other[j++]);\n    }\n  }\n\n  return result;\n}\n/**\r\n * Given two sorted collections of numbers, returns the relative\r\n * complement between them (XOR).\r\n */\n\n\nfunction relativeComplement(one, other) {\n  var result = [];\n  var i = 0,\n      j = 0;\n\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      j++;\n    }\n  }\n\n  return result;\n}\n\nvar numericSort = function (a, b) {\n  return a - b;\n};\n\nvar PipelineRenderer =\n/** @class */\nfunction () {\n  function PipelineRenderer(_templateId, renderers) {\n    this._templateId = _templateId;\n    this.renderers = renderers;\n  }\n\n  Object.defineProperty(PipelineRenderer.prototype, \"templateId\", {\n    get: function () {\n      return this._templateId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  PipelineRenderer.prototype.renderTemplate = function (container) {\n    return this.renderers.map(function (r) {\n      return r.renderTemplate(container);\n    });\n  };\n\n  PipelineRenderer.prototype.renderElement = function (element, index, templateData, height) {\n    var i = 0;\n\n    for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\n      var renderer = _a[_i];\n      renderer.renderElement(element, index, templateData[i++], height);\n    }\n  };\n\n  PipelineRenderer.prototype.disposeElement = function (element, index, templateData, height) {\n    var i = 0;\n\n    for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\n      var renderer = _a[_i];\n\n      if (renderer.disposeElement) {\n        renderer.disposeElement(element, index, templateData[i], height);\n      }\n\n      i += 1;\n    }\n  };\n\n  PipelineRenderer.prototype.disposeTemplate = function (templateData) {\n    var i = 0;\n\n    for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\n      var renderer = _a[_i];\n      renderer.disposeTemplate(templateData[i++]);\n    }\n  };\n\n  return PipelineRenderer;\n}();\n\nvar AccessibiltyRenderer =\n/** @class */\nfunction () {\n  function AccessibiltyRenderer(accessibilityProvider) {\n    this.accessibilityProvider = accessibilityProvider;\n    this.templateId = 'a18n';\n  }\n\n  AccessibiltyRenderer.prototype.renderTemplate = function (container) {\n    return container;\n  };\n\n  AccessibiltyRenderer.prototype.renderElement = function (element, index, container) {\n    var ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n\n    if (ariaLabel) {\n      container.setAttribute('aria-label', ariaLabel);\n    } else {\n      container.removeAttribute('aria-label');\n    }\n\n    var ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n\n    if (typeof ariaLevel === 'number') {\n      container.setAttribute('aria-level', \"\" + ariaLevel);\n    } else {\n      container.removeAttribute('aria-level');\n    }\n  };\n\n  AccessibiltyRenderer.prototype.disposeTemplate = function (templateData) {// noop\n  };\n\n  return AccessibiltyRenderer;\n}();\n\nvar ListViewDragAndDrop =\n/** @class */\nfunction () {\n  function ListViewDragAndDrop(list, dnd) {\n    this.list = list;\n    this.dnd = dnd;\n  }\n\n  ListViewDragAndDrop.prototype.getDragElements = function (element) {\n    var selection = this.list.getSelectedElements();\n    var elements = selection.indexOf(element) > -1 ? selection : [element];\n    return elements;\n  };\n\n  ListViewDragAndDrop.prototype.getDragURI = function (element) {\n    return this.dnd.getDragURI(element);\n  };\n\n  ListViewDragAndDrop.prototype.getDragLabel = function (elements, originalEvent) {\n    if (this.dnd.getDragLabel) {\n      return this.dnd.getDragLabel(elements, originalEvent);\n    }\n\n    return undefined;\n  };\n\n  ListViewDragAndDrop.prototype.onDragStart = function (data, originalEvent) {\n    if (this.dnd.onDragStart) {\n      this.dnd.onDragStart(data, originalEvent);\n    }\n  };\n\n  ListViewDragAndDrop.prototype.onDragOver = function (data, targetElement, targetIndex, originalEvent) {\n    return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\n  };\n\n  ListViewDragAndDrop.prototype.onDragEnd = function (originalEvent) {\n    if (this.dnd.onDragEnd) {\n      this.dnd.onDragEnd(originalEvent);\n    }\n  };\n\n  ListViewDragAndDrop.prototype.drop = function (data, targetElement, targetIndex, originalEvent) {\n    this.dnd.drop(data, targetElement, targetIndex, originalEvent);\n  };\n\n  return ListViewDragAndDrop;\n}();\n\nvar List =\n/** @class */\nfunction () {\n  function List(user, container, virtualDelegate, renderers, _options) {\n    if (_options === void 0) {\n      _options = DefaultOptions;\n    }\n\n    this.user = user;\n    this._options = _options;\n    this.eventBufferer = new EventBufferer();\n    this.disposables = new DisposableStore();\n    this._onDidOpen = new Emitter();\n    this.onDidOpen = this._onDidOpen.event;\n    this._onDidPin = new Emitter();\n    this.didJustPressContextMenuKey = false;\n    this._onDidDispose = new Emitter();\n    this.onDidDispose = this._onDidDispose.event;\n    this.focus = new FocusTrait();\n    this.selection = new Trait('selected');\n    mixin(_options, defaultStyles, false);\n    var baseRenderers = [this.focus.renderer, this.selection.renderer];\n    this.accessibilityProvider = _options.accessibilityProvider;\n\n    if (this.accessibilityProvider) {\n      baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\n\n      if (this.accessibilityProvider.onDidChangeActiveDescendant) {\n        this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant, this, this.disposables);\n      }\n    }\n\n    renderers = renderers.map(function (r) {\n      return new PipelineRenderer(r.templateId, __spreadArrays(baseRenderers, [r]));\n    });\n\n    var viewOptions = __assign(__assign({}, _options), {\n      dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd)\n    });\n\n    this.view = new ListView(container, virtualDelegate, renderers, viewOptions);\n\n    if (typeof _options.ariaRole !== 'string') {\n      this.view.domNode.setAttribute('role', ListAriaRootRole.TREE);\n    } else {\n      this.view.domNode.setAttribute('role', _options.ariaRole);\n    }\n\n    if (_options.styleController) {\n      this.styleController = _options.styleController(this.view.domId);\n    } else {\n      var styleElement = DOM.createStyleSheet(this.view.domNode);\n      this.styleController = new DefaultStyleController(styleElement, this.view.domId);\n    }\n\n    this.spliceable = new CombinedSpliceable([new TraitSpliceable(this.focus, this.view, _options.identityProvider), new TraitSpliceable(this.selection, this.view, _options.identityProvider), this.view]);\n    this.disposables.add(this.focus);\n    this.disposables.add(this.selection);\n    this.disposables.add(this.view);\n    this.disposables.add(this._onDidDispose);\n    this.onDidFocus = Event.map(domEvent(this.view.domNode, 'focus', true), function () {\n      return null;\n    });\n    this.onDidBlur = Event.map(domEvent(this.view.domNode, 'blur', true), function () {\n      return null;\n    });\n    this.disposables.add(new DOMFocusController(this, this.view));\n\n    if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n      var controller = new KeyboardController(this, this.view, _options);\n      this.disposables.add(controller);\n    }\n\n    if (_options.keyboardNavigationLabelProvider) {\n      var delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\n      this.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider, delegate);\n      this.disposables.add(this.typeLabelController);\n    }\n\n    this.disposables.add(this.createMouseController(_options));\n    this.onFocusChange(this._onFocusChange, this, this.disposables);\n    this.onSelectionChange(this._onSelectionChange, this, this.disposables);\n\n    if (_options.ariaLabel) {\n      this.view.domNode.setAttribute('aria-label', localize('aria list', \"{0}. Use the navigation keys to navigate.\", _options.ariaLabel));\n    }\n  }\n\n  Object.defineProperty(List.prototype, \"onFocusChange\", {\n    get: function () {\n      var _this = this;\n\n      return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), function (e) {\n        return _this.toListEvent(e);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onSelectionChange\", {\n    get: function () {\n      var _this = this;\n\n      return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), function (e) {\n        return _this.toListEvent(e);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"domId\", {\n    get: function () {\n      return this.view.domId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onMouseClick\", {\n    get: function () {\n      return this.view.onMouseClick;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onMouseDblClick\", {\n    get: function () {\n      return this.view.onMouseDblClick;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onMouseMiddleClick\", {\n    get: function () {\n      return this.view.onMouseMiddleClick;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onMouseDown\", {\n    get: function () {\n      return this.view.onMouseDown;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onTouchStart\", {\n    get: function () {\n      return this.view.onTouchStart;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onTap\", {\n    get: function () {\n      return this.view.onTap;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onContextMenu\", {\n    get: function () {\n      var _this = this;\n\n      var fromKeydown = Event.chain(domEvent(this.view.domNode, 'keydown')).map(function (e) {\n        return new StandardKeyboardEvent(e);\n      }).filter(function (e) {\n        return _this.didJustPressContextMenuKey = e.keyCode === 58\n        /* ContextMenu */\n        || e.shiftKey && e.keyCode === 68\n        /* F10 */\n        ;\n      }).filter(function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      }).event;\n      var fromKeyup = Event.chain(domEvent(this.view.domNode, 'keyup')).filter(function () {\n        var didJustPressContextMenuKey = _this.didJustPressContextMenuKey;\n        _this.didJustPressContextMenuKey = false;\n        return didJustPressContextMenuKey;\n      }).filter(function () {\n        return _this.getFocus().length > 0 && !!_this.view.domElement(_this.getFocus()[0]);\n      }).map(function (browserEvent) {\n        var index = _this.getFocus()[0];\n\n        var element = _this.view.element(index);\n\n        var anchor = _this.view.domElement(index);\n\n        return {\n          index: index,\n          element: element,\n          anchor: anchor,\n          browserEvent: browserEvent\n        };\n      }).event;\n      var fromMouse = Event.chain(this.view.onContextMenu).filter(function () {\n        return !_this.didJustPressContextMenuKey;\n      }).map(function (_a) {\n        var element = _a.element,\n            index = _a.index,\n            browserEvent = _a.browserEvent;\n        return {\n          element: element,\n          index: index,\n          anchor: {\n            x: browserEvent.clientX + 1,\n            y: browserEvent.clientY\n          },\n          browserEvent: browserEvent\n        };\n      }).event;\n      return Event.any(fromKeydown, fromKeyup, fromMouse);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"onKeyDown\", {\n    get: function () {\n      return domEvent(this.view.domNode, 'keydown');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  List.prototype.createMouseController = function (options) {\n    return new MouseController(this);\n  };\n\n  List.prototype.updateOptions = function (optionsUpdate) {\n    if (optionsUpdate === void 0) {\n      optionsUpdate = {};\n    }\n\n    this._options = __assign(__assign({}, this._options), optionsUpdate);\n\n    if (this.typeLabelController) {\n      this.typeLabelController.updateOptions(this._options);\n    }\n  };\n\n  Object.defineProperty(List.prototype, \"options\", {\n    get: function () {\n      return this._options;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  List.prototype.splice = function (start, deleteCount, elements) {\n    var _this = this;\n\n    if (elements === void 0) {\n      elements = [];\n    }\n\n    if (start < 0 || start > this.view.length) {\n      throw new ListError(this.user, \"Invalid start index: \" + start);\n    }\n\n    if (deleteCount < 0) {\n      throw new ListError(this.user, \"Invalid delete count: \" + deleteCount);\n    }\n\n    if (deleteCount === 0 && elements.length === 0) {\n      return;\n    }\n\n    this.eventBufferer.bufferEvents(function () {\n      return _this.spliceable.splice(start, deleteCount, elements);\n    });\n  };\n\n  List.prototype.rerender = function () {\n    this.view.rerender();\n  };\n\n  List.prototype.element = function (index) {\n    return this.view.element(index);\n  };\n\n  Object.defineProperty(List.prototype, \"length\", {\n    get: function () {\n      return this.view.length;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"contentHeight\", {\n    get: function () {\n      return this.view.contentHeight;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(List.prototype, \"scrollTop\", {\n    get: function () {\n      return this.view.getScrollTop();\n    },\n    set: function (scrollTop) {\n      this.view.setScrollTop(scrollTop);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  List.prototype.domFocus = function () {\n    this.view.domNode.focus();\n  };\n\n  List.prototype.layout = function (height, width) {\n    this.view.layout(height, width);\n  };\n\n  List.prototype.setSelection = function (indexes, browserEvent) {\n    for (var _i = 0, indexes_1 = indexes; _i < indexes_1.length; _i++) {\n      var index = indexes_1[_i];\n\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \" + index);\n      }\n    }\n\n    this.selection.set(indexes, browserEvent);\n  };\n\n  List.prototype.getSelection = function () {\n    return this.selection.get();\n  };\n\n  List.prototype.getSelectedElements = function () {\n    var _this = this;\n\n    return this.getSelection().map(function (i) {\n      return _this.view.element(i);\n    });\n  };\n\n  List.prototype.setFocus = function (indexes, browserEvent) {\n    for (var _i = 0, indexes_2 = indexes; _i < indexes_2.length; _i++) {\n      var index = indexes_2[_i];\n\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \" + index);\n      }\n    }\n\n    this.focus.set(indexes, browserEvent);\n  };\n\n  List.prototype.focusNext = function (n, loop, browserEvent, filter) {\n    if (n === void 0) {\n      n = 1;\n    }\n\n    if (loop === void 0) {\n      loop = false;\n    }\n\n    if (this.length === 0) {\n      return;\n    }\n\n    var focus = this.focus.get();\n    var index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  };\n\n  List.prototype.focusPrevious = function (n, loop, browserEvent, filter) {\n    if (n === void 0) {\n      n = 1;\n    }\n\n    if (loop === void 0) {\n      loop = false;\n    }\n\n    if (this.length === 0) {\n      return;\n    }\n\n    var focus = this.focus.get();\n    var index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  };\n\n  List.prototype.focusNextPage = function (browserEvent, filter) {\n    var _this = this;\n\n    var lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n    lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n    var lastPageElement = this.view.element(lastPageIndex);\n    var currentlyFocusedElement = this.getFocusedElements()[0];\n\n    if (currentlyFocusedElement !== lastPageElement) {\n      var lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n\n      if (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\n        this.setFocus([lastGoodPageIndex], browserEvent);\n      } else {\n        this.setFocus([lastPageIndex], browserEvent);\n      }\n    } else {\n      var previousScrollTop = this.view.getScrollTop();\n      this.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\n\n      if (this.view.getScrollTop() !== previousScrollTop) {\n        // Let the scroll event listener run\n        setTimeout(function () {\n          return _this.focusNextPage(browserEvent, filter);\n        }, 0);\n      }\n    }\n  };\n\n  List.prototype.focusPreviousPage = function (browserEvent, filter) {\n    var _this = this;\n\n    var firstPageIndex;\n    var scrollTop = this.view.getScrollTop();\n\n    if (scrollTop === 0) {\n      firstPageIndex = this.view.indexAt(scrollTop);\n    } else {\n      firstPageIndex = this.view.indexAfter(scrollTop - 1);\n    }\n\n    var firstPageElement = this.view.element(firstPageIndex);\n    var currentlyFocusedElement = this.getFocusedElements()[0];\n\n    if (currentlyFocusedElement !== firstPageElement) {\n      var firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n\n      if (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\n        this.setFocus([firstGoodPageIndex], browserEvent);\n      } else {\n        this.setFocus([firstPageIndex], browserEvent);\n      }\n    } else {\n      var previousScrollTop = scrollTop;\n      this.view.setScrollTop(scrollTop - this.view.renderHeight);\n\n      if (this.view.getScrollTop() !== previousScrollTop) {\n        // Let the scroll event listener run\n        setTimeout(function () {\n          return _this.focusPreviousPage(browserEvent, filter);\n        }, 0);\n      }\n    }\n  };\n\n  List.prototype.focusLast = function (browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n\n    var index = this.findPreviousIndex(this.length - 1, false, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  };\n\n  List.prototype.focusFirst = function (browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n\n    var index = this.findNextIndex(0, false, filter);\n\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  };\n\n  List.prototype.findNextIndex = function (index, loop, filter) {\n    if (loop === void 0) {\n      loop = false;\n    }\n\n    for (var i = 0; i < this.length; i++) {\n      if (index >= this.length && !loop) {\n        return -1;\n      }\n\n      index = index % this.length;\n\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n\n      index++;\n    }\n\n    return -1;\n  };\n\n  List.prototype.findPreviousIndex = function (index, loop, filter) {\n    if (loop === void 0) {\n      loop = false;\n    }\n\n    for (var i = 0; i < this.length; i++) {\n      if (index < 0 && !loop) {\n        return -1;\n      }\n\n      index = (this.length + index % this.length) % this.length;\n\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n\n      index--;\n    }\n\n    return -1;\n  };\n\n  List.prototype.getFocus = function () {\n    return this.focus.get();\n  };\n\n  List.prototype.getFocusedElements = function () {\n    var _this = this;\n\n    return this.getFocus().map(function (i) {\n      return _this.view.element(i);\n    });\n  };\n\n  List.prototype.reveal = function (index, relativeTop) {\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, \"Invalid index \" + index);\n    }\n\n    var scrollTop = this.view.getScrollTop();\n    var elementTop = this.view.elementTop(index);\n    var elementHeight = this.view.elementHeight(index);\n\n    if (isNumber(relativeTop)) {\n      // y = mx + b\n      var m = elementHeight - this.view.renderHeight;\n      this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\n    } else {\n      var viewItemBottom = elementTop + elementHeight;\n      var wrapperBottom = scrollTop + this.view.renderHeight;\n\n      if (elementTop < scrollTop && viewItemBottom >= wrapperBottom) {// The element is already overflowing the viewport, no-op\n      } else if (elementTop < scrollTop) {\n        this.view.setScrollTop(elementTop);\n      } else if (viewItemBottom >= wrapperBottom) {\n        this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n      }\n    }\n  };\n  /**\r\n   * Returns the relative position of an element rendered in the list.\r\n   * Returns `null` if the element isn't *entirely* in the visible viewport.\r\n   */\n\n\n  List.prototype.getRelativeTop = function (index) {\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, \"Invalid index \" + index);\n    }\n\n    var scrollTop = this.view.getScrollTop();\n    var elementTop = this.view.elementTop(index);\n    var elementHeight = this.view.elementHeight(index);\n\n    if (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n      return null;\n    } // y = mx + b\n\n\n    var m = elementHeight - this.view.renderHeight;\n    return Math.abs((scrollTop - elementTop) / m);\n  };\n\n  List.prototype.getHTMLElement = function () {\n    return this.view.domNode;\n  };\n\n  List.prototype.open = function (indexes, browserEvent) {\n    var _this = this;\n\n    for (var _i = 0, indexes_3 = indexes; _i < indexes_3.length; _i++) {\n      var index = indexes_3[_i];\n\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \" + index);\n      }\n    }\n\n    this._onDidOpen.fire({\n      indexes: indexes,\n      elements: indexes.map(function (i) {\n        return _this.view.element(i);\n      }),\n      browserEvent: browserEvent\n    });\n  };\n\n  List.prototype.pin = function (indexes, browserEvent) {\n    var _this = this;\n\n    for (var _i = 0, indexes_4 = indexes; _i < indexes_4.length; _i++) {\n      var index = indexes_4[_i];\n\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \" + index);\n      }\n    }\n\n    this._onDidPin.fire({\n      indexes: indexes,\n      elements: indexes.map(function (i) {\n        return _this.view.element(i);\n      }),\n      browserEvent: browserEvent\n    });\n  };\n\n  List.prototype.style = function (styles) {\n    this.styleController.style(styles);\n  };\n\n  List.prototype.toListEvent = function (_a) {\n    var _this = this;\n\n    var indexes = _a.indexes,\n        browserEvent = _a.browserEvent;\n    return {\n      indexes: indexes,\n      elements: indexes.map(function (i) {\n        return _this.view.element(i);\n      }),\n      browserEvent: browserEvent\n    };\n  };\n\n  List.prototype._onFocusChange = function () {\n    var focus = this.focus.get();\n    DOM.toggleClass(this.view.domNode, 'element-focused', focus.length > 0);\n    this.onDidChangeActiveDescendant();\n  };\n\n  List.prototype.onDidChangeActiveDescendant = function () {\n    var _a;\n\n    var focus = this.focus.get();\n\n    if (focus.length > 0) {\n      var id = void 0;\n\n      if ((_a = this.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getActiveDescendantId) {\n        id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\n      }\n\n      this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\n    } else {\n      this.view.domNode.removeAttribute('aria-activedescendant');\n    }\n  };\n\n  List.prototype._onSelectionChange = function () {\n    var selection = this.selection.get();\n    DOM.toggleClass(this.view.domNode, 'selection-none', selection.length === 0);\n    DOM.toggleClass(this.view.domNode, 'selection-single', selection.length === 1);\n    DOM.toggleClass(this.view.domNode, 'selection-multiple', selection.length > 1);\n  };\n\n  List.prototype.dispose = function () {\n    this._onDidDispose.fire();\n\n    this.disposables.dispose();\n\n    this._onDidOpen.dispose();\n\n    this._onDidPin.dispose();\n\n    this._onDidDispose.dispose();\n  };\n\n  __decorate([memoize], List.prototype, \"onFocusChange\", null);\n\n  __decorate([memoize], List.prototype, \"onSelectionChange\", null);\n\n  __decorate([memoize], List.prototype, \"onContextMenu\", null);\n\n  return List;\n}();\n\nexport { List };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listWidget.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__spreadArrays","il","k","a","j","jl","localize","dispose","DisposableStore","isNumber","range","firstIndex","binarySearch","memoize","DOM","platform","Gesture","StandardKeyboardEvent","Event","Emitter","EventBufferer","domEvent","ListAriaRootRole","ListError","ListView","Color","mixin","CombinedSpliceable","clamp","matchesPrefix","TraitRenderer","trait","renderedElements","get","enumerable","configurable","renderTemplate","container","renderElement","element","index","templateData","renderedElementIndex","el","rendered","unrender","push","renderIndex","splice","start","deleteCount","insertCount","_i","_a","renderedElement","renderIndexes","indexes","_b","indexOf","disposeTemplate","Trait","_trait","sortedIndexes","_onChange","onChange","event","elements","diff","end","filter","map","hasTrait","renderer","_set","toggleClass","contains","removeClass","set","browserEvent","sort","numericSort","result","sortedResult","toRender","disjunction","fire","FocusTrait","_super","setAttribute","removeAttribute","TraitSpliceable","view","identityProvider","_this","pastElementsWithTrait","getId","toString","elementsWithTrait","e","isInputElement","tagName","KeyboardController","list","options","disposables","multipleSelectionSupport","openController","DefaultOpenController","onKeyDown","chain","domNode","keyCode","on","onEnter","onUpArrow","onDownArrow","onPageUpArrow","onPageDownArrow","onEscape","isMacintosh","metaKey","ctrlKey","onCtrlA","preventDefault","stopPropagation","setSelection","getFocus","shouldOpen","open","focusPrevious","reveal","focus","focusNext","focusPreviousPage","focusNextPage","TypeLabelControllerState","DefaultKeyboardNavigationDelegate","class_1","mightProducePrintableCharacter","altKey","TypeLabelController","keyboardNavigationLabelProvider","delegate","enabled","state","Idle","automaticKeyboardNavigation","triggered","enabledDisposables","updateOptions","enableKeyboardNavigation","enable","disable","onChar","forEach","onClear","debounce","onInput","reduce","any","clear","word","delta","Typing","label","getKeyboardNavigationLabel","labelStr","setFocus","DOMFocusController","shiftKey","onTab","focusedDomElement","domElement","tabIndexElement","querySelector","HTMLElement","tabIndex","style","window","getComputedStyle","visibility","display","isSelectionSingleChangeEvent","isSelectionRangeChangeEvent","isMouseRightClick","MouseEvent","button","DefaultMultipleSelectionController","MouseController","multipleSelectionController","mouseSupport","onMouseDown","onContextMenu","onMouseDblClick","onDoubleClick","onTouchStart","add","addTarget","getHTMLElement","onMouseClick","onPointer","onMouseMiddleClick","onTap","isSelectionChangeEvent","document","activeElement","domFocus","reference","selection","getSelection","undefined","changeSelection","pin","min","Math","max","rangeSelection","contiguousRange","getContiguousRangeContaining","newSelection","relativeComplement","DefaultStyleController","styleElement","selectorSuffix","styles","suffix","content","listBackground","isOpaque","console","warn","listFocusBackground","listFocusForeground","listActiveSelectionBackground","listActiveSelectionForeground","listFocusAndSelectionBackground","listFocusAndSelectionForeground","listInactiveFocusBackground","listInactiveSelectionBackground","listInactiveSelectionForeground","listHoverBackground","listHoverForeground","listSelectionOutline","listFocusOutline","listInactiveFocusOutline","listHoverOutline","listDropBackground","listFilterWidgetBackground","listFilterWidgetOutline","listFilterWidgetNoMatchesOutline","listMatchesShadow","newStyles","join","innerHTML","defaultStyles","fromHex","treeIndentGuidesStroke","DefaultOptions","keyboardSupport","dnd","getDragURI","onDragStart","onDragOver","drop","ariaRootRole","TREE","value","reverse","one","other","PipelineRenderer","_templateId","renderers","height","disposeElement","AccessibiltyRenderer","accessibilityProvider","templateId","ariaLabel","getAriaLabel","ariaLevel","getAriaLevel","ListViewDragAndDrop","getDragElements","getSelectedElements","getDragLabel","originalEvent","data","targetElement","targetIndex","onDragEnd","List","user","virtualDelegate","_options","eventBufferer","_onDidOpen","onDidOpen","_onDidPin","didJustPressContextMenuKey","_onDidDispose","onDidDispose","baseRenderers","onDidChangeActiveDescendant","viewOptions","ariaRole","styleController","domId","createStyleSheet","spliceable","onDidFocus","onDidBlur","controller","keyboardNavigationDelegate","typeLabelController","createMouseController","onFocusChange","_onFocusChange","onSelectionChange","_onSelectionChange","wrapEvent","toListEvent","fromKeydown","fromKeyup","anchor","fromMouse","x","clientX","y","clientY","optionsUpdate","bufferEvents","rerender","contentHeight","getScrollTop","scrollTop","setScrollTop","layout","width","indexes_1","indexes_2","loop","findNextIndex","findPreviousIndex","lastPageIndex","indexAt","renderHeight","lastPageElement","currentlyFocusedElement","getFocusedElements","lastGoodPageIndex","previousScrollTop","elementHeight","setTimeout","firstPageIndex","indexAfter","firstPageElement","firstGoodPageIndex","focusLast","focusFirst","relativeTop","elementTop","m","viewItemBottom","wrapperBottom","getRelativeTop","abs","indexes_3","indexes_4","id","getActiveDescendantId","getElementDomId"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport './list.css';\r\nimport { localize } from '../../../../nls.js';\r\nimport { dispose, DisposableStore } from '../../../common/lifecycle.js';\r\nimport { isNumber } from '../../../common/types.js';\r\nimport { range, firstIndex, binarySearch } from '../../../common/arrays.js';\r\nimport { memoize } from '../../../common/decorators.js';\r\nimport * as DOM from '../../dom.js';\r\nimport * as platform from '../../../common/platform.js';\r\nimport { Gesture } from '../../touch.js';\r\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\r\nimport { Event, Emitter, EventBufferer } from '../../../common/event.js';\r\nimport { domEvent } from '../../event.js';\r\nimport { ListAriaRootRole, ListError } from './list.js';\r\nimport { ListView } from './listView.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { CombinedSpliceable } from './splice.js';\r\nimport { clamp } from '../../../common/numbers.js';\r\nimport { matchesPrefix } from '../../../common/filters.js';\r\nvar TraitRenderer = /** @class */ (function () {\r\n    function TraitRenderer(trait) {\r\n        this.trait = trait;\r\n        this.renderedElements = [];\r\n    }\r\n    Object.defineProperty(TraitRenderer.prototype, \"templateId\", {\r\n        get: function () {\r\n            return \"template:\" + this.trait.trait;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    TraitRenderer.prototype.renderTemplate = function (container) {\r\n        return container;\r\n    };\r\n    TraitRenderer.prototype.renderElement = function (element, index, templateData) {\r\n        var renderedElementIndex = firstIndex(this.renderedElements, function (el) { return el.templateData === templateData; });\r\n        if (renderedElementIndex >= 0) {\r\n            var rendered = this.renderedElements[renderedElementIndex];\r\n            this.trait.unrender(templateData);\r\n            rendered.index = index;\r\n        }\r\n        else {\r\n            var rendered = { index: index, templateData: templateData };\r\n            this.renderedElements.push(rendered);\r\n        }\r\n        this.trait.renderIndex(index, templateData);\r\n    };\r\n    TraitRenderer.prototype.splice = function (start, deleteCount, insertCount) {\r\n        var rendered = [];\r\n        for (var _i = 0, _a = this.renderedElements; _i < _a.length; _i++) {\r\n            var renderedElement = _a[_i];\r\n            if (renderedElement.index < start) {\r\n                rendered.push(renderedElement);\r\n            }\r\n            else if (renderedElement.index >= start + deleteCount) {\r\n                rendered.push({\r\n                    index: renderedElement.index + insertCount - deleteCount,\r\n                    templateData: renderedElement.templateData\r\n                });\r\n            }\r\n        }\r\n        this.renderedElements = rendered;\r\n    };\r\n    TraitRenderer.prototype.renderIndexes = function (indexes) {\r\n        for (var _i = 0, _a = this.renderedElements; _i < _a.length; _i++) {\r\n            var _b = _a[_i], index = _b.index, templateData = _b.templateData;\r\n            if (indexes.indexOf(index) > -1) {\r\n                this.trait.renderIndex(index, templateData);\r\n            }\r\n        }\r\n    };\r\n    TraitRenderer.prototype.disposeTemplate = function (templateData) {\r\n        var index = firstIndex(this.renderedElements, function (el) { return el.templateData === templateData; });\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n        this.renderedElements.splice(index, 1);\r\n    };\r\n    return TraitRenderer;\r\n}());\r\nvar Trait = /** @class */ (function () {\r\n    function Trait(_trait) {\r\n        this._trait = _trait;\r\n        this.indexes = [];\r\n        this.sortedIndexes = [];\r\n        this._onChange = new Emitter();\r\n        this.onChange = this._onChange.event;\r\n    }\r\n    Object.defineProperty(Trait.prototype, \"trait\", {\r\n        get: function () { return this._trait; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Trait.prototype, \"renderer\", {\r\n        get: function () {\r\n            return new TraitRenderer(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Trait.prototype.splice = function (start, deleteCount, elements) {\r\n        var diff = elements.length - deleteCount;\r\n        var end = start + deleteCount;\r\n        var indexes = __spreadArrays(this.sortedIndexes.filter(function (i) { return i < start; }), elements.map(function (hasTrait, i) { return hasTrait ? i + start : -1; }).filter(function (i) { return i !== -1; }), this.sortedIndexes.filter(function (i) { return i >= end; }).map(function (i) { return i + diff; }));\r\n        this.renderer.splice(start, deleteCount, elements.length);\r\n        this._set(indexes, indexes);\r\n    };\r\n    Trait.prototype.renderIndex = function (index, container) {\r\n        DOM.toggleClass(container, this._trait, this.contains(index));\r\n    };\r\n    Trait.prototype.unrender = function (container) {\r\n        DOM.removeClass(container, this._trait);\r\n    };\r\n    /**\r\n     * Sets the indexes which should have this trait.\r\n     *\r\n     * @param indexes Indexes which should have this trait.\r\n     * @return The old indexes which had this trait.\r\n     */\r\n    Trait.prototype.set = function (indexes, browserEvent) {\r\n        return this._set(indexes, __spreadArrays(indexes).sort(numericSort), browserEvent);\r\n    };\r\n    Trait.prototype._set = function (indexes, sortedIndexes, browserEvent) {\r\n        var result = this.indexes;\r\n        var sortedResult = this.sortedIndexes;\r\n        this.indexes = indexes;\r\n        this.sortedIndexes = sortedIndexes;\r\n        var toRender = disjunction(sortedResult, indexes);\r\n        this.renderer.renderIndexes(toRender);\r\n        this._onChange.fire({ indexes: indexes, browserEvent: browserEvent });\r\n        return result;\r\n    };\r\n    Trait.prototype.get = function () {\r\n        return this.indexes;\r\n    };\r\n    Trait.prototype.contains = function (index) {\r\n        return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\r\n    };\r\n    Trait.prototype.dispose = function () {\r\n        dispose(this._onChange);\r\n    };\r\n    __decorate([\r\n        memoize\r\n    ], Trait.prototype, \"renderer\", null);\r\n    return Trait;\r\n}());\r\nvar FocusTrait = /** @class */ (function (_super) {\r\n    __extends(FocusTrait, _super);\r\n    function FocusTrait() {\r\n        return _super.call(this, 'focused') || this;\r\n    }\r\n    FocusTrait.prototype.renderIndex = function (index, container) {\r\n        _super.prototype.renderIndex.call(this, index, container);\r\n        if (this.contains(index)) {\r\n            container.setAttribute('aria-selected', 'true');\r\n        }\r\n        else {\r\n            container.removeAttribute('aria-selected');\r\n        }\r\n    };\r\n    return FocusTrait;\r\n}(Trait));\r\n/**\r\n * The TraitSpliceable is used as a util class to be able\r\n * to preserve traits across splice calls, given an identity\r\n * provider.\r\n */\r\nvar TraitSpliceable = /** @class */ (function () {\r\n    function TraitSpliceable(trait, view, identityProvider) {\r\n        this.trait = trait;\r\n        this.view = view;\r\n        this.identityProvider = identityProvider;\r\n    }\r\n    TraitSpliceable.prototype.splice = function (start, deleteCount, elements) {\r\n        var _this = this;\r\n        if (!this.identityProvider) {\r\n            return this.trait.splice(start, deleteCount, elements.map(function () { return false; }));\r\n        }\r\n        var pastElementsWithTrait = this.trait.get().map(function (i) { return _this.identityProvider.getId(_this.view.element(i)).toString(); });\r\n        var elementsWithTrait = elements.map(function (e) { return pastElementsWithTrait.indexOf(_this.identityProvider.getId(e).toString()) > -1; });\r\n        this.trait.splice(start, deleteCount, elementsWithTrait);\r\n    };\r\n    return TraitSpliceable;\r\n}());\r\nfunction isInputElement(e) {\r\n    return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\r\n}\r\nvar KeyboardController = /** @class */ (function () {\r\n    function KeyboardController(list, view, options) {\r\n        this.list = list;\r\n        this.view = view;\r\n        this.disposables = new DisposableStore();\r\n        var multipleSelectionSupport = options.multipleSelectionSupport !== false;\r\n        this.openController = options.openController || DefaultOpenController;\r\n        var onKeyDown = Event.chain(domEvent(view.domNode, 'keydown'))\r\n            .filter(function (e) { return !isInputElement(e.target); })\r\n            .map(function (e) { return new StandardKeyboardEvent(e); });\r\n        onKeyDown.filter(function (e) { return e.keyCode === 3 /* Enter */; }).on(this.onEnter, this, this.disposables);\r\n        onKeyDown.filter(function (e) { return e.keyCode === 16 /* UpArrow */; }).on(this.onUpArrow, this, this.disposables);\r\n        onKeyDown.filter(function (e) { return e.keyCode === 18 /* DownArrow */; }).on(this.onDownArrow, this, this.disposables);\r\n        onKeyDown.filter(function (e) { return e.keyCode === 11 /* PageUp */; }).on(this.onPageUpArrow, this, this.disposables);\r\n        onKeyDown.filter(function (e) { return e.keyCode === 12 /* PageDown */; }).on(this.onPageDownArrow, this, this.disposables);\r\n        onKeyDown.filter(function (e) { return e.keyCode === 9 /* Escape */; }).on(this.onEscape, this, this.disposables);\r\n        if (multipleSelectionSupport) {\r\n            onKeyDown.filter(function (e) { return (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31 /* KEY_A */; }).on(this.onCtrlA, this, this.disposables);\r\n        }\r\n    }\r\n    KeyboardController.prototype.onEnter = function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.setSelection(this.list.getFocus(), e.browserEvent);\r\n        if (this.openController.shouldOpen(e.browserEvent)) {\r\n            this.list.open(this.list.getFocus(), e.browserEvent);\r\n        }\r\n    };\r\n    KeyboardController.prototype.onUpArrow = function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusPrevious(1, false, e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    };\r\n    KeyboardController.prototype.onDownArrow = function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusNext(1, false, e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    };\r\n    KeyboardController.prototype.onPageUpArrow = function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusPreviousPage(e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    };\r\n    KeyboardController.prototype.onPageDownArrow = function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.focusNextPage(e.browserEvent);\r\n        this.list.reveal(this.list.getFocus()[0]);\r\n        this.view.domNode.focus();\r\n    };\r\n    KeyboardController.prototype.onCtrlA = function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.setSelection(range(this.list.length), e.browserEvent);\r\n        this.view.domNode.focus();\r\n    };\r\n    KeyboardController.prototype.onEscape = function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.list.setSelection([], e.browserEvent);\r\n        this.view.domNode.focus();\r\n    };\r\n    KeyboardController.prototype.dispose = function () {\r\n        this.disposables.dispose();\r\n    };\r\n    return KeyboardController;\r\n}());\r\nvar TypeLabelControllerState;\r\n(function (TypeLabelControllerState) {\r\n    TypeLabelControllerState[TypeLabelControllerState[\"Idle\"] = 0] = \"Idle\";\r\n    TypeLabelControllerState[TypeLabelControllerState[\"Typing\"] = 1] = \"Typing\";\r\n})(TypeLabelControllerState || (TypeLabelControllerState = {}));\r\nexport var DefaultKeyboardNavigationDelegate = new /** @class */ (function () {\r\n    function class_1() {\r\n    }\r\n    class_1.prototype.mightProducePrintableCharacter = function (event) {\r\n        if (event.ctrlKey || event.metaKey || event.altKey) {\r\n            return false;\r\n        }\r\n        return (event.keyCode >= 31 /* KEY_A */ && event.keyCode <= 56 /* KEY_Z */)\r\n            || (event.keyCode >= 21 /* KEY_0 */ && event.keyCode <= 30 /* KEY_9 */)\r\n            || (event.keyCode >= 93 /* NUMPAD_0 */ && event.keyCode <= 102 /* NUMPAD_9 */)\r\n            || (event.keyCode >= 80 /* US_SEMICOLON */ && event.keyCode <= 90 /* US_QUOTE */);\r\n    };\r\n    return class_1;\r\n}());\r\nvar TypeLabelController = /** @class */ (function () {\r\n    function TypeLabelController(list, view, keyboardNavigationLabelProvider, delegate) {\r\n        this.list = list;\r\n        this.view = view;\r\n        this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\r\n        this.delegate = delegate;\r\n        this.enabled = false;\r\n        this.state = TypeLabelControllerState.Idle;\r\n        this.automaticKeyboardNavigation = true;\r\n        this.triggered = false;\r\n        this.enabledDisposables = new DisposableStore();\r\n        this.disposables = new DisposableStore();\r\n        this.updateOptions(list.options);\r\n    }\r\n    TypeLabelController.prototype.updateOptions = function (options) {\r\n        var enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\r\n        if (enableKeyboardNavigation) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n        if (typeof options.automaticKeyboardNavigation !== 'undefined') {\r\n            this.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\r\n        }\r\n    };\r\n    TypeLabelController.prototype.enable = function () {\r\n        var _this = this;\r\n        if (this.enabled) {\r\n            return;\r\n        }\r\n        var onChar = Event.chain(domEvent(this.view.domNode, 'keydown'))\r\n            .filter(function (e) { return !isInputElement(e.target); })\r\n            .filter(function () { return _this.automaticKeyboardNavigation || _this.triggered; })\r\n            .map(function (event) { return new StandardKeyboardEvent(event); })\r\n            .filter(function (e) { return _this.delegate.mightProducePrintableCharacter(e); })\r\n            .forEach(function (e) { e.stopPropagation(); e.preventDefault(); })\r\n            .map(function (event) { return event.browserEvent.key; })\r\n            .event;\r\n        var onClear = Event.debounce(onChar, function () { return null; }, 800);\r\n        var onInput = Event.reduce(Event.any(onChar, onClear), function (r, i) { return i === null ? null : ((r || '') + i); });\r\n        onInput(this.onInput, this, this.enabledDisposables);\r\n        this.enabled = true;\r\n        this.triggered = false;\r\n    };\r\n    TypeLabelController.prototype.disable = function () {\r\n        if (!this.enabled) {\r\n            return;\r\n        }\r\n        this.enabledDisposables.clear();\r\n        this.enabled = false;\r\n        this.triggered = false;\r\n    };\r\n    TypeLabelController.prototype.onInput = function (word) {\r\n        if (!word) {\r\n            this.state = TypeLabelControllerState.Idle;\r\n            this.triggered = false;\r\n            return;\r\n        }\r\n        var focus = this.list.getFocus();\r\n        var start = focus.length > 0 ? focus[0] : 0;\r\n        var delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\r\n        this.state = TypeLabelControllerState.Typing;\r\n        for (var i = 0; i < this.list.length; i++) {\r\n            var index = (start + i + delta) % this.list.length;\r\n            var label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\r\n            var labelStr = label && label.toString();\r\n            if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\r\n                this.list.setFocus([index]);\r\n                this.list.reveal(index);\r\n                return;\r\n            }\r\n        }\r\n    };\r\n    TypeLabelController.prototype.dispose = function () {\r\n        this.disable();\r\n        this.enabledDisposables.dispose();\r\n        this.disposables.dispose();\r\n    };\r\n    return TypeLabelController;\r\n}());\r\nvar DOMFocusController = /** @class */ (function () {\r\n    function DOMFocusController(list, view) {\r\n        this.list = list;\r\n        this.view = view;\r\n        this.disposables = new DisposableStore();\r\n        var onKeyDown = Event.chain(domEvent(view.domNode, 'keydown'))\r\n            .filter(function (e) { return !isInputElement(e.target); })\r\n            .map(function (e) { return new StandardKeyboardEvent(e); });\r\n        onKeyDown.filter(function (e) { return e.keyCode === 2 /* Tab */ && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey; })\r\n            .on(this.onTab, this, this.disposables);\r\n    }\r\n    DOMFocusController.prototype.onTab = function (e) {\r\n        if (e.target !== this.view.domNode) {\r\n            return;\r\n        }\r\n        var focus = this.list.getFocus();\r\n        if (focus.length === 0) {\r\n            return;\r\n        }\r\n        var focusedDomElement = this.view.domElement(focus[0]);\r\n        if (!focusedDomElement) {\r\n            return;\r\n        }\r\n        var tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\r\n        if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\r\n            return;\r\n        }\r\n        var style = window.getComputedStyle(tabIndexElement);\r\n        if (style.visibility === 'hidden' || style.display === 'none') {\r\n            return;\r\n        }\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        tabIndexElement.focus();\r\n    };\r\n    DOMFocusController.prototype.dispose = function () {\r\n        this.disposables.dispose();\r\n    };\r\n    return DOMFocusController;\r\n}());\r\nexport function isSelectionSingleChangeEvent(event) {\r\n    return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\r\n}\r\nexport function isSelectionRangeChangeEvent(event) {\r\n    return event.browserEvent.shiftKey;\r\n}\r\nfunction isMouseRightClick(event) {\r\n    return event instanceof MouseEvent && event.button === 2;\r\n}\r\nvar DefaultMultipleSelectionController = {\r\n    isSelectionSingleChangeEvent: isSelectionSingleChangeEvent,\r\n    isSelectionRangeChangeEvent: isSelectionRangeChangeEvent\r\n};\r\nvar DefaultOpenController = {\r\n    shouldOpen: function (event) {\r\n        if (event instanceof MouseEvent) {\r\n            return !isMouseRightClick(event);\r\n        }\r\n        return true;\r\n    }\r\n};\r\nvar MouseController = /** @class */ (function () {\r\n    function MouseController(list) {\r\n        this.list = list;\r\n        this.disposables = new DisposableStore();\r\n        this.multipleSelectionSupport = !(list.options.multipleSelectionSupport === false);\r\n        if (this.multipleSelectionSupport) {\r\n            this.multipleSelectionController = list.options.multipleSelectionController || DefaultMultipleSelectionController;\r\n        }\r\n        this.openController = list.options.openController || DefaultOpenController;\r\n        this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\r\n        if (this.mouseSupport) {\r\n            list.onMouseDown(this.onMouseDown, this, this.disposables);\r\n            list.onContextMenu(this.onContextMenu, this, this.disposables);\r\n            list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\r\n            list.onTouchStart(this.onMouseDown, this, this.disposables);\r\n            this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\r\n        }\r\n        list.onMouseClick(this.onPointer, this, this.disposables);\r\n        list.onMouseMiddleClick(this.onPointer, this, this.disposables);\r\n        list.onTap(this.onPointer, this, this.disposables);\r\n    }\r\n    MouseController.prototype.isSelectionSingleChangeEvent = function (event) {\r\n        if (this.multipleSelectionController) {\r\n            return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\r\n        }\r\n        return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\r\n    };\r\n    MouseController.prototype.isSelectionRangeChangeEvent = function (event) {\r\n        if (this.multipleSelectionController) {\r\n            return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\r\n        }\r\n        return event.browserEvent.shiftKey;\r\n    };\r\n    MouseController.prototype.isSelectionChangeEvent = function (event) {\r\n        return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\r\n    };\r\n    MouseController.prototype.onMouseDown = function (e) {\r\n        if (document.activeElement !== e.browserEvent.target) {\r\n            this.list.domFocus();\r\n        }\r\n    };\r\n    MouseController.prototype.onContextMenu = function (e) {\r\n        var focus = typeof e.index === 'undefined' ? [] : [e.index];\r\n        this.list.setFocus(focus, e.browserEvent);\r\n    };\r\n    MouseController.prototype.onPointer = function (e) {\r\n        if (!this.mouseSupport) {\r\n            return;\r\n        }\r\n        if (isInputElement(e.browserEvent.target)) {\r\n            return;\r\n        }\r\n        var reference = this.list.getFocus()[0];\r\n        var selection = this.list.getSelection();\r\n        reference = reference === undefined ? selection[0] : reference;\r\n        var focus = e.index;\r\n        if (typeof focus === 'undefined') {\r\n            this.list.setFocus([], e.browserEvent);\r\n            this.list.setSelection([], e.browserEvent);\r\n            return;\r\n        }\r\n        if (this.multipleSelectionSupport && this.isSelectionRangeChangeEvent(e)) {\r\n            return this.changeSelection(e, reference);\r\n        }\r\n        if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\r\n            return this.changeSelection(e, reference);\r\n        }\r\n        this.list.setFocus([focus], e.browserEvent);\r\n        if (!isMouseRightClick(e.browserEvent)) {\r\n            this.list.setSelection([focus], e.browserEvent);\r\n            if (this.openController.shouldOpen(e.browserEvent)) {\r\n                this.list.open([focus], e.browserEvent);\r\n            }\r\n        }\r\n    };\r\n    MouseController.prototype.onDoubleClick = function (e) {\r\n        if (isInputElement(e.browserEvent.target)) {\r\n            return;\r\n        }\r\n        if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\r\n            return;\r\n        }\r\n        var focus = this.list.getFocus();\r\n        this.list.setSelection(focus, e.browserEvent);\r\n        this.list.pin(focus);\r\n    };\r\n    MouseController.prototype.changeSelection = function (e, reference) {\r\n        var focus = e.index;\r\n        if (this.isSelectionRangeChangeEvent(e) && reference !== undefined) {\r\n            var min = Math.min(reference, focus);\r\n            var max = Math.max(reference, focus);\r\n            var rangeSelection = range(min, max + 1);\r\n            var selection = this.list.getSelection();\r\n            var contiguousRange = getContiguousRangeContaining(disjunction(selection, [reference]), reference);\r\n            if (contiguousRange.length === 0) {\r\n                return;\r\n            }\r\n            var newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\r\n            this.list.setSelection(newSelection, e.browserEvent);\r\n        }\r\n        else if (this.isSelectionSingleChangeEvent(e)) {\r\n            var selection = this.list.getSelection();\r\n            var newSelection = selection.filter(function (i) { return i !== focus; });\r\n            this.list.setFocus([focus]);\r\n            if (selection.length === newSelection.length) {\r\n                this.list.setSelection(__spreadArrays(newSelection, [focus]), e.browserEvent);\r\n            }\r\n            else {\r\n                this.list.setSelection(newSelection, e.browserEvent);\r\n            }\r\n        }\r\n    };\r\n    MouseController.prototype.dispose = function () {\r\n        this.disposables.dispose();\r\n    };\r\n    return MouseController;\r\n}());\r\nexport { MouseController };\r\nvar DefaultStyleController = /** @class */ (function () {\r\n    function DefaultStyleController(styleElement, selectorSuffix) {\r\n        this.styleElement = styleElement;\r\n        this.selectorSuffix = selectorSuffix;\r\n    }\r\n    DefaultStyleController.prototype.style = function (styles) {\r\n        var suffix = this.selectorSuffix && \".\" + this.selectorSuffix;\r\n        var content = [];\r\n        if (styles.listBackground) {\r\n            if (styles.listBackground.isOpaque()) {\r\n                content.push(\".monaco-list\" + suffix + \" .monaco-list-rows { background: \" + styles.listBackground + \"; }\");\r\n            }\r\n            else if (!platform.isMacintosh) { // subpixel AA doesn't exist in macOS\r\n                console.warn(\"List with id '\" + this.selectorSuffix + \"' was styled with a non-opaque background color. This will break sub-pixel antialiasing.\");\r\n            }\r\n        }\r\n        if (styles.listFocusBackground) {\r\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused { background-color: \" + styles.listFocusBackground + \"; }\");\r\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused:hover { background-color: \" + styles.listFocusBackground + \"; }\"); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listFocusForeground) {\r\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused { color: \" + styles.listFocusForeground + \"; }\");\r\n        }\r\n        if (styles.listActiveSelectionBackground) {\r\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected { background-color: \" + styles.listActiveSelectionBackground + \"; }\");\r\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected:hover { background-color: \" + styles.listActiveSelectionBackground + \"; }\"); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listActiveSelectionForeground) {\r\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected { color: \" + styles.listActiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listFocusAndSelectionBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.selected.focused { background-color: \" + styles.listFocusAndSelectionBackground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFocusAndSelectionForeground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.selected.focused { color: \" + styles.listFocusAndSelectionForeground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listInactiveFocusBackground) {\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused { background-color:  \" + styles.listInactiveFocusBackground + \"; }\");\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused:hover { background-color:  \" + styles.listInactiveFocusBackground + \"; }\"); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listInactiveSelectionBackground) {\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { background-color:  \" + styles.listInactiveSelectionBackground + \"; }\");\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected:hover { background-color:  \" + styles.listInactiveSelectionBackground + \"; }\"); // overwrite :hover style in this case!\r\n        }\r\n        if (styles.listInactiveSelectionForeground) {\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { color: \" + styles.listInactiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listHoverBackground) {\r\n            content.push(\".monaco-list\" + suffix + \":not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  \" + styles.listHoverBackground + \"; }\");\r\n        }\r\n        if (styles.listHoverForeground) {\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row:hover:not(.selected):not(.focused) { color:  \" + styles.listHoverForeground + \"; }\");\r\n        }\r\n        if (styles.listSelectionOutline) {\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { outline: 1px dotted \" + styles.listSelectionOutline + \"; outline-offset: -1px; }\");\r\n        }\r\n        if (styles.listFocusOutline) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.focused { outline: 1px solid \" + styles.listFocusOutline + \"; outline-offset: -1px; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listInactiveFocusOutline) {\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused { outline: 1px dotted \" + styles.listInactiveFocusOutline + \"; outline-offset: -1px; }\");\r\n        }\r\n        if (styles.listHoverOutline) {\r\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row:hover { outline: 1px dashed \" + styles.listHoverOutline + \"; outline-offset: -1px; }\");\r\n        }\r\n        if (styles.listDropBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-list\" + suffix + \".drop-target,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \" .monaco-list-rows.drop-target,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \" .monaco-list-row.drop-target { background-color: \" + styles.listDropBackground + \" !important; color: inherit !important; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFilterWidgetBackground) {\r\n            content.push(\".monaco-list-type-filter { background-color: \" + styles.listFilterWidgetBackground + \" }\");\r\n        }\r\n        if (styles.listFilterWidgetOutline) {\r\n            content.push(\".monaco-list-type-filter { border: 1px solid \" + styles.listFilterWidgetOutline + \"; }\");\r\n        }\r\n        if (styles.listFilterWidgetNoMatchesOutline) {\r\n            content.push(\".monaco-list-type-filter.no-matches { border: 1px solid \" + styles.listFilterWidgetNoMatchesOutline + \"; }\");\r\n        }\r\n        if (styles.listMatchesShadow) {\r\n            content.push(\".monaco-list-type-filter { box-shadow: 1px 1px 1px \" + styles.listMatchesShadow + \"; }\");\r\n        }\r\n        var newStyles = content.join('\\n');\r\n        if (newStyles !== this.styleElement.innerHTML) {\r\n            this.styleElement.innerHTML = newStyles;\r\n        }\r\n    };\r\n    return DefaultStyleController;\r\n}());\r\nexport { DefaultStyleController };\r\nvar defaultStyles = {\r\n    listFocusBackground: Color.fromHex('#7FB0D0'),\r\n    listActiveSelectionBackground: Color.fromHex('#0E639C'),\r\n    listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listFocusAndSelectionBackground: Color.fromHex('#094771'),\r\n    listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\r\n    listHoverBackground: Color.fromHex('#2A2D2E'),\r\n    listDropBackground: Color.fromHex('#383B3D'),\r\n    treeIndentGuidesStroke: Color.fromHex('#a9a9a9')\r\n};\r\nvar DefaultOptions = {\r\n    keyboardSupport: true,\r\n    mouseSupport: true,\r\n    multipleSelectionSupport: true,\r\n    dnd: {\r\n        getDragURI: function () { return null; },\r\n        onDragStart: function () { },\r\n        onDragOver: function () { return false; },\r\n        drop: function () { }\r\n    },\r\n    ariaRootRole: ListAriaRootRole.TREE\r\n};\r\n// TODO@Joao: move these utils into a SortedArray class\r\nfunction getContiguousRangeContaining(range, value) {\r\n    var index = range.indexOf(value);\r\n    if (index === -1) {\r\n        return [];\r\n    }\r\n    var result = [];\r\n    var i = index - 1;\r\n    while (i >= 0 && range[i] === value - (index - i)) {\r\n        result.push(range[i--]);\r\n    }\r\n    result.reverse();\r\n    i = index;\r\n    while (i < range.length && range[i] === value + (i - index)) {\r\n        result.push(range[i++]);\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Given two sorted collections of numbers, returns the intersection\r\n * between them (OR).\r\n */\r\nfunction disjunction(one, other) {\r\n    var result = [];\r\n    var i = 0, j = 0;\r\n    while (i < one.length || j < other.length) {\r\n        if (i >= one.length) {\r\n            result.push(other[j++]);\r\n        }\r\n        else if (j >= other.length) {\r\n            result.push(one[i++]);\r\n        }\r\n        else if (one[i] === other[j]) {\r\n            result.push(one[i]);\r\n            i++;\r\n            j++;\r\n            continue;\r\n        }\r\n        else if (one[i] < other[j]) {\r\n            result.push(one[i++]);\r\n        }\r\n        else {\r\n            result.push(other[j++]);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Given two sorted collections of numbers, returns the relative\r\n * complement between them (XOR).\r\n */\r\nfunction relativeComplement(one, other) {\r\n    var result = [];\r\n    var i = 0, j = 0;\r\n    while (i < one.length || j < other.length) {\r\n        if (i >= one.length) {\r\n            result.push(other[j++]);\r\n        }\r\n        else if (j >= other.length) {\r\n            result.push(one[i++]);\r\n        }\r\n        else if (one[i] === other[j]) {\r\n            i++;\r\n            j++;\r\n            continue;\r\n        }\r\n        else if (one[i] < other[j]) {\r\n            result.push(one[i++]);\r\n        }\r\n        else {\r\n            j++;\r\n        }\r\n    }\r\n    return result;\r\n}\r\nvar numericSort = function (a, b) { return a - b; };\r\nvar PipelineRenderer = /** @class */ (function () {\r\n    function PipelineRenderer(_templateId, renderers) {\r\n        this._templateId = _templateId;\r\n        this.renderers = renderers;\r\n    }\r\n    Object.defineProperty(PipelineRenderer.prototype, \"templateId\", {\r\n        get: function () {\r\n            return this._templateId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    PipelineRenderer.prototype.renderTemplate = function (container) {\r\n        return this.renderers.map(function (r) { return r.renderTemplate(container); });\r\n    };\r\n    PipelineRenderer.prototype.renderElement = function (element, index, templateData, height) {\r\n        var i = 0;\r\n        for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\r\n            var renderer = _a[_i];\r\n            renderer.renderElement(element, index, templateData[i++], height);\r\n        }\r\n    };\r\n    PipelineRenderer.prototype.disposeElement = function (element, index, templateData, height) {\r\n        var i = 0;\r\n        for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\r\n            var renderer = _a[_i];\r\n            if (renderer.disposeElement) {\r\n                renderer.disposeElement(element, index, templateData[i], height);\r\n            }\r\n            i += 1;\r\n        }\r\n    };\r\n    PipelineRenderer.prototype.disposeTemplate = function (templateData) {\r\n        var i = 0;\r\n        for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\r\n            var renderer = _a[_i];\r\n            renderer.disposeTemplate(templateData[i++]);\r\n        }\r\n    };\r\n    return PipelineRenderer;\r\n}());\r\nvar AccessibiltyRenderer = /** @class */ (function () {\r\n    function AccessibiltyRenderer(accessibilityProvider) {\r\n        this.accessibilityProvider = accessibilityProvider;\r\n        this.templateId = 'a18n';\r\n    }\r\n    AccessibiltyRenderer.prototype.renderTemplate = function (container) {\r\n        return container;\r\n    };\r\n    AccessibiltyRenderer.prototype.renderElement = function (element, index, container) {\r\n        var ariaLabel = this.accessibilityProvider.getAriaLabel(element);\r\n        if (ariaLabel) {\r\n            container.setAttribute('aria-label', ariaLabel);\r\n        }\r\n        else {\r\n            container.removeAttribute('aria-label');\r\n        }\r\n        var ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\r\n        if (typeof ariaLevel === 'number') {\r\n            container.setAttribute('aria-level', \"\" + ariaLevel);\r\n        }\r\n        else {\r\n            container.removeAttribute('aria-level');\r\n        }\r\n    };\r\n    AccessibiltyRenderer.prototype.disposeTemplate = function (templateData) {\r\n        // noop\r\n    };\r\n    return AccessibiltyRenderer;\r\n}());\r\nvar ListViewDragAndDrop = /** @class */ (function () {\r\n    function ListViewDragAndDrop(list, dnd) {\r\n        this.list = list;\r\n        this.dnd = dnd;\r\n    }\r\n    ListViewDragAndDrop.prototype.getDragElements = function (element) {\r\n        var selection = this.list.getSelectedElements();\r\n        var elements = selection.indexOf(element) > -1 ? selection : [element];\r\n        return elements;\r\n    };\r\n    ListViewDragAndDrop.prototype.getDragURI = function (element) {\r\n        return this.dnd.getDragURI(element);\r\n    };\r\n    ListViewDragAndDrop.prototype.getDragLabel = function (elements, originalEvent) {\r\n        if (this.dnd.getDragLabel) {\r\n            return this.dnd.getDragLabel(elements, originalEvent);\r\n        }\r\n        return undefined;\r\n    };\r\n    ListViewDragAndDrop.prototype.onDragStart = function (data, originalEvent) {\r\n        if (this.dnd.onDragStart) {\r\n            this.dnd.onDragStart(data, originalEvent);\r\n        }\r\n    };\r\n    ListViewDragAndDrop.prototype.onDragOver = function (data, targetElement, targetIndex, originalEvent) {\r\n        return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\r\n    };\r\n    ListViewDragAndDrop.prototype.onDragEnd = function (originalEvent) {\r\n        if (this.dnd.onDragEnd) {\r\n            this.dnd.onDragEnd(originalEvent);\r\n        }\r\n    };\r\n    ListViewDragAndDrop.prototype.drop = function (data, targetElement, targetIndex, originalEvent) {\r\n        this.dnd.drop(data, targetElement, targetIndex, originalEvent);\r\n    };\r\n    return ListViewDragAndDrop;\r\n}());\r\nvar List = /** @class */ (function () {\r\n    function List(user, container, virtualDelegate, renderers, _options) {\r\n        if (_options === void 0) { _options = DefaultOptions; }\r\n        this.user = user;\r\n        this._options = _options;\r\n        this.eventBufferer = new EventBufferer();\r\n        this.disposables = new DisposableStore();\r\n        this._onDidOpen = new Emitter();\r\n        this.onDidOpen = this._onDidOpen.event;\r\n        this._onDidPin = new Emitter();\r\n        this.didJustPressContextMenuKey = false;\r\n        this._onDidDispose = new Emitter();\r\n        this.onDidDispose = this._onDidDispose.event;\r\n        this.focus = new FocusTrait();\r\n        this.selection = new Trait('selected');\r\n        mixin(_options, defaultStyles, false);\r\n        var baseRenderers = [this.focus.renderer, this.selection.renderer];\r\n        this.accessibilityProvider = _options.accessibilityProvider;\r\n        if (this.accessibilityProvider) {\r\n            baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\r\n            if (this.accessibilityProvider.onDidChangeActiveDescendant) {\r\n                this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant, this, this.disposables);\r\n            }\r\n        }\r\n        renderers = renderers.map(function (r) { return new PipelineRenderer(r.templateId, __spreadArrays(baseRenderers, [r])); });\r\n        var viewOptions = __assign(__assign({}, _options), { dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd) });\r\n        this.view = new ListView(container, virtualDelegate, renderers, viewOptions);\r\n        if (typeof _options.ariaRole !== 'string') {\r\n            this.view.domNode.setAttribute('role', ListAriaRootRole.TREE);\r\n        }\r\n        else {\r\n            this.view.domNode.setAttribute('role', _options.ariaRole);\r\n        }\r\n        if (_options.styleController) {\r\n            this.styleController = _options.styleController(this.view.domId);\r\n        }\r\n        else {\r\n            var styleElement = DOM.createStyleSheet(this.view.domNode);\r\n            this.styleController = new DefaultStyleController(styleElement, this.view.domId);\r\n        }\r\n        this.spliceable = new CombinedSpliceable([\r\n            new TraitSpliceable(this.focus, this.view, _options.identityProvider),\r\n            new TraitSpliceable(this.selection, this.view, _options.identityProvider),\r\n            this.view\r\n        ]);\r\n        this.disposables.add(this.focus);\r\n        this.disposables.add(this.selection);\r\n        this.disposables.add(this.view);\r\n        this.disposables.add(this._onDidDispose);\r\n        this.onDidFocus = Event.map(domEvent(this.view.domNode, 'focus', true), function () { return null; });\r\n        this.onDidBlur = Event.map(domEvent(this.view.domNode, 'blur', true), function () { return null; });\r\n        this.disposables.add(new DOMFocusController(this, this.view));\r\n        if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\r\n            var controller = new KeyboardController(this, this.view, _options);\r\n            this.disposables.add(controller);\r\n        }\r\n        if (_options.keyboardNavigationLabelProvider) {\r\n            var delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\r\n            this.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider, delegate);\r\n            this.disposables.add(this.typeLabelController);\r\n        }\r\n        this.disposables.add(this.createMouseController(_options));\r\n        this.onFocusChange(this._onFocusChange, this, this.disposables);\r\n        this.onSelectionChange(this._onSelectionChange, this, this.disposables);\r\n        if (_options.ariaLabel) {\r\n            this.view.domNode.setAttribute('aria-label', localize('aria list', \"{0}. Use the navigation keys to navigate.\", _options.ariaLabel));\r\n        }\r\n    }\r\n    Object.defineProperty(List.prototype, \"onFocusChange\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), function (e) { return _this.toListEvent(e); });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onSelectionChange\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), function (e) { return _this.toListEvent(e); });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"domId\", {\r\n        get: function () { return this.view.domId; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onMouseClick\", {\r\n        get: function () { return this.view.onMouseClick; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onMouseDblClick\", {\r\n        get: function () { return this.view.onMouseDblClick; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onMouseMiddleClick\", {\r\n        get: function () { return this.view.onMouseMiddleClick; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onMouseDown\", {\r\n        get: function () { return this.view.onMouseDown; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onTouchStart\", {\r\n        get: function () { return this.view.onTouchStart; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onTap\", {\r\n        get: function () { return this.view.onTap; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onContextMenu\", {\r\n        get: function () {\r\n            var _this = this;\r\n            var fromKeydown = Event.chain(domEvent(this.view.domNode, 'keydown'))\r\n                .map(function (e) { return new StandardKeyboardEvent(e); })\r\n                .filter(function (e) { return _this.didJustPressContextMenuKey = e.keyCode === 58 /* ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* F10 */); })\r\n                .filter(function (e) { e.preventDefault(); e.stopPropagation(); return false; })\r\n                .event;\r\n            var fromKeyup = Event.chain(domEvent(this.view.domNode, 'keyup'))\r\n                .filter(function () {\r\n                var didJustPressContextMenuKey = _this.didJustPressContextMenuKey;\r\n                _this.didJustPressContextMenuKey = false;\r\n                return didJustPressContextMenuKey;\r\n            })\r\n                .filter(function () { return _this.getFocus().length > 0 && !!_this.view.domElement(_this.getFocus()[0]); })\r\n                .map(function (browserEvent) {\r\n                var index = _this.getFocus()[0];\r\n                var element = _this.view.element(index);\r\n                var anchor = _this.view.domElement(index);\r\n                return { index: index, element: element, anchor: anchor, browserEvent: browserEvent };\r\n            })\r\n                .event;\r\n            var fromMouse = Event.chain(this.view.onContextMenu)\r\n                .filter(function () { return !_this.didJustPressContextMenuKey; })\r\n                .map(function (_a) {\r\n                var element = _a.element, index = _a.index, browserEvent = _a.browserEvent;\r\n                return ({ element: element, index: index, anchor: { x: browserEvent.clientX + 1, y: browserEvent.clientY }, browserEvent: browserEvent });\r\n            })\r\n                .event;\r\n            return Event.any(fromKeydown, fromKeyup, fromMouse);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"onKeyDown\", {\r\n        get: function () { return domEvent(this.view.domNode, 'keydown'); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    List.prototype.createMouseController = function (options) {\r\n        return new MouseController(this);\r\n    };\r\n    List.prototype.updateOptions = function (optionsUpdate) {\r\n        if (optionsUpdate === void 0) { optionsUpdate = {}; }\r\n        this._options = __assign(__assign({}, this._options), optionsUpdate);\r\n        if (this.typeLabelController) {\r\n            this.typeLabelController.updateOptions(this._options);\r\n        }\r\n    };\r\n    Object.defineProperty(List.prototype, \"options\", {\r\n        get: function () {\r\n            return this._options;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    List.prototype.splice = function (start, deleteCount, elements) {\r\n        var _this = this;\r\n        if (elements === void 0) { elements = []; }\r\n        if (start < 0 || start > this.view.length) {\r\n            throw new ListError(this.user, \"Invalid start index: \" + start);\r\n        }\r\n        if (deleteCount < 0) {\r\n            throw new ListError(this.user, \"Invalid delete count: \" + deleteCount);\r\n        }\r\n        if (deleteCount === 0 && elements.length === 0) {\r\n            return;\r\n        }\r\n        this.eventBufferer.bufferEvents(function () { return _this.spliceable.splice(start, deleteCount, elements); });\r\n    };\r\n    List.prototype.rerender = function () {\r\n        this.view.rerender();\r\n    };\r\n    List.prototype.element = function (index) {\r\n        return this.view.element(index);\r\n    };\r\n    Object.defineProperty(List.prototype, \"length\", {\r\n        get: function () {\r\n            return this.view.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"contentHeight\", {\r\n        get: function () {\r\n            return this.view.contentHeight;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(List.prototype, \"scrollTop\", {\r\n        get: function () {\r\n            return this.view.getScrollTop();\r\n        },\r\n        set: function (scrollTop) {\r\n            this.view.setScrollTop(scrollTop);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    List.prototype.domFocus = function () {\r\n        this.view.domNode.focus();\r\n    };\r\n    List.prototype.layout = function (height, width) {\r\n        this.view.layout(height, width);\r\n    };\r\n    List.prototype.setSelection = function (indexes, browserEvent) {\r\n        for (var _i = 0, indexes_1 = indexes; _i < indexes_1.length; _i++) {\r\n            var index = indexes_1[_i];\r\n            if (index < 0 || index >= this.length) {\r\n                throw new ListError(this.user, \"Invalid index \" + index);\r\n            }\r\n        }\r\n        this.selection.set(indexes, browserEvent);\r\n    };\r\n    List.prototype.getSelection = function () {\r\n        return this.selection.get();\r\n    };\r\n    List.prototype.getSelectedElements = function () {\r\n        var _this = this;\r\n        return this.getSelection().map(function (i) { return _this.view.element(i); });\r\n    };\r\n    List.prototype.setFocus = function (indexes, browserEvent) {\r\n        for (var _i = 0, indexes_2 = indexes; _i < indexes_2.length; _i++) {\r\n            var index = indexes_2[_i];\r\n            if (index < 0 || index >= this.length) {\r\n                throw new ListError(this.user, \"Invalid index \" + index);\r\n            }\r\n        }\r\n        this.focus.set(indexes, browserEvent);\r\n    };\r\n    List.prototype.focusNext = function (n, loop, browserEvent, filter) {\r\n        if (n === void 0) { n = 1; }\r\n        if (loop === void 0) { loop = false; }\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        var focus = this.focus.get();\r\n        var index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    };\r\n    List.prototype.focusPrevious = function (n, loop, browserEvent, filter) {\r\n        if (n === void 0) { n = 1; }\r\n        if (loop === void 0) { loop = false; }\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        var focus = this.focus.get();\r\n        var index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    };\r\n    List.prototype.focusNextPage = function (browserEvent, filter) {\r\n        var _this = this;\r\n        var lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\r\n        lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\r\n        var lastPageElement = this.view.element(lastPageIndex);\r\n        var currentlyFocusedElement = this.getFocusedElements()[0];\r\n        if (currentlyFocusedElement !== lastPageElement) {\r\n            var lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\r\n            if (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\r\n                this.setFocus([lastGoodPageIndex], browserEvent);\r\n            }\r\n            else {\r\n                this.setFocus([lastPageIndex], browserEvent);\r\n            }\r\n        }\r\n        else {\r\n            var previousScrollTop = this.view.getScrollTop();\r\n            this.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\r\n            if (this.view.getScrollTop() !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () { return _this.focusNextPage(browserEvent, filter); }, 0);\r\n            }\r\n        }\r\n    };\r\n    List.prototype.focusPreviousPage = function (browserEvent, filter) {\r\n        var _this = this;\r\n        var firstPageIndex;\r\n        var scrollTop = this.view.getScrollTop();\r\n        if (scrollTop === 0) {\r\n            firstPageIndex = this.view.indexAt(scrollTop);\r\n        }\r\n        else {\r\n            firstPageIndex = this.view.indexAfter(scrollTop - 1);\r\n        }\r\n        var firstPageElement = this.view.element(firstPageIndex);\r\n        var currentlyFocusedElement = this.getFocusedElements()[0];\r\n        if (currentlyFocusedElement !== firstPageElement) {\r\n            var firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\r\n            if (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\r\n                this.setFocus([firstGoodPageIndex], browserEvent);\r\n            }\r\n            else {\r\n                this.setFocus([firstPageIndex], browserEvent);\r\n            }\r\n        }\r\n        else {\r\n            var previousScrollTop = scrollTop;\r\n            this.view.setScrollTop(scrollTop - this.view.renderHeight);\r\n            if (this.view.getScrollTop() !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () { return _this.focusPreviousPage(browserEvent, filter); }, 0);\r\n            }\r\n        }\r\n    };\r\n    List.prototype.focusLast = function (browserEvent, filter) {\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        var index = this.findPreviousIndex(this.length - 1, false, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    };\r\n    List.prototype.focusFirst = function (browserEvent, filter) {\r\n        if (this.length === 0) {\r\n            return;\r\n        }\r\n        var index = this.findNextIndex(0, false, filter);\r\n        if (index > -1) {\r\n            this.setFocus([index], browserEvent);\r\n        }\r\n    };\r\n    List.prototype.findNextIndex = function (index, loop, filter) {\r\n        if (loop === void 0) { loop = false; }\r\n        for (var i = 0; i < this.length; i++) {\r\n            if (index >= this.length && !loop) {\r\n                return -1;\r\n            }\r\n            index = index % this.length;\r\n            if (!filter || filter(this.element(index))) {\r\n                return index;\r\n            }\r\n            index++;\r\n        }\r\n        return -1;\r\n    };\r\n    List.prototype.findPreviousIndex = function (index, loop, filter) {\r\n        if (loop === void 0) { loop = false; }\r\n        for (var i = 0; i < this.length; i++) {\r\n            if (index < 0 && !loop) {\r\n                return -1;\r\n            }\r\n            index = (this.length + (index % this.length)) % this.length;\r\n            if (!filter || filter(this.element(index))) {\r\n                return index;\r\n            }\r\n            index--;\r\n        }\r\n        return -1;\r\n    };\r\n    List.prototype.getFocus = function () {\r\n        return this.focus.get();\r\n    };\r\n    List.prototype.getFocusedElements = function () {\r\n        var _this = this;\r\n        return this.getFocus().map(function (i) { return _this.view.element(i); });\r\n    };\r\n    List.prototype.reveal = function (index, relativeTop) {\r\n        if (index < 0 || index >= this.length) {\r\n            throw new ListError(this.user, \"Invalid index \" + index);\r\n        }\r\n        var scrollTop = this.view.getScrollTop();\r\n        var elementTop = this.view.elementTop(index);\r\n        var elementHeight = this.view.elementHeight(index);\r\n        if (isNumber(relativeTop)) {\r\n            // y = mx + b\r\n            var m = elementHeight - this.view.renderHeight;\r\n            this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\r\n        }\r\n        else {\r\n            var viewItemBottom = elementTop + elementHeight;\r\n            var wrapperBottom = scrollTop + this.view.renderHeight;\r\n            if (elementTop < scrollTop && viewItemBottom >= wrapperBottom) {\r\n                // The element is already overflowing the viewport, no-op\r\n            }\r\n            else if (elementTop < scrollTop) {\r\n                this.view.setScrollTop(elementTop);\r\n            }\r\n            else if (viewItemBottom >= wrapperBottom) {\r\n                this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Returns the relative position of an element rendered in the list.\r\n     * Returns `null` if the element isn't *entirely* in the visible viewport.\r\n     */\r\n    List.prototype.getRelativeTop = function (index) {\r\n        if (index < 0 || index >= this.length) {\r\n            throw new ListError(this.user, \"Invalid index \" + index);\r\n        }\r\n        var scrollTop = this.view.getScrollTop();\r\n        var elementTop = this.view.elementTop(index);\r\n        var elementHeight = this.view.elementHeight(index);\r\n        if (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\r\n            return null;\r\n        }\r\n        // y = mx + b\r\n        var m = elementHeight - this.view.renderHeight;\r\n        return Math.abs((scrollTop - elementTop) / m);\r\n    };\r\n    List.prototype.getHTMLElement = function () {\r\n        return this.view.domNode;\r\n    };\r\n    List.prototype.open = function (indexes, browserEvent) {\r\n        var _this = this;\r\n        for (var _i = 0, indexes_3 = indexes; _i < indexes_3.length; _i++) {\r\n            var index = indexes_3[_i];\r\n            if (index < 0 || index >= this.length) {\r\n                throw new ListError(this.user, \"Invalid index \" + index);\r\n            }\r\n        }\r\n        this._onDidOpen.fire({ indexes: indexes, elements: indexes.map(function (i) { return _this.view.element(i); }), browserEvent: browserEvent });\r\n    };\r\n    List.prototype.pin = function (indexes, browserEvent) {\r\n        var _this = this;\r\n        for (var _i = 0, indexes_4 = indexes; _i < indexes_4.length; _i++) {\r\n            var index = indexes_4[_i];\r\n            if (index < 0 || index >= this.length) {\r\n                throw new ListError(this.user, \"Invalid index \" + index);\r\n            }\r\n        }\r\n        this._onDidPin.fire({ indexes: indexes, elements: indexes.map(function (i) { return _this.view.element(i); }), browserEvent: browserEvent });\r\n    };\r\n    List.prototype.style = function (styles) {\r\n        this.styleController.style(styles);\r\n    };\r\n    List.prototype.toListEvent = function (_a) {\r\n        var _this = this;\r\n        var indexes = _a.indexes, browserEvent = _a.browserEvent;\r\n        return { indexes: indexes, elements: indexes.map(function (i) { return _this.view.element(i); }), browserEvent: browserEvent };\r\n    };\r\n    List.prototype._onFocusChange = function () {\r\n        var focus = this.focus.get();\r\n        DOM.toggleClass(this.view.domNode, 'element-focused', focus.length > 0);\r\n        this.onDidChangeActiveDescendant();\r\n    };\r\n    List.prototype.onDidChangeActiveDescendant = function () {\r\n        var _a;\r\n        var focus = this.focus.get();\r\n        if (focus.length > 0) {\r\n            var id = void 0;\r\n            if ((_a = this.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getActiveDescendantId) {\r\n                id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\r\n            }\r\n            this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\r\n        }\r\n        else {\r\n            this.view.domNode.removeAttribute('aria-activedescendant');\r\n        }\r\n    };\r\n    List.prototype._onSelectionChange = function () {\r\n        var selection = this.selection.get();\r\n        DOM.toggleClass(this.view.domNode, 'selection-none', selection.length === 0);\r\n        DOM.toggleClass(this.view.domNode, 'selection-single', selection.length === 1);\r\n        DOM.toggleClass(this.view.domNode, 'selection-multiple', selection.length > 1);\r\n    };\r\n    List.prototype.dispose = function () {\r\n        this._onDidDispose.fire();\r\n        this.disposables.dispose();\r\n        this._onDidOpen.dispose();\r\n        this._onDidPin.dispose();\r\n        this._onDidDispose.dispose();\r\n    };\r\n    __decorate([\r\n        memoize\r\n    ], List.prototype, \"onFocusChange\", null);\r\n    __decorate([\r\n        memoize\r\n    ], List.prototype, \"onSelectionChange\", null);\r\n    __decorate([\r\n        memoize\r\n    ], List.prototype, \"onContextMenu\", null);\r\n    return List;\r\n}());\r\nexport { List };\r\n"]},"metadata":{},"sourceType":"module"}