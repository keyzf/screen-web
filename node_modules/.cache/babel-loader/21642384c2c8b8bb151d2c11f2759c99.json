{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport './messageController.css';\nimport * as nls from '../../../nls.js';\nimport { TimeoutTimer } from '../../../base/common/async.js';\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\nimport { Range } from '../../common/core/range.js';\nimport { registerEditorContribution, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\nimport { registerThemingParticipant, HIGH_CONTRAST } from '../../../platform/theme/common/themeService.js';\nimport { inputValidationInfoBorder, inputValidationInfoBackground, inputValidationInfoForeground } from '../../../platform/theme/common/colorRegistry.js';\n\nvar MessageController =\n/** @class */\nfunction (_super) {\n  __extends(MessageController, _super);\n\n  function MessageController(editor, contextKeyService) {\n    var _this = _super.call(this) || this;\n\n    _this.closeTimeout = 3000; // close after 3s\n\n    _this._messageWidget = _this._register(new MutableDisposable());\n    _this._messageListeners = _this._register(new DisposableStore());\n    _this._editor = editor;\n    _this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\n\n    _this._register(_this._editor.onDidAttemptReadOnlyEdit(function () {\n      return _this._onDidAttemptReadOnlyEdit();\n    }));\n\n    return _this;\n  }\n\n  MessageController.get = function (editor) {\n    return editor.getContribution(MessageController.ID);\n  };\n\n  MessageController.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this._visible.reset();\n  };\n\n  MessageController.prototype.showMessage = function (message, position) {\n    var _this = this;\n\n    alert(message);\n\n    this._visible.set(true);\n\n    this._messageWidget.clear();\n\n    this._messageListeners.clear();\n\n    this._messageWidget.value = new MessageWidget(this._editor, position, message); // close on blur, cursor, model change, dispose\n\n    this._messageListeners.add(this._editor.onDidBlurEditorText(function () {\n      return _this.closeMessage();\n    }));\n\n    this._messageListeners.add(this._editor.onDidChangeCursorPosition(function () {\n      return _this.closeMessage();\n    }));\n\n    this._messageListeners.add(this._editor.onDidDispose(function () {\n      return _this.closeMessage();\n    }));\n\n    this._messageListeners.add(this._editor.onDidChangeModel(function () {\n      return _this.closeMessage();\n    }));\n\n    this._messageListeners.add(new TimeoutTimer(function () {\n      return _this.closeMessage();\n    }, this.closeTimeout)); // close on mouse move\n\n\n    var bounds;\n\n    this._messageListeners.add(this._editor.onMouseMove(function (e) {\n      // outside the text area\n      if (!e.target.position) {\n        return;\n      }\n\n      if (!bounds) {\n        // define bounding box around position and first mouse occurance\n        bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\n      } else if (!bounds.containsPosition(e.target.position)) {\n        // check if position is still in bounds\n        _this.closeMessage();\n      }\n    }));\n  };\n\n  MessageController.prototype.closeMessage = function () {\n    this._visible.reset();\n\n    this._messageListeners.clear();\n\n    if (this._messageWidget.value) {\n      this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\n    }\n  };\n\n  MessageController.prototype._onDidAttemptReadOnlyEdit = function () {\n    if (this._editor.hasModel()) {\n      this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\n    }\n  };\n\n  MessageController.ID = 'editor.contrib.messageController';\n  MessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false);\n  MessageController = __decorate([__param(1, IContextKeyService)], MessageController);\n  return MessageController;\n}(Disposable);\n\nexport { MessageController };\nvar MessageCommand = EditorCommand.bindToContribution(MessageController.get);\nregisterEditorCommand(new MessageCommand({\n  id: 'leaveEditorMessage',\n  precondition: MessageController.MESSAGE_VISIBLE,\n  handler: function (c) {\n    return c.closeMessage();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 30,\n    primary: 9\n    /* Escape */\n\n  }\n}));\n\nvar MessageWidget =\n/** @class */\nfunction () {\n  function MessageWidget(editor, _a, text) {\n    var lineNumber = _a.lineNumber,\n        column = _a.column; // Editor.IContentWidget.allowEditorOverflow\n\n    this.allowEditorOverflow = true;\n    this.suppressMouseDown = false;\n    this._editor = editor;\n\n    this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0\n    /* Smooth */\n    );\n\n    this._position = {\n      lineNumber: lineNumber,\n      column: column - 1\n    };\n    this._domNode = document.createElement('div');\n\n    this._domNode.classList.add('monaco-editor-overlaymessage');\n\n    var message = document.createElement('div');\n    message.classList.add('message');\n    message.textContent = text;\n\n    this._domNode.appendChild(message);\n\n    var anchor = document.createElement('div');\n    anchor.classList.add('anchor');\n\n    this._domNode.appendChild(anchor);\n\n    this._editor.addContentWidget(this);\n\n    this._domNode.classList.add('fadeIn');\n  }\n\n  MessageWidget.fadeOut = function (messageWidget) {\n    var handle;\n\n    var dispose = function () {\n      messageWidget.dispose();\n      clearTimeout(handle);\n      messageWidget.getDomNode().removeEventListener('animationend', dispose);\n    };\n\n    handle = setTimeout(dispose, 110);\n    messageWidget.getDomNode().addEventListener('animationend', dispose);\n    messageWidget.getDomNode().classList.add('fadeOut');\n    return {\n      dispose: dispose\n    };\n  };\n\n  MessageWidget.prototype.dispose = function () {\n    this._editor.removeContentWidget(this);\n  };\n\n  MessageWidget.prototype.getId = function () {\n    return 'messageoverlay';\n  };\n\n  MessageWidget.prototype.getDomNode = function () {\n    return this._domNode;\n  };\n\n  MessageWidget.prototype.getPosition = function () {\n    return {\n      position: this._position,\n      preference: [1\n      /* ABOVE */\n      , 2\n      /* BELOW */\n      ]\n    };\n  };\n\n  return MessageWidget;\n}();\n\nregisterEditorContribution(MessageController.ID, MessageController);\nregisterThemingParticipant(function (theme, collector) {\n  var border = theme.getColor(inputValidationInfoBorder);\n\n  if (border) {\n    var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\n    collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .anchor { border-top-color: \" + border + \"; }\");\n    collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { border: \" + borderWidth + \"px solid \" + border + \"; }\");\n  }\n\n  var background = theme.getColor(inputValidationInfoBackground);\n\n  if (background) {\n    collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { background-color: \" + background + \"; }\");\n  }\n\n  var foreground = theme.getColor(inputValidationInfoForeground);\n\n  if (foreground) {\n    collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { color: \" + foreground + \"; }\");\n  }\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/contrib/message/messageController.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","nls","TimeoutTimer","Disposable","DisposableStore","MutableDisposable","alert","Range","registerEditorContribution","EditorCommand","registerEditorCommand","IContextKeyService","RawContextKey","registerThemingParticipant","HIGH_CONTRAST","inputValidationInfoBorder","inputValidationInfoBackground","inputValidationInfoForeground","MessageController","_super","editor","contextKeyService","_this","call","closeTimeout","_messageWidget","_register","_messageListeners","_editor","_visible","MESSAGE_VISIBLE","bindTo","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","get","getContribution","ID","dispose","reset","showMessage","message","position","set","clear","value","MessageWidget","add","onDidBlurEditorText","closeMessage","onDidChangeCursorPosition","onDidDispose","onDidChangeModel","bounds","onMouseMove","e","lineNumber","containsPosition","fadeOut","hasModel","localize","getPosition","MessageCommand","bindToContribution","id","precondition","handler","kbOpts","weight","primary","_a","text","column","allowEditorOverflow","suppressMouseDown","revealLinesInCenterIfOutsideViewport","_position","_domNode","document","createElement","classList","textContent","appendChild","anchor","addContentWidget","messageWidget","handle","clearTimeout","getDomNode","removeEventListener","setTimeout","addEventListener","removeContentWidget","getId","preference","theme","collector","border","getColor","borderWidth","type","addRule","background","foreground"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './messageController.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorContribution, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerThemingParticipant, HIGH_CONTRAST } from '../../../platform/theme/common/themeService.js';\r\nimport { inputValidationInfoBorder, inputValidationInfoBackground, inputValidationInfoForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nvar MessageController = /** @class */ (function (_super) {\r\n    __extends(MessageController, _super);\r\n    function MessageController(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.closeTimeout = 3000; // close after 3s\r\n        _this._messageWidget = _this._register(new MutableDisposable());\r\n        _this._messageListeners = _this._register(new DisposableStore());\r\n        _this._editor = editor;\r\n        _this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidAttemptReadOnlyEdit(function () { return _this._onDidAttemptReadOnlyEdit(); }));\r\n        return _this;\r\n    }\r\n    MessageController.get = function (editor) {\r\n        return editor.getContribution(MessageController.ID);\r\n    };\r\n    MessageController.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._visible.reset();\r\n    };\r\n    MessageController.prototype.showMessage = function (message, position) {\r\n        var _this = this;\r\n        alert(message);\r\n        this._visible.set(true);\r\n        this._messageWidget.clear();\r\n        this._messageListeners.clear();\r\n        this._messageWidget.value = new MessageWidget(this._editor, position, message);\r\n        // close on blur, cursor, model change, dispose\r\n        this._messageListeners.add(this._editor.onDidBlurEditorText(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidDispose(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeModel(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(new TimeoutTimer(function () { return _this.closeMessage(); }, this.closeTimeout));\r\n        // close on mouse move\r\n        var bounds;\r\n        this._messageListeners.add(this._editor.onMouseMove(function (e) {\r\n            // outside the text area\r\n            if (!e.target.position) {\r\n                return;\r\n            }\r\n            if (!bounds) {\r\n                // define bounding box around position and first mouse occurance\r\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\r\n            }\r\n            else if (!bounds.containsPosition(e.target.position)) {\r\n                // check if position is still in bounds\r\n                _this.closeMessage();\r\n            }\r\n        }));\r\n    };\r\n    MessageController.prototype.closeMessage = function () {\r\n        this._visible.reset();\r\n        this._messageListeners.clear();\r\n        if (this._messageWidget.value) {\r\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\r\n        }\r\n    };\r\n    MessageController.prototype._onDidAttemptReadOnlyEdit = function () {\r\n        if (this._editor.hasModel()) {\r\n            this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\r\n        }\r\n    };\r\n    MessageController.ID = 'editor.contrib.messageController';\r\n    MessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false);\r\n    MessageController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], MessageController);\r\n    return MessageController;\r\n}(Disposable));\r\nexport { MessageController };\r\nvar MessageCommand = EditorCommand.bindToContribution(MessageController.get);\r\nregisterEditorCommand(new MessageCommand({\r\n    id: 'leaveEditorMessage',\r\n    precondition: MessageController.MESSAGE_VISIBLE,\r\n    handler: function (c) { return c.closeMessage(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        primary: 9 /* Escape */\r\n    }\r\n}));\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(editor, _a, text) {\r\n        var lineNumber = _a.lineNumber, column = _a.column;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this._editor = editor;\r\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* Smooth */);\r\n        this._position = { lineNumber: lineNumber, column: column - 1 };\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.classList.add('monaco-editor-overlaymessage');\r\n        var message = document.createElement('div');\r\n        message.classList.add('message');\r\n        message.textContent = text;\r\n        this._domNode.appendChild(message);\r\n        var anchor = document.createElement('div');\r\n        anchor.classList.add('anchor');\r\n        this._domNode.appendChild(anchor);\r\n        this._editor.addContentWidget(this);\r\n        this._domNode.classList.add('fadeIn');\r\n    }\r\n    MessageWidget.fadeOut = function (messageWidget) {\r\n        var handle;\r\n        var dispose = function () {\r\n            messageWidget.dispose();\r\n            clearTimeout(handle);\r\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\r\n        };\r\n        handle = setTimeout(dispose, 110);\r\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\r\n        messageWidget.getDomNode().classList.add('fadeOut');\r\n        return { dispose: dispose };\r\n    };\r\n    MessageWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    MessageWidget.prototype.getId = function () {\r\n        return 'messageoverlay';\r\n    };\r\n    MessageWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    MessageWidget.prototype.getPosition = function () {\r\n        return { position: this._position, preference: [1 /* ABOVE */, 2 /* BELOW */] };\r\n    };\r\n    return MessageWidget;\r\n}());\r\nregisterEditorContribution(MessageController.ID, MessageController);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(inputValidationInfoBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .anchor { border-top-color: \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n    }\r\n    var background = theme.getColor(inputValidationInfoBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { background-color: \" + background + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(inputValidationInfoForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { color: \" + foreground + \"; }\");\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}