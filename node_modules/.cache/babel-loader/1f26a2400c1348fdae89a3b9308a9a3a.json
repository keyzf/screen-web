{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport './currentLineHighlight.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { editorLineHighlight, editorLineHighlightBorder } from '../../../common/view/editorColorRegistry.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nvar isRenderedUsingBorder = true;\n\nvar AbstractLineHighlightOverlay =\n/** @class */\nfunction (_super) {\n  __extends(AbstractLineHighlightOverlay, _super);\n\n  function AbstractLineHighlightOverlay(context) {\n    var _this = _super.call(this) || this;\n\n    _this._context = context;\n    var options = _this._context.configuration.options;\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    _this._lineHeight = options.get(49\n    /* lineHeight */\n    );\n    _this._renderLineHighlight = options.get(72\n    /* renderLineHighlight */\n    );\n    _this._contentLeft = layoutInfo.contentLeft;\n    _this._contentWidth = layoutInfo.contentWidth;\n    _this._selectionIsEmpty = true;\n    _this._cursorLineNumbers = [];\n    _this._selections = [];\n    _this._renderData = null;\n\n    _this._context.addEventHandler(_this);\n\n    return _this;\n  }\n\n  AbstractLineHighlightOverlay.prototype.dispose = function () {\n    this._context.removeEventHandler(this);\n\n    _super.prototype.dispose.call(this);\n  };\n\n  AbstractLineHighlightOverlay.prototype._readFromSelections = function () {\n    var hasChanged = false; // Only render the first selection when using border\n\n    var renderSelections = isRenderedUsingBorder ? this._selections.slice(0, 1) : this._selections;\n    var cursorsLineNumbers = renderSelections.map(function (s) {\n      return s.positionLineNumber;\n    });\n    cursorsLineNumbers.sort(function (a, b) {\n      return a - b;\n    });\n\n    if (!arrays.equals(this._cursorLineNumbers, cursorsLineNumbers)) {\n      this._cursorLineNumbers = cursorsLineNumbers;\n      hasChanged = true;\n    }\n\n    var selectionIsEmpty = renderSelections.every(function (s) {\n      return s.isEmpty();\n    });\n\n    if (this._selectionIsEmpty !== selectionIsEmpty) {\n      this._selectionIsEmpty = selectionIsEmpty;\n      hasChanged = true;\n    }\n\n    return hasChanged;\n  }; // --- begin event handlers\n\n\n  AbstractLineHighlightOverlay.prototype.onThemeChanged = function (e) {\n    return this._readFromSelections();\n  };\n\n  AbstractLineHighlightOverlay.prototype.onConfigurationChanged = function (e) {\n    var options = this._context.configuration.options;\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    this._lineHeight = options.get(49\n    /* lineHeight */\n    );\n    this._renderLineHighlight = options.get(72\n    /* renderLineHighlight */\n    );\n    this._contentLeft = layoutInfo.contentLeft;\n    this._contentWidth = layoutInfo.contentWidth;\n    return true;\n  };\n\n  AbstractLineHighlightOverlay.prototype.onCursorStateChanged = function (e) {\n    this._selections = e.selections;\n    return this._readFromSelections();\n  };\n\n  AbstractLineHighlightOverlay.prototype.onFlushed = function (e) {\n    return true;\n  };\n\n  AbstractLineHighlightOverlay.prototype.onLinesDeleted = function (e) {\n    return true;\n  };\n\n  AbstractLineHighlightOverlay.prototype.onLinesInserted = function (e) {\n    return true;\n  };\n\n  AbstractLineHighlightOverlay.prototype.onScrollChanged = function (e) {\n    return e.scrollWidthChanged || e.scrollTopChanged;\n  };\n\n  AbstractLineHighlightOverlay.prototype.onZonesChanged = function (e) {\n    return true;\n  }; // --- end event handlers\n\n\n  AbstractLineHighlightOverlay.prototype.prepareRender = function (ctx) {\n    if (!this._shouldRenderThis()) {\n      this._renderData = null;\n      return;\n    }\n\n    var renderedLine = this._renderOne(ctx);\n\n    var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n    var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n    var len = this._cursorLineNumbers.length;\n    var index = 0;\n    var renderData = [];\n\n    for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n      var lineIndex = lineNumber - visibleStartLineNumber;\n\n      while (index < len && this._cursorLineNumbers[index] < lineNumber) {\n        index++;\n      }\n\n      if (index < len && this._cursorLineNumbers[index] === lineNumber) {\n        renderData[lineIndex] = renderedLine;\n      } else {\n        renderData[lineIndex] = '';\n      }\n    }\n\n    this._renderData = renderData;\n  };\n\n  AbstractLineHighlightOverlay.prototype.render = function (startLineNumber, lineNumber) {\n    if (!this._renderData) {\n      return '';\n    }\n\n    var lineIndex = lineNumber - startLineNumber;\n\n    if (lineIndex >= this._renderData.length) {\n      return '';\n    }\n\n    return this._renderData[lineIndex];\n  };\n\n  return AbstractLineHighlightOverlay;\n}(DynamicViewOverlay);\n\nexport { AbstractLineHighlightOverlay };\n\nvar CurrentLineHighlightOverlay =\n/** @class */\nfunction (_super) {\n  __extends(CurrentLineHighlightOverlay, _super);\n\n  function CurrentLineHighlightOverlay() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  CurrentLineHighlightOverlay.prototype._renderOne = function (ctx) {\n    var className = 'current-line' + (this._shouldRenderOther() ? ' current-line-both' : '');\n    return \"<div class=\\\"\" + className + \"\\\" style=\\\"width:\" + Math.max(ctx.scrollWidth, this._contentWidth) + \"px; height:\" + this._lineHeight + \"px;\\\"></div>\";\n  };\n\n  CurrentLineHighlightOverlay.prototype._shouldRenderThis = function () {\n    return (this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all') && this._selectionIsEmpty;\n  };\n\n  CurrentLineHighlightOverlay.prototype._shouldRenderOther = function () {\n    return this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all';\n  };\n\n  return CurrentLineHighlightOverlay;\n}(AbstractLineHighlightOverlay);\n\nexport { CurrentLineHighlightOverlay };\n\nvar CurrentLineMarginHighlightOverlay =\n/** @class */\nfunction (_super) {\n  __extends(CurrentLineMarginHighlightOverlay, _super);\n\n  function CurrentLineMarginHighlightOverlay() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  CurrentLineMarginHighlightOverlay.prototype._renderOne = function (ctx) {\n    var className = 'current-line current-line-margin' + (this._shouldRenderOther() ? ' current-line-margin-both' : '');\n    return \"<div class=\\\"\" + className + \"\\\" style=\\\"width:\" + this._contentLeft + \"px; height:\" + this._lineHeight + \"px;\\\"></div>\";\n  };\n\n  CurrentLineMarginHighlightOverlay.prototype._shouldRenderThis = function () {\n    return this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all';\n  };\n\n  CurrentLineMarginHighlightOverlay.prototype._shouldRenderOther = function () {\n    return (this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all') && this._selectionIsEmpty;\n  };\n\n  return CurrentLineMarginHighlightOverlay;\n}(AbstractLineHighlightOverlay);\n\nexport { CurrentLineMarginHighlightOverlay };\nregisterThemingParticipant(function (theme, collector) {\n  isRenderedUsingBorder = false;\n  var lineHighlight = theme.getColor(editorLineHighlight);\n\n  if (lineHighlight) {\n    collector.addRule(\".monaco-editor .view-overlays .current-line { background-color: \" + lineHighlight + \"; }\");\n    collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { background-color: \" + lineHighlight + \"; border: none; }\");\n  }\n\n  if (!lineHighlight || lineHighlight.isTransparent() || theme.defines(editorLineHighlightBorder)) {\n    var lineHighlightBorder = theme.getColor(editorLineHighlightBorder);\n\n    if (lineHighlightBorder) {\n      isRenderedUsingBorder = true;\n      collector.addRule(\".monaco-editor .view-overlays .current-line { border: 2px solid \" + lineHighlightBorder + \"; }\");\n      collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid \" + lineHighlightBorder + \"; }\");\n\n      if (theme.type === 'hc') {\n        collector.addRule(\".monaco-editor .view-overlays .current-line { border-width: 1px; }\");\n        collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }\");\n      }\n    }\n  }\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","DynamicViewOverlay","editorLineHighlight","editorLineHighlightBorder","arrays","registerThemingParticipant","isRenderedUsingBorder","AbstractLineHighlightOverlay","_super","context","_this","call","_context","options","configuration","layoutInfo","get","_lineHeight","_renderLineHighlight","_contentLeft","contentLeft","_contentWidth","contentWidth","_selectionIsEmpty","_cursorLineNumbers","_selections","_renderData","addEventHandler","dispose","removeEventHandler","_readFromSelections","hasChanged","renderSelections","slice","cursorsLineNumbers","map","s","positionLineNumber","sort","a","equals","selectionIsEmpty","every","isEmpty","onThemeChanged","e","onConfigurationChanged","onCursorStateChanged","selections","onFlushed","onLinesDeleted","onLinesInserted","onScrollChanged","scrollWidthChanged","scrollTopChanged","onZonesChanged","prepareRender","ctx","_shouldRenderThis","renderedLine","_renderOne","visibleStartLineNumber","visibleRange","startLineNumber","visibleEndLineNumber","endLineNumber","len","length","index","renderData","lineNumber","lineIndex","render","CurrentLineHighlightOverlay","apply","arguments","className","_shouldRenderOther","Math","max","scrollWidth","CurrentLineMarginHighlightOverlay","theme","collector","lineHighlight","getColor","addRule","isTransparent","defines","lineHighlightBorder","type"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './currentLineHighlight.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { editorLineHighlight, editorLineHighlightBorder } from '../../../common/view/editorColorRegistry.js';\r\nimport * as arrays from '../../../../base/common/arrays.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar isRenderedUsingBorder = true;\r\nvar AbstractLineHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(AbstractLineHighlightOverlay, _super);\r\n    function AbstractLineHighlightOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._renderLineHighlight = options.get(72 /* renderLineHighlight */);\r\n        _this._contentLeft = layoutInfo.contentLeft;\r\n        _this._contentWidth = layoutInfo.contentWidth;\r\n        _this._selectionIsEmpty = true;\r\n        _this._cursorLineNumbers = [];\r\n        _this._selections = [];\r\n        _this._renderData = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    AbstractLineHighlightOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    AbstractLineHighlightOverlay.prototype._readFromSelections = function () {\r\n        var hasChanged = false;\r\n        // Only render the first selection when using border\r\n        var renderSelections = isRenderedUsingBorder ? this._selections.slice(0, 1) : this._selections;\r\n        var cursorsLineNumbers = renderSelections.map(function (s) { return s.positionLineNumber; });\r\n        cursorsLineNumbers.sort(function (a, b) { return a - b; });\r\n        if (!arrays.equals(this._cursorLineNumbers, cursorsLineNumbers)) {\r\n            this._cursorLineNumbers = cursorsLineNumbers;\r\n            hasChanged = true;\r\n        }\r\n        var selectionIsEmpty = renderSelections.every(function (s) { return s.isEmpty(); });\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            hasChanged = true;\r\n        }\r\n        return hasChanged;\r\n    };\r\n    // --- begin event handlers\r\n    AbstractLineHighlightOverlay.prototype.onThemeChanged = function (e) {\r\n        return this._readFromSelections();\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._renderLineHighlight = options.get(72 /* renderLineHighlight */);\r\n        this._contentLeft = layoutInfo.contentLeft;\r\n        this._contentWidth = layoutInfo.contentWidth;\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onCursorStateChanged = function (e) {\r\n        this._selections = e.selections;\r\n        return this._readFromSelections();\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollWidthChanged || e.scrollTopChanged;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    AbstractLineHighlightOverlay.prototype.prepareRender = function (ctx) {\r\n        if (!this._shouldRenderThis()) {\r\n            this._renderData = null;\r\n            return;\r\n        }\r\n        var renderedLine = this._renderOne(ctx);\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var len = this._cursorLineNumbers.length;\r\n        var index = 0;\r\n        var renderData = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            while (index < len && this._cursorLineNumbers[index] < lineNumber) {\r\n                index++;\r\n            }\r\n            if (index < len && this._cursorLineNumbers[index] === lineNumber) {\r\n                renderData[lineIndex] = renderedLine;\r\n            }\r\n            else {\r\n                renderData[lineIndex] = '';\r\n            }\r\n        }\r\n        this._renderData = renderData;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderData) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex >= this._renderData.length) {\r\n            return '';\r\n        }\r\n        return this._renderData[lineIndex];\r\n    };\r\n    return AbstractLineHighlightOverlay;\r\n}(DynamicViewOverlay));\r\nexport { AbstractLineHighlightOverlay };\r\nvar CurrentLineHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(CurrentLineHighlightOverlay, _super);\r\n    function CurrentLineHighlightOverlay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CurrentLineHighlightOverlay.prototype._renderOne = function (ctx) {\r\n        var className = 'current-line' + (this._shouldRenderOther() ? ' current-line-both' : '');\r\n        return \"<div class=\\\"\" + className + \"\\\" style=\\\"width:\" + Math.max(ctx.scrollWidth, this._contentWidth) + \"px; height:\" + this._lineHeight + \"px;\\\"></div>\";\r\n    };\r\n    CurrentLineHighlightOverlay.prototype._shouldRenderThis = function () {\r\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\r\n            && this._selectionIsEmpty);\r\n    };\r\n    CurrentLineHighlightOverlay.prototype._shouldRenderOther = function () {\r\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all'));\r\n    };\r\n    return CurrentLineHighlightOverlay;\r\n}(AbstractLineHighlightOverlay));\r\nexport { CurrentLineHighlightOverlay };\r\nvar CurrentLineMarginHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(CurrentLineMarginHighlightOverlay, _super);\r\n    function CurrentLineMarginHighlightOverlay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CurrentLineMarginHighlightOverlay.prototype._renderOne = function (ctx) {\r\n        var className = 'current-line current-line-margin' + (this._shouldRenderOther() ? ' current-line-margin-both' : '');\r\n        return \"<div class=\\\"\" + className + \"\\\" style=\\\"width:\" + this._contentLeft + \"px; height:\" + this._lineHeight + \"px;\\\"></div>\";\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype._shouldRenderThis = function () {\r\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all'));\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype._shouldRenderOther = function () {\r\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\r\n            && this._selectionIsEmpty);\r\n    };\r\n    return CurrentLineMarginHighlightOverlay;\r\n}(AbstractLineHighlightOverlay));\r\nexport { CurrentLineMarginHighlightOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    isRenderedUsingBorder = false;\r\n    var lineHighlight = theme.getColor(editorLineHighlight);\r\n    if (lineHighlight) {\r\n        collector.addRule(\".monaco-editor .view-overlays .current-line { background-color: \" + lineHighlight + \"; }\");\r\n        collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { background-color: \" + lineHighlight + \"; border: none; }\");\r\n    }\r\n    if (!lineHighlight || lineHighlight.isTransparent() || theme.defines(editorLineHighlightBorder)) {\r\n        var lineHighlightBorder = theme.getColor(editorLineHighlightBorder);\r\n        if (lineHighlightBorder) {\r\n            isRenderedUsingBorder = true;\r\n            collector.addRule(\".monaco-editor .view-overlays .current-line { border: 2px solid \" + lineHighlightBorder + \"; }\");\r\n            collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid \" + lineHighlightBorder + \"; }\");\r\n            if (theme.type === 'hc') {\r\n                collector.addRule(\".monaco-editor .view-overlays .current-line { border-width: 1px; }\");\r\n                collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }\");\r\n            }\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}