{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport * as nls from '../../../nls.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\n\nvar CursorState =\n/** @class */\nfunction () {\n  function CursorState(selections) {\n    this.selections = selections;\n  }\n\n  CursorState.prototype.equals = function (other) {\n    var thisLen = this.selections.length;\n    var otherLen = other.selections.length;\n\n    if (thisLen !== otherLen) {\n      return false;\n    }\n\n    for (var i = 0; i < thisLen; i++) {\n      if (!this.selections[i].equalsSelection(other.selections[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  return CursorState;\n}();\n\nvar StackElement =\n/** @class */\nfunction () {\n  function StackElement(cursorState, scrollTop, scrollLeft) {\n    this.cursorState = cursorState;\n    this.scrollTop = scrollTop;\n    this.scrollLeft = scrollLeft;\n  }\n\n  return StackElement;\n}();\n\nvar CursorUndoRedoController =\n/** @class */\nfunction (_super) {\n  __extends(CursorUndoRedoController, _super);\n\n  function CursorUndoRedoController(editor) {\n    var _this = _super.call(this) || this;\n\n    _this._editor = editor;\n    _this._isCursorUndoRedo = false;\n    _this._undoStack = [];\n    _this._redoStack = [];\n\n    _this._register(editor.onDidChangeModel(function (e) {\n      _this._undoStack = [];\n      _this._redoStack = [];\n    }));\n\n    _this._register(editor.onDidChangeModelContent(function (e) {\n      _this._undoStack = [];\n      _this._redoStack = [];\n    }));\n\n    _this._register(editor.onDidChangeCursorSelection(function (e) {\n      if (_this._isCursorUndoRedo) {\n        return;\n      }\n\n      if (!e.oldSelections) {\n        return;\n      }\n\n      if (e.oldModelVersionId !== e.modelVersionId) {\n        return;\n      }\n\n      var prevState = new CursorState(e.oldSelections);\n\n      var isEqualToLastUndoStack = _this._undoStack.length > 0 && _this._undoStack[_this._undoStack.length - 1].cursorState.equals(prevState);\n\n      if (!isEqualToLastUndoStack) {\n        _this._undoStack.push(new StackElement(prevState, editor.getScrollTop(), editor.getScrollLeft()));\n\n        _this._redoStack = [];\n\n        if (_this._undoStack.length > 50) {\n          // keep the cursor undo stack bounded\n          _this._undoStack.shift();\n        }\n      }\n    }));\n\n    return _this;\n  }\n\n  CursorUndoRedoController.get = function (editor) {\n    return editor.getContribution(CursorUndoRedoController.ID);\n  };\n\n  CursorUndoRedoController.prototype.cursorUndo = function () {\n    if (!this._editor.hasModel() || this._undoStack.length === 0) {\n      return;\n    }\n\n    this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n\n    this._applyState(this._undoStack.pop());\n  };\n\n  CursorUndoRedoController.prototype.cursorRedo = function () {\n    if (!this._editor.hasModel() || this._redoStack.length === 0) {\n      return;\n    }\n\n    this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n\n    this._applyState(this._redoStack.pop());\n  };\n\n  CursorUndoRedoController.prototype._applyState = function (stackElement) {\n    this._isCursorUndoRedo = true;\n\n    this._editor.setSelections(stackElement.cursorState.selections);\n\n    this._editor.setScrollPosition({\n      scrollTop: stackElement.scrollTop,\n      scrollLeft: stackElement.scrollLeft\n    });\n\n    this._isCursorUndoRedo = false;\n  };\n\n  CursorUndoRedoController.ID = 'editor.contrib.cursorUndoRedoController';\n  return CursorUndoRedoController;\n}(Disposable);\n\nexport { CursorUndoRedoController };\n\nvar CursorUndo =\n/** @class */\nfunction (_super) {\n  __extends(CursorUndo, _super);\n\n  function CursorUndo() {\n    return _super.call(this, {\n      id: 'cursorUndo',\n      label: nls.localize('cursor.undo', \"Cursor Undo\"),\n      alias: 'Cursor Undo',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048\n        /* CtrlCmd */\n        | 51\n        /* KEY_U */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  CursorUndo.prototype.run = function (accessor, editor, args) {\n    CursorUndoRedoController.get(editor).cursorUndo();\n  };\n\n  return CursorUndo;\n}(EditorAction);\n\nexport { CursorUndo };\n\nvar CursorRedo =\n/** @class */\nfunction (_super) {\n  __extends(CursorRedo, _super);\n\n  function CursorRedo() {\n    return _super.call(this, {\n      id: 'cursorRedo',\n      label: nls.localize('cursor.redo', \"Cursor Redo\"),\n      alias: 'Cursor Redo',\n      precondition: undefined\n    }) || this;\n  }\n\n  CursorRedo.prototype.run = function (accessor, editor, args) {\n    CursorUndoRedoController.get(editor).cursorRedo();\n  };\n\n  return CursorRedo;\n}(EditorAction);\n\nexport { CursorRedo };\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController);\nregisterEditorAction(CursorUndo);\nregisterEditorAction(CursorRedo);","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/cursorUndo.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","nls","Disposable","EditorAction","registerEditorAction","registerEditorContribution","EditorContextKeys","CursorState","selections","equals","other","thisLen","length","otherLen","i","equalsSelection","StackElement","cursorState","scrollTop","scrollLeft","CursorUndoRedoController","_super","editor","_this","call","_editor","_isCursorUndoRedo","_undoStack","_redoStack","_register","onDidChangeModel","e","onDidChangeModelContent","onDidChangeCursorSelection","oldSelections","oldModelVersionId","modelVersionId","prevState","isEqualToLastUndoStack","push","getScrollTop","getScrollLeft","shift","get","getContribution","ID","cursorUndo","hasModel","getSelections","_applyState","pop","cursorRedo","stackElement","setSelections","setScrollPosition","CursorUndo","id","label","localize","alias","precondition","undefined","kbOpts","kbExpr","textInputFocus","primary","weight","run","accessor","args","CursorRedo"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nvar CursorState = /** @class */ (function () {\r\n    function CursorState(selections) {\r\n        this.selections = selections;\r\n    }\r\n    CursorState.prototype.equals = function (other) {\r\n        var thisLen = this.selections.length;\r\n        var otherLen = other.selections.length;\r\n        if (thisLen !== otherLen) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < thisLen; i++) {\r\n            if (!this.selections[i].equalsSelection(other.selections[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    return CursorState;\r\n}());\r\nvar StackElement = /** @class */ (function () {\r\n    function StackElement(cursorState, scrollTop, scrollLeft) {\r\n        this.cursorState = cursorState;\r\n        this.scrollTop = scrollTop;\r\n        this.scrollLeft = scrollLeft;\r\n    }\r\n    return StackElement;\r\n}());\r\nvar CursorUndoRedoController = /** @class */ (function (_super) {\r\n    __extends(CursorUndoRedoController, _super);\r\n    function CursorUndoRedoController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._isCursorUndoRedo = false;\r\n        _this._undoStack = [];\r\n        _this._redoStack = [];\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._undoStack = [];\r\n            _this._redoStack = [];\r\n        }));\r\n        _this._register(editor.onDidChangeModelContent(function (e) {\r\n            _this._undoStack = [];\r\n            _this._redoStack = [];\r\n        }));\r\n        _this._register(editor.onDidChangeCursorSelection(function (e) {\r\n            if (_this._isCursorUndoRedo) {\r\n                return;\r\n            }\r\n            if (!e.oldSelections) {\r\n                return;\r\n            }\r\n            if (e.oldModelVersionId !== e.modelVersionId) {\r\n                return;\r\n            }\r\n            var prevState = new CursorState(e.oldSelections);\r\n            var isEqualToLastUndoStack = (_this._undoStack.length > 0 && _this._undoStack[_this._undoStack.length - 1].cursorState.equals(prevState));\r\n            if (!isEqualToLastUndoStack) {\r\n                _this._undoStack.push(new StackElement(prevState, editor.getScrollTop(), editor.getScrollLeft()));\r\n                _this._redoStack = [];\r\n                if (_this._undoStack.length > 50) {\r\n                    // keep the cursor undo stack bounded\r\n                    _this._undoStack.shift();\r\n                }\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    CursorUndoRedoController.get = function (editor) {\r\n        return editor.getContribution(CursorUndoRedoController.ID);\r\n    };\r\n    CursorUndoRedoController.prototype.cursorUndo = function () {\r\n        if (!this._editor.hasModel() || this._undoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\r\n        this._applyState(this._undoStack.pop());\r\n    };\r\n    CursorUndoRedoController.prototype.cursorRedo = function () {\r\n        if (!this._editor.hasModel() || this._redoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\r\n        this._applyState(this._redoStack.pop());\r\n    };\r\n    CursorUndoRedoController.prototype._applyState = function (stackElement) {\r\n        this._isCursorUndoRedo = true;\r\n        this._editor.setSelections(stackElement.cursorState.selections);\r\n        this._editor.setScrollPosition({\r\n            scrollTop: stackElement.scrollTop,\r\n            scrollLeft: stackElement.scrollLeft\r\n        });\r\n        this._isCursorUndoRedo = false;\r\n    };\r\n    CursorUndoRedoController.ID = 'editor.contrib.cursorUndoRedoController';\r\n    return CursorUndoRedoController;\r\n}(Disposable));\r\nexport { CursorUndoRedoController };\r\nvar CursorUndo = /** @class */ (function (_super) {\r\n    __extends(CursorUndo, _super);\r\n    function CursorUndo() {\r\n        return _super.call(this, {\r\n            id: 'cursorUndo',\r\n            label: nls.localize('cursor.undo', \"Cursor Undo\"),\r\n            alias: 'Cursor Undo',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 51 /* KEY_U */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorUndo.prototype.run = function (accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorUndo();\r\n    };\r\n    return CursorUndo;\r\n}(EditorAction));\r\nexport { CursorUndo };\r\nvar CursorRedo = /** @class */ (function (_super) {\r\n    __extends(CursorRedo, _super);\r\n    function CursorRedo() {\r\n        return _super.call(this, {\r\n            id: 'cursorRedo',\r\n            label: nls.localize('cursor.redo', \"Cursor Redo\"),\r\n            alias: 'Cursor Redo',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    CursorRedo.prototype.run = function (accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorRedo();\r\n    };\r\n    return CursorRedo;\r\n}(EditorAction));\r\nexport { CursorRedo };\r\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController);\r\nregisterEditorAction(CursorUndo);\r\nregisterEditorAction(CursorRedo);\r\n"]},"metadata":{},"sourceType":"module"}