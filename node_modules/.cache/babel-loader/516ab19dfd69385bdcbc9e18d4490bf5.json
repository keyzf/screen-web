{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\nimport { Configuration } from '../config/configuration.js';\nimport { VisibleLinesCollection } from './viewLayer.js';\nimport { ViewPart } from './viewPart.js';\n\nvar ViewOverlays =\n/** @class */\nfunction (_super) {\n  __extends(ViewOverlays, _super);\n\n  function ViewOverlays(context) {\n    var _this = _super.call(this, context) || this;\n\n    _this._visibleLines = new VisibleLinesCollection(_this);\n    _this.domNode = _this._visibleLines.domNode;\n    _this._dynamicOverlays = [];\n    _this._isFocused = false;\n\n    _this.domNode.setClassName('view-overlays');\n\n    return _this;\n  }\n\n  ViewOverlays.prototype.shouldRender = function () {\n    if (_super.prototype.shouldRender.call(this)) {\n      return true;\n    }\n\n    for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\n      var dynamicOverlay = this._dynamicOverlays[i];\n\n      if (dynamicOverlay.shouldRender()) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  ViewOverlays.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\n      var dynamicOverlay = this._dynamicOverlays[i];\n      dynamicOverlay.dispose();\n    }\n\n    this._dynamicOverlays = [];\n  };\n\n  ViewOverlays.prototype.getDomNode = function () {\n    return this.domNode;\n  }; // ---- begin IVisibleLinesHost\n\n\n  ViewOverlays.prototype.createVisibleLine = function () {\n    return new ViewOverlayLine(this._context.configuration, this._dynamicOverlays);\n  }; // ---- end IVisibleLinesHost\n\n\n  ViewOverlays.prototype.addDynamicOverlay = function (overlay) {\n    this._dynamicOverlays.push(overlay);\n  }; // ----- event handlers\n\n\n  ViewOverlays.prototype.onConfigurationChanged = function (e) {\n    this._visibleLines.onConfigurationChanged(e);\n\n    var startLineNumber = this._visibleLines.getStartLineNumber();\n\n    var endLineNumber = this._visibleLines.getEndLineNumber();\n\n    for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n      var line = this._visibleLines.getVisibleLine(lineNumber);\n\n      line.onConfigurationChanged(e);\n    }\n\n    return true;\n  };\n\n  ViewOverlays.prototype.onFlushed = function (e) {\n    return this._visibleLines.onFlushed(e);\n  };\n\n  ViewOverlays.prototype.onFocusChanged = function (e) {\n    this._isFocused = e.isFocused;\n    return true;\n  };\n\n  ViewOverlays.prototype.onLinesChanged = function (e) {\n    return this._visibleLines.onLinesChanged(e);\n  };\n\n  ViewOverlays.prototype.onLinesDeleted = function (e) {\n    return this._visibleLines.onLinesDeleted(e);\n  };\n\n  ViewOverlays.prototype.onLinesInserted = function (e) {\n    return this._visibleLines.onLinesInserted(e);\n  };\n\n  ViewOverlays.prototype.onScrollChanged = function (e) {\n    return this._visibleLines.onScrollChanged(e) || true;\n  };\n\n  ViewOverlays.prototype.onTokensChanged = function (e) {\n    return this._visibleLines.onTokensChanged(e);\n  };\n\n  ViewOverlays.prototype.onZonesChanged = function (e) {\n    return this._visibleLines.onZonesChanged(e);\n  }; // ----- end event handlers\n\n\n  ViewOverlays.prototype.prepareRender = function (ctx) {\n    var toRender = this._dynamicOverlays.filter(function (overlay) {\n      return overlay.shouldRender();\n    });\n\n    for (var i = 0, len = toRender.length; i < len; i++) {\n      var dynamicOverlay = toRender[i];\n      dynamicOverlay.prepareRender(ctx);\n      dynamicOverlay.onDidRender();\n    }\n  };\n\n  ViewOverlays.prototype.render = function (ctx) {\n    // Overwriting to bypass `shouldRender` flag\n    this._viewOverlaysRender(ctx);\n\n    this.domNode.toggleClassName('focused', this._isFocused);\n  };\n\n  ViewOverlays.prototype._viewOverlaysRender = function (ctx) {\n    this._visibleLines.renderLines(ctx.viewportData);\n  };\n\n  return ViewOverlays;\n}(ViewPart);\n\nexport { ViewOverlays };\n\nvar ViewOverlayLine =\n/** @class */\nfunction () {\n  function ViewOverlayLine(configuration, dynamicOverlays) {\n    this._configuration = configuration;\n    this._lineHeight = this._configuration.options.get(49\n    /* lineHeight */\n    );\n    this._dynamicOverlays = dynamicOverlays;\n    this._domNode = null;\n    this._renderedContent = null;\n  }\n\n  ViewOverlayLine.prototype.getDomNode = function () {\n    if (!this._domNode) {\n      return null;\n    }\n\n    return this._domNode.domNode;\n  };\n\n  ViewOverlayLine.prototype.setDomNode = function (domNode) {\n    this._domNode = createFastDomNode(domNode);\n  };\n\n  ViewOverlayLine.prototype.onContentChanged = function () {// Nothing\n  };\n\n  ViewOverlayLine.prototype.onTokensChanged = function () {// Nothing\n  };\n\n  ViewOverlayLine.prototype.onConfigurationChanged = function (e) {\n    this._lineHeight = this._configuration.options.get(49\n    /* lineHeight */\n    );\n  };\n\n  ViewOverlayLine.prototype.renderLine = function (lineNumber, deltaTop, viewportData, sb) {\n    var result = '';\n\n    for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\n      var dynamicOverlay = this._dynamicOverlays[i];\n      result += dynamicOverlay.render(viewportData.startLineNumber, lineNumber);\n    }\n\n    if (this._renderedContent === result) {\n      // No rendering needed\n      return false;\n    }\n\n    this._renderedContent = result;\n    sb.appendASCIIString('<div style=\"position:absolute;top:');\n    sb.appendASCIIString(String(deltaTop));\n    sb.appendASCIIString('px;width:100%;height:');\n    sb.appendASCIIString(String(this._lineHeight));\n    sb.appendASCIIString('px;\">');\n    sb.appendASCIIString(result);\n    sb.appendASCIIString('</div>');\n    return true;\n  };\n\n  ViewOverlayLine.prototype.layoutLine = function (lineNumber, deltaTop) {\n    if (this._domNode) {\n      this._domNode.setTop(deltaTop);\n\n      this._domNode.setHeight(this._lineHeight);\n    }\n  };\n\n  return ViewOverlayLine;\n}();\n\nexport { ViewOverlayLine };\n\nvar ContentViewOverlays =\n/** @class */\nfunction (_super) {\n  __extends(ContentViewOverlays, _super);\n\n  function ContentViewOverlays(context) {\n    var _this = _super.call(this, context) || this;\n\n    var options = _this._context.configuration.options;\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    _this._contentWidth = layoutInfo.contentWidth;\n\n    _this.domNode.setHeight(0);\n\n    return _this;\n  } // --- begin event handlers\n\n\n  ContentViewOverlays.prototype.onConfigurationChanged = function (e) {\n    var options = this._context.configuration.options;\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    this._contentWidth = layoutInfo.contentWidth;\n    return _super.prototype.onConfigurationChanged.call(this, e) || true;\n  };\n\n  ContentViewOverlays.prototype.onScrollChanged = function (e) {\n    return _super.prototype.onScrollChanged.call(this, e) || e.scrollWidthChanged;\n  }; // --- end event handlers\n\n\n  ContentViewOverlays.prototype._viewOverlaysRender = function (ctx) {\n    _super.prototype._viewOverlaysRender.call(this, ctx);\n\n    this.domNode.setWidth(Math.max(ctx.scrollWidth, this._contentWidth));\n  };\n\n  return ContentViewOverlays;\n}(ViewOverlays);\n\nexport { ContentViewOverlays };\n\nvar MarginViewOverlays =\n/** @class */\nfunction (_super) {\n  __extends(MarginViewOverlays, _super);\n\n  function MarginViewOverlays(context) {\n    var _this = _super.call(this, context) || this;\n\n    var options = _this._context.configuration.options;\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    _this._contentLeft = layoutInfo.contentLeft;\n\n    _this.domNode.setClassName('margin-view-overlays');\n\n    _this.domNode.setWidth(1);\n\n    Configuration.applyFontInfo(_this.domNode, options.get(34\n    /* fontInfo */\n    ));\n    return _this;\n  }\n\n  MarginViewOverlays.prototype.onConfigurationChanged = function (e) {\n    var options = this._context.configuration.options;\n    Configuration.applyFontInfo(this.domNode, options.get(34\n    /* fontInfo */\n    ));\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    this._contentLeft = layoutInfo.contentLeft;\n    return _super.prototype.onConfigurationChanged.call(this, e) || true;\n  };\n\n  MarginViewOverlays.prototype.onScrollChanged = function (e) {\n    return _super.prototype.onScrollChanged.call(this, e) || e.scrollHeightChanged;\n  };\n\n  MarginViewOverlays.prototype._viewOverlaysRender = function (ctx) {\n    _super.prototype._viewOverlaysRender.call(this, ctx);\n\n    var height = Math.min(ctx.scrollHeight, 1000000);\n    this.domNode.setHeight(height);\n    this.domNode.setWidth(this._contentLeft);\n  };\n\n  return MarginViewOverlays;\n}(ViewOverlays);\n\nexport { MarginViewOverlays };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/browser/view/viewOverlays.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createFastDomNode","Configuration","VisibleLinesCollection","ViewPart","ViewOverlays","_super","context","_this","call","_visibleLines","domNode","_dynamicOverlays","_isFocused","setClassName","shouldRender","i","len","length","dynamicOverlay","dispose","getDomNode","createVisibleLine","ViewOverlayLine","_context","configuration","addDynamicOverlay","overlay","push","onConfigurationChanged","e","startLineNumber","getStartLineNumber","endLineNumber","getEndLineNumber","lineNumber","line","getVisibleLine","onFlushed","onFocusChanged","isFocused","onLinesChanged","onLinesDeleted","onLinesInserted","onScrollChanged","onTokensChanged","onZonesChanged","prepareRender","ctx","toRender","filter","onDidRender","render","_viewOverlaysRender","toggleClassName","renderLines","viewportData","dynamicOverlays","_configuration","_lineHeight","options","get","_domNode","_renderedContent","setDomNode","onContentChanged","renderLine","deltaTop","sb","result","appendASCIIString","String","layoutLine","setTop","setHeight","ContentViewOverlays","layoutInfo","_contentWidth","contentWidth","scrollWidthChanged","setWidth","Math","max","scrollWidth","MarginViewOverlays","_contentLeft","contentLeft","applyFontInfo","scrollHeightChanged","height","min","scrollHeight"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { VisibleLinesCollection } from './viewLayer.js';\r\nimport { ViewPart } from './viewPart.js';\r\nvar ViewOverlays = /** @class */ (function (_super) {\r\n    __extends(ViewOverlays, _super);\r\n    function ViewOverlays(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._visibleLines = new VisibleLinesCollection(_this);\r\n        _this.domNode = _this._visibleLines.domNode;\r\n        _this._dynamicOverlays = [];\r\n        _this._isFocused = false;\r\n        _this.domNode.setClassName('view-overlays');\r\n        return _this;\r\n    }\r\n    ViewOverlays.prototype.shouldRender = function () {\r\n        if (_super.prototype.shouldRender.call(this)) {\r\n            return true;\r\n        }\r\n        for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\r\n            var dynamicOverlay = this._dynamicOverlays[i];\r\n            if (dynamicOverlay.shouldRender()) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    ViewOverlays.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\r\n            var dynamicOverlay = this._dynamicOverlays[i];\r\n            dynamicOverlay.dispose();\r\n        }\r\n        this._dynamicOverlays = [];\r\n    };\r\n    ViewOverlays.prototype.getDomNode = function () {\r\n        return this.domNode;\r\n    };\r\n    // ---- begin IVisibleLinesHost\r\n    ViewOverlays.prototype.createVisibleLine = function () {\r\n        return new ViewOverlayLine(this._context.configuration, this._dynamicOverlays);\r\n    };\r\n    // ---- end IVisibleLinesHost\r\n    ViewOverlays.prototype.addDynamicOverlay = function (overlay) {\r\n        this._dynamicOverlays.push(overlay);\r\n    };\r\n    // ----- event handlers\r\n    ViewOverlays.prototype.onConfigurationChanged = function (e) {\r\n        this._visibleLines.onConfigurationChanged(e);\r\n        var startLineNumber = this._visibleLines.getStartLineNumber();\r\n        var endLineNumber = this._visibleLines.getEndLineNumber();\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var line = this._visibleLines.getVisibleLine(lineNumber);\r\n            line.onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewOverlays.prototype.onFlushed = function (e) {\r\n        return this._visibleLines.onFlushed(e);\r\n    };\r\n    ViewOverlays.prototype.onFocusChanged = function (e) {\r\n        this._isFocused = e.isFocused;\r\n        return true;\r\n    };\r\n    ViewOverlays.prototype.onLinesChanged = function (e) {\r\n        return this._visibleLines.onLinesChanged(e);\r\n    };\r\n    ViewOverlays.prototype.onLinesDeleted = function (e) {\r\n        return this._visibleLines.onLinesDeleted(e);\r\n    };\r\n    ViewOverlays.prototype.onLinesInserted = function (e) {\r\n        return this._visibleLines.onLinesInserted(e);\r\n    };\r\n    ViewOverlays.prototype.onScrollChanged = function (e) {\r\n        return this._visibleLines.onScrollChanged(e) || true;\r\n    };\r\n    ViewOverlays.prototype.onTokensChanged = function (e) {\r\n        return this._visibleLines.onTokensChanged(e);\r\n    };\r\n    ViewOverlays.prototype.onZonesChanged = function (e) {\r\n        return this._visibleLines.onZonesChanged(e);\r\n    };\r\n    // ----- end event handlers\r\n    ViewOverlays.prototype.prepareRender = function (ctx) {\r\n        var toRender = this._dynamicOverlays.filter(function (overlay) { return overlay.shouldRender(); });\r\n        for (var i = 0, len = toRender.length; i < len; i++) {\r\n            var dynamicOverlay = toRender[i];\r\n            dynamicOverlay.prepareRender(ctx);\r\n            dynamicOverlay.onDidRender();\r\n        }\r\n    };\r\n    ViewOverlays.prototype.render = function (ctx) {\r\n        // Overwriting to bypass `shouldRender` flag\r\n        this._viewOverlaysRender(ctx);\r\n        this.domNode.toggleClassName('focused', this._isFocused);\r\n    };\r\n    ViewOverlays.prototype._viewOverlaysRender = function (ctx) {\r\n        this._visibleLines.renderLines(ctx.viewportData);\r\n    };\r\n    return ViewOverlays;\r\n}(ViewPart));\r\nexport { ViewOverlays };\r\nvar ViewOverlayLine = /** @class */ (function () {\r\n    function ViewOverlayLine(configuration, dynamicOverlays) {\r\n        this._configuration = configuration;\r\n        this._lineHeight = this._configuration.options.get(49 /* lineHeight */);\r\n        this._dynamicOverlays = dynamicOverlays;\r\n        this._domNode = null;\r\n        this._renderedContent = null;\r\n    }\r\n    ViewOverlayLine.prototype.getDomNode = function () {\r\n        if (!this._domNode) {\r\n            return null;\r\n        }\r\n        return this._domNode.domNode;\r\n    };\r\n    ViewOverlayLine.prototype.setDomNode = function (domNode) {\r\n        this._domNode = createFastDomNode(domNode);\r\n    };\r\n    ViewOverlayLine.prototype.onContentChanged = function () {\r\n        // Nothing\r\n    };\r\n    ViewOverlayLine.prototype.onTokensChanged = function () {\r\n        // Nothing\r\n    };\r\n    ViewOverlayLine.prototype.onConfigurationChanged = function (e) {\r\n        this._lineHeight = this._configuration.options.get(49 /* lineHeight */);\r\n    };\r\n    ViewOverlayLine.prototype.renderLine = function (lineNumber, deltaTop, viewportData, sb) {\r\n        var result = '';\r\n        for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\r\n            var dynamicOverlay = this._dynamicOverlays[i];\r\n            result += dynamicOverlay.render(viewportData.startLineNumber, lineNumber);\r\n        }\r\n        if (this._renderedContent === result) {\r\n            // No rendering needed\r\n            return false;\r\n        }\r\n        this._renderedContent = result;\r\n        sb.appendASCIIString('<div style=\"position:absolute;top:');\r\n        sb.appendASCIIString(String(deltaTop));\r\n        sb.appendASCIIString('px;width:100%;height:');\r\n        sb.appendASCIIString(String(this._lineHeight));\r\n        sb.appendASCIIString('px;\">');\r\n        sb.appendASCIIString(result);\r\n        sb.appendASCIIString('</div>');\r\n        return true;\r\n    };\r\n    ViewOverlayLine.prototype.layoutLine = function (lineNumber, deltaTop) {\r\n        if (this._domNode) {\r\n            this._domNode.setTop(deltaTop);\r\n            this._domNode.setHeight(this._lineHeight);\r\n        }\r\n    };\r\n    return ViewOverlayLine;\r\n}());\r\nexport { ViewOverlayLine };\r\nvar ContentViewOverlays = /** @class */ (function (_super) {\r\n    __extends(ContentViewOverlays, _super);\r\n    function ContentViewOverlays(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._contentWidth = layoutInfo.contentWidth;\r\n        _this.domNode.setHeight(0);\r\n        return _this;\r\n    }\r\n    // --- begin event handlers\r\n    ContentViewOverlays.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._contentWidth = layoutInfo.contentWidth;\r\n        return _super.prototype.onConfigurationChanged.call(this, e) || true;\r\n    };\r\n    ContentViewOverlays.prototype.onScrollChanged = function (e) {\r\n        return _super.prototype.onScrollChanged.call(this, e) || e.scrollWidthChanged;\r\n    };\r\n    // --- end event handlers\r\n    ContentViewOverlays.prototype._viewOverlaysRender = function (ctx) {\r\n        _super.prototype._viewOverlaysRender.call(this, ctx);\r\n        this.domNode.setWidth(Math.max(ctx.scrollWidth, this._contentWidth));\r\n    };\r\n    return ContentViewOverlays;\r\n}(ViewOverlays));\r\nexport { ContentViewOverlays };\r\nvar MarginViewOverlays = /** @class */ (function (_super) {\r\n    __extends(MarginViewOverlays, _super);\r\n    function MarginViewOverlays(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._contentLeft = layoutInfo.contentLeft;\r\n        _this.domNode.setClassName('margin-view-overlays');\r\n        _this.domNode.setWidth(1);\r\n        Configuration.applyFontInfo(_this.domNode, options.get(34 /* fontInfo */));\r\n        return _this;\r\n    }\r\n    MarginViewOverlays.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        Configuration.applyFontInfo(this.domNode, options.get(34 /* fontInfo */));\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._contentLeft = layoutInfo.contentLeft;\r\n        return _super.prototype.onConfigurationChanged.call(this, e) || true;\r\n    };\r\n    MarginViewOverlays.prototype.onScrollChanged = function (e) {\r\n        return _super.prototype.onScrollChanged.call(this, e) || e.scrollHeightChanged;\r\n    };\r\n    MarginViewOverlays.prototype._viewOverlaysRender = function (ctx) {\r\n        _super.prototype._viewOverlaysRender.call(this, ctx);\r\n        var height = Math.min(ctx.scrollHeight, 1000000);\r\n        this.domNode.setHeight(height);\r\n        this.domNode.setWidth(this._contentLeft);\r\n    };\r\n    return MarginViewOverlays;\r\n}(ViewOverlays));\r\nexport { MarginViewOverlays };\r\n"]},"metadata":{},"sourceType":"module"}