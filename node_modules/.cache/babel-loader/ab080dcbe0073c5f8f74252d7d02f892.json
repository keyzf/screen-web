{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport * as DOM from './dom.js';\nexport function renderText(text, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var element = createElement(options);\n  element.textContent = text;\n  return element;\n}\nexport function renderFormattedText(formattedText, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var element = createElement(options);\n\n  _renderFormattedText(element, parseFormattedText(formattedText), options.actionHandler);\n\n  return element;\n}\nexport function createElement(options) {\n  var tagName = options.inline ? 'span' : 'div';\n  var element = document.createElement(tagName);\n\n  if (options.className) {\n    element.className = options.className;\n  }\n\n  return element;\n}\n\nvar StringStream =\n/** @class */\nfunction () {\n  function StringStream(source) {\n    this.source = source;\n    this.index = 0;\n  }\n\n  StringStream.prototype.eos = function () {\n    return this.index >= this.source.length;\n  };\n\n  StringStream.prototype.next = function () {\n    var next = this.peek();\n    this.advance();\n    return next;\n  };\n\n  StringStream.prototype.peek = function () {\n    return this.source[this.index];\n  };\n\n  StringStream.prototype.advance = function () {\n    this.index++;\n  };\n\n  return StringStream;\n}();\n\nfunction _renderFormattedText(element, treeNode, actionHandler) {\n  var child;\n\n  if (treeNode.type === 2\n  /* Text */\n  ) {\n      child = document.createTextNode(treeNode.content || '');\n    } else if (treeNode.type === 3\n  /* Bold */\n  ) {\n      child = document.createElement('b');\n    } else if (treeNode.type === 4\n  /* Italics */\n  ) {\n      child = document.createElement('i');\n    } else if (treeNode.type === 5\n  /* Action */\n  && actionHandler) {\n    var a = document.createElement('a');\n    a.href = '#';\n    actionHandler.disposeables.add(DOM.addStandardDisposableListener(a, 'click', function (event) {\n      actionHandler.callback(String(treeNode.index), event);\n    }));\n    child = a;\n  } else if (treeNode.type === 7\n  /* NewLine */\n  ) {\n      child = document.createElement('br');\n    } else if (treeNode.type === 1\n  /* Root */\n  ) {\n      child = element;\n    }\n\n  if (child && element !== child) {\n    element.appendChild(child);\n  }\n\n  if (child && Array.isArray(treeNode.children)) {\n    treeNode.children.forEach(function (nodeChild) {\n      _renderFormattedText(child, nodeChild, actionHandler);\n    });\n  }\n}\n\nfunction parseFormattedText(content) {\n  var root = {\n    type: 1\n    /* Root */\n    ,\n    children: []\n  };\n  var actionViewItemIndex = 0;\n  var current = root;\n  var stack = [];\n  var stream = new StringStream(content);\n\n  while (!stream.eos()) {\n    var next = stream.next();\n    var isEscapedFormatType = next === '\\\\' && formatTagType(stream.peek()) !== 0\n    /* Invalid */\n    ;\n\n    if (isEscapedFormatType) {\n      next = stream.next(); // unread the backslash if it escapes a format tag type\n    }\n\n    if (!isEscapedFormatType && isFormatTag(next) && next === stream.peek()) {\n      stream.advance();\n\n      if (current.type === 2\n      /* Text */\n      ) {\n          current = stack.pop();\n        }\n\n      var type = formatTagType(next);\n\n      if (current.type === type || current.type === 5\n      /* Action */\n      && type === 6\n      /* ActionClose */\n      ) {\n        current = stack.pop();\n      } else {\n        var newCurrent = {\n          type: type,\n          children: []\n        };\n\n        if (type === 5\n        /* Action */\n        ) {\n            newCurrent.index = actionViewItemIndex;\n            actionViewItemIndex++;\n          }\n\n        current.children.push(newCurrent);\n        stack.push(current);\n        current = newCurrent;\n      }\n    } else if (next === '\\n') {\n      if (current.type === 2\n      /* Text */\n      ) {\n          current = stack.pop();\n        }\n\n      current.children.push({\n        type: 7\n        /* NewLine */\n\n      });\n    } else {\n      if (current.type !== 2\n      /* Text */\n      ) {\n          var textCurrent = {\n            type: 2\n            /* Text */\n            ,\n            content: next\n          };\n          current.children.push(textCurrent);\n          stack.push(current);\n          current = textCurrent;\n        } else {\n        current.content += next;\n      }\n    }\n  }\n\n  if (current.type === 2\n  /* Text */\n  ) {\n      current = stack.pop();\n    }\n\n  if (stack.length) {// incorrectly formatted string literal\n  }\n\n  return root;\n}\n\nfunction isFormatTag(char) {\n  return formatTagType(char) !== 0\n  /* Invalid */\n  ;\n}\n\nfunction formatTagType(char) {\n  switch (char) {\n    case '*':\n      return 3\n      /* Bold */\n      ;\n\n    case '_':\n      return 4\n      /* Italics */\n      ;\n\n    case '[':\n      return 5\n      /* Action */\n      ;\n\n    case ']':\n      return 6\n      /* ActionClose */\n      ;\n\n    default:\n      return 0\n      /* Invalid */\n      ;\n  }\n}","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/base/browser/formattedTextRenderer.js"],"names":["DOM","renderText","text","options","element","createElement","textContent","renderFormattedText","formattedText","_renderFormattedText","parseFormattedText","actionHandler","tagName","inline","document","className","StringStream","source","index","prototype","eos","length","next","peek","advance","treeNode","child","type","createTextNode","content","a","href","disposeables","add","addStandardDisposableListener","event","callback","String","appendChild","Array","isArray","children","forEach","nodeChild","root","actionViewItemIndex","current","stack","stream","isEscapedFormatType","formatTagType","isFormatTag","pop","newCurrent","push","textCurrent","char"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as DOM from './dom.js';\r\nexport function renderText(text, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    element.textContent = text;\r\n    return element;\r\n}\r\nexport function renderFormattedText(formattedText, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    _renderFormattedText(element, parseFormattedText(formattedText), options.actionHandler);\r\n    return element;\r\n}\r\nexport function createElement(options) {\r\n    var tagName = options.inline ? 'span' : 'div';\r\n    var element = document.createElement(tagName);\r\n    if (options.className) {\r\n        element.className = options.className;\r\n    }\r\n    return element;\r\n}\r\nvar StringStream = /** @class */ (function () {\r\n    function StringStream(source) {\r\n        this.source = source;\r\n        this.index = 0;\r\n    }\r\n    StringStream.prototype.eos = function () {\r\n        return this.index >= this.source.length;\r\n    };\r\n    StringStream.prototype.next = function () {\r\n        var next = this.peek();\r\n        this.advance();\r\n        return next;\r\n    };\r\n    StringStream.prototype.peek = function () {\r\n        return this.source[this.index];\r\n    };\r\n    StringStream.prototype.advance = function () {\r\n        this.index++;\r\n    };\r\n    return StringStream;\r\n}());\r\nfunction _renderFormattedText(element, treeNode, actionHandler) {\r\n    var child;\r\n    if (treeNode.type === 2 /* Text */) {\r\n        child = document.createTextNode(treeNode.content || '');\r\n    }\r\n    else if (treeNode.type === 3 /* Bold */) {\r\n        child = document.createElement('b');\r\n    }\r\n    else if (treeNode.type === 4 /* Italics */) {\r\n        child = document.createElement('i');\r\n    }\r\n    else if (treeNode.type === 5 /* Action */ && actionHandler) {\r\n        var a = document.createElement('a');\r\n        a.href = '#';\r\n        actionHandler.disposeables.add(DOM.addStandardDisposableListener(a, 'click', function (event) {\r\n            actionHandler.callback(String(treeNode.index), event);\r\n        }));\r\n        child = a;\r\n    }\r\n    else if (treeNode.type === 7 /* NewLine */) {\r\n        child = document.createElement('br');\r\n    }\r\n    else if (treeNode.type === 1 /* Root */) {\r\n        child = element;\r\n    }\r\n    if (child && element !== child) {\r\n        element.appendChild(child);\r\n    }\r\n    if (child && Array.isArray(treeNode.children)) {\r\n        treeNode.children.forEach(function (nodeChild) {\r\n            _renderFormattedText(child, nodeChild, actionHandler);\r\n        });\r\n    }\r\n}\r\nfunction parseFormattedText(content) {\r\n    var root = {\r\n        type: 1 /* Root */,\r\n        children: []\r\n    };\r\n    var actionViewItemIndex = 0;\r\n    var current = root;\r\n    var stack = [];\r\n    var stream = new StringStream(content);\r\n    while (!stream.eos()) {\r\n        var next = stream.next();\r\n        var isEscapedFormatType = (next === '\\\\' && formatTagType(stream.peek()) !== 0 /* Invalid */);\r\n        if (isEscapedFormatType) {\r\n            next = stream.next(); // unread the backslash if it escapes a format tag type\r\n        }\r\n        if (!isEscapedFormatType && isFormatTag(next) && next === stream.peek()) {\r\n            stream.advance();\r\n            if (current.type === 2 /* Text */) {\r\n                current = stack.pop();\r\n            }\r\n            var type = formatTagType(next);\r\n            if (current.type === type || (current.type === 5 /* Action */ && type === 6 /* ActionClose */)) {\r\n                current = stack.pop();\r\n            }\r\n            else {\r\n                var newCurrent = {\r\n                    type: type,\r\n                    children: []\r\n                };\r\n                if (type === 5 /* Action */) {\r\n                    newCurrent.index = actionViewItemIndex;\r\n                    actionViewItemIndex++;\r\n                }\r\n                current.children.push(newCurrent);\r\n                stack.push(current);\r\n                current = newCurrent;\r\n            }\r\n        }\r\n        else if (next === '\\n') {\r\n            if (current.type === 2 /* Text */) {\r\n                current = stack.pop();\r\n            }\r\n            current.children.push({\r\n                type: 7 /* NewLine */\r\n            });\r\n        }\r\n        else {\r\n            if (current.type !== 2 /* Text */) {\r\n                var textCurrent = {\r\n                    type: 2 /* Text */,\r\n                    content: next\r\n                };\r\n                current.children.push(textCurrent);\r\n                stack.push(current);\r\n                current = textCurrent;\r\n            }\r\n            else {\r\n                current.content += next;\r\n            }\r\n        }\r\n    }\r\n    if (current.type === 2 /* Text */) {\r\n        current = stack.pop();\r\n    }\r\n    if (stack.length) {\r\n        // incorrectly formatted string literal\r\n    }\r\n    return root;\r\n}\r\nfunction isFormatTag(char) {\r\n    return formatTagType(char) !== 0 /* Invalid */;\r\n}\r\nfunction formatTagType(char) {\r\n    switch (char) {\r\n        case '*':\r\n            return 3 /* Bold */;\r\n        case '_':\r\n            return 4 /* Italics */;\r\n        case '[':\r\n            return 5 /* Action */;\r\n        case ']':\r\n            return 6 /* ActionClose */;\r\n        default:\r\n            return 0 /* Invalid */;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}