{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport { ReferencesModel, FileReferences, OneReference } from '../referencesModel.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { attachBadgeStyler } from '../../../../platform/theme/common/styler.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { localize } from '../../../../nls.js';\nimport { getBaseLabel } from '../../../../base/common/labels.js';\nimport { dirname, basename } from '../../../../base/common/resources.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { FuzzyScore, createMatches } from '../../../../base/common/filters.js';\nimport { HighlightedLabel } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\n\nvar DataSource =\n/** @class */\nfunction () {\n  function DataSource(_resolverService) {\n    this._resolverService = _resolverService;\n  }\n\n  DataSource.prototype.hasChildren = function (element) {\n    if (element instanceof ReferencesModel) {\n      return true;\n    }\n\n    if (element instanceof FileReferences && !element.failure) {\n      return true;\n    }\n\n    return false;\n  };\n\n  DataSource.prototype.getChildren = function (element) {\n    if (element instanceof ReferencesModel) {\n      return element.groups;\n    }\n\n    if (element instanceof FileReferences) {\n      return element.resolve(this._resolverService).then(function (val) {\n        // if (element.failure) {\n        // \t// refresh the element on failure so that\n        // \t// we can update its rendering\n        // \treturn tree.refresh(element).then(() => val.children);\n        // }\n        return val.children;\n      });\n    }\n\n    throw new Error('bad tree');\n  };\n\n  DataSource = __decorate([__param(0, ITextModelService)], DataSource);\n  return DataSource;\n}();\n\nexport { DataSource }; //#endregion\n\nvar Delegate =\n/** @class */\nfunction () {\n  function Delegate() {}\n\n  Delegate.prototype.getHeight = function () {\n    return 23;\n  };\n\n  Delegate.prototype.getTemplateId = function (element) {\n    if (element instanceof FileReferences) {\n      return FileReferencesRenderer.id;\n    } else {\n      return OneReferenceRenderer.id;\n    }\n  };\n\n  return Delegate;\n}();\n\nexport { Delegate };\n\nvar StringRepresentationProvider =\n/** @class */\nfunction () {\n  function StringRepresentationProvider(_keybindingService) {\n    this._keybindingService = _keybindingService;\n  }\n\n  StringRepresentationProvider.prototype.getKeyboardNavigationLabel = function (element) {\n    if (element instanceof OneReference) {\n      var preview = element.parent.preview;\n      var parts = preview && preview.preview(element.range);\n\n      if (parts) {\n        return parts.value;\n      }\n    } // FileReferences or unresolved OneReference\n\n\n    return basename(element.uri);\n  };\n\n  StringRepresentationProvider = __decorate([__param(0, IKeybindingService)], StringRepresentationProvider);\n  return StringRepresentationProvider;\n}();\n\nexport { StringRepresentationProvider };\n\nvar IdentityProvider =\n/** @class */\nfunction () {\n  function IdentityProvider() {}\n\n  IdentityProvider.prototype.getId = function (element) {\n    return element instanceof OneReference ? element.id : element.uri;\n  };\n\n  return IdentityProvider;\n}();\n\nexport { IdentityProvider }; //#region render: File\n\nvar FileReferencesTemplate =\n/** @class */\nfunction (_super) {\n  __extends(FileReferencesTemplate, _super);\n\n  function FileReferencesTemplate(container, _uriLabel, themeService) {\n    var _this = _super.call(this) || this;\n\n    _this._uriLabel = _uriLabel;\n    var parent = document.createElement('div');\n    dom.addClass(parent, 'reference-file');\n    _this.file = _this._register(new IconLabel(parent, {\n      supportHighlights: true\n    }));\n    _this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\n\n    _this._register(attachBadgeStyler(_this.badge, themeService));\n\n    container.appendChild(parent);\n    return _this;\n  }\n\n  FileReferencesTemplate.prototype.set = function (element, matches) {\n    var parent = dirname(element.uri);\n    this.file.setLabel(getBaseLabel(element.uri), this._uriLabel.getUriLabel(parent, {\n      relative: true\n    }), {\n      title: this._uriLabel.getUriLabel(element.uri),\n      matches: matches\n    });\n    var len = element.children.length;\n    this.badge.setCount(len);\n\n    if (element.failure) {\n      this.badge.setTitleFormat(localize('referencesFailre', \"Failed to resolve file.\"));\n    } else if (len > 1) {\n      this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n    } else {\n      this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n    }\n  };\n\n  FileReferencesTemplate = __decorate([__param(1, ILabelService), __param(2, IThemeService)], FileReferencesTemplate);\n  return FileReferencesTemplate;\n}(Disposable);\n\nvar FileReferencesRenderer =\n/** @class */\nfunction () {\n  function FileReferencesRenderer(_instantiationService) {\n    this._instantiationService = _instantiationService;\n    this.templateId = FileReferencesRenderer.id;\n  }\n\n  FileReferencesRenderer.prototype.renderTemplate = function (container) {\n    return this._instantiationService.createInstance(FileReferencesTemplate, container);\n  };\n\n  FileReferencesRenderer.prototype.renderElement = function (node, index, template) {\n    template.set(node.element, createMatches(node.filterData));\n  };\n\n  FileReferencesRenderer.prototype.disposeTemplate = function (templateData) {\n    templateData.dispose();\n  };\n\n  FileReferencesRenderer.id = 'FileReferencesRenderer';\n  FileReferencesRenderer = __decorate([__param(0, IInstantiationService)], FileReferencesRenderer);\n  return FileReferencesRenderer;\n}();\n\nexport { FileReferencesRenderer }; //#endregion\n//#region render: Reference\n\nvar OneReferenceTemplate =\n/** @class */\nfunction () {\n  function OneReferenceTemplate(container) {\n    this.label = new HighlightedLabel(container, false);\n  }\n\n  OneReferenceTemplate.prototype.set = function (element, score) {\n    var filePreview = element.parent.preview;\n    var preview = filePreview && filePreview.preview(element.range);\n\n    if (!preview) {\n      // this means we FAILED to resolve the document...\n      this.label.set(basename(element.uri) + \":\" + (element.range.startLineNumber + 1) + \":\" + (element.range.startColumn + 1));\n    } else {\n      // render search match as highlight unless\n      // we have score, then render the score\n      var value = preview.value,\n          highlight = preview.highlight;\n\n      if (score && !FuzzyScore.isDefault(score)) {\n        dom.toggleClass(this.label.element, 'referenceMatch', false);\n        this.label.set(value, createMatches(score));\n      } else {\n        dom.toggleClass(this.label.element, 'referenceMatch', true);\n        this.label.set(value, [highlight]);\n      }\n    }\n  };\n\n  return OneReferenceTemplate;\n}();\n\nvar OneReferenceRenderer =\n/** @class */\nfunction () {\n  function OneReferenceRenderer() {\n    this.templateId = OneReferenceRenderer.id;\n  }\n\n  OneReferenceRenderer.prototype.renderTemplate = function (container) {\n    return new OneReferenceTemplate(container);\n  };\n\n  OneReferenceRenderer.prototype.renderElement = function (node, index, templateData) {\n    templateData.set(node.element, node.filterData);\n  };\n\n  OneReferenceRenderer.prototype.disposeTemplate = function () {};\n\n  OneReferenceRenderer.id = 'OneReferenceRenderer';\n  return OneReferenceRenderer;\n}();\n\nexport { OneReferenceRenderer }; //#endregion\n\nvar AriaProvider =\n/** @class */\nfunction () {\n  function AriaProvider() {}\n\n  AriaProvider.prototype.getAriaLabel = function (element) {\n    return element.ariaMessage;\n  };\n\n  return AriaProvider;\n}();\n\nexport { AriaProvider };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesTree.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","ReferencesModel","FileReferences","OneReference","ITextModelService","IconLabel","CountBadge","ILabelService","IThemeService","attachBadgeStyler","dom","localize","getBaseLabel","dirname","basename","Disposable","IInstantiationService","IKeybindingService","FuzzyScore","createMatches","HighlightedLabel","DataSource","_resolverService","hasChildren","element","failure","getChildren","groups","resolve","then","val","children","Error","Delegate","getHeight","getTemplateId","FileReferencesRenderer","id","OneReferenceRenderer","StringRepresentationProvider","_keybindingService","getKeyboardNavigationLabel","preview","parent","parts","range","value","uri","IdentityProvider","getId","FileReferencesTemplate","_super","container","_uriLabel","themeService","_this","call","document","createElement","addClass","file","_register","supportHighlights","badge","append","$","appendChild","set","matches","setLabel","getUriLabel","relative","title","len","setCount","setTitleFormat","_instantiationService","templateId","renderTemplate","createInstance","renderElement","node","index","template","filterData","disposeTemplate","templateData","dispose","OneReferenceTemplate","label","score","filePreview","startLineNumber","startColumn","highlight","isDefault","toggleClass","AriaProvider","getAriaLabel","ariaMessage"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { ReferencesModel, FileReferences, OneReference } from '../referencesModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\r\nimport { attachBadgeStyler } from '../../../../platform/theme/common/styler.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { localize } from '../../../../nls.js';\r\nimport { getBaseLabel } from '../../../../base/common/labels.js';\r\nimport { dirname, basename } from '../../../../base/common/resources.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { FuzzyScore, createMatches } from '../../../../base/common/filters.js';\r\nimport { HighlightedLabel } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\r\nvar DataSource = /** @class */ (function () {\r\n    function DataSource(_resolverService) {\r\n        this._resolverService = _resolverService;\r\n    }\r\n    DataSource.prototype.hasChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return true;\r\n        }\r\n        if (element instanceof FileReferences && !element.failure) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    DataSource.prototype.getChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return element.groups;\r\n        }\r\n        if (element instanceof FileReferences) {\r\n            return element.resolve(this._resolverService).then(function (val) {\r\n                // if (element.failure) {\r\n                // \t// refresh the element on failure so that\r\n                // \t// we can update its rendering\r\n                // \treturn tree.refresh(element).then(() => val.children);\r\n                // }\r\n                return val.children;\r\n            });\r\n        }\r\n        throw new Error('bad tree');\r\n    };\r\n    DataSource = __decorate([\r\n        __param(0, ITextModelService)\r\n    ], DataSource);\r\n    return DataSource;\r\n}());\r\nexport { DataSource };\r\n//#endregion\r\nvar Delegate = /** @class */ (function () {\r\n    function Delegate() {\r\n    }\r\n    Delegate.prototype.getHeight = function () {\r\n        return 23;\r\n    };\r\n    Delegate.prototype.getTemplateId = function (element) {\r\n        if (element instanceof FileReferences) {\r\n            return FileReferencesRenderer.id;\r\n        }\r\n        else {\r\n            return OneReferenceRenderer.id;\r\n        }\r\n    };\r\n    return Delegate;\r\n}());\r\nexport { Delegate };\r\nvar StringRepresentationProvider = /** @class */ (function () {\r\n    function StringRepresentationProvider(_keybindingService) {\r\n        this._keybindingService = _keybindingService;\r\n    }\r\n    StringRepresentationProvider.prototype.getKeyboardNavigationLabel = function (element) {\r\n        if (element instanceof OneReference) {\r\n            var preview = element.parent.preview;\r\n            var parts = preview && preview.preview(element.range);\r\n            if (parts) {\r\n                return parts.value;\r\n            }\r\n        }\r\n        // FileReferences or unresolved OneReference\r\n        return basename(element.uri);\r\n    };\r\n    StringRepresentationProvider = __decorate([\r\n        __param(0, IKeybindingService)\r\n    ], StringRepresentationProvider);\r\n    return StringRepresentationProvider;\r\n}());\r\nexport { StringRepresentationProvider };\r\nvar IdentityProvider = /** @class */ (function () {\r\n    function IdentityProvider() {\r\n    }\r\n    IdentityProvider.prototype.getId = function (element) {\r\n        return element instanceof OneReference ? element.id : element.uri;\r\n    };\r\n    return IdentityProvider;\r\n}());\r\nexport { IdentityProvider };\r\n//#region render: File\r\nvar FileReferencesTemplate = /** @class */ (function (_super) {\r\n    __extends(FileReferencesTemplate, _super);\r\n    function FileReferencesTemplate(container, _uriLabel, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._uriLabel = _uriLabel;\r\n        var parent = document.createElement('div');\r\n        dom.addClass(parent, 'reference-file');\r\n        _this.file = _this._register(new IconLabel(parent, { supportHighlights: true }));\r\n        _this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\r\n        _this._register(attachBadgeStyler(_this.badge, themeService));\r\n        container.appendChild(parent);\r\n        return _this;\r\n    }\r\n    FileReferencesTemplate.prototype.set = function (element, matches) {\r\n        var parent = dirname(element.uri);\r\n        this.file.setLabel(getBaseLabel(element.uri), this._uriLabel.getUriLabel(parent, { relative: true }), { title: this._uriLabel.getUriLabel(element.uri), matches: matches });\r\n        var len = element.children.length;\r\n        this.badge.setCount(len);\r\n        if (element.failure) {\r\n            this.badge.setTitleFormat(localize('referencesFailre', \"Failed to resolve file.\"));\r\n        }\r\n        else if (len > 1) {\r\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\r\n        }\r\n        else {\r\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\r\n        }\r\n    };\r\n    FileReferencesTemplate = __decorate([\r\n        __param(1, ILabelService),\r\n        __param(2, IThemeService)\r\n    ], FileReferencesTemplate);\r\n    return FileReferencesTemplate;\r\n}(Disposable));\r\nvar FileReferencesRenderer = /** @class */ (function () {\r\n    function FileReferencesRenderer(_instantiationService) {\r\n        this._instantiationService = _instantiationService;\r\n        this.templateId = FileReferencesRenderer.id;\r\n    }\r\n    FileReferencesRenderer.prototype.renderTemplate = function (container) {\r\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\r\n    };\r\n    FileReferencesRenderer.prototype.renderElement = function (node, index, template) {\r\n        template.set(node.element, createMatches(node.filterData));\r\n    };\r\n    FileReferencesRenderer.prototype.disposeTemplate = function (templateData) {\r\n        templateData.dispose();\r\n    };\r\n    FileReferencesRenderer.id = 'FileReferencesRenderer';\r\n    FileReferencesRenderer = __decorate([\r\n        __param(0, IInstantiationService)\r\n    ], FileReferencesRenderer);\r\n    return FileReferencesRenderer;\r\n}());\r\nexport { FileReferencesRenderer };\r\n//#endregion\r\n//#region render: Reference\r\nvar OneReferenceTemplate = /** @class */ (function () {\r\n    function OneReferenceTemplate(container) {\r\n        this.label = new HighlightedLabel(container, false);\r\n    }\r\n    OneReferenceTemplate.prototype.set = function (element, score) {\r\n        var filePreview = element.parent.preview;\r\n        var preview = filePreview && filePreview.preview(element.range);\r\n        if (!preview) {\r\n            // this means we FAILED to resolve the document...\r\n            this.label.set(basename(element.uri) + \":\" + (element.range.startLineNumber + 1) + \":\" + (element.range.startColumn + 1));\r\n        }\r\n        else {\r\n            // render search match as highlight unless\r\n            // we have score, then render the score\r\n            var value = preview.value, highlight = preview.highlight;\r\n            if (score && !FuzzyScore.isDefault(score)) {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', false);\r\n                this.label.set(value, createMatches(score));\r\n            }\r\n            else {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', true);\r\n                this.label.set(value, [highlight]);\r\n            }\r\n        }\r\n    };\r\n    return OneReferenceTemplate;\r\n}());\r\nvar OneReferenceRenderer = /** @class */ (function () {\r\n    function OneReferenceRenderer() {\r\n        this.templateId = OneReferenceRenderer.id;\r\n    }\r\n    OneReferenceRenderer.prototype.renderTemplate = function (container) {\r\n        return new OneReferenceTemplate(container);\r\n    };\r\n    OneReferenceRenderer.prototype.renderElement = function (node, index, templateData) {\r\n        templateData.set(node.element, node.filterData);\r\n    };\r\n    OneReferenceRenderer.prototype.disposeTemplate = function () {\r\n    };\r\n    OneReferenceRenderer.id = 'OneReferenceRenderer';\r\n    return OneReferenceRenderer;\r\n}());\r\nexport { OneReferenceRenderer };\r\n//#endregion\r\nvar AriaProvider = /** @class */ (function () {\r\n    function AriaProvider() {\r\n    }\r\n    AriaProvider.prototype.getAriaLabel = function (element) {\r\n        return element.ariaMessage;\r\n    };\r\n    return AriaProvider;\r\n}());\r\nexport { AriaProvider };\r\n"]},"metadata":{},"sourceType":"module"}