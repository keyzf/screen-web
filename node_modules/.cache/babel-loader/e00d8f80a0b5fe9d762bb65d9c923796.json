{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport './media/editor.css';\nimport * as nls from '../../../nls.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable, dispose } from '../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { Configuration } from '../config/configuration.js';\nimport { EditorExtensionsRegistry } from '../editorExtensions.js';\nimport { ICodeEditorService } from '../services/codeEditorService.js';\nimport { View } from '../view/viewImpl.js';\nimport { ViewOutgoingEvents } from '../view/viewOutgoingEvents.js';\nimport { filterValidationDecorations } from '../../common/config/editorOptions.js';\nimport { Cursor } from '../../common/controller/cursor.js';\nimport { CursorColumns } from '../../common/controller/cursorCommon.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { Selection } from '../../common/core/selection.js';\nimport { InternalEditorAction } from '../../common/editorAction.js';\nimport * as editorCommon from '../../common/editorCommon.js';\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\nimport * as modes from '../../common/modes.js';\nimport { editorUnnecessaryCodeBorder, editorUnnecessaryCodeOpacity } from '../../common/view/editorColorRegistry.js';\nimport { editorErrorBorder, editorErrorForeground, editorHintBorder, editorHintForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, editorForeground } from '../../../platform/theme/common/colorRegistry.js';\nimport { ViewModel } from '../../common/viewModel/viewModelImpl.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { withNullAsUndefined } from '../../../base/common/types.js';\nimport { MonospaceLineBreaksComputerFactory } from '../../common/viewModel/monospaceLineBreaksComputer.js';\nimport { DOMLineBreaksComputerFactory } from '../view/domLineBreaksComputer.js';\nvar EDITOR_ID = 0;\n\nvar ModelData =\n/** @class */\nfunction () {\n  function ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove) {\n    this.model = model;\n    this.viewModel = viewModel;\n    this.cursor = cursor;\n    this.view = view;\n    this.hasRealView = hasRealView;\n    this.listenersToRemove = listenersToRemove;\n  }\n\n  ModelData.prototype.dispose = function () {\n    dispose(this.listenersToRemove);\n    this.model.onBeforeDetached();\n\n    if (this.hasRealView) {\n      this.view.dispose();\n    }\n\n    this.cursor.dispose();\n    this.viewModel.dispose();\n  };\n\n  return ModelData;\n}();\n\nvar CodeEditorWidget =\n/** @class */\nfunction (_super) {\n  __extends(CodeEditorWidget, _super);\n\n  function CodeEditorWidget(domElement, options, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\n    var _this = _super.call(this) || this; //#region Eventing\n\n\n    _this._onDidDispose = _this._register(new Emitter());\n    _this.onDidDispose = _this._onDidDispose.event;\n    _this._onDidChangeModelContent = _this._register(new Emitter());\n    _this.onDidChangeModelContent = _this._onDidChangeModelContent.event;\n    _this._onDidChangeModelLanguage = _this._register(new Emitter());\n    _this.onDidChangeModelLanguage = _this._onDidChangeModelLanguage.event;\n    _this._onDidChangeModelLanguageConfiguration = _this._register(new Emitter());\n    _this.onDidChangeModelLanguageConfiguration = _this._onDidChangeModelLanguageConfiguration.event;\n    _this._onDidChangeModelOptions = _this._register(new Emitter());\n    _this.onDidChangeModelOptions = _this._onDidChangeModelOptions.event;\n    _this._onDidChangeModelDecorations = _this._register(new Emitter());\n    _this.onDidChangeModelDecorations = _this._onDidChangeModelDecorations.event;\n    _this._onDidChangeConfiguration = _this._register(new Emitter());\n    _this.onDidChangeConfiguration = _this._onDidChangeConfiguration.event;\n    _this._onDidChangeModel = _this._register(new Emitter());\n    _this.onDidChangeModel = _this._onDidChangeModel.event;\n    _this._onDidChangeCursorPosition = _this._register(new Emitter());\n    _this.onDidChangeCursorPosition = _this._onDidChangeCursorPosition.event;\n    _this._onDidChangeCursorSelection = _this._register(new Emitter());\n    _this.onDidChangeCursorSelection = _this._onDidChangeCursorSelection.event;\n    _this._onDidAttemptReadOnlyEdit = _this._register(new Emitter());\n    _this.onDidAttemptReadOnlyEdit = _this._onDidAttemptReadOnlyEdit.event;\n    _this._onDidLayoutChange = _this._register(new Emitter());\n    _this.onDidLayoutChange = _this._onDidLayoutChange.event;\n    _this._editorTextFocus = _this._register(new BooleanEventEmitter());\n    _this.onDidFocusEditorText = _this._editorTextFocus.onDidChangeToTrue;\n    _this.onDidBlurEditorText = _this._editorTextFocus.onDidChangeToFalse;\n    _this._editorWidgetFocus = _this._register(new BooleanEventEmitter());\n    _this.onDidFocusEditorWidget = _this._editorWidgetFocus.onDidChangeToTrue;\n    _this.onDidBlurEditorWidget = _this._editorWidgetFocus.onDidChangeToFalse;\n    _this._onWillType = _this._register(new Emitter());\n    _this.onWillType = _this._onWillType.event;\n    _this._onDidType = _this._register(new Emitter());\n    _this.onDidType = _this._onDidType.event;\n    _this._onDidCompositionStart = _this._register(new Emitter());\n    _this.onDidCompositionStart = _this._onDidCompositionStart.event;\n    _this._onDidCompositionEnd = _this._register(new Emitter());\n    _this.onDidCompositionEnd = _this._onDidCompositionEnd.event;\n    _this._onDidPaste = _this._register(new Emitter());\n    _this.onDidPaste = _this._onDidPaste.event;\n    _this._onMouseUp = _this._register(new Emitter());\n    _this.onMouseUp = _this._onMouseUp.event;\n    _this._onMouseDown = _this._register(new Emitter());\n    _this.onMouseDown = _this._onMouseDown.event;\n    _this._onMouseDrag = _this._register(new Emitter());\n    _this.onMouseDrag = _this._onMouseDrag.event;\n    _this._onMouseDrop = _this._register(new Emitter());\n    _this.onMouseDrop = _this._onMouseDrop.event;\n    _this._onContextMenu = _this._register(new Emitter());\n    _this.onContextMenu = _this._onContextMenu.event;\n    _this._onMouseMove = _this._register(new Emitter());\n    _this.onMouseMove = _this._onMouseMove.event;\n    _this._onMouseLeave = _this._register(new Emitter());\n    _this.onMouseLeave = _this._onMouseLeave.event;\n    _this._onMouseWheel = _this._register(new Emitter());\n    _this.onMouseWheel = _this._onMouseWheel.event;\n    _this._onKeyUp = _this._register(new Emitter());\n    _this.onKeyUp = _this._onKeyUp.event;\n    _this._onKeyDown = _this._register(new Emitter());\n    _this.onKeyDown = _this._onKeyDown.event;\n    _this._onDidContentSizeChange = _this._register(new Emitter());\n    _this.onDidContentSizeChange = _this._onDidContentSizeChange.event;\n    _this._onDidScrollChange = _this._register(new Emitter());\n    _this.onDidScrollChange = _this._onDidScrollChange.event;\n    _this._onDidChangeViewZones = _this._register(new Emitter());\n    _this.onDidChangeViewZones = _this._onDidChangeViewZones.event;\n    _this._domElement = domElement;\n    _this._id = ++EDITOR_ID;\n    _this._decorationTypeKeysToIds = {};\n    _this._decorationTypeSubtypes = {};\n    _this.isSimpleWidget = codeEditorWidgetOptions.isSimpleWidget || false;\n    _this._telemetryData = codeEditorWidgetOptions.telemetryData;\n    options = options || {};\n    _this._configuration = _this._register(_this._createConfiguration(options, accessibilityService));\n\n    _this._register(_this._configuration.onDidChange(function (e) {\n      _this._onDidChangeConfiguration.fire(e);\n\n      var options = _this._configuration.options;\n\n      if (e.hasChanged(107\n      /* layoutInfo */\n      )) {\n        var layoutInfo = options.get(107\n        /* layoutInfo */\n        );\n\n        _this._onDidLayoutChange.fire(layoutInfo);\n      }\n    }));\n\n    _this._contextKeyService = _this._register(contextKeyService.createScoped(_this._domElement));\n    _this._notificationService = notificationService;\n    _this._codeEditorService = codeEditorService;\n    _this._commandService = commandService;\n    _this._themeService = themeService;\n\n    _this._register(new EditorContextKeysManager(_this, _this._contextKeyService));\n\n    _this._register(new EditorModeContext(_this, _this._contextKeyService));\n\n    _this._instantiationService = instantiationService.createChild(new ServiceCollection([IContextKeyService, _this._contextKeyService]));\n    _this._modelData = null;\n    _this._contributions = {};\n    _this._actions = {};\n    _this._focusTracker = new CodeEditorWidgetFocusTracker(domElement);\n\n    _this._focusTracker.onChange(function () {\n      _this._editorWidgetFocus.setValue(_this._focusTracker.hasFocus());\n    });\n\n    _this._contentWidgets = {};\n    _this._overlayWidgets = {};\n    var contributions;\n\n    if (Array.isArray(codeEditorWidgetOptions.contributions)) {\n      contributions = codeEditorWidgetOptions.contributions;\n    } else {\n      contributions = EditorExtensionsRegistry.getEditorContributions();\n    }\n\n    for (var _i = 0, contributions_1 = contributions; _i < contributions_1.length; _i++) {\n      var desc = contributions_1[_i];\n\n      try {\n        var contribution = _this._instantiationService.createInstance(desc.ctor, _this);\n\n        _this._contributions[desc.id] = contribution;\n      } catch (err) {\n        onUnexpectedError(err);\n      }\n    }\n\n    EditorExtensionsRegistry.getEditorActions().forEach(function (action) {\n      var internalAction = new InternalEditorAction(action.id, action.label, action.alias, withNullAsUndefined(action.precondition), function () {\n        return _this._instantiationService.invokeFunction(function (accessor) {\n          return Promise.resolve(action.runEditorCommand(accessor, _this, null));\n        });\n      }, _this._contextKeyService);\n      _this._actions[internalAction.id] = internalAction;\n    });\n\n    _this._codeEditorService.addCodeEditor(_this);\n\n    return _this;\n  }\n\n  CodeEditorWidget.prototype._createConfiguration = function (options, accessibilityService) {\n    return new Configuration(this.isSimpleWidget, options, this._domElement, accessibilityService);\n  };\n\n  CodeEditorWidget.prototype.getId = function () {\n    return this.getEditorType() + ':' + this._id;\n  };\n\n  CodeEditorWidget.prototype.getEditorType = function () {\n    return editorCommon.EditorType.ICodeEditor;\n  };\n\n  CodeEditorWidget.prototype.dispose = function () {\n    this._codeEditorService.removeCodeEditor(this);\n\n    this._focusTracker.dispose();\n\n    var keys = Object.keys(this._contributions);\n\n    for (var i = 0, len = keys.length; i < len; i++) {\n      var contributionId = keys[i];\n\n      this._contributions[contributionId].dispose();\n    }\n\n    this._removeDecorationTypes();\n\n    this._postDetachModelCleanup(this._detachModel());\n\n    this._onDidDispose.fire();\n\n    _super.prototype.dispose.call(this);\n  };\n\n  CodeEditorWidget.prototype.invokeWithinContext = function (fn) {\n    return this._instantiationService.invokeFunction(fn);\n  };\n\n  CodeEditorWidget.prototype.updateOptions = function (newOptions) {\n    this._configuration.updateOptions(newOptions);\n  };\n\n  CodeEditorWidget.prototype.getOptions = function () {\n    return this._configuration.options;\n  };\n\n  CodeEditorWidget.prototype.getOption = function (id) {\n    return this._configuration.options.get(id);\n  };\n\n  CodeEditorWidget.prototype.getRawOptions = function () {\n    return this._configuration.getRawOptions();\n  };\n\n  CodeEditorWidget.prototype.getValue = function (options) {\n    if (options === void 0) {\n      options = null;\n    }\n\n    if (!this._modelData) {\n      return '';\n    }\n\n    var preserveBOM = options && options.preserveBOM ? true : false;\n    var eolPreference = 0\n    /* TextDefined */\n    ;\n\n    if (options && options.lineEnding && options.lineEnding === '\\n') {\n      eolPreference = 1\n      /* LF */\n      ;\n    } else if (options && options.lineEnding && options.lineEnding === '\\r\\n') {\n      eolPreference = 2\n      /* CRLF */\n      ;\n    }\n\n    return this._modelData.model.getValue(eolPreference, preserveBOM);\n  };\n\n  CodeEditorWidget.prototype.setValue = function (newValue) {\n    if (!this._modelData) {\n      return;\n    }\n\n    this._modelData.model.setValue(newValue);\n  };\n\n  CodeEditorWidget.prototype.getModel = function () {\n    if (!this._modelData) {\n      return null;\n    }\n\n    return this._modelData.model;\n  };\n\n  CodeEditorWidget.prototype.setModel = function (_model) {\n    if (_model === void 0) {\n      _model = null;\n    }\n\n    var model = _model;\n\n    if (this._modelData === null && model === null) {\n      // Current model is the new model\n      return;\n    }\n\n    if (this._modelData && this._modelData.model === model) {\n      // Current model is the new model\n      return;\n    }\n\n    var hasTextFocus = this.hasTextFocus();\n\n    var detachedModel = this._detachModel();\n\n    this._attachModel(model);\n\n    if (hasTextFocus && this.hasModel()) {\n      this.focus();\n    }\n\n    var e = {\n      oldModelUrl: detachedModel ? detachedModel.uri : null,\n      newModelUrl: model ? model.uri : null\n    };\n\n    this._removeDecorationTypes();\n\n    this._onDidChangeModel.fire(e);\n\n    this._postDetachModelCleanup(detachedModel);\n  };\n\n  CodeEditorWidget.prototype._removeDecorationTypes = function () {\n    this._decorationTypeKeysToIds = {};\n\n    if (this._decorationTypeSubtypes) {\n      for (var decorationType in this._decorationTypeSubtypes) {\n        var subTypes = this._decorationTypeSubtypes[decorationType];\n\n        for (var subType in subTypes) {\n          this._removeDecorationType(decorationType + '-' + subType);\n        }\n      }\n\n      this._decorationTypeSubtypes = {};\n    }\n  };\n\n  CodeEditorWidget.prototype.getVisibleRanges = function () {\n    if (!this._modelData) {\n      return [];\n    }\n\n    return this._modelData.viewModel.getVisibleRanges();\n  };\n\n  CodeEditorWidget.prototype.getWhitespaces = function () {\n    if (!this._modelData) {\n      return [];\n    }\n\n    return this._modelData.viewModel.viewLayout.getWhitespaces();\n  };\n\n  CodeEditorWidget._getVerticalOffsetForPosition = function (modelData, modelLineNumber, modelColumn) {\n    var modelPosition = modelData.model.validatePosition({\n      lineNumber: modelLineNumber,\n      column: modelColumn\n    });\n    var viewPosition = modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n    return modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\n  };\n\n  CodeEditorWidget.prototype.getTopForLineNumber = function (lineNumber) {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, 1);\n  };\n\n  CodeEditorWidget.prototype.getTopForPosition = function (lineNumber, column) {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, column);\n  };\n\n  CodeEditorWidget.prototype.setHiddenAreas = function (ranges) {\n    if (this._modelData) {\n      this._modelData.viewModel.setHiddenAreas(ranges.map(function (r) {\n        return Range.lift(r);\n      }));\n    }\n  };\n\n  CodeEditorWidget.prototype.getVisibleColumnFromPosition = function (rawPosition) {\n    if (!this._modelData) {\n      return rawPosition.column;\n    }\n\n    var position = this._modelData.model.validatePosition(rawPosition);\n\n    var tabSize = this._modelData.model.getOptions().tabSize;\n\n    return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber), position.column, tabSize) + 1;\n  };\n\n  CodeEditorWidget.prototype.getPosition = function () {\n    if (!this._modelData) {\n      return null;\n    }\n\n    return this._modelData.cursor.getPosition();\n  };\n\n  CodeEditorWidget.prototype.setPosition = function (position) {\n    if (!this._modelData) {\n      return;\n    }\n\n    if (!Position.isIPosition(position)) {\n      throw new Error('Invalid arguments');\n    }\n\n    this._modelData.cursor.setSelections('api', [{\n      selectionStartLineNumber: position.lineNumber,\n      selectionStartColumn: position.column,\n      positionLineNumber: position.lineNumber,\n      positionColumn: position.column\n    }]);\n  };\n\n  CodeEditorWidget.prototype._sendRevealRange = function (modelRange, verticalType, revealHorizontal, scrollType) {\n    if (!this._modelData) {\n      return;\n    }\n\n    if (!Range.isIRange(modelRange)) {\n      throw new Error('Invalid arguments');\n    }\n\n    var validatedModelRange = this._modelData.model.validateRange(modelRange);\n\n    var viewRange = this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);\n\n    this._modelData.cursor.emitCursorRevealRange('api', viewRange, verticalType, revealHorizontal, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealLine = function (lineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealLine(lineNumber, 0\n    /* Simple */\n    , scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealLineInCenter = function (lineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealLine(lineNumber, 1\n    /* Center */\n    , scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealLineInCenterIfOutsideViewport = function (lineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealLine(lineNumber, 2\n    /* CenterIfOutsideViewport */\n    , scrollType);\n  };\n\n  CodeEditorWidget.prototype._revealLine = function (lineNumber, revealType, scrollType) {\n    if (typeof lineNumber !== 'number') {\n      throw new Error('Invalid arguments');\n    }\n\n    this._sendRevealRange(new Range(lineNumber, 1, lineNumber, 1), revealType, false, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealPosition = function (position, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealPosition(position, 0\n    /* Simple */\n    , true, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealPositionInCenter = function (position, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealPosition(position, 1\n    /* Center */\n    , true, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealPositionInCenterIfOutsideViewport = function (position, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealPosition(position, 2\n    /* CenterIfOutsideViewport */\n    , true, scrollType);\n  };\n\n  CodeEditorWidget.prototype._revealPosition = function (position, verticalType, revealHorizontal, scrollType) {\n    if (!Position.isIPosition(position)) {\n      throw new Error('Invalid arguments');\n    }\n\n    this._sendRevealRange(new Range(position.lineNumber, position.column, position.lineNumber, position.column), verticalType, revealHorizontal, scrollType);\n  };\n\n  CodeEditorWidget.prototype.getSelection = function () {\n    if (!this._modelData) {\n      return null;\n    }\n\n    return this._modelData.cursor.getSelection();\n  };\n\n  CodeEditorWidget.prototype.getSelections = function () {\n    if (!this._modelData) {\n      return null;\n    }\n\n    return this._modelData.cursor.getSelections();\n  };\n\n  CodeEditorWidget.prototype.setSelection = function (something) {\n    var isSelection = Selection.isISelection(something);\n    var isRange = Range.isIRange(something);\n\n    if (!isSelection && !isRange) {\n      throw new Error('Invalid arguments');\n    }\n\n    if (isSelection) {\n      this._setSelectionImpl(something);\n    } else if (isRange) {\n      // act as if it was an IRange\n      var selection = {\n        selectionStartLineNumber: something.startLineNumber,\n        selectionStartColumn: something.startColumn,\n        positionLineNumber: something.endLineNumber,\n        positionColumn: something.endColumn\n      };\n\n      this._setSelectionImpl(selection);\n    }\n  };\n\n  CodeEditorWidget.prototype._setSelectionImpl = function (sel) {\n    if (!this._modelData) {\n      return;\n    }\n\n    var selection = new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\n\n    this._modelData.cursor.setSelections('api', [selection]);\n  };\n\n  CodeEditorWidget.prototype.revealLines = function (startLineNumber, endLineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealLines(startLineNumber, endLineNumber, 0\n    /* Simple */\n    , scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealLinesInCenter = function (startLineNumber, endLineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealLines(startLineNumber, endLineNumber, 1\n    /* Center */\n    , scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealLinesInCenterIfOutsideViewport = function (startLineNumber, endLineNumber, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealLines(startLineNumber, endLineNumber, 2\n    /* CenterIfOutsideViewport */\n    , scrollType);\n  };\n\n  CodeEditorWidget.prototype._revealLines = function (startLineNumber, endLineNumber, verticalType, scrollType) {\n    if (typeof startLineNumber !== 'number' || typeof endLineNumber !== 'number') {\n      throw new Error('Invalid arguments');\n    }\n\n    this._sendRevealRange(new Range(startLineNumber, 1, endLineNumber, 1), verticalType, false, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealRange = function (range, scrollType, revealVerticalInCenter, revealHorizontal) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    if (revealVerticalInCenter === void 0) {\n      revealVerticalInCenter = false;\n    }\n\n    if (revealHorizontal === void 0) {\n      revealHorizontal = true;\n    }\n\n    this._revealRange(range, revealVerticalInCenter ? 1\n    /* Center */\n    : 0\n    /* Simple */\n    , revealHorizontal, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealRangeInCenter = function (range, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealRange(range, 1\n    /* Center */\n    , true, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealRangeInCenterIfOutsideViewport = function (range, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealRange(range, 2\n    /* CenterIfOutsideViewport */\n    , true, scrollType);\n  };\n\n  CodeEditorWidget.prototype.revealRangeAtTop = function (range, scrollType) {\n    if (scrollType === void 0) {\n      scrollType = 0\n      /* Smooth */\n      ;\n    }\n\n    this._revealRange(range, 3\n    /* Top */\n    , true, scrollType);\n  };\n\n  CodeEditorWidget.prototype._revealRange = function (range, verticalType, revealHorizontal, scrollType) {\n    if (!Range.isIRange(range)) {\n      throw new Error('Invalid arguments');\n    }\n\n    this._sendRevealRange(Range.lift(range), verticalType, revealHorizontal, scrollType);\n  };\n\n  CodeEditorWidget.prototype.setSelections = function (ranges, source) {\n    if (source === void 0) {\n      source = 'api';\n    }\n\n    if (!this._modelData) {\n      return;\n    }\n\n    if (!ranges || ranges.length === 0) {\n      throw new Error('Invalid arguments');\n    }\n\n    for (var i = 0, len = ranges.length; i < len; i++) {\n      if (!Selection.isISelection(ranges[i])) {\n        throw new Error('Invalid arguments');\n      }\n    }\n\n    this._modelData.cursor.setSelections(source, ranges);\n  };\n\n  CodeEditorWidget.prototype.getContentWidth = function () {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return this._modelData.viewModel.viewLayout.getContentWidth();\n  };\n\n  CodeEditorWidget.prototype.getScrollWidth = function () {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return this._modelData.viewModel.viewLayout.getScrollWidth();\n  };\n\n  CodeEditorWidget.prototype.getScrollLeft = function () {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return this._modelData.viewModel.viewLayout.getCurrentScrollLeft();\n  };\n\n  CodeEditorWidget.prototype.getContentHeight = function () {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return this._modelData.viewModel.viewLayout.getContentHeight();\n  };\n\n  CodeEditorWidget.prototype.getScrollHeight = function () {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return this._modelData.viewModel.viewLayout.getScrollHeight();\n  };\n\n  CodeEditorWidget.prototype.getScrollTop = function () {\n    if (!this._modelData) {\n      return -1;\n    }\n\n    return this._modelData.viewModel.viewLayout.getCurrentScrollTop();\n  };\n\n  CodeEditorWidget.prototype.setScrollLeft = function (newScrollLeft) {\n    if (!this._modelData) {\n      return;\n    }\n\n    if (typeof newScrollLeft !== 'number') {\n      throw new Error('Invalid arguments');\n    }\n\n    this._modelData.viewModel.viewLayout.setScrollPositionNow({\n      scrollLeft: newScrollLeft\n    });\n  };\n\n  CodeEditorWidget.prototype.setScrollTop = function (newScrollTop) {\n    if (!this._modelData) {\n      return;\n    }\n\n    if (typeof newScrollTop !== 'number') {\n      throw new Error('Invalid arguments');\n    }\n\n    this._modelData.viewModel.viewLayout.setScrollPositionNow({\n      scrollTop: newScrollTop\n    });\n  };\n\n  CodeEditorWidget.prototype.setScrollPosition = function (position) {\n    if (!this._modelData) {\n      return;\n    }\n\n    this._modelData.viewModel.viewLayout.setScrollPositionNow(position);\n  };\n\n  CodeEditorWidget.prototype.saveViewState = function () {\n    if (!this._modelData) {\n      return null;\n    }\n\n    var contributionsState = {};\n    var keys = Object.keys(this._contributions);\n\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n      var id = keys_1[_i];\n      var contribution = this._contributions[id];\n\n      if (typeof contribution.saveViewState === 'function') {\n        contributionsState[id] = contribution.saveViewState();\n      }\n    }\n\n    var cursorState = this._modelData.cursor.saveState();\n\n    var viewState = this._modelData.viewModel.saveState();\n\n    return {\n      cursorState: cursorState,\n      viewState: viewState,\n      contributionsState: contributionsState\n    };\n  };\n\n  CodeEditorWidget.prototype.restoreViewState = function (s) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return;\n    }\n\n    var codeEditorState = s;\n\n    if (codeEditorState && codeEditorState.cursorState && codeEditorState.viewState) {\n      var cursorState = codeEditorState.cursorState;\n\n      if (Array.isArray(cursorState)) {\n        this._modelData.cursor.restoreState(cursorState);\n      } else {\n        // Backwards compatibility\n        this._modelData.cursor.restoreState([cursorState]);\n      }\n\n      var contributionsState = codeEditorState.contributionsState || {};\n      var keys = Object.keys(this._contributions);\n\n      for (var i = 0, len = keys.length; i < len; i++) {\n        var id = keys[i];\n        var contribution = this._contributions[id];\n\n        if (typeof contribution.restoreViewState === 'function') {\n          contribution.restoreViewState(contributionsState[id]);\n        }\n      }\n\n      var reducedState = this._modelData.viewModel.reduceRestoreState(codeEditorState.viewState);\n\n      this._modelData.view.restoreState(reducedState);\n    }\n  };\n\n  CodeEditorWidget.prototype.getContribution = function (id) {\n    return this._contributions[id] || null;\n  };\n\n  CodeEditorWidget.prototype.getActions = function () {\n    var result = [];\n    var keys = Object.keys(this._actions);\n\n    for (var i = 0, len = keys.length; i < len; i++) {\n      var id = keys[i];\n      result.push(this._actions[id]);\n    }\n\n    return result;\n  };\n\n  CodeEditorWidget.prototype.getSupportedActions = function () {\n    var result = this.getActions();\n    result = result.filter(function (action) {\n      return action.isSupported();\n    });\n    return result;\n  };\n\n  CodeEditorWidget.prototype.getAction = function (id) {\n    return this._actions[id] || null;\n  };\n\n  CodeEditorWidget.prototype.trigger = function (source, handlerId, payload) {\n    payload = payload || {}; // Special case for typing\n\n    if (handlerId === editorCommon.Handler.Type) {\n      if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\n        // nothing to do\n        return;\n      }\n\n      if (source === 'keyboard') {\n        this._onWillType.fire(payload.text);\n      }\n\n      this._modelData.cursor.trigger(source, handlerId, payload);\n\n      if (source === 'keyboard') {\n        this._onDidType.fire(payload.text);\n      }\n\n      return;\n    } // Special case for pasting\n\n\n    if (handlerId === editorCommon.Handler.Paste) {\n      if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\n        // nothing to do\n        return;\n      }\n\n      var startPosition = this._modelData.cursor.getSelection().getStartPosition();\n\n      this._modelData.cursor.trigger(source, handlerId, payload);\n\n      var endPosition = this._modelData.cursor.getSelection().getStartPosition();\n\n      if (source === 'keyboard') {\n        this._onDidPaste.fire({\n          range: new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column),\n          mode: payload.mode\n        });\n      }\n\n      return;\n    }\n\n    var action = this.getAction(handlerId);\n\n    if (action) {\n      Promise.resolve(action.run()).then(undefined, onUnexpectedError);\n      return;\n    }\n\n    if (!this._modelData) {\n      return;\n    }\n\n    if (this._triggerEditorCommand(source, handlerId, payload)) {\n      return;\n    }\n\n    this._modelData.cursor.trigger(source, handlerId, payload);\n\n    if (handlerId === editorCommon.Handler.CompositionStart) {\n      this._onDidCompositionStart.fire();\n    }\n\n    if (handlerId === editorCommon.Handler.CompositionEnd) {\n      this._onDidCompositionEnd.fire();\n    }\n  };\n\n  CodeEditorWidget.prototype._triggerEditorCommand = function (source, handlerId, payload) {\n    var _this = this;\n\n    var command = EditorExtensionsRegistry.getEditorCommand(handlerId);\n\n    if (command) {\n      payload = payload || {};\n      payload.source = source;\n\n      this._instantiationService.invokeFunction(function (accessor) {\n        Promise.resolve(command.runEditorCommand(accessor, _this, payload)).then(undefined, onUnexpectedError);\n      });\n\n      return true;\n    }\n\n    return false;\n  };\n\n  CodeEditorWidget.prototype._getCursors = function () {\n    if (!this._modelData) {\n      return null;\n    }\n\n    return this._modelData.cursor;\n  };\n\n  CodeEditorWidget.prototype.pushUndoStop = function () {\n    if (!this._modelData) {\n      return false;\n    }\n\n    if (this._configuration.options.get(68\n    /* readOnly */\n    )) {\n      // read only editor => sorry!\n      return false;\n    }\n\n    this._modelData.model.pushStackElement();\n\n    return true;\n  };\n\n  CodeEditorWidget.prototype.executeEdits = function (source, edits, endCursorState) {\n    if (!this._modelData) {\n      return false;\n    }\n\n    if (this._configuration.options.get(68\n    /* readOnly */\n    )) {\n      // read only editor => sorry!\n      return false;\n    }\n\n    var cursorStateComputer;\n\n    if (!endCursorState) {\n      cursorStateComputer = function () {\n        return null;\n      };\n    } else if (Array.isArray(endCursorState)) {\n      cursorStateComputer = function () {\n        return endCursorState;\n      };\n    } else {\n      cursorStateComputer = endCursorState;\n    }\n\n    this._modelData.cursor.executeEdits(source, edits, cursorStateComputer);\n\n    return true;\n  };\n\n  CodeEditorWidget.prototype.executeCommand = function (source, command) {\n    if (!this._modelData) {\n      return;\n    }\n\n    this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommand, command);\n  };\n\n  CodeEditorWidget.prototype.executeCommands = function (source, commands) {\n    if (!this._modelData) {\n      return;\n    }\n\n    this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommands, commands);\n  };\n\n  CodeEditorWidget.prototype.changeDecorations = function (callback) {\n    if (!this._modelData) {\n      // callback will not be called\n      return null;\n    }\n\n    return this._modelData.model.changeDecorations(callback, this._id);\n  };\n\n  CodeEditorWidget.prototype.getLineDecorations = function (lineNumber) {\n    if (!this._modelData) {\n      return null;\n    }\n\n    return this._modelData.model.getLineDecorations(lineNumber, this._id, filterValidationDecorations(this._configuration.options));\n  };\n\n  CodeEditorWidget.prototype.deltaDecorations = function (oldDecorations, newDecorations) {\n    if (!this._modelData) {\n      return [];\n    }\n\n    if (oldDecorations.length === 0 && newDecorations.length === 0) {\n      return oldDecorations;\n    }\n\n    return this._modelData.model.deltaDecorations(oldDecorations, newDecorations, this._id);\n  };\n\n  CodeEditorWidget.prototype.removeDecorations = function (decorationTypeKey) {\n    // remove decorations for type and sub type\n    var oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey];\n\n    if (oldDecorationsIds) {\n      this.deltaDecorations(oldDecorationsIds, []);\n    }\n\n    if (this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)) {\n      delete this._decorationTypeKeysToIds[decorationTypeKey];\n    }\n\n    if (this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)) {\n      delete this._decorationTypeSubtypes[decorationTypeKey];\n    }\n  };\n\n  CodeEditorWidget.prototype.getLayoutInfo = function () {\n    var options = this._configuration.options;\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    return layoutInfo;\n  };\n\n  CodeEditorWidget.prototype.createOverviewRuler = function (cssClassName) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return null;\n    }\n\n    return this._modelData.view.createOverviewRuler(cssClassName);\n  };\n\n  CodeEditorWidget.prototype.getContainerDomNode = function () {\n    return this._domElement;\n  };\n\n  CodeEditorWidget.prototype.getDomNode = function () {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return null;\n    }\n\n    return this._modelData.view.domNode.domNode;\n  };\n\n  CodeEditorWidget.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return;\n    }\n\n    this._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent);\n  };\n\n  CodeEditorWidget.prototype.layout = function (dimension) {\n    this._configuration.observeReferenceElement(dimension);\n\n    this.render();\n  };\n\n  CodeEditorWidget.prototype.focus = function () {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return;\n    }\n\n    this._modelData.view.focus();\n  };\n\n  CodeEditorWidget.prototype.hasTextFocus = function () {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return false;\n    }\n\n    return this._modelData.view.isFocused();\n  };\n\n  CodeEditorWidget.prototype.hasWidgetFocus = function () {\n    return this._focusTracker && this._focusTracker.hasFocus();\n  };\n\n  CodeEditorWidget.prototype.addContentWidget = function (widget) {\n    var widgetData = {\n      widget: widget,\n      position: widget.getPosition()\n    };\n\n    if (this._contentWidgets.hasOwnProperty(widget.getId())) {\n      console.warn('Overwriting a content widget with the same id.');\n    }\n\n    this._contentWidgets[widget.getId()] = widgetData;\n\n    if (this._modelData && this._modelData.hasRealView) {\n      this._modelData.view.addContentWidget(widgetData);\n    }\n  };\n\n  CodeEditorWidget.prototype.layoutContentWidget = function (widget) {\n    var widgetId = widget.getId();\n\n    if (this._contentWidgets.hasOwnProperty(widgetId)) {\n      var widgetData = this._contentWidgets[widgetId];\n      widgetData.position = widget.getPosition();\n\n      if (this._modelData && this._modelData.hasRealView) {\n        this._modelData.view.layoutContentWidget(widgetData);\n      }\n    }\n  };\n\n  CodeEditorWidget.prototype.removeContentWidget = function (widget) {\n    var widgetId = widget.getId();\n\n    if (this._contentWidgets.hasOwnProperty(widgetId)) {\n      var widgetData = this._contentWidgets[widgetId];\n      delete this._contentWidgets[widgetId];\n\n      if (this._modelData && this._modelData.hasRealView) {\n        this._modelData.view.removeContentWidget(widgetData);\n      }\n    }\n  };\n\n  CodeEditorWidget.prototype.addOverlayWidget = function (widget) {\n    var widgetData = {\n      widget: widget,\n      position: widget.getPosition()\n    };\n\n    if (this._overlayWidgets.hasOwnProperty(widget.getId())) {\n      console.warn('Overwriting an overlay widget with the same id.');\n    }\n\n    this._overlayWidgets[widget.getId()] = widgetData;\n\n    if (this._modelData && this._modelData.hasRealView) {\n      this._modelData.view.addOverlayWidget(widgetData);\n    }\n  };\n\n  CodeEditorWidget.prototype.layoutOverlayWidget = function (widget) {\n    var widgetId = widget.getId();\n\n    if (this._overlayWidgets.hasOwnProperty(widgetId)) {\n      var widgetData = this._overlayWidgets[widgetId];\n      widgetData.position = widget.getPosition();\n\n      if (this._modelData && this._modelData.hasRealView) {\n        this._modelData.view.layoutOverlayWidget(widgetData);\n      }\n    }\n  };\n\n  CodeEditorWidget.prototype.removeOverlayWidget = function (widget) {\n    var widgetId = widget.getId();\n\n    if (this._overlayWidgets.hasOwnProperty(widgetId)) {\n      var widgetData = this._overlayWidgets[widgetId];\n      delete this._overlayWidgets[widgetId];\n\n      if (this._modelData && this._modelData.hasRealView) {\n        this._modelData.view.removeOverlayWidget(widgetData);\n      }\n    }\n  };\n\n  CodeEditorWidget.prototype.changeViewZones = function (callback) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return;\n    }\n\n    var hasChanges = this._modelData.view.change(callback);\n\n    if (hasChanges) {\n      this._onDidChangeViewZones.fire();\n    }\n  };\n\n  CodeEditorWidget.prototype.getTargetAtClientPoint = function (clientX, clientY) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return null;\n    }\n\n    return this._modelData.view.getTargetAtClientPoint(clientX, clientY);\n  };\n\n  CodeEditorWidget.prototype.getScrolledVisiblePosition = function (rawPosition) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return null;\n    }\n\n    var position = this._modelData.model.validatePosition(rawPosition);\n\n    var options = this._configuration.options;\n    var layoutInfo = options.get(107\n    /* layoutInfo */\n    );\n    var top = CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, position.lineNumber, position.column) - this.getScrollTop();\n    var left = this._modelData.view.getOffsetForColumn(position.lineNumber, position.column) + layoutInfo.glyphMarginWidth + layoutInfo.lineNumbersWidth + layoutInfo.decorationsWidth - this.getScrollLeft();\n    return {\n      top: top,\n      left: left,\n      height: options.get(49\n      /* lineHeight */\n      )\n    };\n  };\n\n  CodeEditorWidget.prototype.getOffsetForColumn = function (lineNumber, column) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return -1;\n    }\n\n    return this._modelData.view.getOffsetForColumn(lineNumber, column);\n  };\n\n  CodeEditorWidget.prototype.render = function (forceRedraw) {\n    if (forceRedraw === void 0) {\n      forceRedraw = false;\n    }\n\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return;\n    }\n\n    this._modelData.view.render(true, forceRedraw);\n  };\n\n  CodeEditorWidget.prototype.setAriaOptions = function (options) {\n    if (!this._modelData || !this._modelData.hasRealView) {\n      return;\n    }\n\n    this._modelData.view.setAriaOptions(options);\n  };\n\n  CodeEditorWidget.prototype.applyFontInfo = function (target) {\n    Configuration.applyFontInfoSlow(target, this._configuration.options.get(34\n    /* fontInfo */\n    ));\n  };\n\n  CodeEditorWidget.prototype._attachModel = function (model) {\n    var _this = this;\n\n    if (!model) {\n      this._modelData = null;\n      return;\n    }\n\n    var listenersToRemove = [];\n\n    this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n\n    this._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines());\n\n    this._configuration.setMaxLineNumber(model.getLineCount());\n\n    model.onBeforeAttached();\n    var viewModel = new ViewModel(this._id, this._configuration, model, DOMLineBreaksComputerFactory.create(), MonospaceLineBreaksComputerFactory.create(this._configuration.options), function (callback) {\n      return dom.scheduleAtNextAnimationFrame(callback);\n    });\n    listenersToRemove.push(model.onDidChangeDecorations(function (e) {\n      return _this._onDidChangeModelDecorations.fire(e);\n    }));\n    listenersToRemove.push(model.onDidChangeLanguage(function (e) {\n      _this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n\n      _this._onDidChangeModelLanguage.fire(e);\n    }));\n    listenersToRemove.push(model.onDidChangeLanguageConfiguration(function (e) {\n      return _this._onDidChangeModelLanguageConfiguration.fire(e);\n    }));\n    listenersToRemove.push(model.onDidChangeContent(function (e) {\n      return _this._onDidChangeModelContent.fire(e);\n    }));\n    listenersToRemove.push(model.onDidChangeOptions(function (e) {\n      return _this._onDidChangeModelOptions.fire(e);\n    })); // Someone might destroy the model from under the editor, so prevent any exceptions by setting a null model\n\n    listenersToRemove.push(model.onWillDispose(function () {\n      return _this.setModel(null);\n    }));\n    var cursor = new Cursor(this._configuration, model, viewModel);\n    listenersToRemove.push(cursor.onDidReachMaxCursorCount(function () {\n      _this._notificationService.warn(nls.localize('cursors.maximum', \"The number of cursors has been limited to {0}.\", Cursor.MAX_CURSOR_COUNT));\n    }));\n    listenersToRemove.push(cursor.onDidAttemptReadOnlyEdit(function () {\n      _this._onDidAttemptReadOnlyEdit.fire(undefined);\n    }));\n    listenersToRemove.push(cursor.onDidChange(function (e) {\n      var positions = [];\n\n      for (var i = 0, len = e.selections.length; i < len; i++) {\n        positions[i] = e.selections[i].getPosition();\n      }\n\n      var e1 = {\n        position: positions[0],\n        secondaryPositions: positions.slice(1),\n        reason: e.reason,\n        source: e.source\n      };\n\n      _this._onDidChangeCursorPosition.fire(e1);\n\n      var e2 = {\n        selection: e.selections[0],\n        secondarySelections: e.selections.slice(1),\n        modelVersionId: e.modelVersionId,\n        oldSelections: e.oldSelections,\n        oldModelVersionId: e.oldModelVersionId,\n        source: e.source,\n        reason: e.reason\n      };\n\n      _this._onDidChangeCursorSelection.fire(e2);\n    }));\n\n    var _a = this._createView(viewModel, cursor),\n        view = _a[0],\n        hasRealView = _a[1];\n\n    if (hasRealView) {\n      this._domElement.appendChild(view.domNode.domNode);\n\n      var keys = Object.keys(this._contentWidgets);\n\n      for (var i = 0, len = keys.length; i < len; i++) {\n        var widgetId = keys[i];\n        view.addContentWidget(this._contentWidgets[widgetId]);\n      }\n\n      keys = Object.keys(this._overlayWidgets);\n\n      for (var i = 0, len = keys.length; i < len; i++) {\n        var widgetId = keys[i];\n        view.addOverlayWidget(this._overlayWidgets[widgetId]);\n      }\n\n      view.render(false, true);\n      view.domNode.domNode.setAttribute('data-uri', model.uri.toString());\n    }\n\n    this._modelData = new ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove);\n  };\n\n  CodeEditorWidget.prototype._createView = function (viewModel, cursor) {\n    var _this = this;\n\n    var commandDelegate;\n\n    if (this.isSimpleWidget) {\n      commandDelegate = {\n        executeEditorCommand: function (editorCommand, args) {\n          editorCommand.runCoreEditorCommand(cursor, args);\n        },\n        paste: function (source, text, pasteOnNewLine, multicursorText, mode) {\n          _this.trigger(source, editorCommon.Handler.Paste, {\n            text: text,\n            pasteOnNewLine: pasteOnNewLine,\n            multicursorText: multicursorText,\n            mode: mode\n          });\n        },\n        type: function (source, text) {\n          _this.trigger(source, editorCommon.Handler.Type, {\n            text: text\n          });\n        },\n        replacePreviousChar: function (source, text, replaceCharCnt) {\n          _this.trigger(source, editorCommon.Handler.ReplacePreviousChar, {\n            text: text,\n            replaceCharCnt: replaceCharCnt\n          });\n        },\n        compositionStart: function (source) {\n          _this.trigger(source, editorCommon.Handler.CompositionStart, undefined);\n        },\n        compositionEnd: function (source) {\n          _this.trigger(source, editorCommon.Handler.CompositionEnd, undefined);\n        },\n        cut: function (source) {\n          _this.trigger(source, editorCommon.Handler.Cut, undefined);\n        }\n      };\n    } else {\n      commandDelegate = {\n        executeEditorCommand: function (editorCommand, args) {\n          editorCommand.runCoreEditorCommand(cursor, args);\n        },\n        paste: function (source, text, pasteOnNewLine, multicursorText, mode) {\n          _this._commandService.executeCommand(editorCommon.Handler.Paste, {\n            text: text,\n            pasteOnNewLine: pasteOnNewLine,\n            multicursorText: multicursorText,\n            mode: mode\n          });\n        },\n        type: function (source, text) {\n          _this._commandService.executeCommand(editorCommon.Handler.Type, {\n            text: text\n          });\n        },\n        replacePreviousChar: function (source, text, replaceCharCnt) {\n          _this._commandService.executeCommand(editorCommon.Handler.ReplacePreviousChar, {\n            text: text,\n            replaceCharCnt: replaceCharCnt\n          });\n        },\n        compositionStart: function (source) {\n          _this._commandService.executeCommand(editorCommon.Handler.CompositionStart, {});\n        },\n        compositionEnd: function (source) {\n          _this._commandService.executeCommand(editorCommon.Handler.CompositionEnd, {});\n        },\n        cut: function (source) {\n          _this._commandService.executeCommand(editorCommon.Handler.Cut, {});\n        }\n      };\n    }\n\n    var viewOutgoingEvents = new ViewOutgoingEvents(viewModel);\n\n    viewOutgoingEvents.onDidContentSizeChange = function (e) {\n      return _this._onDidContentSizeChange.fire(e);\n    };\n\n    viewOutgoingEvents.onDidScroll = function (e) {\n      return _this._onDidScrollChange.fire(e);\n    };\n\n    viewOutgoingEvents.onDidGainFocus = function () {\n      return _this._editorTextFocus.setValue(true);\n    };\n\n    viewOutgoingEvents.onDidLoseFocus = function () {\n      return _this._editorTextFocus.setValue(false);\n    };\n\n    viewOutgoingEvents.onContextMenu = function (e) {\n      return _this._onContextMenu.fire(e);\n    };\n\n    viewOutgoingEvents.onMouseDown = function (e) {\n      return _this._onMouseDown.fire(e);\n    };\n\n    viewOutgoingEvents.onMouseUp = function (e) {\n      return _this._onMouseUp.fire(e);\n    };\n\n    viewOutgoingEvents.onMouseDrag = function (e) {\n      return _this._onMouseDrag.fire(e);\n    };\n\n    viewOutgoingEvents.onMouseDrop = function (e) {\n      return _this._onMouseDrop.fire(e);\n    };\n\n    viewOutgoingEvents.onKeyUp = function (e) {\n      return _this._onKeyUp.fire(e);\n    };\n\n    viewOutgoingEvents.onMouseMove = function (e) {\n      return _this._onMouseMove.fire(e);\n    };\n\n    viewOutgoingEvents.onMouseLeave = function (e) {\n      return _this._onMouseLeave.fire(e);\n    };\n\n    viewOutgoingEvents.onMouseWheel = function (e) {\n      return _this._onMouseWheel.fire(e);\n    };\n\n    viewOutgoingEvents.onKeyDown = function (e) {\n      return _this._onKeyDown.fire(e);\n    };\n\n    var view = new View(commandDelegate, this._configuration, this._themeService, viewModel, cursor, viewOutgoingEvents);\n    return [view, true];\n  };\n\n  CodeEditorWidget.prototype._postDetachModelCleanup = function (detachedModel) {\n    if (detachedModel) {\n      detachedModel.removeAllDecorationsWithOwnerId(this._id);\n    }\n  };\n\n  CodeEditorWidget.prototype._detachModel = function () {\n    if (!this._modelData) {\n      return null;\n    }\n\n    var model = this._modelData.model;\n    var removeDomNode = this._modelData.hasRealView ? this._modelData.view.domNode.domNode : null;\n\n    this._modelData.dispose();\n\n    this._modelData = null;\n\n    this._domElement.removeAttribute('data-mode-id');\n\n    if (removeDomNode) {\n      this._domElement.removeChild(removeDomNode);\n    }\n\n    return model;\n  };\n\n  CodeEditorWidget.prototype._removeDecorationType = function (key) {\n    this._codeEditorService.removeDecorationType(key);\n  };\n\n  CodeEditorWidget.prototype.hasModel = function () {\n    return this._modelData !== null;\n  };\n\n  CodeEditorWidget = __decorate([__param(3, IInstantiationService), __param(4, ICodeEditorService), __param(5, ICommandService), __param(6, IContextKeyService), __param(7, IThemeService), __param(8, INotificationService), __param(9, IAccessibilityService)], CodeEditorWidget);\n  return CodeEditorWidget;\n}(Disposable);\n\nexport { CodeEditorWidget };\n\nvar BooleanEventEmitter =\n/** @class */\nfunction (_super) {\n  __extends(BooleanEventEmitter, _super);\n\n  function BooleanEventEmitter() {\n    var _this = _super.call(this) || this;\n\n    _this._onDidChangeToTrue = _this._register(new Emitter());\n    _this.onDidChangeToTrue = _this._onDidChangeToTrue.event;\n    _this._onDidChangeToFalse = _this._register(new Emitter());\n    _this.onDidChangeToFalse = _this._onDidChangeToFalse.event;\n    _this._value = 0\n    /* NotSet */\n    ;\n    return _this;\n  }\n\n  BooleanEventEmitter.prototype.setValue = function (_value) {\n    var value = _value ? 2\n    /* True */\n    : 1\n    /* False */\n    ;\n\n    if (this._value === value) {\n      return;\n    }\n\n    this._value = value;\n\n    if (this._value === 2\n    /* True */\n    ) {\n        this._onDidChangeToTrue.fire();\n      } else if (this._value === 1\n    /* False */\n    ) {\n        this._onDidChangeToFalse.fire();\n      }\n  };\n\n  return BooleanEventEmitter;\n}(Disposable);\n\nexport { BooleanEventEmitter };\n\nvar EditorContextKeysManager =\n/** @class */\nfunction (_super) {\n  __extends(EditorContextKeysManager, _super);\n\n  function EditorContextKeysManager(editor, contextKeyService) {\n    var _this = _super.call(this) || this;\n\n    _this._editor = editor;\n    contextKeyService.createKey('editorId', editor.getId());\n    _this._editorSimpleInput = EditorContextKeys.editorSimpleInput.bindTo(contextKeyService);\n    _this._editorFocus = EditorContextKeys.focus.bindTo(contextKeyService);\n    _this._textInputFocus = EditorContextKeys.textInputFocus.bindTo(contextKeyService);\n    _this._editorTextFocus = EditorContextKeys.editorTextFocus.bindTo(contextKeyService);\n    _this._editorTabMovesFocus = EditorContextKeys.tabMovesFocus.bindTo(contextKeyService);\n    _this._editorReadonly = EditorContextKeys.readOnly.bindTo(contextKeyService);\n    _this._hasMultipleSelections = EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService);\n    _this._hasNonEmptySelection = EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService);\n    _this._canUndo = EditorContextKeys.canUndo.bindTo(contextKeyService);\n    _this._canRedo = EditorContextKeys.canRedo.bindTo(contextKeyService);\n\n    _this._register(_this._editor.onDidChangeConfiguration(function () {\n      return _this._updateFromConfig();\n    }));\n\n    _this._register(_this._editor.onDidChangeCursorSelection(function () {\n      return _this._updateFromSelection();\n    }));\n\n    _this._register(_this._editor.onDidFocusEditorWidget(function () {\n      return _this._updateFromFocus();\n    }));\n\n    _this._register(_this._editor.onDidBlurEditorWidget(function () {\n      return _this._updateFromFocus();\n    }));\n\n    _this._register(_this._editor.onDidFocusEditorText(function () {\n      return _this._updateFromFocus();\n    }));\n\n    _this._register(_this._editor.onDidBlurEditorText(function () {\n      return _this._updateFromFocus();\n    }));\n\n    _this._register(_this._editor.onDidChangeModel(function () {\n      return _this._updateFromModel();\n    }));\n\n    _this._register(_this._editor.onDidChangeConfiguration(function () {\n      return _this._updateFromModel();\n    }));\n\n    _this._updateFromConfig();\n\n    _this._updateFromSelection();\n\n    _this._updateFromFocus();\n\n    _this._updateFromModel();\n\n    _this._editorSimpleInput.set(_this._editor.isSimpleWidget);\n\n    return _this;\n  }\n\n  EditorContextKeysManager.prototype._updateFromConfig = function () {\n    var options = this._editor.getOptions();\n\n    this._editorTabMovesFocus.set(options.get(106\n    /* tabFocusMode */\n    ));\n\n    this._editorReadonly.set(options.get(68\n    /* readOnly */\n    ));\n  };\n\n  EditorContextKeysManager.prototype._updateFromSelection = function () {\n    var selections = this._editor.getSelections();\n\n    if (!selections) {\n      this._hasMultipleSelections.reset();\n\n      this._hasNonEmptySelection.reset();\n    } else {\n      this._hasMultipleSelections.set(selections.length > 1);\n\n      this._hasNonEmptySelection.set(selections.some(function (s) {\n        return !s.isEmpty();\n      }));\n    }\n  };\n\n  EditorContextKeysManager.prototype._updateFromFocus = function () {\n    this._editorFocus.set(this._editor.hasWidgetFocus() && !this._editor.isSimpleWidget);\n\n    this._editorTextFocus.set(this._editor.hasTextFocus() && !this._editor.isSimpleWidget);\n\n    this._textInputFocus.set(this._editor.hasTextFocus());\n  };\n\n  EditorContextKeysManager.prototype._updateFromModel = function () {\n    var model = this._editor.getModel();\n\n    this._canUndo.set(Boolean(model && model.canUndo()));\n\n    this._canRedo.set(Boolean(model && model.canRedo()));\n  };\n\n  return EditorContextKeysManager;\n}(Disposable);\n\nvar EditorModeContext =\n/** @class */\nfunction (_super) {\n  __extends(EditorModeContext, _super);\n\n  function EditorModeContext(_editor, _contextKeyService) {\n    var _this = _super.call(this) || this;\n\n    _this._editor = _editor;\n    _this._contextKeyService = _contextKeyService;\n    _this._langId = EditorContextKeys.languageId.bindTo(_contextKeyService);\n    _this._hasCompletionItemProvider = EditorContextKeys.hasCompletionItemProvider.bindTo(_contextKeyService);\n    _this._hasCodeActionsProvider = EditorContextKeys.hasCodeActionsProvider.bindTo(_contextKeyService);\n    _this._hasCodeLensProvider = EditorContextKeys.hasCodeLensProvider.bindTo(_contextKeyService);\n    _this._hasDefinitionProvider = EditorContextKeys.hasDefinitionProvider.bindTo(_contextKeyService);\n    _this._hasDeclarationProvider = EditorContextKeys.hasDeclarationProvider.bindTo(_contextKeyService);\n    _this._hasImplementationProvider = EditorContextKeys.hasImplementationProvider.bindTo(_contextKeyService);\n    _this._hasTypeDefinitionProvider = EditorContextKeys.hasTypeDefinitionProvider.bindTo(_contextKeyService);\n    _this._hasHoverProvider = EditorContextKeys.hasHoverProvider.bindTo(_contextKeyService);\n    _this._hasDocumentHighlightProvider = EditorContextKeys.hasDocumentHighlightProvider.bindTo(_contextKeyService);\n    _this._hasDocumentSymbolProvider = EditorContextKeys.hasDocumentSymbolProvider.bindTo(_contextKeyService);\n    _this._hasReferenceProvider = EditorContextKeys.hasReferenceProvider.bindTo(_contextKeyService);\n    _this._hasRenameProvider = EditorContextKeys.hasRenameProvider.bindTo(_contextKeyService);\n    _this._hasSignatureHelpProvider = EditorContextKeys.hasSignatureHelpProvider.bindTo(_contextKeyService);\n    _this._hasDocumentFormattingProvider = EditorContextKeys.hasDocumentFormattingProvider.bindTo(_contextKeyService);\n    _this._hasDocumentSelectionFormattingProvider = EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\n    _this._hasMultipleDocumentFormattingProvider = EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(_contextKeyService);\n    _this._hasMultipleDocumentSelectionFormattingProvider = EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\n    _this._isInWalkThrough = EditorContextKeys.isInEmbeddedEditor.bindTo(_contextKeyService);\n\n    var update = function () {\n      return _this._update();\n    }; // update when model/mode changes\n\n\n    _this._register(_editor.onDidChangeModel(update));\n\n    _this._register(_editor.onDidChangeModelLanguage(update)); // update when registries change\n\n\n    _this._register(modes.CompletionProviderRegistry.onDidChange(update));\n\n    _this._register(modes.CodeActionProviderRegistry.onDidChange(update));\n\n    _this._register(modes.CodeLensProviderRegistry.onDidChange(update));\n\n    _this._register(modes.DefinitionProviderRegistry.onDidChange(update));\n\n    _this._register(modes.DeclarationProviderRegistry.onDidChange(update));\n\n    _this._register(modes.ImplementationProviderRegistry.onDidChange(update));\n\n    _this._register(modes.TypeDefinitionProviderRegistry.onDidChange(update));\n\n    _this._register(modes.HoverProviderRegistry.onDidChange(update));\n\n    _this._register(modes.DocumentHighlightProviderRegistry.onDidChange(update));\n\n    _this._register(modes.DocumentSymbolProviderRegistry.onDidChange(update));\n\n    _this._register(modes.ReferenceProviderRegistry.onDidChange(update));\n\n    _this._register(modes.RenameProviderRegistry.onDidChange(update));\n\n    _this._register(modes.DocumentFormattingEditProviderRegistry.onDidChange(update));\n\n    _this._register(modes.DocumentRangeFormattingEditProviderRegistry.onDidChange(update));\n\n    _this._register(modes.SignatureHelpProviderRegistry.onDidChange(update));\n\n    update();\n    return _this;\n  }\n\n  EditorModeContext.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n  };\n\n  EditorModeContext.prototype.reset = function () {\n    var _this = this;\n\n    this._contextKeyService.bufferChangeEvents(function () {\n      _this._langId.reset();\n\n      _this._hasCompletionItemProvider.reset();\n\n      _this._hasCodeActionsProvider.reset();\n\n      _this._hasCodeLensProvider.reset();\n\n      _this._hasDefinitionProvider.reset();\n\n      _this._hasDeclarationProvider.reset();\n\n      _this._hasImplementationProvider.reset();\n\n      _this._hasTypeDefinitionProvider.reset();\n\n      _this._hasHoverProvider.reset();\n\n      _this._hasDocumentHighlightProvider.reset();\n\n      _this._hasDocumentSymbolProvider.reset();\n\n      _this._hasReferenceProvider.reset();\n\n      _this._hasRenameProvider.reset();\n\n      _this._hasDocumentFormattingProvider.reset();\n\n      _this._hasDocumentSelectionFormattingProvider.reset();\n\n      _this._hasSignatureHelpProvider.reset();\n\n      _this._isInWalkThrough.reset();\n    });\n  };\n\n  EditorModeContext.prototype._update = function () {\n    var _this = this;\n\n    var model = this._editor.getModel();\n\n    if (!model) {\n      this.reset();\n      return;\n    }\n\n    this._contextKeyService.bufferChangeEvents(function () {\n      _this._langId.set(model.getLanguageIdentifier().language);\n\n      _this._hasCompletionItemProvider.set(modes.CompletionProviderRegistry.has(model));\n\n      _this._hasCodeActionsProvider.set(modes.CodeActionProviderRegistry.has(model));\n\n      _this._hasCodeLensProvider.set(modes.CodeLensProviderRegistry.has(model));\n\n      _this._hasDefinitionProvider.set(modes.DefinitionProviderRegistry.has(model));\n\n      _this._hasDeclarationProvider.set(modes.DeclarationProviderRegistry.has(model));\n\n      _this._hasImplementationProvider.set(modes.ImplementationProviderRegistry.has(model));\n\n      _this._hasTypeDefinitionProvider.set(modes.TypeDefinitionProviderRegistry.has(model));\n\n      _this._hasHoverProvider.set(modes.HoverProviderRegistry.has(model));\n\n      _this._hasDocumentHighlightProvider.set(modes.DocumentHighlightProviderRegistry.has(model));\n\n      _this._hasDocumentSymbolProvider.set(modes.DocumentSymbolProviderRegistry.has(model));\n\n      _this._hasReferenceProvider.set(modes.ReferenceProviderRegistry.has(model));\n\n      _this._hasRenameProvider.set(modes.RenameProviderRegistry.has(model));\n\n      _this._hasSignatureHelpProvider.set(modes.SignatureHelpProviderRegistry.has(model));\n\n      _this._hasDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.has(model) || modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n\n      _this._hasDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n\n      _this._hasMultipleDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.all(model).length + modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n\n      _this._hasMultipleDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n\n      _this._isInWalkThrough.set(model.uri.scheme === Schemas.walkThroughSnippet);\n    });\n  };\n\n  return EditorModeContext;\n}(Disposable);\n\nexport { EditorModeContext };\n\nvar CodeEditorWidgetFocusTracker =\n/** @class */\nfunction (_super) {\n  __extends(CodeEditorWidgetFocusTracker, _super);\n\n  function CodeEditorWidgetFocusTracker(domElement) {\n    var _this = _super.call(this) || this;\n\n    _this._onChange = _this._register(new Emitter());\n    _this.onChange = _this._onChange.event;\n    _this._hasFocus = false;\n    _this._domFocusTracker = _this._register(dom.trackFocus(domElement));\n\n    _this._register(_this._domFocusTracker.onDidFocus(function () {\n      _this._hasFocus = true;\n\n      _this._onChange.fire(undefined);\n    }));\n\n    _this._register(_this._domFocusTracker.onDidBlur(function () {\n      _this._hasFocus = false;\n\n      _this._onChange.fire(undefined);\n    }));\n\n    return _this;\n  }\n\n  CodeEditorWidgetFocusTracker.prototype.hasFocus = function () {\n    return this._hasFocus;\n  };\n\n  return CodeEditorWidgetFocusTracker;\n}(Disposable);\n\nvar squigglyStart = encodeURIComponent(\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='\");\nvar squigglyEnd = encodeURIComponent(\"'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>\");\n\nfunction getSquigglySVGData(color) {\n  return squigglyStart + encodeURIComponent(color.toString()) + squigglyEnd;\n}\n\nvar dotdotdotStart = encodeURIComponent(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"3\\\" width=\\\"12\\\"><g fill=\\\"\");\nvar dotdotdotEnd = encodeURIComponent(\"\\\"><circle cx=\\\"1\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"5\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"9\\\" cy=\\\"1\\\" r=\\\"1\\\"/></g></svg>\");\n\nfunction getDotDotDotSVGData(color) {\n  return dotdotdotStart + encodeURIComponent(color.toString()) + dotdotdotEnd;\n}\n\nregisterThemingParticipant(function (theme, collector) {\n  var errorBorderColor = theme.getColor(editorErrorBorder);\n\n  if (errorBorderColor) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-error\"\n    /* EditorErrorDecoration */\n    + \" { border-bottom: 4px double \" + errorBorderColor + \"; }\");\n  }\n\n  var errorForeground = theme.getColor(editorErrorForeground);\n\n  if (errorForeground) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-error\"\n    /* EditorErrorDecoration */\n    + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(errorForeground) + \"\\\") repeat-x bottom left; }\");\n  }\n\n  var warningBorderColor = theme.getColor(editorWarningBorder);\n\n  if (warningBorderColor) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-warning\"\n    /* EditorWarningDecoration */\n    + \" { border-bottom: 4px double \" + warningBorderColor + \"; }\");\n  }\n\n  var warningForeground = theme.getColor(editorWarningForeground);\n\n  if (warningForeground) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-warning\"\n    /* EditorWarningDecoration */\n    + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(warningForeground) + \"\\\") repeat-x bottom left; }\");\n  }\n\n  var infoBorderColor = theme.getColor(editorInfoBorder);\n\n  if (infoBorderColor) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-info\"\n    /* EditorInfoDecoration */\n    + \" { border-bottom: 4px double \" + infoBorderColor + \"; }\");\n  }\n\n  var infoForeground = theme.getColor(editorInfoForeground);\n\n  if (infoForeground) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-info\"\n    /* EditorInfoDecoration */\n    + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(infoForeground) + \"\\\") repeat-x bottom left; }\");\n  }\n\n  var hintBorderColor = theme.getColor(editorHintBorder);\n\n  if (hintBorderColor) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-hint\"\n    /* EditorHintDecoration */\n    + \" { border-bottom: 2px dotted \" + hintBorderColor + \"; }\");\n  }\n\n  var hintForeground = theme.getColor(editorHintForeground);\n\n  if (hintForeground) {\n    collector.addRule(\".monaco-editor .\" + \"squiggly-hint\"\n    /* EditorHintDecoration */\n    + \" { background: url(\\\"data:image/svg+xml,\" + getDotDotDotSVGData(hintForeground) + \"\\\") no-repeat bottom left; }\");\n  }\n\n  var unnecessaryForeground = theme.getColor(editorUnnecessaryCodeOpacity);\n\n  if (unnecessaryForeground) {\n    collector.addRule(\".monaco-editor.showUnused .\" + \"squiggly-inline-unnecessary\"\n    /* EditorUnnecessaryInlineDecoration */\n    + \" { opacity: \" + unnecessaryForeground.rgba.a + \"; }\");\n  }\n\n  var unnecessaryBorder = theme.getColor(editorUnnecessaryCodeBorder);\n\n  if (unnecessaryBorder) {\n    collector.addRule(\".monaco-editor.showUnused .\" + \"squiggly-unnecessary\"\n    /* EditorUnnecessaryDecoration */\n    + \" { border-bottom: 2px dashed \" + unnecessaryBorder + \"; }\");\n  }\n\n  var deprecatedForeground = theme.getColor(editorForeground) || 'inherit';\n  collector.addRule(\".monaco-editor .\" + \"squiggly-inline-deprecated\"\n  /* EditorDeprecatedInlineDecoration */\n  + \" { text-decoration: line-through; text-decoration-color: \" + deprecatedForeground + \"}\");\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/browser/widget/codeEditorWidget.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","nls","dom","onUnexpectedError","Emitter","Disposable","dispose","Schemas","Configuration","EditorExtensionsRegistry","ICodeEditorService","View","ViewOutgoingEvents","filterValidationDecorations","Cursor","CursorColumns","Position","Range","Selection","InternalEditorAction","editorCommon","EditorContextKeys","modes","editorUnnecessaryCodeBorder","editorUnnecessaryCodeOpacity","editorErrorBorder","editorErrorForeground","editorHintBorder","editorHintForeground","editorInfoBorder","editorInfoForeground","editorWarningBorder","editorWarningForeground","editorForeground","ViewModel","ICommandService","IContextKeyService","IInstantiationService","ServiceCollection","INotificationService","IThemeService","registerThemingParticipant","IAccessibilityService","withNullAsUndefined","MonospaceLineBreaksComputerFactory","DOMLineBreaksComputerFactory","EDITOR_ID","ModelData","model","viewModel","cursor","view","hasRealView","listenersToRemove","onBeforeDetached","CodeEditorWidget","_super","domElement","options","codeEditorWidgetOptions","instantiationService","codeEditorService","commandService","contextKeyService","themeService","notificationService","accessibilityService","_this","call","_onDidDispose","_register","onDidDispose","event","_onDidChangeModelContent","onDidChangeModelContent","_onDidChangeModelLanguage","onDidChangeModelLanguage","_onDidChangeModelLanguageConfiguration","onDidChangeModelLanguageConfiguration","_onDidChangeModelOptions","onDidChangeModelOptions","_onDidChangeModelDecorations","onDidChangeModelDecorations","_onDidChangeConfiguration","onDidChangeConfiguration","_onDidChangeModel","onDidChangeModel","_onDidChangeCursorPosition","onDidChangeCursorPosition","_onDidChangeCursorSelection","onDidChangeCursorSelection","_onDidAttemptReadOnlyEdit","onDidAttemptReadOnlyEdit","_onDidLayoutChange","onDidLayoutChange","_editorTextFocus","BooleanEventEmitter","onDidFocusEditorText","onDidChangeToTrue","onDidBlurEditorText","onDidChangeToFalse","_editorWidgetFocus","onDidFocusEditorWidget","onDidBlurEditorWidget","_onWillType","onWillType","_onDidType","onDidType","_onDidCompositionStart","onDidCompositionStart","_onDidCompositionEnd","onDidCompositionEnd","_onDidPaste","onDidPaste","_onMouseUp","onMouseUp","_onMouseDown","onMouseDown","_onMouseDrag","onMouseDrag","_onMouseDrop","onMouseDrop","_onContextMenu","onContextMenu","_onMouseMove","onMouseMove","_onMouseLeave","onMouseLeave","_onMouseWheel","onMouseWheel","_onKeyUp","onKeyUp","_onKeyDown","onKeyDown","_onDidContentSizeChange","onDidContentSizeChange","_onDidScrollChange","onDidScrollChange","_onDidChangeViewZones","onDidChangeViewZones","_domElement","_id","_decorationTypeKeysToIds","_decorationTypeSubtypes","isSimpleWidget","_telemetryData","telemetryData","_configuration","_createConfiguration","onDidChange","e","fire","hasChanged","layoutInfo","get","_contextKeyService","createScoped","_notificationService","_codeEditorService","_commandService","_themeService","EditorContextKeysManager","EditorModeContext","_instantiationService","createChild","_modelData","_contributions","_actions","_focusTracker","CodeEditorWidgetFocusTracker","onChange","setValue","hasFocus","_contentWidgets","_overlayWidgets","contributions","isArray","getEditorContributions","_i","contributions_1","contribution","createInstance","ctor","id","err","getEditorActions","forEach","action","internalAction","label","alias","precondition","invokeFunction","accessor","Promise","resolve","runEditorCommand","addCodeEditor","getId","getEditorType","EditorType","ICodeEditor","removeCodeEditor","keys","len","contributionId","_removeDecorationTypes","_postDetachModelCleanup","_detachModel","invokeWithinContext","fn","updateOptions","newOptions","getOptions","getOption","getRawOptions","getValue","preserveBOM","eolPreference","lineEnding","newValue","getModel","setModel","_model","hasTextFocus","detachedModel","_attachModel","hasModel","focus","oldModelUrl","uri","newModelUrl","decorationType","subTypes","subType","_removeDecorationType","getVisibleRanges","getWhitespaces","viewLayout","_getVerticalOffsetForPosition","modelData","modelLineNumber","modelColumn","modelPosition","validatePosition","lineNumber","column","viewPosition","coordinatesConverter","convertModelPositionToViewPosition","getVerticalOffsetForLineNumber","getTopForLineNumber","getTopForPosition","setHiddenAreas","ranges","map","lift","getVisibleColumnFromPosition","rawPosition","position","tabSize","visibleColumnFromColumn","getLineContent","getPosition","setPosition","isIPosition","Error","setSelections","selectionStartLineNumber","selectionStartColumn","positionLineNumber","positionColumn","_sendRevealRange","modelRange","verticalType","revealHorizontal","scrollType","isIRange","validatedModelRange","validateRange","viewRange","convertModelRangeToViewRange","emitCursorRevealRange","revealLine","_revealLine","revealLineInCenter","revealLineInCenterIfOutsideViewport","revealType","revealPosition","_revealPosition","revealPositionInCenter","revealPositionInCenterIfOutsideViewport","getSelection","getSelections","setSelection","something","isSelection","isISelection","isRange","_setSelectionImpl","selection","startLineNumber","startColumn","endLineNumber","endColumn","sel","revealLines","_revealLines","revealLinesInCenter","revealLinesInCenterIfOutsideViewport","revealRange","range","revealVerticalInCenter","_revealRange","revealRangeInCenter","revealRangeInCenterIfOutsideViewport","revealRangeAtTop","source","getContentWidth","getScrollWidth","getScrollLeft","getCurrentScrollLeft","getContentHeight","getScrollHeight","getScrollTop","getCurrentScrollTop","setScrollLeft","newScrollLeft","setScrollPositionNow","scrollLeft","setScrollTop","newScrollTop","scrollTop","setScrollPosition","saveViewState","contributionsState","keys_1","cursorState","saveState","viewState","restoreViewState","s","codeEditorState","restoreState","reducedState","reduceRestoreState","getContribution","getActions","result","push","getSupportedActions","filter","isSupported","getAction","trigger","handlerId","payload","Handler","Type","text","Paste","startPosition","getStartPosition","endPosition","mode","run","then","undefined","_triggerEditorCommand","CompositionStart","CompositionEnd","command","getEditorCommand","_getCursors","pushUndoStop","pushStackElement","executeEdits","edits","endCursorState","cursorStateComputer","executeCommand","ExecuteCommand","executeCommands","commands","ExecuteCommands","changeDecorations","callback","getLineDecorations","deltaDecorations","oldDecorations","newDecorations","removeDecorations","decorationTypeKey","oldDecorationsIds","getLayoutInfo","createOverviewRuler","cssClassName","getContainerDomNode","getDomNode","domNode","delegateVerticalScrollbarMouseDown","browserEvent","layout","dimension","observeReferenceElement","render","isFocused","hasWidgetFocus","addContentWidget","widget","widgetData","console","warn","layoutContentWidget","widgetId","removeContentWidget","addOverlayWidget","layoutOverlayWidget","removeOverlayWidget","changeViewZones","hasChanges","change","getTargetAtClientPoint","clientX","clientY","getScrolledVisiblePosition","top","left","getOffsetForColumn","glyphMarginWidth","lineNumbersWidth","decorationsWidth","height","forceRedraw","setAriaOptions","applyFontInfo","applyFontInfoSlow","setAttribute","getLanguageIdentifier","language","setIsDominatedByLongLines","isDominatedByLongLines","setMaxLineNumber","getLineCount","onBeforeAttached","scheduleAtNextAnimationFrame","onDidChangeDecorations","onDidChangeLanguage","onDidChangeLanguageConfiguration","onDidChangeContent","onDidChangeOptions","onWillDispose","onDidReachMaxCursorCount","localize","MAX_CURSOR_COUNT","positions","selections","e1","secondaryPositions","slice","reason","e2","secondarySelections","modelVersionId","oldSelections","oldModelVersionId","_a","_createView","appendChild","toString","commandDelegate","executeEditorCommand","editorCommand","args","runCoreEditorCommand","paste","pasteOnNewLine","multicursorText","type","replacePreviousChar","replaceCharCnt","ReplacePreviousChar","compositionStart","compositionEnd","cut","Cut","viewOutgoingEvents","onDidScroll","onDidGainFocus","onDidLoseFocus","removeAllDecorationsWithOwnerId","removeDomNode","removeAttribute","removeChild","removeDecorationType","_onDidChangeToTrue","_onDidChangeToFalse","_value","value","editor","_editor","createKey","_editorSimpleInput","editorSimpleInput","bindTo","_editorFocus","_textInputFocus","textInputFocus","editorTextFocus","_editorTabMovesFocus","tabMovesFocus","_editorReadonly","readOnly","_hasMultipleSelections","hasMultipleSelections","_hasNonEmptySelection","hasNonEmptySelection","_canUndo","canUndo","_canRedo","canRedo","_updateFromConfig","_updateFromSelection","_updateFromFocus","_updateFromModel","set","reset","some","isEmpty","Boolean","_langId","languageId","_hasCompletionItemProvider","hasCompletionItemProvider","_hasCodeActionsProvider","hasCodeActionsProvider","_hasCodeLensProvider","hasCodeLensProvider","_hasDefinitionProvider","hasDefinitionProvider","_hasDeclarationProvider","hasDeclarationProvider","_hasImplementationProvider","hasImplementationProvider","_hasTypeDefinitionProvider","hasTypeDefinitionProvider","_hasHoverProvider","hasHoverProvider","_hasDocumentHighlightProvider","hasDocumentHighlightProvider","_hasDocumentSymbolProvider","hasDocumentSymbolProvider","_hasReferenceProvider","hasReferenceProvider","_hasRenameProvider","hasRenameProvider","_hasSignatureHelpProvider","hasSignatureHelpProvider","_hasDocumentFormattingProvider","hasDocumentFormattingProvider","_hasDocumentSelectionFormattingProvider","hasDocumentSelectionFormattingProvider","_hasMultipleDocumentFormattingProvider","hasMultipleDocumentFormattingProvider","_hasMultipleDocumentSelectionFormattingProvider","hasMultipleDocumentSelectionFormattingProvider","_isInWalkThrough","isInEmbeddedEditor","update","_update","CompletionProviderRegistry","CodeActionProviderRegistry","CodeLensProviderRegistry","DefinitionProviderRegistry","DeclarationProviderRegistry","ImplementationProviderRegistry","TypeDefinitionProviderRegistry","HoverProviderRegistry","DocumentHighlightProviderRegistry","DocumentSymbolProviderRegistry","ReferenceProviderRegistry","RenameProviderRegistry","DocumentFormattingEditProviderRegistry","DocumentRangeFormattingEditProviderRegistry","SignatureHelpProviderRegistry","bufferChangeEvents","has","all","scheme","walkThroughSnippet","_onChange","_hasFocus","_domFocusTracker","trackFocus","onDidFocus","onDidBlur","squigglyStart","encodeURIComponent","squigglyEnd","getSquigglySVGData","color","dotdotdotStart","dotdotdotEnd","getDotDotDotSVGData","theme","collector","errorBorderColor","getColor","addRule","errorForeground","warningBorderColor","warningForeground","infoBorderColor","infoForeground","hintBorderColor","hintForeground","unnecessaryForeground","rgba","a","unnecessaryBorder","deprecatedForeground"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/editor.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, dispose } from '../../../base/common/lifecycle.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { EditorExtensionsRegistry } from '../editorExtensions.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { View } from '../view/viewImpl.js';\r\nimport { ViewOutgoingEvents } from '../view/viewOutgoingEvents.js';\r\nimport { filterValidationDecorations } from '../../common/config/editorOptions.js';\r\nimport { Cursor } from '../../common/controller/cursor.js';\r\nimport { CursorColumns } from '../../common/controller/cursorCommon.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { InternalEditorAction } from '../../common/editorAction.js';\r\nimport * as editorCommon from '../../common/editorCommon.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { editorUnnecessaryCodeBorder, editorUnnecessaryCodeOpacity } from '../../common/view/editorColorRegistry.js';\r\nimport { editorErrorBorder, editorErrorForeground, editorHintBorder, editorHintForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, editorForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { ViewModel } from '../../common/viewModel/viewModelImpl.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\r\nimport { withNullAsUndefined } from '../../../base/common/types.js';\r\nimport { MonospaceLineBreaksComputerFactory } from '../../common/viewModel/monospaceLineBreaksComputer.js';\r\nimport { DOMLineBreaksComputerFactory } from '../view/domLineBreaksComputer.js';\r\nvar EDITOR_ID = 0;\r\nvar ModelData = /** @class */ (function () {\r\n    function ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove) {\r\n        this.model = model;\r\n        this.viewModel = viewModel;\r\n        this.cursor = cursor;\r\n        this.view = view;\r\n        this.hasRealView = hasRealView;\r\n        this.listenersToRemove = listenersToRemove;\r\n    }\r\n    ModelData.prototype.dispose = function () {\r\n        dispose(this.listenersToRemove);\r\n        this.model.onBeforeDetached();\r\n        if (this.hasRealView) {\r\n            this.view.dispose();\r\n        }\r\n        this.cursor.dispose();\r\n        this.viewModel.dispose();\r\n    };\r\n    return ModelData;\r\n}());\r\nvar CodeEditorWidget = /** @class */ (function (_super) {\r\n    __extends(CodeEditorWidget, _super);\r\n    function CodeEditorWidget(domElement, options, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\r\n        var _this = _super.call(this) || this;\r\n        //#region Eventing\r\n        _this._onDidDispose = _this._register(new Emitter());\r\n        _this.onDidDispose = _this._onDidDispose.event;\r\n        _this._onDidChangeModelContent = _this._register(new Emitter());\r\n        _this.onDidChangeModelContent = _this._onDidChangeModelContent.event;\r\n        _this._onDidChangeModelLanguage = _this._register(new Emitter());\r\n        _this.onDidChangeModelLanguage = _this._onDidChangeModelLanguage.event;\r\n        _this._onDidChangeModelLanguageConfiguration = _this._register(new Emitter());\r\n        _this.onDidChangeModelLanguageConfiguration = _this._onDidChangeModelLanguageConfiguration.event;\r\n        _this._onDidChangeModelOptions = _this._register(new Emitter());\r\n        _this.onDidChangeModelOptions = _this._onDidChangeModelOptions.event;\r\n        _this._onDidChangeModelDecorations = _this._register(new Emitter());\r\n        _this.onDidChangeModelDecorations = _this._onDidChangeModelDecorations.event;\r\n        _this._onDidChangeConfiguration = _this._register(new Emitter());\r\n        _this.onDidChangeConfiguration = _this._onDidChangeConfiguration.event;\r\n        _this._onDidChangeModel = _this._register(new Emitter());\r\n        _this.onDidChangeModel = _this._onDidChangeModel.event;\r\n        _this._onDidChangeCursorPosition = _this._register(new Emitter());\r\n        _this.onDidChangeCursorPosition = _this._onDidChangeCursorPosition.event;\r\n        _this._onDidChangeCursorSelection = _this._register(new Emitter());\r\n        _this.onDidChangeCursorSelection = _this._onDidChangeCursorSelection.event;\r\n        _this._onDidAttemptReadOnlyEdit = _this._register(new Emitter());\r\n        _this.onDidAttemptReadOnlyEdit = _this._onDidAttemptReadOnlyEdit.event;\r\n        _this._onDidLayoutChange = _this._register(new Emitter());\r\n        _this.onDidLayoutChange = _this._onDidLayoutChange.event;\r\n        _this._editorTextFocus = _this._register(new BooleanEventEmitter());\r\n        _this.onDidFocusEditorText = _this._editorTextFocus.onDidChangeToTrue;\r\n        _this.onDidBlurEditorText = _this._editorTextFocus.onDidChangeToFalse;\r\n        _this._editorWidgetFocus = _this._register(new BooleanEventEmitter());\r\n        _this.onDidFocusEditorWidget = _this._editorWidgetFocus.onDidChangeToTrue;\r\n        _this.onDidBlurEditorWidget = _this._editorWidgetFocus.onDidChangeToFalse;\r\n        _this._onWillType = _this._register(new Emitter());\r\n        _this.onWillType = _this._onWillType.event;\r\n        _this._onDidType = _this._register(new Emitter());\r\n        _this.onDidType = _this._onDidType.event;\r\n        _this._onDidCompositionStart = _this._register(new Emitter());\r\n        _this.onDidCompositionStart = _this._onDidCompositionStart.event;\r\n        _this._onDidCompositionEnd = _this._register(new Emitter());\r\n        _this.onDidCompositionEnd = _this._onDidCompositionEnd.event;\r\n        _this._onDidPaste = _this._register(new Emitter());\r\n        _this.onDidPaste = _this._onDidPaste.event;\r\n        _this._onMouseUp = _this._register(new Emitter());\r\n        _this.onMouseUp = _this._onMouseUp.event;\r\n        _this._onMouseDown = _this._register(new Emitter());\r\n        _this.onMouseDown = _this._onMouseDown.event;\r\n        _this._onMouseDrag = _this._register(new Emitter());\r\n        _this.onMouseDrag = _this._onMouseDrag.event;\r\n        _this._onMouseDrop = _this._register(new Emitter());\r\n        _this.onMouseDrop = _this._onMouseDrop.event;\r\n        _this._onContextMenu = _this._register(new Emitter());\r\n        _this.onContextMenu = _this._onContextMenu.event;\r\n        _this._onMouseMove = _this._register(new Emitter());\r\n        _this.onMouseMove = _this._onMouseMove.event;\r\n        _this._onMouseLeave = _this._register(new Emitter());\r\n        _this.onMouseLeave = _this._onMouseLeave.event;\r\n        _this._onMouseWheel = _this._register(new Emitter());\r\n        _this.onMouseWheel = _this._onMouseWheel.event;\r\n        _this._onKeyUp = _this._register(new Emitter());\r\n        _this.onKeyUp = _this._onKeyUp.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._onDidContentSizeChange = _this._register(new Emitter());\r\n        _this.onDidContentSizeChange = _this._onDidContentSizeChange.event;\r\n        _this._onDidScrollChange = _this._register(new Emitter());\r\n        _this.onDidScrollChange = _this._onDidScrollChange.event;\r\n        _this._onDidChangeViewZones = _this._register(new Emitter());\r\n        _this.onDidChangeViewZones = _this._onDidChangeViewZones.event;\r\n        _this._domElement = domElement;\r\n        _this._id = (++EDITOR_ID);\r\n        _this._decorationTypeKeysToIds = {};\r\n        _this._decorationTypeSubtypes = {};\r\n        _this.isSimpleWidget = codeEditorWidgetOptions.isSimpleWidget || false;\r\n        _this._telemetryData = codeEditorWidgetOptions.telemetryData;\r\n        options = options || {};\r\n        _this._configuration = _this._register(_this._createConfiguration(options, accessibilityService));\r\n        _this._register(_this._configuration.onDidChange(function (e) {\r\n            _this._onDidChangeConfiguration.fire(e);\r\n            var options = _this._configuration.options;\r\n            if (e.hasChanged(107 /* layoutInfo */)) {\r\n                var layoutInfo = options.get(107 /* layoutInfo */);\r\n                _this._onDidLayoutChange.fire(layoutInfo);\r\n            }\r\n        }));\r\n        _this._contextKeyService = _this._register(contextKeyService.createScoped(_this._domElement));\r\n        _this._notificationService = notificationService;\r\n        _this._codeEditorService = codeEditorService;\r\n        _this._commandService = commandService;\r\n        _this._themeService = themeService;\r\n        _this._register(new EditorContextKeysManager(_this, _this._contextKeyService));\r\n        _this._register(new EditorModeContext(_this, _this._contextKeyService));\r\n        _this._instantiationService = instantiationService.createChild(new ServiceCollection([IContextKeyService, _this._contextKeyService]));\r\n        _this._modelData = null;\r\n        _this._contributions = {};\r\n        _this._actions = {};\r\n        _this._focusTracker = new CodeEditorWidgetFocusTracker(domElement);\r\n        _this._focusTracker.onChange(function () {\r\n            _this._editorWidgetFocus.setValue(_this._focusTracker.hasFocus());\r\n        });\r\n        _this._contentWidgets = {};\r\n        _this._overlayWidgets = {};\r\n        var contributions;\r\n        if (Array.isArray(codeEditorWidgetOptions.contributions)) {\r\n            contributions = codeEditorWidgetOptions.contributions;\r\n        }\r\n        else {\r\n            contributions = EditorExtensionsRegistry.getEditorContributions();\r\n        }\r\n        for (var _i = 0, contributions_1 = contributions; _i < contributions_1.length; _i++) {\r\n            var desc = contributions_1[_i];\r\n            try {\r\n                var contribution = _this._instantiationService.createInstance(desc.ctor, _this);\r\n                _this._contributions[desc.id] = contribution;\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n        }\r\n        EditorExtensionsRegistry.getEditorActions().forEach(function (action) {\r\n            var internalAction = new InternalEditorAction(action.id, action.label, action.alias, withNullAsUndefined(action.precondition), function () {\r\n                return _this._instantiationService.invokeFunction(function (accessor) {\r\n                    return Promise.resolve(action.runEditorCommand(accessor, _this, null));\r\n                });\r\n            }, _this._contextKeyService);\r\n            _this._actions[internalAction.id] = internalAction;\r\n        });\r\n        _this._codeEditorService.addCodeEditor(_this);\r\n        return _this;\r\n    }\r\n    CodeEditorWidget.prototype._createConfiguration = function (options, accessibilityService) {\r\n        return new Configuration(this.isSimpleWidget, options, this._domElement, accessibilityService);\r\n    };\r\n    CodeEditorWidget.prototype.getId = function () {\r\n        return this.getEditorType() + ':' + this._id;\r\n    };\r\n    CodeEditorWidget.prototype.getEditorType = function () {\r\n        return editorCommon.EditorType.ICodeEditor;\r\n    };\r\n    CodeEditorWidget.prototype.dispose = function () {\r\n        this._codeEditorService.removeCodeEditor(this);\r\n        this._focusTracker.dispose();\r\n        var keys = Object.keys(this._contributions);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var contributionId = keys[i];\r\n            this._contributions[contributionId].dispose();\r\n        }\r\n        this._removeDecorationTypes();\r\n        this._postDetachModelCleanup(this._detachModel());\r\n        this._onDidDispose.fire();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    CodeEditorWidget.prototype.invokeWithinContext = function (fn) {\r\n        return this._instantiationService.invokeFunction(fn);\r\n    };\r\n    CodeEditorWidget.prototype.updateOptions = function (newOptions) {\r\n        this._configuration.updateOptions(newOptions);\r\n    };\r\n    CodeEditorWidget.prototype.getOptions = function () {\r\n        return this._configuration.options;\r\n    };\r\n    CodeEditorWidget.prototype.getOption = function (id) {\r\n        return this._configuration.options.get(id);\r\n    };\r\n    CodeEditorWidget.prototype.getRawOptions = function () {\r\n        return this._configuration.getRawOptions();\r\n    };\r\n    CodeEditorWidget.prototype.getValue = function (options) {\r\n        if (options === void 0) { options = null; }\r\n        if (!this._modelData) {\r\n            return '';\r\n        }\r\n        var preserveBOM = (options && options.preserveBOM) ? true : false;\r\n        var eolPreference = 0 /* TextDefined */;\r\n        if (options && options.lineEnding && options.lineEnding === '\\n') {\r\n            eolPreference = 1 /* LF */;\r\n        }\r\n        else if (options && options.lineEnding && options.lineEnding === '\\r\\n') {\r\n            eolPreference = 2 /* CRLF */;\r\n        }\r\n        return this._modelData.model.getValue(eolPreference, preserveBOM);\r\n    };\r\n    CodeEditorWidget.prototype.setValue = function (newValue) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.model.setValue(newValue);\r\n    };\r\n    CodeEditorWidget.prototype.getModel = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.model;\r\n    };\r\n    CodeEditorWidget.prototype.setModel = function (_model) {\r\n        if (_model === void 0) { _model = null; }\r\n        var model = _model;\r\n        if (this._modelData === null && model === null) {\r\n            // Current model is the new model\r\n            return;\r\n        }\r\n        if (this._modelData && this._modelData.model === model) {\r\n            // Current model is the new model\r\n            return;\r\n        }\r\n        var hasTextFocus = this.hasTextFocus();\r\n        var detachedModel = this._detachModel();\r\n        this._attachModel(model);\r\n        if (hasTextFocus && this.hasModel()) {\r\n            this.focus();\r\n        }\r\n        var e = {\r\n            oldModelUrl: detachedModel ? detachedModel.uri : null,\r\n            newModelUrl: model ? model.uri : null\r\n        };\r\n        this._removeDecorationTypes();\r\n        this._onDidChangeModel.fire(e);\r\n        this._postDetachModelCleanup(detachedModel);\r\n    };\r\n    CodeEditorWidget.prototype._removeDecorationTypes = function () {\r\n        this._decorationTypeKeysToIds = {};\r\n        if (this._decorationTypeSubtypes) {\r\n            for (var decorationType in this._decorationTypeSubtypes) {\r\n                var subTypes = this._decorationTypeSubtypes[decorationType];\r\n                for (var subType in subTypes) {\r\n                    this._removeDecorationType(decorationType + '-' + subType);\r\n                }\r\n            }\r\n            this._decorationTypeSubtypes = {};\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getVisibleRanges = function () {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        return this._modelData.viewModel.getVisibleRanges();\r\n    };\r\n    CodeEditorWidget.prototype.getWhitespaces = function () {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getWhitespaces();\r\n    };\r\n    CodeEditorWidget._getVerticalOffsetForPosition = function (modelData, modelLineNumber, modelColumn) {\r\n        var modelPosition = modelData.model.validatePosition({\r\n            lineNumber: modelLineNumber,\r\n            column: modelColumn\r\n        });\r\n        var viewPosition = modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\r\n        return modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\r\n    };\r\n    CodeEditorWidget.prototype.getTopForLineNumber = function (lineNumber) {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, 1);\r\n    };\r\n    CodeEditorWidget.prototype.getTopForPosition = function (lineNumber, column) {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, column);\r\n    };\r\n    CodeEditorWidget.prototype.setHiddenAreas = function (ranges) {\r\n        if (this._modelData) {\r\n            this._modelData.viewModel.setHiddenAreas(ranges.map(function (r) { return Range.lift(r); }));\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getVisibleColumnFromPosition = function (rawPosition) {\r\n        if (!this._modelData) {\r\n            return rawPosition.column;\r\n        }\r\n        var position = this._modelData.model.validatePosition(rawPosition);\r\n        var tabSize = this._modelData.model.getOptions().tabSize;\r\n        return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber), position.column, tabSize) + 1;\r\n    };\r\n    CodeEditorWidget.prototype.getPosition = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor.getPosition();\r\n    };\r\n    CodeEditorWidget.prototype.setPosition = function (position) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!Position.isIPosition(position)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.cursor.setSelections('api', [{\r\n                selectionStartLineNumber: position.lineNumber,\r\n                selectionStartColumn: position.column,\r\n                positionLineNumber: position.lineNumber,\r\n                positionColumn: position.column\r\n            }]);\r\n    };\r\n    CodeEditorWidget.prototype._sendRevealRange = function (modelRange, verticalType, revealHorizontal, scrollType) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!Range.isIRange(modelRange)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        var validatedModelRange = this._modelData.model.validateRange(modelRange);\r\n        var viewRange = this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);\r\n        this._modelData.cursor.emitCursorRevealRange('api', viewRange, verticalType, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLine = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLine(lineNumber, 0 /* Simple */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLineInCenter = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLine(lineNumber, 1 /* Center */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLineInCenterIfOutsideViewport = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLine(lineNumber, 2 /* CenterIfOutsideViewport */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealLine = function (lineNumber, revealType, scrollType) {\r\n        if (typeof lineNumber !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(lineNumber, 1, lineNumber, 1), revealType, false, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealPosition = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealPosition(position, 0 /* Simple */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealPositionInCenter = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealPosition(position, 1 /* Center */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealPositionInCenterIfOutsideViewport = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealPosition(position, 2 /* CenterIfOutsideViewport */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealPosition = function (position, verticalType, revealHorizontal, scrollType) {\r\n        if (!Position.isIPosition(position)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(position.lineNumber, position.column, position.lineNumber, position.column), verticalType, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.getSelection = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor.getSelection();\r\n    };\r\n    CodeEditorWidget.prototype.getSelections = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor.getSelections();\r\n    };\r\n    CodeEditorWidget.prototype.setSelection = function (something) {\r\n        var isSelection = Selection.isISelection(something);\r\n        var isRange = Range.isIRange(something);\r\n        if (!isSelection && !isRange) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        if (isSelection) {\r\n            this._setSelectionImpl(something);\r\n        }\r\n        else if (isRange) {\r\n            // act as if it was an IRange\r\n            var selection = {\r\n                selectionStartLineNumber: something.startLineNumber,\r\n                selectionStartColumn: something.startColumn,\r\n                positionLineNumber: something.endLineNumber,\r\n                positionColumn: something.endColumn\r\n            };\r\n            this._setSelectionImpl(selection);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype._setSelectionImpl = function (sel) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        var selection = new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\r\n        this._modelData.cursor.setSelections('api', [selection]);\r\n    };\r\n    CodeEditorWidget.prototype.revealLines = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLines(startLineNumber, endLineNumber, 0 /* Simple */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLinesInCenter = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLines(startLineNumber, endLineNumber, 1 /* Center */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLinesInCenterIfOutsideViewport = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLines(startLineNumber, endLineNumber, 2 /* CenterIfOutsideViewport */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealLines = function (startLineNumber, endLineNumber, verticalType, scrollType) {\r\n        if (typeof startLineNumber !== 'number' || typeof endLineNumber !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(startLineNumber, 1, endLineNumber, 1), verticalType, false, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRange = function (range, scrollType, revealVerticalInCenter, revealHorizontal) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        if (revealVerticalInCenter === void 0) { revealVerticalInCenter = false; }\r\n        if (revealHorizontal === void 0) { revealHorizontal = true; }\r\n        this._revealRange(range, revealVerticalInCenter ? 1 /* Center */ : 0 /* Simple */, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRangeInCenter = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealRange(range, 1 /* Center */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRangeInCenterIfOutsideViewport = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealRange(range, 2 /* CenterIfOutsideViewport */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRangeAtTop = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealRange(range, 3 /* Top */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealRange = function (range, verticalType, revealHorizontal, scrollType) {\r\n        if (!Range.isIRange(range)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(Range.lift(range), verticalType, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.setSelections = function (ranges, source) {\r\n        if (source === void 0) { source = 'api'; }\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!ranges || ranges.length === 0) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        for (var i = 0, len = ranges.length; i < len; i++) {\r\n            if (!Selection.isISelection(ranges[i])) {\r\n                throw new Error('Invalid arguments');\r\n            }\r\n        }\r\n        this._modelData.cursor.setSelections(source, ranges);\r\n    };\r\n    CodeEditorWidget.prototype.getContentWidth = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getContentWidth();\r\n    };\r\n    CodeEditorWidget.prototype.getScrollWidth = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getScrollWidth();\r\n    };\r\n    CodeEditorWidget.prototype.getScrollLeft = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getCurrentScrollLeft();\r\n    };\r\n    CodeEditorWidget.prototype.getContentHeight = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getContentHeight();\r\n    };\r\n    CodeEditorWidget.prototype.getScrollHeight = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getScrollHeight();\r\n    };\r\n    CodeEditorWidget.prototype.getScrollTop = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getCurrentScrollTop();\r\n    };\r\n    CodeEditorWidget.prototype.setScrollLeft = function (newScrollLeft) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (typeof newScrollLeft !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.viewModel.viewLayout.setScrollPositionNow({\r\n            scrollLeft: newScrollLeft\r\n        });\r\n    };\r\n    CodeEditorWidget.prototype.setScrollTop = function (newScrollTop) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (typeof newScrollTop !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.viewModel.viewLayout.setScrollPositionNow({\r\n            scrollTop: newScrollTop\r\n        });\r\n    };\r\n    CodeEditorWidget.prototype.setScrollPosition = function (position) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.viewLayout.setScrollPositionNow(position);\r\n    };\r\n    CodeEditorWidget.prototype.saveViewState = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        var contributionsState = {};\r\n        var keys = Object.keys(this._contributions);\r\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n            var id = keys_1[_i];\r\n            var contribution = this._contributions[id];\r\n            if (typeof contribution.saveViewState === 'function') {\r\n                contributionsState[id] = contribution.saveViewState();\r\n            }\r\n        }\r\n        var cursorState = this._modelData.cursor.saveState();\r\n        var viewState = this._modelData.viewModel.saveState();\r\n        return {\r\n            cursorState: cursorState,\r\n            viewState: viewState,\r\n            contributionsState: contributionsState\r\n        };\r\n    };\r\n    CodeEditorWidget.prototype.restoreViewState = function (s) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        var codeEditorState = s;\r\n        if (codeEditorState && codeEditorState.cursorState && codeEditorState.viewState) {\r\n            var cursorState = codeEditorState.cursorState;\r\n            if (Array.isArray(cursorState)) {\r\n                this._modelData.cursor.restoreState(cursorState);\r\n            }\r\n            else {\r\n                // Backwards compatibility\r\n                this._modelData.cursor.restoreState([cursorState]);\r\n            }\r\n            var contributionsState = codeEditorState.contributionsState || {};\r\n            var keys = Object.keys(this._contributions);\r\n            for (var i = 0, len = keys.length; i < len; i++) {\r\n                var id = keys[i];\r\n                var contribution = this._contributions[id];\r\n                if (typeof contribution.restoreViewState === 'function') {\r\n                    contribution.restoreViewState(contributionsState[id]);\r\n                }\r\n            }\r\n            var reducedState = this._modelData.viewModel.reduceRestoreState(codeEditorState.viewState);\r\n            this._modelData.view.restoreState(reducedState);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getContribution = function (id) {\r\n        return (this._contributions[id] || null);\r\n    };\r\n    CodeEditorWidget.prototype.getActions = function () {\r\n        var result = [];\r\n        var keys = Object.keys(this._actions);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var id = keys[i];\r\n            result.push(this._actions[id]);\r\n        }\r\n        return result;\r\n    };\r\n    CodeEditorWidget.prototype.getSupportedActions = function () {\r\n        var result = this.getActions();\r\n        result = result.filter(function (action) { return action.isSupported(); });\r\n        return result;\r\n    };\r\n    CodeEditorWidget.prototype.getAction = function (id) {\r\n        return this._actions[id] || null;\r\n    };\r\n    CodeEditorWidget.prototype.trigger = function (source, handlerId, payload) {\r\n        payload = payload || {};\r\n        // Special case for typing\r\n        if (handlerId === editorCommon.Handler.Type) {\r\n            if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\r\n                // nothing to do\r\n                return;\r\n            }\r\n            if (source === 'keyboard') {\r\n                this._onWillType.fire(payload.text);\r\n            }\r\n            this._modelData.cursor.trigger(source, handlerId, payload);\r\n            if (source === 'keyboard') {\r\n                this._onDidType.fire(payload.text);\r\n            }\r\n            return;\r\n        }\r\n        // Special case for pasting\r\n        if (handlerId === editorCommon.Handler.Paste) {\r\n            if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\r\n                // nothing to do\r\n                return;\r\n            }\r\n            var startPosition = this._modelData.cursor.getSelection().getStartPosition();\r\n            this._modelData.cursor.trigger(source, handlerId, payload);\r\n            var endPosition = this._modelData.cursor.getSelection().getStartPosition();\r\n            if (source === 'keyboard') {\r\n                this._onDidPaste.fire({\r\n                    range: new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column),\r\n                    mode: payload.mode\r\n                });\r\n            }\r\n            return;\r\n        }\r\n        var action = this.getAction(handlerId);\r\n        if (action) {\r\n            Promise.resolve(action.run()).then(undefined, onUnexpectedError);\r\n            return;\r\n        }\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (this._triggerEditorCommand(source, handlerId, payload)) {\r\n            return;\r\n        }\r\n        this._modelData.cursor.trigger(source, handlerId, payload);\r\n        if (handlerId === editorCommon.Handler.CompositionStart) {\r\n            this._onDidCompositionStart.fire();\r\n        }\r\n        if (handlerId === editorCommon.Handler.CompositionEnd) {\r\n            this._onDidCompositionEnd.fire();\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype._triggerEditorCommand = function (source, handlerId, payload) {\r\n        var _this = this;\r\n        var command = EditorExtensionsRegistry.getEditorCommand(handlerId);\r\n        if (command) {\r\n            payload = payload || {};\r\n            payload.source = source;\r\n            this._instantiationService.invokeFunction(function (accessor) {\r\n                Promise.resolve(command.runEditorCommand(accessor, _this, payload)).then(undefined, onUnexpectedError);\r\n            });\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CodeEditorWidget.prototype._getCursors = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor;\r\n    };\r\n    CodeEditorWidget.prototype.pushUndoStop = function () {\r\n        if (!this._modelData) {\r\n            return false;\r\n        }\r\n        if (this._configuration.options.get(68 /* readOnly */)) {\r\n            // read only editor => sorry!\r\n            return false;\r\n        }\r\n        this._modelData.model.pushStackElement();\r\n        return true;\r\n    };\r\n    CodeEditorWidget.prototype.executeEdits = function (source, edits, endCursorState) {\r\n        if (!this._modelData) {\r\n            return false;\r\n        }\r\n        if (this._configuration.options.get(68 /* readOnly */)) {\r\n            // read only editor => sorry!\r\n            return false;\r\n        }\r\n        var cursorStateComputer;\r\n        if (!endCursorState) {\r\n            cursorStateComputer = function () { return null; };\r\n        }\r\n        else if (Array.isArray(endCursorState)) {\r\n            cursorStateComputer = function () { return endCursorState; };\r\n        }\r\n        else {\r\n            cursorStateComputer = endCursorState;\r\n        }\r\n        this._modelData.cursor.executeEdits(source, edits, cursorStateComputer);\r\n        return true;\r\n    };\r\n    CodeEditorWidget.prototype.executeCommand = function (source, command) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommand, command);\r\n    };\r\n    CodeEditorWidget.prototype.executeCommands = function (source, commands) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommands, commands);\r\n    };\r\n    CodeEditorWidget.prototype.changeDecorations = function (callback) {\r\n        if (!this._modelData) {\r\n            // callback will not be called\r\n            return null;\r\n        }\r\n        return this._modelData.model.changeDecorations(callback, this._id);\r\n    };\r\n    CodeEditorWidget.prototype.getLineDecorations = function (lineNumber) {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.model.getLineDecorations(lineNumber, this._id, filterValidationDecorations(this._configuration.options));\r\n    };\r\n    CodeEditorWidget.prototype.deltaDecorations = function (oldDecorations, newDecorations) {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        if (oldDecorations.length === 0 && newDecorations.length === 0) {\r\n            return oldDecorations;\r\n        }\r\n        return this._modelData.model.deltaDecorations(oldDecorations, newDecorations, this._id);\r\n    };\r\n    CodeEditorWidget.prototype.removeDecorations = function (decorationTypeKey) {\r\n        // remove decorations for type and sub type\r\n        var oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey];\r\n        if (oldDecorationsIds) {\r\n            this.deltaDecorations(oldDecorationsIds, []);\r\n        }\r\n        if (this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)) {\r\n            delete this._decorationTypeKeysToIds[decorationTypeKey];\r\n        }\r\n        if (this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)) {\r\n            delete this._decorationTypeSubtypes[decorationTypeKey];\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getLayoutInfo = function () {\r\n        var options = this._configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        return layoutInfo;\r\n    };\r\n    CodeEditorWidget.prototype.createOverviewRuler = function (cssClassName) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.createOverviewRuler(cssClassName);\r\n    };\r\n    CodeEditorWidget.prototype.getContainerDomNode = function () {\r\n        return this._domElement;\r\n    };\r\n    CodeEditorWidget.prototype.getDomNode = function () {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.domNode.domNode;\r\n    };\r\n    CodeEditorWidget.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent);\r\n    };\r\n    CodeEditorWidget.prototype.layout = function (dimension) {\r\n        this._configuration.observeReferenceElement(dimension);\r\n        this.render();\r\n    };\r\n    CodeEditorWidget.prototype.focus = function () {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.focus();\r\n    };\r\n    CodeEditorWidget.prototype.hasTextFocus = function () {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return false;\r\n        }\r\n        return this._modelData.view.isFocused();\r\n    };\r\n    CodeEditorWidget.prototype.hasWidgetFocus = function () {\r\n        return this._focusTracker && this._focusTracker.hasFocus();\r\n    };\r\n    CodeEditorWidget.prototype.addContentWidget = function (widget) {\r\n        var widgetData = {\r\n            widget: widget,\r\n            position: widget.getPosition()\r\n        };\r\n        if (this._contentWidgets.hasOwnProperty(widget.getId())) {\r\n            console.warn('Overwriting a content widget with the same id.');\r\n        }\r\n        this._contentWidgets[widget.getId()] = widgetData;\r\n        if (this._modelData && this._modelData.hasRealView) {\r\n            this._modelData.view.addContentWidget(widgetData);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.layoutContentWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._contentWidgets[widgetId];\r\n            widgetData.position = widget.getPosition();\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.layoutContentWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.removeContentWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._contentWidgets[widgetId];\r\n            delete this._contentWidgets[widgetId];\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.removeContentWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.addOverlayWidget = function (widget) {\r\n        var widgetData = {\r\n            widget: widget,\r\n            position: widget.getPosition()\r\n        };\r\n        if (this._overlayWidgets.hasOwnProperty(widget.getId())) {\r\n            console.warn('Overwriting an overlay widget with the same id.');\r\n        }\r\n        this._overlayWidgets[widget.getId()] = widgetData;\r\n        if (this._modelData && this._modelData.hasRealView) {\r\n            this._modelData.view.addOverlayWidget(widgetData);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.layoutOverlayWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._overlayWidgets[widgetId];\r\n            widgetData.position = widget.getPosition();\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.layoutOverlayWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.removeOverlayWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._overlayWidgets[widgetId];\r\n            delete this._overlayWidgets[widgetId];\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.removeOverlayWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.changeViewZones = function (callback) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        var hasChanges = this._modelData.view.change(callback);\r\n        if (hasChanges) {\r\n            this._onDidChangeViewZones.fire();\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getTargetAtClientPoint = function (clientX, clientY) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.getTargetAtClientPoint(clientX, clientY);\r\n    };\r\n    CodeEditorWidget.prototype.getScrolledVisiblePosition = function (rawPosition) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        var position = this._modelData.model.validatePosition(rawPosition);\r\n        var options = this._configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        var top = CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, position.lineNumber, position.column) - this.getScrollTop();\r\n        var left = this._modelData.view.getOffsetForColumn(position.lineNumber, position.column) + layoutInfo.glyphMarginWidth + layoutInfo.lineNumbersWidth + layoutInfo.decorationsWidth - this.getScrollLeft();\r\n        return {\r\n            top: top,\r\n            left: left,\r\n            height: options.get(49 /* lineHeight */)\r\n        };\r\n    };\r\n    CodeEditorWidget.prototype.getOffsetForColumn = function (lineNumber, column) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return -1;\r\n        }\r\n        return this._modelData.view.getOffsetForColumn(lineNumber, column);\r\n    };\r\n    CodeEditorWidget.prototype.render = function (forceRedraw) {\r\n        if (forceRedraw === void 0) { forceRedraw = false; }\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.render(true, forceRedraw);\r\n    };\r\n    CodeEditorWidget.prototype.setAriaOptions = function (options) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.setAriaOptions(options);\r\n    };\r\n    CodeEditorWidget.prototype.applyFontInfo = function (target) {\r\n        Configuration.applyFontInfoSlow(target, this._configuration.options.get(34 /* fontInfo */));\r\n    };\r\n    CodeEditorWidget.prototype._attachModel = function (model) {\r\n        var _this = this;\r\n        if (!model) {\r\n            this._modelData = null;\r\n            return;\r\n        }\r\n        var listenersToRemove = [];\r\n        this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\r\n        this._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines());\r\n        this._configuration.setMaxLineNumber(model.getLineCount());\r\n        model.onBeforeAttached();\r\n        var viewModel = new ViewModel(this._id, this._configuration, model, DOMLineBreaksComputerFactory.create(), MonospaceLineBreaksComputerFactory.create(this._configuration.options), function (callback) { return dom.scheduleAtNextAnimationFrame(callback); });\r\n        listenersToRemove.push(model.onDidChangeDecorations(function (e) { return _this._onDidChangeModelDecorations.fire(e); }));\r\n        listenersToRemove.push(model.onDidChangeLanguage(function (e) {\r\n            _this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\r\n            _this._onDidChangeModelLanguage.fire(e);\r\n        }));\r\n        listenersToRemove.push(model.onDidChangeLanguageConfiguration(function (e) { return _this._onDidChangeModelLanguageConfiguration.fire(e); }));\r\n        listenersToRemove.push(model.onDidChangeContent(function (e) { return _this._onDidChangeModelContent.fire(e); }));\r\n        listenersToRemove.push(model.onDidChangeOptions(function (e) { return _this._onDidChangeModelOptions.fire(e); }));\r\n        // Someone might destroy the model from under the editor, so prevent any exceptions by setting a null model\r\n        listenersToRemove.push(model.onWillDispose(function () { return _this.setModel(null); }));\r\n        var cursor = new Cursor(this._configuration, model, viewModel);\r\n        listenersToRemove.push(cursor.onDidReachMaxCursorCount(function () {\r\n            _this._notificationService.warn(nls.localize('cursors.maximum', \"The number of cursors has been limited to {0}.\", Cursor.MAX_CURSOR_COUNT));\r\n        }));\r\n        listenersToRemove.push(cursor.onDidAttemptReadOnlyEdit(function () {\r\n            _this._onDidAttemptReadOnlyEdit.fire(undefined);\r\n        }));\r\n        listenersToRemove.push(cursor.onDidChange(function (e) {\r\n            var positions = [];\r\n            for (var i = 0, len = e.selections.length; i < len; i++) {\r\n                positions[i] = e.selections[i].getPosition();\r\n            }\r\n            var e1 = {\r\n                position: positions[0],\r\n                secondaryPositions: positions.slice(1),\r\n                reason: e.reason,\r\n                source: e.source\r\n            };\r\n            _this._onDidChangeCursorPosition.fire(e1);\r\n            var e2 = {\r\n                selection: e.selections[0],\r\n                secondarySelections: e.selections.slice(1),\r\n                modelVersionId: e.modelVersionId,\r\n                oldSelections: e.oldSelections,\r\n                oldModelVersionId: e.oldModelVersionId,\r\n                source: e.source,\r\n                reason: e.reason\r\n            };\r\n            _this._onDidChangeCursorSelection.fire(e2);\r\n        }));\r\n        var _a = this._createView(viewModel, cursor), view = _a[0], hasRealView = _a[1];\r\n        if (hasRealView) {\r\n            this._domElement.appendChild(view.domNode.domNode);\r\n            var keys = Object.keys(this._contentWidgets);\r\n            for (var i = 0, len = keys.length; i < len; i++) {\r\n                var widgetId = keys[i];\r\n                view.addContentWidget(this._contentWidgets[widgetId]);\r\n            }\r\n            keys = Object.keys(this._overlayWidgets);\r\n            for (var i = 0, len = keys.length; i < len; i++) {\r\n                var widgetId = keys[i];\r\n                view.addOverlayWidget(this._overlayWidgets[widgetId]);\r\n            }\r\n            view.render(false, true);\r\n            view.domNode.domNode.setAttribute('data-uri', model.uri.toString());\r\n        }\r\n        this._modelData = new ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove);\r\n    };\r\n    CodeEditorWidget.prototype._createView = function (viewModel, cursor) {\r\n        var _this = this;\r\n        var commandDelegate;\r\n        if (this.isSimpleWidget) {\r\n            commandDelegate = {\r\n                executeEditorCommand: function (editorCommand, args) {\r\n                    editorCommand.runCoreEditorCommand(cursor, args);\r\n                },\r\n                paste: function (source, text, pasteOnNewLine, multicursorText, mode) {\r\n                    _this.trigger(source, editorCommon.Handler.Paste, { text: text, pasteOnNewLine: pasteOnNewLine, multicursorText: multicursorText, mode: mode });\r\n                },\r\n                type: function (source, text) {\r\n                    _this.trigger(source, editorCommon.Handler.Type, { text: text });\r\n                },\r\n                replacePreviousChar: function (source, text, replaceCharCnt) {\r\n                    _this.trigger(source, editorCommon.Handler.ReplacePreviousChar, { text: text, replaceCharCnt: replaceCharCnt });\r\n                },\r\n                compositionStart: function (source) {\r\n                    _this.trigger(source, editorCommon.Handler.CompositionStart, undefined);\r\n                },\r\n                compositionEnd: function (source) {\r\n                    _this.trigger(source, editorCommon.Handler.CompositionEnd, undefined);\r\n                },\r\n                cut: function (source) {\r\n                    _this.trigger(source, editorCommon.Handler.Cut, undefined);\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            commandDelegate = {\r\n                executeEditorCommand: function (editorCommand, args) {\r\n                    editorCommand.runCoreEditorCommand(cursor, args);\r\n                },\r\n                paste: function (source, text, pasteOnNewLine, multicursorText, mode) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.Paste, {\r\n                        text: text,\r\n                        pasteOnNewLine: pasteOnNewLine,\r\n                        multicursorText: multicursorText,\r\n                        mode: mode\r\n                    });\r\n                },\r\n                type: function (source, text) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.Type, {\r\n                        text: text\r\n                    });\r\n                },\r\n                replacePreviousChar: function (source, text, replaceCharCnt) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.ReplacePreviousChar, {\r\n                        text: text,\r\n                        replaceCharCnt: replaceCharCnt\r\n                    });\r\n                },\r\n                compositionStart: function (source) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.CompositionStart, {});\r\n                },\r\n                compositionEnd: function (source) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.CompositionEnd, {});\r\n                },\r\n                cut: function (source) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.Cut, {});\r\n                }\r\n            };\r\n        }\r\n        var viewOutgoingEvents = new ViewOutgoingEvents(viewModel);\r\n        viewOutgoingEvents.onDidContentSizeChange = function (e) { return _this._onDidContentSizeChange.fire(e); };\r\n        viewOutgoingEvents.onDidScroll = function (e) { return _this._onDidScrollChange.fire(e); };\r\n        viewOutgoingEvents.onDidGainFocus = function () { return _this._editorTextFocus.setValue(true); };\r\n        viewOutgoingEvents.onDidLoseFocus = function () { return _this._editorTextFocus.setValue(false); };\r\n        viewOutgoingEvents.onContextMenu = function (e) { return _this._onContextMenu.fire(e); };\r\n        viewOutgoingEvents.onMouseDown = function (e) { return _this._onMouseDown.fire(e); };\r\n        viewOutgoingEvents.onMouseUp = function (e) { return _this._onMouseUp.fire(e); };\r\n        viewOutgoingEvents.onMouseDrag = function (e) { return _this._onMouseDrag.fire(e); };\r\n        viewOutgoingEvents.onMouseDrop = function (e) { return _this._onMouseDrop.fire(e); };\r\n        viewOutgoingEvents.onKeyUp = function (e) { return _this._onKeyUp.fire(e); };\r\n        viewOutgoingEvents.onMouseMove = function (e) { return _this._onMouseMove.fire(e); };\r\n        viewOutgoingEvents.onMouseLeave = function (e) { return _this._onMouseLeave.fire(e); };\r\n        viewOutgoingEvents.onMouseWheel = function (e) { return _this._onMouseWheel.fire(e); };\r\n        viewOutgoingEvents.onKeyDown = function (e) { return _this._onKeyDown.fire(e); };\r\n        var view = new View(commandDelegate, this._configuration, this._themeService, viewModel, cursor, viewOutgoingEvents);\r\n        return [view, true];\r\n    };\r\n    CodeEditorWidget.prototype._postDetachModelCleanup = function (detachedModel) {\r\n        if (detachedModel) {\r\n            detachedModel.removeAllDecorationsWithOwnerId(this._id);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype._detachModel = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        var model = this._modelData.model;\r\n        var removeDomNode = this._modelData.hasRealView ? this._modelData.view.domNode.domNode : null;\r\n        this._modelData.dispose();\r\n        this._modelData = null;\r\n        this._domElement.removeAttribute('data-mode-id');\r\n        if (removeDomNode) {\r\n            this._domElement.removeChild(removeDomNode);\r\n        }\r\n        return model;\r\n    };\r\n    CodeEditorWidget.prototype._removeDecorationType = function (key) {\r\n        this._codeEditorService.removeDecorationType(key);\r\n    };\r\n    CodeEditorWidget.prototype.hasModel = function () {\r\n        return (this._modelData !== null);\r\n    };\r\n    CodeEditorWidget = __decorate([\r\n        __param(3, IInstantiationService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, ICommandService),\r\n        __param(6, IContextKeyService),\r\n        __param(7, IThemeService),\r\n        __param(8, INotificationService),\r\n        __param(9, IAccessibilityService)\r\n    ], CodeEditorWidget);\r\n    return CodeEditorWidget;\r\n}(Disposable));\r\nexport { CodeEditorWidget };\r\nvar BooleanEventEmitter = /** @class */ (function (_super) {\r\n    __extends(BooleanEventEmitter, _super);\r\n    function BooleanEventEmitter() {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidChangeToTrue = _this._register(new Emitter());\r\n        _this.onDidChangeToTrue = _this._onDidChangeToTrue.event;\r\n        _this._onDidChangeToFalse = _this._register(new Emitter());\r\n        _this.onDidChangeToFalse = _this._onDidChangeToFalse.event;\r\n        _this._value = 0 /* NotSet */;\r\n        return _this;\r\n    }\r\n    BooleanEventEmitter.prototype.setValue = function (_value) {\r\n        var value = (_value ? 2 /* True */ : 1 /* False */);\r\n        if (this._value === value) {\r\n            return;\r\n        }\r\n        this._value = value;\r\n        if (this._value === 2 /* True */) {\r\n            this._onDidChangeToTrue.fire();\r\n        }\r\n        else if (this._value === 1 /* False */) {\r\n            this._onDidChangeToFalse.fire();\r\n        }\r\n    };\r\n    return BooleanEventEmitter;\r\n}(Disposable));\r\nexport { BooleanEventEmitter };\r\nvar EditorContextKeysManager = /** @class */ (function (_super) {\r\n    __extends(EditorContextKeysManager, _super);\r\n    function EditorContextKeysManager(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        contextKeyService.createKey('editorId', editor.getId());\r\n        _this._editorSimpleInput = EditorContextKeys.editorSimpleInput.bindTo(contextKeyService);\r\n        _this._editorFocus = EditorContextKeys.focus.bindTo(contextKeyService);\r\n        _this._textInputFocus = EditorContextKeys.textInputFocus.bindTo(contextKeyService);\r\n        _this._editorTextFocus = EditorContextKeys.editorTextFocus.bindTo(contextKeyService);\r\n        _this._editorTabMovesFocus = EditorContextKeys.tabMovesFocus.bindTo(contextKeyService);\r\n        _this._editorReadonly = EditorContextKeys.readOnly.bindTo(contextKeyService);\r\n        _this._hasMultipleSelections = EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService);\r\n        _this._hasNonEmptySelection = EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService);\r\n        _this._canUndo = EditorContextKeys.canUndo.bindTo(contextKeyService);\r\n        _this._canRedo = EditorContextKeys.canRedo.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidChangeConfiguration(function () { return _this._updateFromConfig(); }));\r\n        _this._register(_this._editor.onDidChangeCursorSelection(function () { return _this._updateFromSelection(); }));\r\n        _this._register(_this._editor.onDidFocusEditorWidget(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidBlurEditorWidget(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidFocusEditorText(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidBlurEditorText(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidChangeModel(function () { return _this._updateFromModel(); }));\r\n        _this._register(_this._editor.onDidChangeConfiguration(function () { return _this._updateFromModel(); }));\r\n        _this._updateFromConfig();\r\n        _this._updateFromSelection();\r\n        _this._updateFromFocus();\r\n        _this._updateFromModel();\r\n        _this._editorSimpleInput.set(_this._editor.isSimpleWidget);\r\n        return _this;\r\n    }\r\n    EditorContextKeysManager.prototype._updateFromConfig = function () {\r\n        var options = this._editor.getOptions();\r\n        this._editorTabMovesFocus.set(options.get(106 /* tabFocusMode */));\r\n        this._editorReadonly.set(options.get(68 /* readOnly */));\r\n    };\r\n    EditorContextKeysManager.prototype._updateFromSelection = function () {\r\n        var selections = this._editor.getSelections();\r\n        if (!selections) {\r\n            this._hasMultipleSelections.reset();\r\n            this._hasNonEmptySelection.reset();\r\n        }\r\n        else {\r\n            this._hasMultipleSelections.set(selections.length > 1);\r\n            this._hasNonEmptySelection.set(selections.some(function (s) { return !s.isEmpty(); }));\r\n        }\r\n    };\r\n    EditorContextKeysManager.prototype._updateFromFocus = function () {\r\n        this._editorFocus.set(this._editor.hasWidgetFocus() && !this._editor.isSimpleWidget);\r\n        this._editorTextFocus.set(this._editor.hasTextFocus() && !this._editor.isSimpleWidget);\r\n        this._textInputFocus.set(this._editor.hasTextFocus());\r\n    };\r\n    EditorContextKeysManager.prototype._updateFromModel = function () {\r\n        var model = this._editor.getModel();\r\n        this._canUndo.set(Boolean(model && model.canUndo()));\r\n        this._canRedo.set(Boolean(model && model.canRedo()));\r\n    };\r\n    return EditorContextKeysManager;\r\n}(Disposable));\r\nvar EditorModeContext = /** @class */ (function (_super) {\r\n    __extends(EditorModeContext, _super);\r\n    function EditorModeContext(_editor, _contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._contextKeyService = _contextKeyService;\r\n        _this._langId = EditorContextKeys.languageId.bindTo(_contextKeyService);\r\n        _this._hasCompletionItemProvider = EditorContextKeys.hasCompletionItemProvider.bindTo(_contextKeyService);\r\n        _this._hasCodeActionsProvider = EditorContextKeys.hasCodeActionsProvider.bindTo(_contextKeyService);\r\n        _this._hasCodeLensProvider = EditorContextKeys.hasCodeLensProvider.bindTo(_contextKeyService);\r\n        _this._hasDefinitionProvider = EditorContextKeys.hasDefinitionProvider.bindTo(_contextKeyService);\r\n        _this._hasDeclarationProvider = EditorContextKeys.hasDeclarationProvider.bindTo(_contextKeyService);\r\n        _this._hasImplementationProvider = EditorContextKeys.hasImplementationProvider.bindTo(_contextKeyService);\r\n        _this._hasTypeDefinitionProvider = EditorContextKeys.hasTypeDefinitionProvider.bindTo(_contextKeyService);\r\n        _this._hasHoverProvider = EditorContextKeys.hasHoverProvider.bindTo(_contextKeyService);\r\n        _this._hasDocumentHighlightProvider = EditorContextKeys.hasDocumentHighlightProvider.bindTo(_contextKeyService);\r\n        _this._hasDocumentSymbolProvider = EditorContextKeys.hasDocumentSymbolProvider.bindTo(_contextKeyService);\r\n        _this._hasReferenceProvider = EditorContextKeys.hasReferenceProvider.bindTo(_contextKeyService);\r\n        _this._hasRenameProvider = EditorContextKeys.hasRenameProvider.bindTo(_contextKeyService);\r\n        _this._hasSignatureHelpProvider = EditorContextKeys.hasSignatureHelpProvider.bindTo(_contextKeyService);\r\n        _this._hasDocumentFormattingProvider = EditorContextKeys.hasDocumentFormattingProvider.bindTo(_contextKeyService);\r\n        _this._hasDocumentSelectionFormattingProvider = EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\r\n        _this._hasMultipleDocumentFormattingProvider = EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(_contextKeyService);\r\n        _this._hasMultipleDocumentSelectionFormattingProvider = EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(_contextKeyService);\r\n        _this._isInWalkThrough = EditorContextKeys.isInEmbeddedEditor.bindTo(_contextKeyService);\r\n        var update = function () { return _this._update(); };\r\n        // update when model/mode changes\r\n        _this._register(_editor.onDidChangeModel(update));\r\n        _this._register(_editor.onDidChangeModelLanguage(update));\r\n        // update when registries change\r\n        _this._register(modes.CompletionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.CodeActionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.CodeLensProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DefinitionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DeclarationProviderRegistry.onDidChange(update));\r\n        _this._register(modes.ImplementationProviderRegistry.onDidChange(update));\r\n        _this._register(modes.TypeDefinitionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.HoverProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentHighlightProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentSymbolProviderRegistry.onDidChange(update));\r\n        _this._register(modes.ReferenceProviderRegistry.onDidChange(update));\r\n        _this._register(modes.RenameProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentFormattingEditProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentRangeFormattingEditProviderRegistry.onDidChange(update));\r\n        _this._register(modes.SignatureHelpProviderRegistry.onDidChange(update));\r\n        update();\r\n        return _this;\r\n    }\r\n    EditorModeContext.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    EditorModeContext.prototype.reset = function () {\r\n        var _this = this;\r\n        this._contextKeyService.bufferChangeEvents(function () {\r\n            _this._langId.reset();\r\n            _this._hasCompletionItemProvider.reset();\r\n            _this._hasCodeActionsProvider.reset();\r\n            _this._hasCodeLensProvider.reset();\r\n            _this._hasDefinitionProvider.reset();\r\n            _this._hasDeclarationProvider.reset();\r\n            _this._hasImplementationProvider.reset();\r\n            _this._hasTypeDefinitionProvider.reset();\r\n            _this._hasHoverProvider.reset();\r\n            _this._hasDocumentHighlightProvider.reset();\r\n            _this._hasDocumentSymbolProvider.reset();\r\n            _this._hasReferenceProvider.reset();\r\n            _this._hasRenameProvider.reset();\r\n            _this._hasDocumentFormattingProvider.reset();\r\n            _this._hasDocumentSelectionFormattingProvider.reset();\r\n            _this._hasSignatureHelpProvider.reset();\r\n            _this._isInWalkThrough.reset();\r\n        });\r\n    };\r\n    EditorModeContext.prototype._update = function () {\r\n        var _this = this;\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._contextKeyService.bufferChangeEvents(function () {\r\n            _this._langId.set(model.getLanguageIdentifier().language);\r\n            _this._hasCompletionItemProvider.set(modes.CompletionProviderRegistry.has(model));\r\n            _this._hasCodeActionsProvider.set(modes.CodeActionProviderRegistry.has(model));\r\n            _this._hasCodeLensProvider.set(modes.CodeLensProviderRegistry.has(model));\r\n            _this._hasDefinitionProvider.set(modes.DefinitionProviderRegistry.has(model));\r\n            _this._hasDeclarationProvider.set(modes.DeclarationProviderRegistry.has(model));\r\n            _this._hasImplementationProvider.set(modes.ImplementationProviderRegistry.has(model));\r\n            _this._hasTypeDefinitionProvider.set(modes.TypeDefinitionProviderRegistry.has(model));\r\n            _this._hasHoverProvider.set(modes.HoverProviderRegistry.has(model));\r\n            _this._hasDocumentHighlightProvider.set(modes.DocumentHighlightProviderRegistry.has(model));\r\n            _this._hasDocumentSymbolProvider.set(modes.DocumentSymbolProviderRegistry.has(model));\r\n            _this._hasReferenceProvider.set(modes.ReferenceProviderRegistry.has(model));\r\n            _this._hasRenameProvider.set(modes.RenameProviderRegistry.has(model));\r\n            _this._hasSignatureHelpProvider.set(modes.SignatureHelpProviderRegistry.has(model));\r\n            _this._hasDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.has(model) || modes.DocumentRangeFormattingEditProviderRegistry.has(model));\r\n            _this._hasDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.has(model));\r\n            _this._hasMultipleDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.all(model).length + modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\r\n            _this._hasMultipleDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\r\n            _this._isInWalkThrough.set(model.uri.scheme === Schemas.walkThroughSnippet);\r\n        });\r\n    };\r\n    return EditorModeContext;\r\n}(Disposable));\r\nexport { EditorModeContext };\r\nvar CodeEditorWidgetFocusTracker = /** @class */ (function (_super) {\r\n    __extends(CodeEditorWidgetFocusTracker, _super);\r\n    function CodeEditorWidgetFocusTracker(domElement) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onChange = _this._register(new Emitter());\r\n        _this.onChange = _this._onChange.event;\r\n        _this._hasFocus = false;\r\n        _this._domFocusTracker = _this._register(dom.trackFocus(domElement));\r\n        _this._register(_this._domFocusTracker.onDidFocus(function () {\r\n            _this._hasFocus = true;\r\n            _this._onChange.fire(undefined);\r\n        }));\r\n        _this._register(_this._domFocusTracker.onDidBlur(function () {\r\n            _this._hasFocus = false;\r\n            _this._onChange.fire(undefined);\r\n        }));\r\n        return _this;\r\n    }\r\n    CodeEditorWidgetFocusTracker.prototype.hasFocus = function () {\r\n        return this._hasFocus;\r\n    };\r\n    return CodeEditorWidgetFocusTracker;\r\n}(Disposable));\r\nvar squigglyStart = encodeURIComponent(\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='\");\r\nvar squigglyEnd = encodeURIComponent(\"'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>\");\r\nfunction getSquigglySVGData(color) {\r\n    return squigglyStart + encodeURIComponent(color.toString()) + squigglyEnd;\r\n}\r\nvar dotdotdotStart = encodeURIComponent(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"3\\\" width=\\\"12\\\"><g fill=\\\"\");\r\nvar dotdotdotEnd = encodeURIComponent(\"\\\"><circle cx=\\\"1\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"5\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"9\\\" cy=\\\"1\\\" r=\\\"1\\\"/></g></svg>\");\r\nfunction getDotDotDotSVGData(color) {\r\n    return dotdotdotStart + encodeURIComponent(color.toString()) + dotdotdotEnd;\r\n}\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var errorBorderColor = theme.getColor(editorErrorBorder);\r\n    if (errorBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-error\" /* EditorErrorDecoration */ + \" { border-bottom: 4px double \" + errorBorderColor + \"; }\");\r\n    }\r\n    var errorForeground = theme.getColor(editorErrorForeground);\r\n    if (errorForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-error\" /* EditorErrorDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(errorForeground) + \"\\\") repeat-x bottom left; }\");\r\n    }\r\n    var warningBorderColor = theme.getColor(editorWarningBorder);\r\n    if (warningBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-warning\" /* EditorWarningDecoration */ + \" { border-bottom: 4px double \" + warningBorderColor + \"; }\");\r\n    }\r\n    var warningForeground = theme.getColor(editorWarningForeground);\r\n    if (warningForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-warning\" /* EditorWarningDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(warningForeground) + \"\\\") repeat-x bottom left; }\");\r\n    }\r\n    var infoBorderColor = theme.getColor(editorInfoBorder);\r\n    if (infoBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-info\" /* EditorInfoDecoration */ + \" { border-bottom: 4px double \" + infoBorderColor + \"; }\");\r\n    }\r\n    var infoForeground = theme.getColor(editorInfoForeground);\r\n    if (infoForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-info\" /* EditorInfoDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(infoForeground) + \"\\\") repeat-x bottom left; }\");\r\n    }\r\n    var hintBorderColor = theme.getColor(editorHintBorder);\r\n    if (hintBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-hint\" /* EditorHintDecoration */ + \" { border-bottom: 2px dotted \" + hintBorderColor + \"; }\");\r\n    }\r\n    var hintForeground = theme.getColor(editorHintForeground);\r\n    if (hintForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-hint\" /* EditorHintDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getDotDotDotSVGData(hintForeground) + \"\\\") no-repeat bottom left; }\");\r\n    }\r\n    var unnecessaryForeground = theme.getColor(editorUnnecessaryCodeOpacity);\r\n    if (unnecessaryForeground) {\r\n        collector.addRule(\".monaco-editor.showUnused .\" + \"squiggly-inline-unnecessary\" /* EditorUnnecessaryInlineDecoration */ + \" { opacity: \" + unnecessaryForeground.rgba.a + \"; }\");\r\n    }\r\n    var unnecessaryBorder = theme.getColor(editorUnnecessaryCodeBorder);\r\n    if (unnecessaryBorder) {\r\n        collector.addRule(\".monaco-editor.showUnused .\" + \"squiggly-unnecessary\" /* EditorUnnecessaryDecoration */ + \" { border-bottom: 2px dashed \" + unnecessaryBorder + \"; }\");\r\n    }\r\n    var deprecatedForeground = theme.getColor(editorForeground) || 'inherit';\r\n    collector.addRule(\".monaco-editor .\" + \"squiggly-inline-deprecated\" /* EditorDeprecatedInlineDecoration */ + \" { text-decoration: line-through; text-decoration-color: \" + deprecatedForeground + \"}\");\r\n});\r\n"]},"metadata":{},"sourceType":"module"}