{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport * as dom from '../../../base/browser/dom.js';\nimport { Color } from '../../../base/common/color.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { TokenizationRegistry } from '../../common/modes.js';\nimport { TokenTheme, generateTokensCSSForColorMap } from '../../common/modes/supports/tokenization.js';\nimport { hc_black, vs, vs_dark } from '../common/themes.js';\nimport { Registry } from '../../../platform/registry/common/platform.js';\nimport { Extensions } from '../../../platform/theme/common/colorRegistry.js';\nimport { Extensions as ThemingExtensions } from '../../../platform/theme/common/themeService.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nvar VS_THEME_NAME = 'vs';\nvar VS_DARK_THEME_NAME = 'vs-dark';\nvar HC_BLACK_THEME_NAME = 'hc-black';\nvar colorRegistry = Registry.as(Extensions.ColorContribution);\nvar themingRegistry = Registry.as(ThemingExtensions.ThemingContribution);\n\nvar StandaloneTheme =\n/** @class */\nfunction () {\n  function StandaloneTheme(name, standaloneThemeData) {\n    this.themeData = standaloneThemeData;\n    var base = standaloneThemeData.base;\n\n    if (name.length > 0) {\n      this.id = base + ' ' + name;\n      this.themeName = name;\n    } else {\n      this.id = base;\n      this.themeName = base;\n    }\n\n    this.colors = null;\n    this.defaultColors = Object.create(null);\n    this._tokenTheme = null;\n  }\n\n  Object.defineProperty(StandaloneTheme.prototype, \"base\", {\n    get: function () {\n      return this.themeData.base;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StandaloneTheme.prototype.notifyBaseUpdated = function () {\n    if (this.themeData.inherit) {\n      this.colors = null;\n      this._tokenTheme = null;\n    }\n  };\n\n  StandaloneTheme.prototype.getColors = function () {\n    if (!this.colors) {\n      var colors = new Map();\n\n      for (var id in this.themeData.colors) {\n        colors.set(id, Color.fromHex(this.themeData.colors[id]));\n      }\n\n      if (this.themeData.inherit) {\n        var baseData = getBuiltinRules(this.themeData.base);\n\n        for (var id in baseData.colors) {\n          if (!colors.has(id)) {\n            colors.set(id, Color.fromHex(baseData.colors[id]));\n          }\n        }\n      }\n\n      this.colors = colors;\n    }\n\n    return this.colors;\n  };\n\n  StandaloneTheme.prototype.getColor = function (colorId, useDefault) {\n    var color = this.getColors().get(colorId);\n\n    if (color) {\n      return color;\n    }\n\n    if (useDefault !== false) {\n      return this.getDefault(colorId);\n    }\n\n    return undefined;\n  };\n\n  StandaloneTheme.prototype.getDefault = function (colorId) {\n    var color = this.defaultColors[colorId];\n\n    if (color) {\n      return color;\n    }\n\n    color = colorRegistry.resolveDefaultColor(colorId, this);\n    this.defaultColors[colorId] = color;\n    return color;\n  };\n\n  StandaloneTheme.prototype.defines = function (colorId) {\n    return Object.prototype.hasOwnProperty.call(this.getColors(), colorId);\n  };\n\n  Object.defineProperty(StandaloneTheme.prototype, \"type\", {\n    get: function () {\n      switch (this.base) {\n        case VS_THEME_NAME:\n          return 'light';\n\n        case HC_BLACK_THEME_NAME:\n          return 'hc';\n\n        default:\n          return 'dark';\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StandaloneTheme.prototype, \"tokenTheme\", {\n    get: function () {\n      if (!this._tokenTheme) {\n        var rules = [];\n        var encodedTokensColors = [];\n\n        if (this.themeData.inherit) {\n          var baseData = getBuiltinRules(this.themeData.base);\n          rules = baseData.rules;\n\n          if (baseData.encodedTokensColors) {\n            encodedTokensColors = baseData.encodedTokensColors;\n          }\n        }\n\n        rules = rules.concat(this.themeData.rules);\n\n        if (this.themeData.encodedTokensColors) {\n          encodedTokensColors = this.themeData.encodedTokensColors;\n        }\n\n        this._tokenTheme = TokenTheme.createFromRawTokenTheme(rules, encodedTokensColors);\n      }\n\n      return this._tokenTheme;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StandaloneTheme.prototype.getTokenStyleMetadata = function (type, modifiers) {\n    return undefined;\n  };\n\n  return StandaloneTheme;\n}();\n\nfunction isBuiltinTheme(themeName) {\n  return themeName === VS_THEME_NAME || themeName === VS_DARK_THEME_NAME || themeName === HC_BLACK_THEME_NAME;\n}\n\nfunction getBuiltinRules(builtinTheme) {\n  switch (builtinTheme) {\n    case VS_THEME_NAME:\n      return vs;\n\n    case VS_DARK_THEME_NAME:\n      return vs_dark;\n\n    case HC_BLACK_THEME_NAME:\n      return hc_black;\n  }\n}\n\nfunction newBuiltInTheme(builtinTheme) {\n  var themeData = getBuiltinRules(builtinTheme);\n  return new StandaloneTheme(builtinTheme, themeData);\n}\n\nvar StandaloneThemeServiceImpl =\n/** @class */\nfunction (_super) {\n  __extends(StandaloneThemeServiceImpl, _super);\n\n  function StandaloneThemeServiceImpl() {\n    var _this = _super.call(this) || this;\n\n    _this._onThemeChange = _this._register(new Emitter());\n    _this.onThemeChange = _this._onThemeChange.event;\n    _this._environment = Object.create(null);\n    _this._knownThemes = new Map();\n\n    _this._knownThemes.set(VS_THEME_NAME, newBuiltInTheme(VS_THEME_NAME));\n\n    _this._knownThemes.set(VS_DARK_THEME_NAME, newBuiltInTheme(VS_DARK_THEME_NAME));\n\n    _this._knownThemes.set(HC_BLACK_THEME_NAME, newBuiltInTheme(HC_BLACK_THEME_NAME));\n\n    _this._css = '';\n    _this._globalStyleElement = null;\n    _this._styleElements = [];\n\n    _this.setTheme(VS_THEME_NAME);\n\n    return _this;\n  }\n\n  StandaloneThemeServiceImpl.prototype.registerEditorContainer = function (domNode) {\n    if (dom.isInShadowDOM(domNode)) {\n      return this._registerShadowDomContainer(domNode);\n    }\n\n    return this._registerRegularEditorContainer();\n  };\n\n  StandaloneThemeServiceImpl.prototype._registerRegularEditorContainer = function () {\n    if (!this._globalStyleElement) {\n      this._globalStyleElement = dom.createStyleSheet();\n      this._globalStyleElement.className = 'monaco-colors';\n      this._globalStyleElement.innerHTML = this._css;\n\n      this._styleElements.push(this._globalStyleElement);\n    }\n\n    return Disposable.None;\n  };\n\n  StandaloneThemeServiceImpl.prototype._registerShadowDomContainer = function (domNode) {\n    var _this = this;\n\n    var styleElement = dom.createStyleSheet(domNode);\n    styleElement.className = 'monaco-colors';\n    styleElement.innerHTML = this._css;\n\n    this._styleElements.push(styleElement);\n\n    return {\n      dispose: function () {\n        for (var i = 0; i < _this._styleElements.length; i++) {\n          if (_this._styleElements[i] === styleElement) {\n            _this._styleElements.splice(i, 1);\n\n            return;\n          }\n        }\n      }\n    };\n  };\n\n  StandaloneThemeServiceImpl.prototype.defineTheme = function (themeName, themeData) {\n    if (!/^[a-z0-9\\-]+$/i.test(themeName)) {\n      throw new Error('Illegal theme name!');\n    }\n\n    if (!isBuiltinTheme(themeData.base) && !isBuiltinTheme(themeName)) {\n      throw new Error('Illegal theme base!');\n    } // set or replace theme\n\n\n    this._knownThemes.set(themeName, new StandaloneTheme(themeName, themeData));\n\n    if (isBuiltinTheme(themeName)) {\n      this._knownThemes.forEach(function (theme) {\n        if (theme.base === themeName) {\n          theme.notifyBaseUpdated();\n        }\n      });\n    }\n\n    if (this._theme && this._theme.themeName === themeName) {\n      this.setTheme(themeName); // refresh theme\n    }\n  };\n\n  StandaloneThemeServiceImpl.prototype.getTheme = function () {\n    return this._theme;\n  };\n\n  StandaloneThemeServiceImpl.prototype.setTheme = function (themeName) {\n    var _this = this;\n\n    var theme;\n\n    if (this._knownThemes.has(themeName)) {\n      theme = this._knownThemes.get(themeName);\n    } else {\n      theme = this._knownThemes.get(VS_THEME_NAME);\n    }\n\n    if (this._theme === theme) {\n      // Nothing to do\n      return theme.id;\n    }\n\n    this._theme = theme;\n    var cssRules = [];\n    var hasRule = {};\n    var ruleCollector = {\n      addRule: function (rule) {\n        if (!hasRule[rule]) {\n          cssRules.push(rule);\n          hasRule[rule] = true;\n        }\n      }\n    };\n    themingRegistry.getThemingParticipants().forEach(function (p) {\n      return p(theme, ruleCollector, _this._environment);\n    });\n    var tokenTheme = theme.tokenTheme;\n    var colorMap = tokenTheme.getColorMap();\n    ruleCollector.addRule(generateTokensCSSForColorMap(colorMap));\n    this._css = cssRules.join('\\n');\n\n    this._styleElements.forEach(function (styleElement) {\n      return styleElement.innerHTML = _this._css;\n    });\n\n    TokenizationRegistry.setColorMap(colorMap);\n\n    this._onThemeChange.fire(theme);\n\n    return theme.id;\n  };\n\n  StandaloneThemeServiceImpl.prototype.getIconTheme = function () {\n    return {\n      hasFileIcons: false,\n      hasFolderIcons: false,\n      hidesExplorerArrows: false\n    };\n  };\n\n  return StandaloneThemeServiceImpl;\n}(Disposable);\n\nexport { StandaloneThemeServiceImpl };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneThemeServiceImpl.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","dom","Color","Emitter","TokenizationRegistry","TokenTheme","generateTokensCSSForColorMap","hc_black","vs","vs_dark","Registry","Extensions","ThemingExtensions","Disposable","VS_THEME_NAME","VS_DARK_THEME_NAME","HC_BLACK_THEME_NAME","colorRegistry","as","ColorContribution","themingRegistry","ThemingContribution","StandaloneTheme","name","standaloneThemeData","themeData","base","length","id","themeName","colors","defaultColors","_tokenTheme","defineProperty","get","enumerable","configurable","notifyBaseUpdated","inherit","getColors","Map","set","fromHex","baseData","getBuiltinRules","has","getColor","colorId","useDefault","color","getDefault","undefined","resolveDefaultColor","defines","call","rules","encodedTokensColors","concat","createFromRawTokenTheme","getTokenStyleMetadata","type","modifiers","isBuiltinTheme","builtinTheme","newBuiltInTheme","StandaloneThemeServiceImpl","_super","_this","_onThemeChange","_register","onThemeChange","event","_environment","_knownThemes","_css","_globalStyleElement","_styleElements","setTheme","registerEditorContainer","domNode","isInShadowDOM","_registerShadowDomContainer","_registerRegularEditorContainer","createStyleSheet","className","innerHTML","push","None","styleElement","dispose","i","splice","defineTheme","test","Error","forEach","theme","_theme","getTheme","cssRules","hasRule","ruleCollector","addRule","rule","getThemingParticipants","tokenTheme","colorMap","getColorMap","join","setColorMap","fire","getIconTheme","hasFileIcons","hasFolderIcons","hidesExplorerArrows"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\nimport { TokenTheme, generateTokensCSSForColorMap } from '../../common/modes/supports/tokenization.js';\r\nimport { hc_black, vs, vs_dark } from '../common/themes.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\nimport { Extensions } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { Extensions as ThemingExtensions } from '../../../platform/theme/common/themeService.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nvar VS_THEME_NAME = 'vs';\r\nvar VS_DARK_THEME_NAME = 'vs-dark';\r\nvar HC_BLACK_THEME_NAME = 'hc-black';\r\nvar colorRegistry = Registry.as(Extensions.ColorContribution);\r\nvar themingRegistry = Registry.as(ThemingExtensions.ThemingContribution);\r\nvar StandaloneTheme = /** @class */ (function () {\r\n    function StandaloneTheme(name, standaloneThemeData) {\r\n        this.themeData = standaloneThemeData;\r\n        var base = standaloneThemeData.base;\r\n        if (name.length > 0) {\r\n            this.id = base + ' ' + name;\r\n            this.themeName = name;\r\n        }\r\n        else {\r\n            this.id = base;\r\n            this.themeName = base;\r\n        }\r\n        this.colors = null;\r\n        this.defaultColors = Object.create(null);\r\n        this._tokenTheme = null;\r\n    }\r\n    Object.defineProperty(StandaloneTheme.prototype, \"base\", {\r\n        get: function () {\r\n            return this.themeData.base;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    StandaloneTheme.prototype.notifyBaseUpdated = function () {\r\n        if (this.themeData.inherit) {\r\n            this.colors = null;\r\n            this._tokenTheme = null;\r\n        }\r\n    };\r\n    StandaloneTheme.prototype.getColors = function () {\r\n        if (!this.colors) {\r\n            var colors = new Map();\r\n            for (var id in this.themeData.colors) {\r\n                colors.set(id, Color.fromHex(this.themeData.colors[id]));\r\n            }\r\n            if (this.themeData.inherit) {\r\n                var baseData = getBuiltinRules(this.themeData.base);\r\n                for (var id in baseData.colors) {\r\n                    if (!colors.has(id)) {\r\n                        colors.set(id, Color.fromHex(baseData.colors[id]));\r\n                    }\r\n                }\r\n            }\r\n            this.colors = colors;\r\n        }\r\n        return this.colors;\r\n    };\r\n    StandaloneTheme.prototype.getColor = function (colorId, useDefault) {\r\n        var color = this.getColors().get(colorId);\r\n        if (color) {\r\n            return color;\r\n        }\r\n        if (useDefault !== false) {\r\n            return this.getDefault(colorId);\r\n        }\r\n        return undefined;\r\n    };\r\n    StandaloneTheme.prototype.getDefault = function (colorId) {\r\n        var color = this.defaultColors[colorId];\r\n        if (color) {\r\n            return color;\r\n        }\r\n        color = colorRegistry.resolveDefaultColor(colorId, this);\r\n        this.defaultColors[colorId] = color;\r\n        return color;\r\n    };\r\n    StandaloneTheme.prototype.defines = function (colorId) {\r\n        return Object.prototype.hasOwnProperty.call(this.getColors(), colorId);\r\n    };\r\n    Object.defineProperty(StandaloneTheme.prototype, \"type\", {\r\n        get: function () {\r\n            switch (this.base) {\r\n                case VS_THEME_NAME: return 'light';\r\n                case HC_BLACK_THEME_NAME: return 'hc';\r\n                default: return 'dark';\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(StandaloneTheme.prototype, \"tokenTheme\", {\r\n        get: function () {\r\n            if (!this._tokenTheme) {\r\n                var rules = [];\r\n                var encodedTokensColors = [];\r\n                if (this.themeData.inherit) {\r\n                    var baseData = getBuiltinRules(this.themeData.base);\r\n                    rules = baseData.rules;\r\n                    if (baseData.encodedTokensColors) {\r\n                        encodedTokensColors = baseData.encodedTokensColors;\r\n                    }\r\n                }\r\n                rules = rules.concat(this.themeData.rules);\r\n                if (this.themeData.encodedTokensColors) {\r\n                    encodedTokensColors = this.themeData.encodedTokensColors;\r\n                }\r\n                this._tokenTheme = TokenTheme.createFromRawTokenTheme(rules, encodedTokensColors);\r\n            }\r\n            return this._tokenTheme;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    StandaloneTheme.prototype.getTokenStyleMetadata = function (type, modifiers) {\r\n        return undefined;\r\n    };\r\n    return StandaloneTheme;\r\n}());\r\nfunction isBuiltinTheme(themeName) {\r\n    return (themeName === VS_THEME_NAME\r\n        || themeName === VS_DARK_THEME_NAME\r\n        || themeName === HC_BLACK_THEME_NAME);\r\n}\r\nfunction getBuiltinRules(builtinTheme) {\r\n    switch (builtinTheme) {\r\n        case VS_THEME_NAME:\r\n            return vs;\r\n        case VS_DARK_THEME_NAME:\r\n            return vs_dark;\r\n        case HC_BLACK_THEME_NAME:\r\n            return hc_black;\r\n    }\r\n}\r\nfunction newBuiltInTheme(builtinTheme) {\r\n    var themeData = getBuiltinRules(builtinTheme);\r\n    return new StandaloneTheme(builtinTheme, themeData);\r\n}\r\nvar StandaloneThemeServiceImpl = /** @class */ (function (_super) {\r\n    __extends(StandaloneThemeServiceImpl, _super);\r\n    function StandaloneThemeServiceImpl() {\r\n        var _this = _super.call(this) || this;\r\n        _this._onThemeChange = _this._register(new Emitter());\r\n        _this.onThemeChange = _this._onThemeChange.event;\r\n        _this._environment = Object.create(null);\r\n        _this._knownThemes = new Map();\r\n        _this._knownThemes.set(VS_THEME_NAME, newBuiltInTheme(VS_THEME_NAME));\r\n        _this._knownThemes.set(VS_DARK_THEME_NAME, newBuiltInTheme(VS_DARK_THEME_NAME));\r\n        _this._knownThemes.set(HC_BLACK_THEME_NAME, newBuiltInTheme(HC_BLACK_THEME_NAME));\r\n        _this._css = '';\r\n        _this._globalStyleElement = null;\r\n        _this._styleElements = [];\r\n        _this.setTheme(VS_THEME_NAME);\r\n        return _this;\r\n    }\r\n    StandaloneThemeServiceImpl.prototype.registerEditorContainer = function (domNode) {\r\n        if (dom.isInShadowDOM(domNode)) {\r\n            return this._registerShadowDomContainer(domNode);\r\n        }\r\n        return this._registerRegularEditorContainer();\r\n    };\r\n    StandaloneThemeServiceImpl.prototype._registerRegularEditorContainer = function () {\r\n        if (!this._globalStyleElement) {\r\n            this._globalStyleElement = dom.createStyleSheet();\r\n            this._globalStyleElement.className = 'monaco-colors';\r\n            this._globalStyleElement.innerHTML = this._css;\r\n            this._styleElements.push(this._globalStyleElement);\r\n        }\r\n        return Disposable.None;\r\n    };\r\n    StandaloneThemeServiceImpl.prototype._registerShadowDomContainer = function (domNode) {\r\n        var _this = this;\r\n        var styleElement = dom.createStyleSheet(domNode);\r\n        styleElement.className = 'monaco-colors';\r\n        styleElement.innerHTML = this._css;\r\n        this._styleElements.push(styleElement);\r\n        return {\r\n            dispose: function () {\r\n                for (var i = 0; i < _this._styleElements.length; i++) {\r\n                    if (_this._styleElements[i] === styleElement) {\r\n                        _this._styleElements.splice(i, 1);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    };\r\n    StandaloneThemeServiceImpl.prototype.defineTheme = function (themeName, themeData) {\r\n        if (!/^[a-z0-9\\-]+$/i.test(themeName)) {\r\n            throw new Error('Illegal theme name!');\r\n        }\r\n        if (!isBuiltinTheme(themeData.base) && !isBuiltinTheme(themeName)) {\r\n            throw new Error('Illegal theme base!');\r\n        }\r\n        // set or replace theme\r\n        this._knownThemes.set(themeName, new StandaloneTheme(themeName, themeData));\r\n        if (isBuiltinTheme(themeName)) {\r\n            this._knownThemes.forEach(function (theme) {\r\n                if (theme.base === themeName) {\r\n                    theme.notifyBaseUpdated();\r\n                }\r\n            });\r\n        }\r\n        if (this._theme && this._theme.themeName === themeName) {\r\n            this.setTheme(themeName); // refresh theme\r\n        }\r\n    };\r\n    StandaloneThemeServiceImpl.prototype.getTheme = function () {\r\n        return this._theme;\r\n    };\r\n    StandaloneThemeServiceImpl.prototype.setTheme = function (themeName) {\r\n        var _this = this;\r\n        var theme;\r\n        if (this._knownThemes.has(themeName)) {\r\n            theme = this._knownThemes.get(themeName);\r\n        }\r\n        else {\r\n            theme = this._knownThemes.get(VS_THEME_NAME);\r\n        }\r\n        if (this._theme === theme) {\r\n            // Nothing to do\r\n            return theme.id;\r\n        }\r\n        this._theme = theme;\r\n        var cssRules = [];\r\n        var hasRule = {};\r\n        var ruleCollector = {\r\n            addRule: function (rule) {\r\n                if (!hasRule[rule]) {\r\n                    cssRules.push(rule);\r\n                    hasRule[rule] = true;\r\n                }\r\n            }\r\n        };\r\n        themingRegistry.getThemingParticipants().forEach(function (p) { return p(theme, ruleCollector, _this._environment); });\r\n        var tokenTheme = theme.tokenTheme;\r\n        var colorMap = tokenTheme.getColorMap();\r\n        ruleCollector.addRule(generateTokensCSSForColorMap(colorMap));\r\n        this._css = cssRules.join('\\n');\r\n        this._styleElements.forEach(function (styleElement) { return styleElement.innerHTML = _this._css; });\r\n        TokenizationRegistry.setColorMap(colorMap);\r\n        this._onThemeChange.fire(theme);\r\n        return theme.id;\r\n    };\r\n    StandaloneThemeServiceImpl.prototype.getIconTheme = function () {\r\n        return {\r\n            hasFileIcons: false,\r\n            hasFolderIcons: false,\r\n            hidesExplorerArrows: false\r\n        };\r\n    };\r\n    return StandaloneThemeServiceImpl;\r\n}(Disposable));\r\nexport { StandaloneThemeServiceImpl };\r\n"]},"metadata":{},"sourceType":"module"}