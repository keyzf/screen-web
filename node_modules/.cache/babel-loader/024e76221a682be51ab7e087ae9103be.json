{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { EditorWorkerClient } from './editorWorkerServiceImpl.js';\nimport * as types from '../../../base/common/types.js';\n/**\r\n * Create a new web worker that has model syncing capabilities built in.\r\n * Specify an AMD module to load that will `create` an object that will be proxied.\r\n */\n\nexport function createWebWorker(modelService, opts) {\n  return new MonacoWebWorkerImpl(modelService, opts);\n}\n\nvar MonacoWebWorkerImpl =\n/** @class */\nfunction (_super) {\n  __extends(MonacoWebWorkerImpl, _super);\n\n  function MonacoWebWorkerImpl(modelService, opts) {\n    var _this = _super.call(this, modelService, opts.keepIdleModels || false, opts.label) || this;\n\n    _this._foreignModuleId = opts.moduleId;\n    _this._foreignModuleCreateData = opts.createData || null;\n    _this._foreignModuleHost = opts.host || null;\n    _this._foreignProxy = null;\n    return _this;\n  } // foreign host request\n\n\n  MonacoWebWorkerImpl.prototype.fhr = function (method, args) {\n    if (!this._foreignModuleHost || typeof this._foreignModuleHost[method] !== 'function') {\n      return Promise.reject(new Error('Missing method ' + method + ' or missing main thread foreign host.'));\n    }\n\n    try {\n      return Promise.resolve(this._foreignModuleHost[method].apply(this._foreignModuleHost, args));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n\n  MonacoWebWorkerImpl.prototype._getForeignProxy = function () {\n    var _this = this;\n\n    if (!this._foreignProxy) {\n      this._foreignProxy = this._getProxy().then(function (proxy) {\n        var foreignHostMethods = _this._foreignModuleHost ? types.getAllMethodNames(_this._foreignModuleHost) : [];\n        return proxy.loadForeignModule(_this._foreignModuleId, _this._foreignModuleCreateData, foreignHostMethods).then(function (foreignMethods) {\n          _this._foreignModuleCreateData = null;\n\n          var proxyMethodRequest = function (method, args) {\n            return proxy.fmr(method, args);\n          };\n\n          var createProxyMethod = function (method, proxyMethodRequest) {\n            return function () {\n              var args = Array.prototype.slice.call(arguments, 0);\n              return proxyMethodRequest(method, args);\n            };\n          };\n\n          var foreignProxy = {};\n\n          for (var _i = 0, foreignMethods_1 = foreignMethods; _i < foreignMethods_1.length; _i++) {\n            var foreignMethod = foreignMethods_1[_i];\n            foreignProxy[foreignMethod] = createProxyMethod(foreignMethod, proxyMethodRequest);\n          }\n\n          return foreignProxy;\n        });\n      });\n    }\n\n    return this._foreignProxy;\n  };\n\n  MonacoWebWorkerImpl.prototype.getProxy = function () {\n    return this._getForeignProxy();\n  };\n\n  MonacoWebWorkerImpl.prototype.withSyncedResources = function (resources) {\n    var _this = this;\n\n    return this._withSyncedResources(resources).then(function (_) {\n      return _this.getProxy();\n    });\n  };\n\n  return MonacoWebWorkerImpl;\n}(EditorWorkerClient);","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/common/services/webWorker.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","EditorWorkerClient","types","createWebWorker","modelService","opts","MonacoWebWorkerImpl","_super","_this","call","keepIdleModels","label","_foreignModuleId","moduleId","_foreignModuleCreateData","createData","_foreignModuleHost","host","_foreignProxy","fhr","method","args","Promise","reject","Error","resolve","apply","e","_getForeignProxy","_getProxy","then","proxy","foreignHostMethods","getAllMethodNames","loadForeignModule","foreignMethods","proxyMethodRequest","fmr","createProxyMethod","slice","arguments","foreignProxy","_i","foreignMethods_1","length","foreignMethod","getProxy","withSyncedResources","resources","_withSyncedResources","_"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { EditorWorkerClient } from './editorWorkerServiceImpl.js';\r\nimport * as types from '../../../base/common/types.js';\r\n/**\r\n * Create a new web worker that has model syncing capabilities built in.\r\n * Specify an AMD module to load that will `create` an object that will be proxied.\r\n */\r\nexport function createWebWorker(modelService, opts) {\r\n    return new MonacoWebWorkerImpl(modelService, opts);\r\n}\r\nvar MonacoWebWorkerImpl = /** @class */ (function (_super) {\r\n    __extends(MonacoWebWorkerImpl, _super);\r\n    function MonacoWebWorkerImpl(modelService, opts) {\r\n        var _this = _super.call(this, modelService, opts.keepIdleModels || false, opts.label) || this;\r\n        _this._foreignModuleId = opts.moduleId;\r\n        _this._foreignModuleCreateData = opts.createData || null;\r\n        _this._foreignModuleHost = opts.host || null;\r\n        _this._foreignProxy = null;\r\n        return _this;\r\n    }\r\n    // foreign host request\r\n    MonacoWebWorkerImpl.prototype.fhr = function (method, args) {\r\n        if (!this._foreignModuleHost || typeof this._foreignModuleHost[method] !== 'function') {\r\n            return Promise.reject(new Error('Missing method ' + method + ' or missing main thread foreign host.'));\r\n        }\r\n        try {\r\n            return Promise.resolve(this._foreignModuleHost[method].apply(this._foreignModuleHost, args));\r\n        }\r\n        catch (e) {\r\n            return Promise.reject(e);\r\n        }\r\n    };\r\n    MonacoWebWorkerImpl.prototype._getForeignProxy = function () {\r\n        var _this = this;\r\n        if (!this._foreignProxy) {\r\n            this._foreignProxy = this._getProxy().then(function (proxy) {\r\n                var foreignHostMethods = _this._foreignModuleHost ? types.getAllMethodNames(_this._foreignModuleHost) : [];\r\n                return proxy.loadForeignModule(_this._foreignModuleId, _this._foreignModuleCreateData, foreignHostMethods).then(function (foreignMethods) {\r\n                    _this._foreignModuleCreateData = null;\r\n                    var proxyMethodRequest = function (method, args) {\r\n                        return proxy.fmr(method, args);\r\n                    };\r\n                    var createProxyMethod = function (method, proxyMethodRequest) {\r\n                        return function () {\r\n                            var args = Array.prototype.slice.call(arguments, 0);\r\n                            return proxyMethodRequest(method, args);\r\n                        };\r\n                    };\r\n                    var foreignProxy = {};\r\n                    for (var _i = 0, foreignMethods_1 = foreignMethods; _i < foreignMethods_1.length; _i++) {\r\n                        var foreignMethod = foreignMethods_1[_i];\r\n                        foreignProxy[foreignMethod] = createProxyMethod(foreignMethod, proxyMethodRequest);\r\n                    }\r\n                    return foreignProxy;\r\n                });\r\n            });\r\n        }\r\n        return this._foreignProxy;\r\n    };\r\n    MonacoWebWorkerImpl.prototype.getProxy = function () {\r\n        return this._getForeignProxy();\r\n    };\r\n    MonacoWebWorkerImpl.prototype.withSyncedResources = function (resources) {\r\n        var _this = this;\r\n        return this._withSyncedResources(resources).then(function (_) { return _this.getProxy(); });\r\n    };\r\n    return MonacoWebWorkerImpl;\r\n}(EditorWorkerClient));\r\n"]},"metadata":{},"sourceType":"module"}