{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter, Event } from './event.js';\nvar shortcutEvent = Object.freeze(function (callback, context) {\n  var handle = setTimeout(callback.bind(context), 0);\n  return {\n    dispose: function () {\n      clearTimeout(handle);\n    }\n  };\n});\nexport var CancellationToken;\n\n(function (CancellationToken) {\n  function isCancellationToken(thing) {\n    if (thing === CancellationToken.None || thing === CancellationToken.Cancelled) {\n      return true;\n    }\n\n    if (thing instanceof MutableToken) {\n      return true;\n    }\n\n    if (!thing || typeof thing !== 'object') {\n      return false;\n    }\n\n    return typeof thing.isCancellationRequested === 'boolean' && typeof thing.onCancellationRequested === 'function';\n  }\n\n  CancellationToken.isCancellationToken = isCancellationToken;\n  CancellationToken.None = Object.freeze({\n    isCancellationRequested: false,\n    onCancellationRequested: Event.None\n  });\n  CancellationToken.Cancelled = Object.freeze({\n    isCancellationRequested: true,\n    onCancellationRequested: shortcutEvent\n  });\n})(CancellationToken || (CancellationToken = {}));\n\nvar MutableToken =\n/** @class */\nfunction () {\n  function MutableToken() {\n    this._isCancelled = false;\n    this._emitter = null;\n  }\n\n  MutableToken.prototype.cancel = function () {\n    if (!this._isCancelled) {\n      this._isCancelled = true;\n\n      if (this._emitter) {\n        this._emitter.fire(undefined);\n\n        this.dispose();\n      }\n    }\n  };\n\n  Object.defineProperty(MutableToken.prototype, \"isCancellationRequested\", {\n    get: function () {\n      return this._isCancelled;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MutableToken.prototype, \"onCancellationRequested\", {\n    get: function () {\n      if (this._isCancelled) {\n        return shortcutEvent;\n      }\n\n      if (!this._emitter) {\n        this._emitter = new Emitter();\n      }\n\n      return this._emitter.event;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  MutableToken.prototype.dispose = function () {\n    if (this._emitter) {\n      this._emitter.dispose();\n\n      this._emitter = null;\n    }\n  };\n\n  return MutableToken;\n}();\n\nvar CancellationTokenSource =\n/** @class */\nfunction () {\n  function CancellationTokenSource(parent) {\n    this._token = undefined;\n    this._parentListener = undefined;\n    this._parentListener = parent && parent.onCancellationRequested(this.cancel, this);\n  }\n\n  Object.defineProperty(CancellationTokenSource.prototype, \"token\", {\n    get: function () {\n      if (!this._token) {\n        // be lazy and create the token only when\n        // actually needed\n        this._token = new MutableToken();\n      }\n\n      return this._token;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  CancellationTokenSource.prototype.cancel = function () {\n    if (!this._token) {\n      // save an object by returning the default\n      // cancelled token when cancellation happens\n      // before someone asks for the token\n      this._token = CancellationToken.Cancelled;\n    } else if (this._token instanceof MutableToken) {\n      // actually cancel\n      this._token.cancel();\n    }\n  };\n\n  CancellationTokenSource.prototype.dispose = function (cancel) {\n    if (cancel === void 0) {\n      cancel = false;\n    }\n\n    if (cancel) {\n      this.cancel();\n    }\n\n    if (this._parentListener) {\n      this._parentListener.dispose();\n    }\n\n    if (!this._token) {\n      // ensure to initialize with an empty token if we had none\n      this._token = CancellationToken.None;\n    } else if (this._token instanceof MutableToken) {\n      // actually dispose\n      this._token.dispose();\n    }\n  };\n\n  return CancellationTokenSource;\n}();\n\nexport { CancellationTokenSource };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/base/common/cancellation.js"],"names":["Emitter","Event","shortcutEvent","Object","freeze","callback","context","handle","setTimeout","bind","dispose","clearTimeout","CancellationToken","isCancellationToken","thing","None","Cancelled","MutableToken","isCancellationRequested","onCancellationRequested","_isCancelled","_emitter","prototype","cancel","fire","undefined","defineProperty","get","enumerable","configurable","event","CancellationTokenSource","parent","_token","_parentListener"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter, Event } from './event.js';\r\nvar shortcutEvent = Object.freeze(function (callback, context) {\r\n    var handle = setTimeout(callback.bind(context), 0);\r\n    return { dispose: function () { clearTimeout(handle); } };\r\n});\r\nexport var CancellationToken;\r\n(function (CancellationToken) {\r\n    function isCancellationToken(thing) {\r\n        if (thing === CancellationToken.None || thing === CancellationToken.Cancelled) {\r\n            return true;\r\n        }\r\n        if (thing instanceof MutableToken) {\r\n            return true;\r\n        }\r\n        if (!thing || typeof thing !== 'object') {\r\n            return false;\r\n        }\r\n        return typeof thing.isCancellationRequested === 'boolean'\r\n            && typeof thing.onCancellationRequested === 'function';\r\n    }\r\n    CancellationToken.isCancellationToken = isCancellationToken;\r\n    CancellationToken.None = Object.freeze({\r\n        isCancellationRequested: false,\r\n        onCancellationRequested: Event.None\r\n    });\r\n    CancellationToken.Cancelled = Object.freeze({\r\n        isCancellationRequested: true,\r\n        onCancellationRequested: shortcutEvent\r\n    });\r\n})(CancellationToken || (CancellationToken = {}));\r\nvar MutableToken = /** @class */ (function () {\r\n    function MutableToken() {\r\n        this._isCancelled = false;\r\n        this._emitter = null;\r\n    }\r\n    MutableToken.prototype.cancel = function () {\r\n        if (!this._isCancelled) {\r\n            this._isCancelled = true;\r\n            if (this._emitter) {\r\n                this._emitter.fire(undefined);\r\n                this.dispose();\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(MutableToken.prototype, \"isCancellationRequested\", {\r\n        get: function () {\r\n            return this._isCancelled;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MutableToken.prototype, \"onCancellationRequested\", {\r\n        get: function () {\r\n            if (this._isCancelled) {\r\n                return shortcutEvent;\r\n            }\r\n            if (!this._emitter) {\r\n                this._emitter = new Emitter();\r\n            }\r\n            return this._emitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MutableToken.prototype.dispose = function () {\r\n        if (this._emitter) {\r\n            this._emitter.dispose();\r\n            this._emitter = null;\r\n        }\r\n    };\r\n    return MutableToken;\r\n}());\r\nvar CancellationTokenSource = /** @class */ (function () {\r\n    function CancellationTokenSource(parent) {\r\n        this._token = undefined;\r\n        this._parentListener = undefined;\r\n        this._parentListener = parent && parent.onCancellationRequested(this.cancel, this);\r\n    }\r\n    Object.defineProperty(CancellationTokenSource.prototype, \"token\", {\r\n        get: function () {\r\n            if (!this._token) {\r\n                // be lazy and create the token only when\r\n                // actually needed\r\n                this._token = new MutableToken();\r\n            }\r\n            return this._token;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CancellationTokenSource.prototype.cancel = function () {\r\n        if (!this._token) {\r\n            // save an object by returning the default\r\n            // cancelled token when cancellation happens\r\n            // before someone asks for the token\r\n            this._token = CancellationToken.Cancelled;\r\n        }\r\n        else if (this._token instanceof MutableToken) {\r\n            // actually cancel\r\n            this._token.cancel();\r\n        }\r\n    };\r\n    CancellationTokenSource.prototype.dispose = function (cancel) {\r\n        if (cancel === void 0) { cancel = false; }\r\n        if (cancel) {\r\n            this.cancel();\r\n        }\r\n        if (this._parentListener) {\r\n            this._parentListener.dispose();\r\n        }\r\n        if (!this._token) {\r\n            // ensure to initialize with an empty token if we had none\r\n            this._token = CancellationToken.None;\r\n        }\r\n        else if (this._token instanceof MutableToken) {\r\n            // actually dispose\r\n            this._token.dispose();\r\n        }\r\n    };\r\n    return CancellationTokenSource;\r\n}());\r\nexport { CancellationTokenSource };\r\n"]},"metadata":{},"sourceType":"module"}