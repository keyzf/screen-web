{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport './media/gotoErrorWidget.css';\nimport * as nls from '../../../nls.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { MarkerSeverity } from '../../../platform/markers/common/markers.js';\nimport { Range } from '../../common/core/range.js';\nimport { registerColor, oneOf, textLinkForeground, editorErrorForeground, editorErrorBorder, editorWarningForeground, editorWarningBorder, editorInfoForeground, editorInfoBorder } from '../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\nimport { Color } from '../../../base/common/color.js';\nimport { ScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { getBaseLabel, getPathLabel } from '../../../base/common/labels.js';\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { PeekViewWidget, peekViewTitleForeground, peekViewTitleInfoForeground } from '../peekView/peekView.js';\nimport { basename } from '../../../base/common/resources.js';\nimport { SeverityIcon } from '../../../platform/severityIcon/common/severityIcon.js';\n\nvar MessageWidget =\n/** @class */\nfunction () {\n  function MessageWidget(parent, editor, onRelatedInformation, _openerService) {\n    var _this = this;\n\n    this._openerService = _openerService;\n    this._lines = 0;\n    this._longestLineLength = 0;\n    this._relatedDiagnostics = new WeakMap();\n    this._disposables = new DisposableStore();\n    this._editor = editor;\n    var domNode = document.createElement('div');\n    domNode.className = 'descriptioncontainer';\n    domNode.setAttribute('aria-live', 'assertive');\n    domNode.setAttribute('role', 'alert');\n    this._messageBlock = document.createElement('div');\n    dom.addClass(this._messageBlock, 'message');\n    domNode.appendChild(this._messageBlock);\n    this._relatedBlock = document.createElement('div');\n    domNode.appendChild(this._relatedBlock);\n\n    this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', function (event) {\n      event.preventDefault();\n\n      var related = _this._relatedDiagnostics.get(event.target);\n\n      if (related) {\n        onRelatedInformation(related);\n      }\n    }));\n\n    this._scrollable = new ScrollableElement(domNode, {\n      horizontal: 1\n      /* Auto */\n      ,\n      vertical: 1\n      /* Auto */\n      ,\n      useShadows: false,\n      horizontalScrollbarSize: 3,\n      verticalScrollbarSize: 3\n    });\n    parent.appendChild(this._scrollable.getDomNode());\n\n    this._disposables.add(this._scrollable.onScroll(function (e) {\n      domNode.style.left = \"-\" + e.scrollLeft + \"px\";\n      domNode.style.top = \"-\" + e.scrollTop + \"px\";\n    }));\n\n    this._disposables.add(this._scrollable);\n  }\n\n  MessageWidget.prototype.dispose = function () {\n    dispose(this._disposables);\n  };\n\n  MessageWidget.prototype.update = function (_a) {\n    var _this = this;\n\n    var source = _a.source,\n        message = _a.message,\n        relatedInformation = _a.relatedInformation,\n        code = _a.code;\n    var sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n\n    if (code) {\n      if (typeof code === 'string') {\n        sourceAndCodeLength += code.length;\n      } else {\n        sourceAndCodeLength += code.value.length;\n      }\n    }\n\n    var lines = message.split(/\\r\\n|\\r|\\n/g);\n    this._lines = lines.length;\n    this._longestLineLength = 0;\n\n    for (var _i = 0, lines_1 = lines; _i < lines_1.length; _i++) {\n      var line = lines_1[_i];\n      this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n    }\n\n    dom.clearNode(this._messageBlock);\n\n    this._editor.applyFontInfo(this._messageBlock);\n\n    var lastLineElement = this._messageBlock;\n\n    for (var _b = 0, lines_2 = lines; _b < lines_2.length; _b++) {\n      var line = lines_2[_b];\n      lastLineElement = document.createElement('div');\n      lastLineElement.innerText = line;\n\n      if (line === '') {\n        lastLineElement.style.height = this._messageBlock.style.lineHeight;\n      }\n\n      this._messageBlock.appendChild(lastLineElement);\n    }\n\n    if (source || code) {\n      var detailsElement = document.createElement('span');\n      dom.addClass(detailsElement, 'details');\n      lastLineElement.appendChild(detailsElement);\n\n      if (source) {\n        var sourceElement = document.createElement('span');\n        sourceElement.innerText = source;\n        dom.addClass(sourceElement, 'source');\n        detailsElement.appendChild(sourceElement);\n      }\n\n      if (code) {\n        if (typeof code === 'string') {\n          var codeElement = document.createElement('span');\n          codeElement.innerText = \"(\" + code + \")\";\n          dom.addClass(codeElement, 'code');\n          detailsElement.appendChild(codeElement);\n        } else {\n          this._codeLink = dom.$('a.code-link');\n\n          this._codeLink.setAttribute('href', \"\" + code.link.toString());\n\n          this._codeLink.onclick = function (e) {\n            _this._openerService.open(code.link);\n\n            e.preventDefault();\n            e.stopPropagation();\n          };\n\n          var codeElement = dom.append(this._codeLink, dom.$('span'));\n          codeElement.innerText = code.value;\n          detailsElement.appendChild(this._codeLink);\n        }\n      }\n    }\n\n    dom.clearNode(this._relatedBlock);\n\n    this._editor.applyFontInfo(this._relatedBlock);\n\n    if (isNonEmptyArray(relatedInformation)) {\n      var relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n\n      relatedInformationNode.style.paddingTop = Math.floor(this._editor.getOption(49\n      /* lineHeight */\n      ) * 0.66) + \"px\";\n      this._lines += 1;\n\n      for (var _c = 0, relatedInformation_1 = relatedInformation; _c < relatedInformation_1.length; _c++) {\n        var related = relatedInformation_1[_c];\n        var container = document.createElement('div');\n        var relatedResource = document.createElement('a');\n        dom.addClass(relatedResource, 'filename');\n        relatedResource.innerHTML = getBaseLabel(related.resource) + \"(\" + related.startLineNumber + \", \" + related.startColumn + \"): \";\n        relatedResource.title = getPathLabel(related.resource, undefined);\n\n        this._relatedDiagnostics.set(relatedResource, related);\n\n        var relatedMessage = document.createElement('span');\n        relatedMessage.innerText = related.message;\n        container.appendChild(relatedResource);\n        container.appendChild(relatedMessage);\n        this._lines += 1;\n        relatedInformationNode.appendChild(container);\n      }\n    }\n\n    var fontInfo = this._editor.getOption(34\n    /* fontInfo */\n    );\n\n    var scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n    var scrollHeight = fontInfo.lineHeight * this._lines;\n\n    this._scrollable.setScrollDimensions({\n      scrollWidth: scrollWidth,\n      scrollHeight: scrollHeight\n    });\n  };\n\n  MessageWidget.prototype.layout = function (height, width) {\n    this._scrollable.getDomNode().style.height = height + \"px\";\n    this._scrollable.getDomNode().style.width = width + \"px\";\n\n    this._scrollable.setScrollDimensions({\n      width: width,\n      height: height\n    });\n  };\n\n  MessageWidget.prototype.getHeightInLines = function () {\n    return Math.min(17, this._lines);\n  };\n\n  return MessageWidget;\n}();\n\nvar MarkerNavigationWidget =\n/** @class */\nfunction (_super) {\n  __extends(MarkerNavigationWidget, _super);\n\n  function MarkerNavigationWidget(editor, actions, _themeService, _openerService) {\n    var _this = _super.call(this, editor, {\n      showArrow: true,\n      showFrame: true,\n      isAccessible: true\n    }) || this;\n\n    _this.actions = actions;\n    _this._themeService = _themeService;\n    _this._openerService = _openerService;\n    _this._callOnDispose = new DisposableStore();\n    _this._onDidSelectRelatedInformation = new Emitter();\n    _this.onDidSelectRelatedInformation = _this._onDidSelectRelatedInformation.event;\n    _this._severity = MarkerSeverity.Warning;\n    _this._backgroundColor = Color.white;\n\n    _this._applyTheme(_themeService.getTheme());\n\n    _this._callOnDispose.add(_themeService.onThemeChange(_this._applyTheme.bind(_this)));\n\n    _this.create();\n\n    return _this;\n  }\n\n  MarkerNavigationWidget.prototype._applyTheme = function (theme) {\n    this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n    var colorId = editorMarkerNavigationError;\n\n    if (this._severity === MarkerSeverity.Warning) {\n      colorId = editorMarkerNavigationWarning;\n    } else if (this._severity === MarkerSeverity.Info) {\n      colorId = editorMarkerNavigationInfo;\n    }\n\n    var frameColor = theme.getColor(colorId);\n    this.style({\n      arrowColor: frameColor,\n      frameColor: frameColor,\n      headerBackgroundColor: this._backgroundColor,\n      primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n      secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n    }); // style() will trigger _applyStyles\n  };\n\n  MarkerNavigationWidget.prototype._applyStyles = function () {\n    if (this._parentContainer) {\n      this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n    }\n\n    _super.prototype._applyStyles.call(this);\n  };\n\n  MarkerNavigationWidget.prototype.dispose = function () {\n    this._callOnDispose.dispose();\n\n    _super.prototype.dispose.call(this);\n  };\n\n  MarkerNavigationWidget.prototype._fillHead = function (container) {\n    _super.prototype._fillHead.call(this, container);\n\n    this._actionbarWidget.push(this.actions, {\n      label: false,\n      icon: true,\n      index: 0\n    });\n  };\n\n  MarkerNavigationWidget.prototype._fillTitleIcon = function (container) {\n    this._icon = dom.append(container, dom.$(''));\n  };\n\n  MarkerNavigationWidget.prototype._getActionBarOptions = function () {\n    return {\n      orientation: 0\n      /* HORIZONTAL */\n\n    };\n  };\n\n  MarkerNavigationWidget.prototype._fillBody = function (container) {\n    var _this = this;\n\n    this._parentContainer = container;\n    dom.addClass(container, 'marker-widget');\n    this._parentContainer.tabIndex = 0;\n\n    this._parentContainer.setAttribute('role', 'tooltip');\n\n    this._container = document.createElement('div');\n    container.appendChild(this._container);\n    this._message = new MessageWidget(this._container, this.editor, function (related) {\n      return _this._onDidSelectRelatedInformation.fire(related);\n    }, this._openerService);\n\n    this._disposables.add(this._message);\n  };\n\n  MarkerNavigationWidget.prototype.show = function (where, heightInLines) {\n    throw new Error('call showAtMarker');\n  };\n\n  MarkerNavigationWidget.prototype.showAtMarker = function (marker, markerIdx, markerCount) {\n    // update:\n    // * title\n    // * message\n    this._container.classList.remove('stale');\n\n    this._message.update(marker); // update frame color (only applied on 'show')\n\n\n    this._severity = marker.severity;\n\n    this._applyTheme(this._themeService.getTheme()); // show\n\n\n    var range = Range.lift(marker);\n    var editorPosition = this.editor.getPosition();\n    var position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n\n    _super.prototype.show.call(this, position, this.computeRequiredHeight());\n\n    var model = this.editor.getModel();\n\n    if (model) {\n      var detail = markerCount > 1 ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount) : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n      this.setTitle(basename(model.uri), detail);\n    }\n\n    this._icon.className = \"codicon \" + SeverityIcon.className(MarkerSeverity.toSeverity(this._severity));\n    this.editor.revealPositionInCenter(position, 0\n    /* Smooth */\n    );\n    this.editor.focus();\n  };\n\n  MarkerNavigationWidget.prototype.updateMarker = function (marker) {\n    this._container.classList.remove('stale');\n\n    this._message.update(marker);\n  };\n\n  MarkerNavigationWidget.prototype.showStale = function () {\n    this._container.classList.add('stale');\n\n    this._relayout();\n  };\n\n  MarkerNavigationWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\n    _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\n\n    this._heightInPixel = heightInPixel;\n\n    this._message.layout(heightInPixel, widthInPixel);\n\n    this._container.style.height = heightInPixel + \"px\";\n  };\n\n  MarkerNavigationWidget.prototype._onWidth = function (widthInPixel) {\n    this._message.layout(this._heightInPixel, widthInPixel);\n  };\n\n  MarkerNavigationWidget.prototype._relayout = function () {\n    _super.prototype._relayout.call(this, this.computeRequiredHeight());\n  };\n\n  MarkerNavigationWidget.prototype.computeRequiredHeight = function () {\n    return 3 + this._message.getHeightInLines();\n  };\n\n  return MarkerNavigationWidget;\n}(PeekViewWidget);\n\nexport { MarkerNavigationWidget }; // theming\n\nvar errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nvar warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nvar infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nexport var editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', {\n  dark: errorDefault,\n  light: errorDefault,\n  hc: errorDefault\n}, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nexport var editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', {\n  dark: warningDefault,\n  light: warningDefault,\n  hc: warningDefault\n}, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nexport var editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', {\n  dark: infoDefault,\n  light: infoDefault,\n  hc: infoDefault\n}, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nexport var editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', {\n  dark: '#2D2D30',\n  light: Color.white,\n  hc: '#0C141F'\n}, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\nregisterThemingParticipant(function (theme, collector) {\n  var linkFg = theme.getColor(textLinkForeground);\n\n  if (linkFg) {\n    collector.addRule(\".monaco-editor .marker-widget a { color: \" + linkFg + \"; }\");\n    collector.addRule(\".monaco-editor .marker-widget a.code-link span:hover { color: \" + linkFg + \"; }\");\n  }\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoErrorWidget.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","nls","dom","dispose","DisposableStore","MarkerSeverity","Range","registerColor","oneOf","textLinkForeground","editorErrorForeground","editorErrorBorder","editorWarningForeground","editorWarningBorder","editorInfoForeground","editorInfoBorder","registerThemingParticipant","Color","ScrollableElement","getBaseLabel","getPathLabel","isNonEmptyArray","Emitter","PeekViewWidget","peekViewTitleForeground","peekViewTitleInfoForeground","basename","SeverityIcon","MessageWidget","parent","editor","onRelatedInformation","_openerService","_this","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","_disposables","_editor","domNode","document","createElement","className","setAttribute","_messageBlock","addClass","appendChild","_relatedBlock","add","addStandardDisposableListener","event","preventDefault","related","get","target","_scrollable","horizontal","vertical","useShadows","horizontalScrollbarSize","verticalScrollbarSize","getDomNode","onScroll","e","style","left","scrollLeft","top","scrollTop","update","_a","source","message","relatedInformation","code","sourceAndCodeLength","length","value","lines","split","_i","lines_1","line","Math","max","clearNode","applyFontInfo","lastLineElement","_b","lines_2","innerText","height","lineHeight","detailsElement","sourceElement","codeElement","_codeLink","$","link","toString","onclick","open","stopPropagation","append","relatedInformationNode","paddingTop","floor","getOption","_c","relatedInformation_1","container","relatedResource","innerHTML","resource","startLineNumber","startColumn","title","undefined","set","relatedMessage","fontInfo","scrollWidth","ceil","typicalFullwidthCharacterWidth","scrollHeight","setScrollDimensions","layout","width","getHeightInLines","min","MarkerNavigationWidget","_super","actions","_themeService","call","showArrow","showFrame","isAccessible","_callOnDispose","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","Warning","_backgroundColor","white","_applyTheme","getTheme","onThemeChange","bind","theme","getColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","editorMarkerNavigationWarning","Info","editorMarkerNavigationInfo","frameColor","arrowColor","headerBackgroundColor","primaryHeadingColor","secondaryHeadingColor","_applyStyles","_parentContainer","backgroundColor","_fillHead","_actionbarWidget","push","label","icon","index","_fillTitleIcon","_icon","_getActionBarOptions","orientation","_fillBody","tabIndex","_container","_message","fire","show","where","heightInLines","Error","showAtMarker","marker","markerIdx","markerCount","classList","remove","severity","range","lift","editorPosition","getPosition","position","containsPosition","getStartPosition","computeRequiredHeight","model","getModel","detail","localize","setTitle","uri","toSeverity","revealPositionInCenter","focus","updateMarker","showStale","_relayout","_doLayoutBody","heightInPixel","widthInPixel","_heightInPixel","_onWidth","errorDefault","warningDefault","infoDefault","dark","light","hc","collector","linkFg","addRule"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './media/gotoErrorWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerColor, oneOf, textLinkForeground, editorErrorForeground, editorErrorBorder, editorWarningForeground, editorWarningBorder, editorInfoForeground, editorInfoBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { ScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { getBaseLabel, getPathLabel } from '../../../base/common/labels.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { PeekViewWidget, peekViewTitleForeground, peekViewTitleInfoForeground } from '../peekView/peekView.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { SeverityIcon } from '../../../platform/severityIcon/common/severityIcon.js';\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(parent, editor, onRelatedInformation, _openerService) {\r\n        var _this = this;\r\n        this._openerService = _openerService;\r\n        this._lines = 0;\r\n        this._longestLineLength = 0;\r\n        this._relatedDiagnostics = new WeakMap();\r\n        this._disposables = new DisposableStore();\r\n        this._editor = editor;\r\n        var domNode = document.createElement('div');\r\n        domNode.className = 'descriptioncontainer';\r\n        domNode.setAttribute('aria-live', 'assertive');\r\n        domNode.setAttribute('role', 'alert');\r\n        this._messageBlock = document.createElement('div');\r\n        dom.addClass(this._messageBlock, 'message');\r\n        domNode.appendChild(this._messageBlock);\r\n        this._relatedBlock = document.createElement('div');\r\n        domNode.appendChild(this._relatedBlock);\r\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', function (event) {\r\n            event.preventDefault();\r\n            var related = _this._relatedDiagnostics.get(event.target);\r\n            if (related) {\r\n                onRelatedInformation(related);\r\n            }\r\n        }));\r\n        this._scrollable = new ScrollableElement(domNode, {\r\n            horizontal: 1 /* Auto */,\r\n            vertical: 1 /* Auto */,\r\n            useShadows: false,\r\n            horizontalScrollbarSize: 3,\r\n            verticalScrollbarSize: 3\r\n        });\r\n        parent.appendChild(this._scrollable.getDomNode());\r\n        this._disposables.add(this._scrollable.onScroll(function (e) {\r\n            domNode.style.left = \"-\" + e.scrollLeft + \"px\";\r\n            domNode.style.top = \"-\" + e.scrollTop + \"px\";\r\n        }));\r\n        this._disposables.add(this._scrollable);\r\n    }\r\n    MessageWidget.prototype.dispose = function () {\r\n        dispose(this._disposables);\r\n    };\r\n    MessageWidget.prototype.update = function (_a) {\r\n        var _this = this;\r\n        var source = _a.source, message = _a.message, relatedInformation = _a.relatedInformation, code = _a.code;\r\n        var sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\r\n        if (code) {\r\n            if (typeof code === 'string') {\r\n                sourceAndCodeLength += code.length;\r\n            }\r\n            else {\r\n                sourceAndCodeLength += code.value.length;\r\n            }\r\n        }\r\n        var lines = message.split(/\\r\\n|\\r|\\n/g);\r\n        this._lines = lines.length;\r\n        this._longestLineLength = 0;\r\n        for (var _i = 0, lines_1 = lines; _i < lines_1.length; _i++) {\r\n            var line = lines_1[_i];\r\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\r\n        }\r\n        dom.clearNode(this._messageBlock);\r\n        this._editor.applyFontInfo(this._messageBlock);\r\n        var lastLineElement = this._messageBlock;\r\n        for (var _b = 0, lines_2 = lines; _b < lines_2.length; _b++) {\r\n            var line = lines_2[_b];\r\n            lastLineElement = document.createElement('div');\r\n            lastLineElement.innerText = line;\r\n            if (line === '') {\r\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\r\n            }\r\n            this._messageBlock.appendChild(lastLineElement);\r\n        }\r\n        if (source || code) {\r\n            var detailsElement = document.createElement('span');\r\n            dom.addClass(detailsElement, 'details');\r\n            lastLineElement.appendChild(detailsElement);\r\n            if (source) {\r\n                var sourceElement = document.createElement('span');\r\n                sourceElement.innerText = source;\r\n                dom.addClass(sourceElement, 'source');\r\n                detailsElement.appendChild(sourceElement);\r\n            }\r\n            if (code) {\r\n                if (typeof code === 'string') {\r\n                    var codeElement = document.createElement('span');\r\n                    codeElement.innerText = \"(\" + code + \")\";\r\n                    dom.addClass(codeElement, 'code');\r\n                    detailsElement.appendChild(codeElement);\r\n                }\r\n                else {\r\n                    this._codeLink = dom.$('a.code-link');\r\n                    this._codeLink.setAttribute('href', \"\" + code.link.toString());\r\n                    this._codeLink.onclick = function (e) {\r\n                        _this._openerService.open(code.link);\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                    };\r\n                    var codeElement = dom.append(this._codeLink, dom.$('span'));\r\n                    codeElement.innerText = code.value;\r\n                    detailsElement.appendChild(this._codeLink);\r\n                }\r\n            }\r\n        }\r\n        dom.clearNode(this._relatedBlock);\r\n        this._editor.applyFontInfo(this._relatedBlock);\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            var relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\r\n            relatedInformationNode.style.paddingTop = Math.floor(this._editor.getOption(49 /* lineHeight */) * 0.66) + \"px\";\r\n            this._lines += 1;\r\n            for (var _c = 0, relatedInformation_1 = relatedInformation; _c < relatedInformation_1.length; _c++) {\r\n                var related = relatedInformation_1[_c];\r\n                var container = document.createElement('div');\r\n                var relatedResource = document.createElement('a');\r\n                dom.addClass(relatedResource, 'filename');\r\n                relatedResource.innerHTML = getBaseLabel(related.resource) + \"(\" + related.startLineNumber + \", \" + related.startColumn + \"): \";\r\n                relatedResource.title = getPathLabel(related.resource, undefined);\r\n                this._relatedDiagnostics.set(relatedResource, related);\r\n                var relatedMessage = document.createElement('span');\r\n                relatedMessage.innerText = related.message;\r\n                container.appendChild(relatedResource);\r\n                container.appendChild(relatedMessage);\r\n                this._lines += 1;\r\n                relatedInformationNode.appendChild(container);\r\n            }\r\n        }\r\n        var fontInfo = this._editor.getOption(34 /* fontInfo */);\r\n        var scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\r\n        var scrollHeight = fontInfo.lineHeight * this._lines;\r\n        this._scrollable.setScrollDimensions({ scrollWidth: scrollWidth, scrollHeight: scrollHeight });\r\n    };\r\n    MessageWidget.prototype.layout = function (height, width) {\r\n        this._scrollable.getDomNode().style.height = height + \"px\";\r\n        this._scrollable.getDomNode().style.width = width + \"px\";\r\n        this._scrollable.setScrollDimensions({ width: width, height: height });\r\n    };\r\n    MessageWidget.prototype.getHeightInLines = function () {\r\n        return Math.min(17, this._lines);\r\n    };\r\n    return MessageWidget;\r\n}());\r\nvar MarkerNavigationWidget = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationWidget, _super);\r\n    function MarkerNavigationWidget(editor, actions, _themeService, _openerService) {\r\n        var _this = _super.call(this, editor, { showArrow: true, showFrame: true, isAccessible: true }) || this;\r\n        _this.actions = actions;\r\n        _this._themeService = _themeService;\r\n        _this._openerService = _openerService;\r\n        _this._callOnDispose = new DisposableStore();\r\n        _this._onDidSelectRelatedInformation = new Emitter();\r\n        _this.onDidSelectRelatedInformation = _this._onDidSelectRelatedInformation.event;\r\n        _this._severity = MarkerSeverity.Warning;\r\n        _this._backgroundColor = Color.white;\r\n        _this._applyTheme(_themeService.getTheme());\r\n        _this._callOnDispose.add(_themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    MarkerNavigationWidget.prototype._applyTheme = function (theme) {\r\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\r\n        var colorId = editorMarkerNavigationError;\r\n        if (this._severity === MarkerSeverity.Warning) {\r\n            colorId = editorMarkerNavigationWarning;\r\n        }\r\n        else if (this._severity === MarkerSeverity.Info) {\r\n            colorId = editorMarkerNavigationInfo;\r\n        }\r\n        var frameColor = theme.getColor(colorId);\r\n        this.style({\r\n            arrowColor: frameColor,\r\n            frameColor: frameColor,\r\n            headerBackgroundColor: this._backgroundColor,\r\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\r\n        }); // style() will trigger _applyStyles\r\n    };\r\n    MarkerNavigationWidget.prototype._applyStyles = function () {\r\n        if (this._parentContainer) {\r\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\r\n        }\r\n        _super.prototype._applyStyles.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype._fillHead = function (container) {\r\n        _super.prototype._fillHead.call(this, container);\r\n        this._actionbarWidget.push(this.actions, { label: false, icon: true, index: 0 });\r\n    };\r\n    MarkerNavigationWidget.prototype._fillTitleIcon = function (container) {\r\n        this._icon = dom.append(container, dom.$(''));\r\n    };\r\n    MarkerNavigationWidget.prototype._getActionBarOptions = function () {\r\n        return {\r\n            orientation: 0 /* HORIZONTAL */\r\n        };\r\n    };\r\n    MarkerNavigationWidget.prototype._fillBody = function (container) {\r\n        var _this = this;\r\n        this._parentContainer = container;\r\n        dom.addClass(container, 'marker-widget');\r\n        this._parentContainer.tabIndex = 0;\r\n        this._parentContainer.setAttribute('role', 'tooltip');\r\n        this._container = document.createElement('div');\r\n        container.appendChild(this._container);\r\n        this._message = new MessageWidget(this._container, this.editor, function (related) { return _this._onDidSelectRelatedInformation.fire(related); }, this._openerService);\r\n        this._disposables.add(this._message);\r\n    };\r\n    MarkerNavigationWidget.prototype.show = function (where, heightInLines) {\r\n        throw new Error('call showAtMarker');\r\n    };\r\n    MarkerNavigationWidget.prototype.showAtMarker = function (marker, markerIdx, markerCount) {\r\n        // update:\r\n        // * title\r\n        // * message\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n        // update frame color (only applied on 'show')\r\n        this._severity = marker.severity;\r\n        this._applyTheme(this._themeService.getTheme());\r\n        // show\r\n        var range = Range.lift(marker);\r\n        var editorPosition = this.editor.getPosition();\r\n        var position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\r\n        _super.prototype.show.call(this, position, this.computeRequiredHeight());\r\n        var model = this.editor.getModel();\r\n        if (model) {\r\n            var detail = markerCount > 1\r\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\r\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\r\n            this.setTitle(basename(model.uri), detail);\r\n        }\r\n        this._icon.className = \"codicon \" + SeverityIcon.className(MarkerSeverity.toSeverity(this._severity));\r\n        this.editor.revealPositionInCenter(position, 0 /* Smooth */);\r\n        this.editor.focus();\r\n    };\r\n    MarkerNavigationWidget.prototype.updateMarker = function (marker) {\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n    };\r\n    MarkerNavigationWidget.prototype.showStale = function () {\r\n        this._container.classList.add('stale');\r\n        this._relayout();\r\n    };\r\n    MarkerNavigationWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\r\n        this._heightInPixel = heightInPixel;\r\n        this._message.layout(heightInPixel, widthInPixel);\r\n        this._container.style.height = heightInPixel + \"px\";\r\n    };\r\n    MarkerNavigationWidget.prototype._onWidth = function (widthInPixel) {\r\n        this._message.layout(this._heightInPixel, widthInPixel);\r\n    };\r\n    MarkerNavigationWidget.prototype._relayout = function () {\r\n        _super.prototype._relayout.call(this, this.computeRequiredHeight());\r\n    };\r\n    MarkerNavigationWidget.prototype.computeRequiredHeight = function () {\r\n        return 3 + this._message.getHeightInLines();\r\n    };\r\n    return MarkerNavigationWidget;\r\n}(PeekViewWidget));\r\nexport { MarkerNavigationWidget };\r\n// theming\r\nvar errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\r\nvar warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\r\nvar infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\r\nexport var editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hc: errorDefault }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\r\nexport var editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hc: warningDefault }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\r\nexport var editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hc: infoDefault }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\r\nexport var editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: '#2D2D30', light: Color.white, hc: '#0C141F' }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var linkFg = theme.getColor(textLinkForeground);\r\n    if (linkFg) {\r\n        collector.addRule(\".monaco-editor .marker-widget a { color: \" + linkFg + \"; }\");\r\n        collector.addRule(\".monaco-editor .marker-widget a.code-link span:hover { color: \" + linkFg + \"; }\");\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}