{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nexport function values(forEachable) {\n  var result = [];\n  forEachable.forEach(function (value) {\n    return result.push(value);\n  });\n  return result;\n}\nexport function keys(map) {\n  var result = [];\n  map.forEach(function (_value, key) {\n    return result.push(key);\n  });\n  return result;\n}\n\nvar StringIterator =\n/** @class */\nfunction () {\n  function StringIterator() {\n    this._value = '';\n    this._pos = 0;\n  }\n\n  StringIterator.prototype.reset = function (key) {\n    this._value = key;\n    this._pos = 0;\n    return this;\n  };\n\n  StringIterator.prototype.next = function () {\n    this._pos += 1;\n    return this;\n  };\n\n  StringIterator.prototype.hasNext = function () {\n    return this._pos < this._value.length - 1;\n  };\n\n  StringIterator.prototype.cmp = function (a) {\n    var aCode = a.charCodeAt(0);\n\n    var thisCode = this._value.charCodeAt(this._pos);\n\n    return aCode - thisCode;\n  };\n\n  StringIterator.prototype.value = function () {\n    return this._value[this._pos];\n  };\n\n  return StringIterator;\n}();\n\nexport { StringIterator };\n\nvar PathIterator =\n/** @class */\nfunction () {\n  function PathIterator(_splitOnBackslash) {\n    if (_splitOnBackslash === void 0) {\n      _splitOnBackslash = true;\n    }\n\n    this._splitOnBackslash = _splitOnBackslash;\n  }\n\n  PathIterator.prototype.reset = function (key) {\n    this._value = key.replace(/\\\\$|\\/$/, '');\n    this._from = 0;\n    this._to = 0;\n    return this.next();\n  };\n\n  PathIterator.prototype.hasNext = function () {\n    return this._to < this._value.length;\n  };\n\n  PathIterator.prototype.next = function () {\n    // this._data = key.split(/[\\\\/]/).filter(s => !!s);\n    this._from = this._to;\n    var justSeps = true;\n\n    for (; this._to < this._value.length; this._to++) {\n      var ch = this._value.charCodeAt(this._to);\n\n      if (ch === 47\n      /* Slash */\n      || this._splitOnBackslash && ch === 92\n      /* Backslash */\n      ) {\n          if (justSeps) {\n            this._from++;\n          } else {\n            break;\n          }\n        } else {\n        justSeps = false;\n      }\n    }\n\n    return this;\n  };\n\n  PathIterator.prototype.cmp = function (a) {\n    var aPos = 0;\n    var aLen = a.length;\n    var thisPos = this._from;\n\n    while (aPos < aLen && thisPos < this._to) {\n      var cmp = a.charCodeAt(aPos) - this._value.charCodeAt(thisPos);\n\n      if (cmp !== 0) {\n        return cmp;\n      }\n\n      aPos += 1;\n      thisPos += 1;\n    }\n\n    if (aLen === this._to - this._from) {\n      return 0;\n    } else if (aPos < aLen) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  PathIterator.prototype.value = function () {\n    return this._value.substring(this._from, this._to);\n  };\n\n  return PathIterator;\n}();\n\nexport { PathIterator };\n\nvar TernarySearchTreeNode =\n/** @class */\nfunction () {\n  function TernarySearchTreeNode() {}\n\n  return TernarySearchTreeNode;\n}();\n\nvar TernarySearchTree =\n/** @class */\nfunction () {\n  function TernarySearchTree(segments) {\n    this._iter = segments;\n  }\n\n  TernarySearchTree.forPaths = function () {\n    return new TernarySearchTree(new PathIterator());\n  };\n\n  TernarySearchTree.forStrings = function () {\n    return new TernarySearchTree(new StringIterator());\n  };\n\n  TernarySearchTree.prototype.clear = function () {\n    this._root = undefined;\n  };\n\n  TernarySearchTree.prototype.set = function (key, element) {\n    var iter = this._iter.reset(key);\n\n    var node;\n\n    if (!this._root) {\n      this._root = new TernarySearchTreeNode();\n      this._root.segment = iter.value();\n    }\n\n    node = this._root;\n\n    while (true) {\n      var val = iter.cmp(node.segment);\n\n      if (val > 0) {\n        // left\n        if (!node.left) {\n          node.left = new TernarySearchTreeNode();\n          node.left.segment = iter.value();\n        }\n\n        node = node.left;\n      } else if (val < 0) {\n        // right\n        if (!node.right) {\n          node.right = new TernarySearchTreeNode();\n          node.right.segment = iter.value();\n        }\n\n        node = node.right;\n      } else if (iter.hasNext()) {\n        // mid\n        iter.next();\n\n        if (!node.mid) {\n          node.mid = new TernarySearchTreeNode();\n          node.mid.segment = iter.value();\n        }\n\n        node = node.mid;\n      } else {\n        break;\n      }\n    }\n\n    var oldElement = node.value;\n    node.value = element;\n    node.key = key;\n    return oldElement;\n  };\n\n  TernarySearchTree.prototype.get = function (key) {\n    var iter = this._iter.reset(key);\n\n    var node = this._root;\n\n    while (node) {\n      var val = iter.cmp(node.segment);\n\n      if (val > 0) {\n        // left\n        node = node.left;\n      } else if (val < 0) {\n        // right\n        node = node.right;\n      } else if (iter.hasNext()) {\n        // mid\n        iter.next();\n        node = node.mid;\n      } else {\n        break;\n      }\n    }\n\n    return node ? node.value : undefined;\n  };\n\n  TernarySearchTree.prototype.findSubstr = function (key) {\n    var iter = this._iter.reset(key);\n\n    var node = this._root;\n    var candidate = undefined;\n\n    while (node) {\n      var val = iter.cmp(node.segment);\n\n      if (val > 0) {\n        // left\n        node = node.left;\n      } else if (val < 0) {\n        // right\n        node = node.right;\n      } else if (iter.hasNext()) {\n        // mid\n        iter.next();\n        candidate = node.value || candidate;\n        node = node.mid;\n      } else {\n        break;\n      }\n    }\n\n    return node && node.value || candidate;\n  };\n\n  TernarySearchTree.prototype.forEach = function (callback) {\n    this._forEach(this._root, callback);\n  };\n\n  TernarySearchTree.prototype._forEach = function (node, callback) {\n    if (node) {\n      // left\n      this._forEach(node.left, callback); // node\n\n\n      if (node.value) {\n        // callback(node.value, this._iter.join(parts));\n        callback(node.value, node.key);\n      } // mid\n\n\n      this._forEach(node.mid, callback); // right\n\n\n      this._forEach(node.right, callback);\n    }\n  };\n\n  return TernarySearchTree;\n}();\n\nexport { TernarySearchTree };\n\nvar ResourceMap =\n/** @class */\nfunction () {\n  function ResourceMap() {\n    this.map = new Map();\n    this.ignoreCase = false; // in the future this should be an uri-comparator\n  }\n\n  ResourceMap.prototype.set = function (resource, value) {\n    this.map.set(this.toKey(resource), value);\n  };\n\n  ResourceMap.prototype.get = function (resource) {\n    return this.map.get(this.toKey(resource));\n  };\n\n  ResourceMap.prototype.toKey = function (resource) {\n    var key = resource.toString();\n\n    if (this.ignoreCase) {\n      key = key.toLowerCase();\n    }\n\n    return key;\n  };\n\n  return ResourceMap;\n}();\n\nexport { ResourceMap };\n\nvar LinkedMap =\n/** @class */\nfunction () {\n  function LinkedMap() {\n    this._map = new Map();\n    this._head = undefined;\n    this._tail = undefined;\n    this._size = 0;\n  }\n\n  LinkedMap.prototype.clear = function () {\n    this._map.clear();\n\n    this._head = undefined;\n    this._tail = undefined;\n    this._size = 0;\n  };\n\n  Object.defineProperty(LinkedMap.prototype, \"size\", {\n    get: function () {\n      return this._size;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  LinkedMap.prototype.get = function (key, touch) {\n    if (touch === void 0) {\n      touch = 0\n      /* None */\n      ;\n    }\n\n    var item = this._map.get(key);\n\n    if (!item) {\n      return undefined;\n    }\n\n    if (touch !== 0\n    /* None */\n    ) {\n        this.touch(item, touch);\n      }\n\n    return item.value;\n  };\n\n  LinkedMap.prototype.set = function (key, value, touch) {\n    if (touch === void 0) {\n      touch = 0\n      /* None */\n      ;\n    }\n\n    var item = this._map.get(key);\n\n    if (item) {\n      item.value = value;\n\n      if (touch !== 0\n      /* None */\n      ) {\n          this.touch(item, touch);\n        }\n    } else {\n      item = {\n        key: key,\n        value: value,\n        next: undefined,\n        previous: undefined\n      };\n\n      switch (touch) {\n        case 0\n        /* None */\n        :\n          this.addItemLast(item);\n          break;\n\n        case 1\n        /* AsOld */\n        :\n          this.addItemFirst(item);\n          break;\n\n        case 2\n        /* AsNew */\n        :\n          this.addItemLast(item);\n          break;\n\n        default:\n          this.addItemLast(item);\n          break;\n      }\n\n      this._map.set(key, item);\n\n      this._size++;\n    }\n  };\n\n  LinkedMap.prototype.delete = function (key) {\n    return !!this.remove(key);\n  };\n\n  LinkedMap.prototype.remove = function (key) {\n    var item = this._map.get(key);\n\n    if (!item) {\n      return undefined;\n    }\n\n    this._map.delete(key);\n\n    this.removeItem(item);\n    this._size--;\n    return item.value;\n  };\n\n  LinkedMap.prototype.forEach = function (callbackfn, thisArg) {\n    var current = this._head;\n\n    while (current) {\n      if (thisArg) {\n        callbackfn.bind(thisArg)(current.value, current.key, this);\n      } else {\n        callbackfn(current.value, current.key, this);\n      }\n\n      current = current.next;\n    }\n  };\n  /* VS Code / Monaco editor runs on es5 which has no Symbol.iterator\r\n  keys(): IterableIterator<K> {\r\n      const current = this._head;\r\n      const iterator: IterableIterator<K> = {\r\n          [Symbol.iterator]() {\r\n              return iterator;\r\n          },\r\n          next():IteratorResult<K> {\r\n              if (current) {\r\n                  const result = { value: current.key, done: false };\r\n                  current = current.next;\r\n                  return result;\r\n              } else {\r\n                  return { value: undefined, done: true };\r\n              }\r\n          }\r\n      };\r\n      return iterator;\r\n  }\r\n    values(): IterableIterator<V> {\r\n      const current = this._head;\r\n      const iterator: IterableIterator<V> = {\r\n          [Symbol.iterator]() {\r\n              return iterator;\r\n          },\r\n          next():IteratorResult<V> {\r\n              if (current) {\r\n                  const result = { value: current.value, done: false };\r\n                  current = current.next;\r\n                  return result;\r\n              } else {\r\n                  return { value: undefined, done: true };\r\n              }\r\n          }\r\n      };\r\n      return iterator;\r\n  }\r\n  */\n\n\n  LinkedMap.prototype.trimOld = function (newSize) {\n    if (newSize >= this.size) {\n      return;\n    }\n\n    if (newSize === 0) {\n      this.clear();\n      return;\n    }\n\n    var current = this._head;\n    var currentSize = this.size;\n\n    while (current && currentSize > newSize) {\n      this._map.delete(current.key);\n\n      current = current.next;\n      currentSize--;\n    }\n\n    this._head = current;\n    this._size = currentSize;\n\n    if (current) {\n      current.previous = undefined;\n    }\n  };\n\n  LinkedMap.prototype.addItemFirst = function (item) {\n    // First time Insert\n    if (!this._head && !this._tail) {\n      this._tail = item;\n    } else if (!this._head) {\n      throw new Error('Invalid list');\n    } else {\n      item.next = this._head;\n      this._head.previous = item;\n    }\n\n    this._head = item;\n  };\n\n  LinkedMap.prototype.addItemLast = function (item) {\n    // First time Insert\n    if (!this._head && !this._tail) {\n      this._head = item;\n    } else if (!this._tail) {\n      throw new Error('Invalid list');\n    } else {\n      item.previous = this._tail;\n      this._tail.next = item;\n    }\n\n    this._tail = item;\n  };\n\n  LinkedMap.prototype.removeItem = function (item) {\n    if (item === this._head && item === this._tail) {\n      this._head = undefined;\n      this._tail = undefined;\n    } else if (item === this._head) {\n      // This can only happend if size === 1 which is handle\n      // by the case above.\n      if (!item.next) {\n        throw new Error('Invalid list');\n      }\n\n      item.next.previous = undefined;\n      this._head = item.next;\n    } else if (item === this._tail) {\n      // This can only happend if size === 1 which is handle\n      // by the case above.\n      if (!item.previous) {\n        throw new Error('Invalid list');\n      }\n\n      item.previous.next = undefined;\n      this._tail = item.previous;\n    } else {\n      var next = item.next;\n      var previous = item.previous;\n\n      if (!next || !previous) {\n        throw new Error('Invalid list');\n      }\n\n      next.previous = previous;\n      previous.next = next;\n    }\n\n    item.next = undefined;\n    item.previous = undefined;\n  };\n\n  LinkedMap.prototype.touch = function (item, touch) {\n    if (!this._head || !this._tail) {\n      throw new Error('Invalid list');\n    }\n\n    if (touch !== 1\n    /* AsOld */\n    && touch !== 2\n    /* AsNew */\n    ) {\n        return;\n      }\n\n    if (touch === 1\n    /* AsOld */\n    ) {\n        if (item === this._head) {\n          return;\n        }\n\n        var next = item.next;\n        var previous = item.previous; // Unlink the item\n\n        if (item === this._tail) {\n          // previous must be defined since item was not head but is tail\n          // So there are more than on item in the map\n          previous.next = undefined;\n          this._tail = previous;\n        } else {\n          // Both next and previous are not undefined since item was neither head nor tail.\n          next.previous = previous;\n          previous.next = next;\n        } // Insert the node at head\n\n\n        item.previous = undefined;\n        item.next = this._head;\n        this._head.previous = item;\n        this._head = item;\n      } else if (touch === 2\n    /* AsNew */\n    ) {\n        if (item === this._tail) {\n          return;\n        }\n\n        var next = item.next;\n        var previous = item.previous; // Unlink the item.\n\n        if (item === this._head) {\n          // next must be defined since item was not tail but is head\n          // So there are more than on item in the map\n          next.previous = undefined;\n          this._head = next;\n        } else {\n          // Both next and previous are not undefined since item was neither head nor tail.\n          next.previous = previous;\n          previous.next = next;\n        }\n\n        item.next = undefined;\n        item.previous = this._tail;\n        this._tail.next = item;\n        this._tail = item;\n      }\n  };\n\n  LinkedMap.prototype.toJSON = function () {\n    var data = [];\n    this.forEach(function (value, key) {\n      data.push([key, value]);\n    });\n    return data;\n  };\n\n  return LinkedMap;\n}();\n\nexport { LinkedMap };\n\nvar LRUCache =\n/** @class */\nfunction (_super) {\n  __extends(LRUCache, _super);\n\n  function LRUCache(limit, ratio) {\n    if (ratio === void 0) {\n      ratio = 1;\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this._limit = limit;\n    _this._ratio = Math.min(Math.max(0, ratio), 1);\n    return _this;\n  }\n\n  LRUCache.prototype.get = function (key) {\n    return _super.prototype.get.call(this, key, 2\n    /* AsNew */\n    );\n  };\n\n  LRUCache.prototype.peek = function (key) {\n    return _super.prototype.get.call(this, key, 0\n    /* None */\n    );\n  };\n\n  LRUCache.prototype.set = function (key, value) {\n    _super.prototype.set.call(this, key, value, 2\n    /* AsNew */\n    );\n\n    this.checkTrim();\n  };\n\n  LRUCache.prototype.checkTrim = function () {\n    if (this.size > this._limit) {\n      this.trimOld(Math.round(this._limit * this._ratio));\n    }\n  };\n\n  return LRUCache;\n}(LinkedMap);\n\nexport { LRUCache };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/base/common/map.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","values","forEachable","result","forEach","value","push","keys","map","_value","key","StringIterator","_pos","reset","next","hasNext","length","cmp","a","aCode","charCodeAt","thisCode","PathIterator","_splitOnBackslash","replace","_from","_to","justSeps","ch","aPos","aLen","thisPos","substring","TernarySearchTreeNode","TernarySearchTree","segments","_iter","forPaths","forStrings","clear","_root","undefined","set","element","iter","node","segment","val","left","right","mid","oldElement","get","findSubstr","candidate","callback","_forEach","ResourceMap","Map","ignoreCase","resource","toKey","toString","toLowerCase","LinkedMap","_map","_head","_tail","_size","defineProperty","enumerable","configurable","touch","item","previous","addItemLast","addItemFirst","delete","remove","removeItem","callbackfn","thisArg","current","bind","trimOld","newSize","size","currentSize","Error","toJSON","data","LRUCache","_super","limit","ratio","_this","call","_limit","_ratio","Math","min","max","peek","checkTrim","round"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nexport function values(forEachable) {\r\n    var result = [];\r\n    forEachable.forEach(function (value) { return result.push(value); });\r\n    return result;\r\n}\r\nexport function keys(map) {\r\n    var result = [];\r\n    map.forEach(function (_value, key) { return result.push(key); });\r\n    return result;\r\n}\r\nvar StringIterator = /** @class */ (function () {\r\n    function StringIterator() {\r\n        this._value = '';\r\n        this._pos = 0;\r\n    }\r\n    StringIterator.prototype.reset = function (key) {\r\n        this._value = key;\r\n        this._pos = 0;\r\n        return this;\r\n    };\r\n    StringIterator.prototype.next = function () {\r\n        this._pos += 1;\r\n        return this;\r\n    };\r\n    StringIterator.prototype.hasNext = function () {\r\n        return this._pos < this._value.length - 1;\r\n    };\r\n    StringIterator.prototype.cmp = function (a) {\r\n        var aCode = a.charCodeAt(0);\r\n        var thisCode = this._value.charCodeAt(this._pos);\r\n        return aCode - thisCode;\r\n    };\r\n    StringIterator.prototype.value = function () {\r\n        return this._value[this._pos];\r\n    };\r\n    return StringIterator;\r\n}());\r\nexport { StringIterator };\r\nvar PathIterator = /** @class */ (function () {\r\n    function PathIterator(_splitOnBackslash) {\r\n        if (_splitOnBackslash === void 0) { _splitOnBackslash = true; }\r\n        this._splitOnBackslash = _splitOnBackslash;\r\n    }\r\n    PathIterator.prototype.reset = function (key) {\r\n        this._value = key.replace(/\\\\$|\\/$/, '');\r\n        this._from = 0;\r\n        this._to = 0;\r\n        return this.next();\r\n    };\r\n    PathIterator.prototype.hasNext = function () {\r\n        return this._to < this._value.length;\r\n    };\r\n    PathIterator.prototype.next = function () {\r\n        // this._data = key.split(/[\\\\/]/).filter(s => !!s);\r\n        this._from = this._to;\r\n        var justSeps = true;\r\n        for (; this._to < this._value.length; this._to++) {\r\n            var ch = this._value.charCodeAt(this._to);\r\n            if (ch === 47 /* Slash */ || this._splitOnBackslash && ch === 92 /* Backslash */) {\r\n                if (justSeps) {\r\n                    this._from++;\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n            else {\r\n                justSeps = false;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    PathIterator.prototype.cmp = function (a) {\r\n        var aPos = 0;\r\n        var aLen = a.length;\r\n        var thisPos = this._from;\r\n        while (aPos < aLen && thisPos < this._to) {\r\n            var cmp = a.charCodeAt(aPos) - this._value.charCodeAt(thisPos);\r\n            if (cmp !== 0) {\r\n                return cmp;\r\n            }\r\n            aPos += 1;\r\n            thisPos += 1;\r\n        }\r\n        if (aLen === this._to - this._from) {\r\n            return 0;\r\n        }\r\n        else if (aPos < aLen) {\r\n            return -1;\r\n        }\r\n        else {\r\n            return 1;\r\n        }\r\n    };\r\n    PathIterator.prototype.value = function () {\r\n        return this._value.substring(this._from, this._to);\r\n    };\r\n    return PathIterator;\r\n}());\r\nexport { PathIterator };\r\nvar TernarySearchTreeNode = /** @class */ (function () {\r\n    function TernarySearchTreeNode() {\r\n    }\r\n    return TernarySearchTreeNode;\r\n}());\r\nvar TernarySearchTree = /** @class */ (function () {\r\n    function TernarySearchTree(segments) {\r\n        this._iter = segments;\r\n    }\r\n    TernarySearchTree.forPaths = function () {\r\n        return new TernarySearchTree(new PathIterator());\r\n    };\r\n    TernarySearchTree.forStrings = function () {\r\n        return new TernarySearchTree(new StringIterator());\r\n    };\r\n    TernarySearchTree.prototype.clear = function () {\r\n        this._root = undefined;\r\n    };\r\n    TernarySearchTree.prototype.set = function (key, element) {\r\n        var iter = this._iter.reset(key);\r\n        var node;\r\n        if (!this._root) {\r\n            this._root = new TernarySearchTreeNode();\r\n            this._root.segment = iter.value();\r\n        }\r\n        node = this._root;\r\n        while (true) {\r\n            var val = iter.cmp(node.segment);\r\n            if (val > 0) {\r\n                // left\r\n                if (!node.left) {\r\n                    node.left = new TernarySearchTreeNode();\r\n                    node.left.segment = iter.value();\r\n                }\r\n                node = node.left;\r\n            }\r\n            else if (val < 0) {\r\n                // right\r\n                if (!node.right) {\r\n                    node.right = new TernarySearchTreeNode();\r\n                    node.right.segment = iter.value();\r\n                }\r\n                node = node.right;\r\n            }\r\n            else if (iter.hasNext()) {\r\n                // mid\r\n                iter.next();\r\n                if (!node.mid) {\r\n                    node.mid = new TernarySearchTreeNode();\r\n                    node.mid.segment = iter.value();\r\n                }\r\n                node = node.mid;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        var oldElement = node.value;\r\n        node.value = element;\r\n        node.key = key;\r\n        return oldElement;\r\n    };\r\n    TernarySearchTree.prototype.get = function (key) {\r\n        var iter = this._iter.reset(key);\r\n        var node = this._root;\r\n        while (node) {\r\n            var val = iter.cmp(node.segment);\r\n            if (val > 0) {\r\n                // left\r\n                node = node.left;\r\n            }\r\n            else if (val < 0) {\r\n                // right\r\n                node = node.right;\r\n            }\r\n            else if (iter.hasNext()) {\r\n                // mid\r\n                iter.next();\r\n                node = node.mid;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return node ? node.value : undefined;\r\n    };\r\n    TernarySearchTree.prototype.findSubstr = function (key) {\r\n        var iter = this._iter.reset(key);\r\n        var node = this._root;\r\n        var candidate = undefined;\r\n        while (node) {\r\n            var val = iter.cmp(node.segment);\r\n            if (val > 0) {\r\n                // left\r\n                node = node.left;\r\n            }\r\n            else if (val < 0) {\r\n                // right\r\n                node = node.right;\r\n            }\r\n            else if (iter.hasNext()) {\r\n                // mid\r\n                iter.next();\r\n                candidate = node.value || candidate;\r\n                node = node.mid;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return node && node.value || candidate;\r\n    };\r\n    TernarySearchTree.prototype.forEach = function (callback) {\r\n        this._forEach(this._root, callback);\r\n    };\r\n    TernarySearchTree.prototype._forEach = function (node, callback) {\r\n        if (node) {\r\n            // left\r\n            this._forEach(node.left, callback);\r\n            // node\r\n            if (node.value) {\r\n                // callback(node.value, this._iter.join(parts));\r\n                callback(node.value, node.key);\r\n            }\r\n            // mid\r\n            this._forEach(node.mid, callback);\r\n            // right\r\n            this._forEach(node.right, callback);\r\n        }\r\n    };\r\n    return TernarySearchTree;\r\n}());\r\nexport { TernarySearchTree };\r\nvar ResourceMap = /** @class */ (function () {\r\n    function ResourceMap() {\r\n        this.map = new Map();\r\n        this.ignoreCase = false; // in the future this should be an uri-comparator\r\n    }\r\n    ResourceMap.prototype.set = function (resource, value) {\r\n        this.map.set(this.toKey(resource), value);\r\n    };\r\n    ResourceMap.prototype.get = function (resource) {\r\n        return this.map.get(this.toKey(resource));\r\n    };\r\n    ResourceMap.prototype.toKey = function (resource) {\r\n        var key = resource.toString();\r\n        if (this.ignoreCase) {\r\n            key = key.toLowerCase();\r\n        }\r\n        return key;\r\n    };\r\n    return ResourceMap;\r\n}());\r\nexport { ResourceMap };\r\nvar LinkedMap = /** @class */ (function () {\r\n    function LinkedMap() {\r\n        this._map = new Map();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    LinkedMap.prototype.clear = function () {\r\n        this._map.clear();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    };\r\n    Object.defineProperty(LinkedMap.prototype, \"size\", {\r\n        get: function () {\r\n            return this._size;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LinkedMap.prototype.get = function (key, touch) {\r\n        if (touch === void 0) { touch = 0 /* None */; }\r\n        var item = this._map.get(key);\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        if (touch !== 0 /* None */) {\r\n            this.touch(item, touch);\r\n        }\r\n        return item.value;\r\n    };\r\n    LinkedMap.prototype.set = function (key, value, touch) {\r\n        if (touch === void 0) { touch = 0 /* None */; }\r\n        var item = this._map.get(key);\r\n        if (item) {\r\n            item.value = value;\r\n            if (touch !== 0 /* None */) {\r\n                this.touch(item, touch);\r\n            }\r\n        }\r\n        else {\r\n            item = { key: key, value: value, next: undefined, previous: undefined };\r\n            switch (touch) {\r\n                case 0 /* None */:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                case 1 /* AsOld */:\r\n                    this.addItemFirst(item);\r\n                    break;\r\n                case 2 /* AsNew */:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                default:\r\n                    this.addItemLast(item);\r\n                    break;\r\n            }\r\n            this._map.set(key, item);\r\n            this._size++;\r\n        }\r\n    };\r\n    LinkedMap.prototype.delete = function (key) {\r\n        return !!this.remove(key);\r\n    };\r\n    LinkedMap.prototype.remove = function (key) {\r\n        var item = this._map.get(key);\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        this._map.delete(key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return item.value;\r\n    };\r\n    LinkedMap.prototype.forEach = function (callbackfn, thisArg) {\r\n        var current = this._head;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.next;\r\n        }\r\n    };\r\n    /* VS Code / Monaco editor runs on es5 which has no Symbol.iterator\r\n    keys(): IterableIterator<K> {\r\n        const current = this._head;\r\n        const iterator: IterableIterator<K> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<K> {\r\n                if (current) {\r\n                    const result = { value: current.key, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n\r\n    values(): IterableIterator<V> {\r\n        const current = this._head;\r\n        const iterator: IterableIterator<V> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<V> {\r\n                if (current) {\r\n                    const result = { value: current.value, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n    */\r\n    LinkedMap.prototype.trimOld = function (newSize) {\r\n        if (newSize >= this.size) {\r\n            return;\r\n        }\r\n        if (newSize === 0) {\r\n            this.clear();\r\n            return;\r\n        }\r\n        var current = this._head;\r\n        var currentSize = this.size;\r\n        while (current && currentSize > newSize) {\r\n            this._map.delete(current.key);\r\n            current = current.next;\r\n            currentSize--;\r\n        }\r\n        this._head = current;\r\n        this._size = currentSize;\r\n        if (current) {\r\n            current.previous = undefined;\r\n        }\r\n    };\r\n    LinkedMap.prototype.addItemFirst = function (item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._tail = item;\r\n        }\r\n        else if (!this._head) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n        }\r\n        this._head = item;\r\n    };\r\n    LinkedMap.prototype.addItemLast = function (item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._head = item;\r\n        }\r\n        else if (!this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n        }\r\n        this._tail = item;\r\n    };\r\n    LinkedMap.prototype.removeItem = function (item) {\r\n        if (item === this._head && item === this._tail) {\r\n            this._head = undefined;\r\n            this._tail = undefined;\r\n        }\r\n        else if (item === this._head) {\r\n            // This can only happend if size === 1 which is handle\r\n            // by the case above.\r\n            if (!item.next) {\r\n                throw new Error('Invalid list');\r\n            }\r\n            item.next.previous = undefined;\r\n            this._head = item.next;\r\n        }\r\n        else if (item === this._tail) {\r\n            // This can only happend if size === 1 which is handle\r\n            // by the case above.\r\n            if (!item.previous) {\r\n                throw new Error('Invalid list');\r\n            }\r\n            item.previous.next = undefined;\r\n            this._tail = item.previous;\r\n        }\r\n        else {\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            if (!next || !previous) {\r\n                throw new Error('Invalid list');\r\n            }\r\n            next.previous = previous;\r\n            previous.next = next;\r\n        }\r\n        item.next = undefined;\r\n        item.previous = undefined;\r\n    };\r\n    LinkedMap.prototype.touch = function (item, touch) {\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        if ((touch !== 1 /* AsOld */ && touch !== 2 /* AsNew */)) {\r\n            return;\r\n        }\r\n        if (touch === 1 /* AsOld */) {\r\n            if (item === this._head) {\r\n                return;\r\n            }\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            // Unlink the item\r\n            if (item === this._tail) {\r\n                // previous must be defined since item was not head but is tail\r\n                // So there are more than on item in the map\r\n                previous.next = undefined;\r\n                this._tail = previous;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            // Insert the node at head\r\n            item.previous = undefined;\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n            this._head = item;\r\n        }\r\n        else if (touch === 2 /* AsNew */) {\r\n            if (item === this._tail) {\r\n                return;\r\n            }\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            // Unlink the item.\r\n            if (item === this._head) {\r\n                // next must be defined since item was not tail but is head\r\n                // So there are more than on item in the map\r\n                next.previous = undefined;\r\n                this._head = next;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            item.next = undefined;\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n            this._tail = item;\r\n        }\r\n    };\r\n    LinkedMap.prototype.toJSON = function () {\r\n        var data = [];\r\n        this.forEach(function (value, key) {\r\n            data.push([key, value]);\r\n        });\r\n        return data;\r\n    };\r\n    return LinkedMap;\r\n}());\r\nexport { LinkedMap };\r\nvar LRUCache = /** @class */ (function (_super) {\r\n    __extends(LRUCache, _super);\r\n    function LRUCache(limit, ratio) {\r\n        if (ratio === void 0) { ratio = 1; }\r\n        var _this = _super.call(this) || this;\r\n        _this._limit = limit;\r\n        _this._ratio = Math.min(Math.max(0, ratio), 1);\r\n        return _this;\r\n    }\r\n    LRUCache.prototype.get = function (key) {\r\n        return _super.prototype.get.call(this, key, 2 /* AsNew */);\r\n    };\r\n    LRUCache.prototype.peek = function (key) {\r\n        return _super.prototype.get.call(this, key, 0 /* None */);\r\n    };\r\n    LRUCache.prototype.set = function (key, value) {\r\n        _super.prototype.set.call(this, key, value, 2 /* AsNew */);\r\n        this.checkTrim();\r\n    };\r\n    LRUCache.prototype.checkTrim = function () {\r\n        if (this.size > this._limit) {\r\n            this.trimOld(Math.round(this._limit * this._ratio));\r\n        }\r\n    };\r\n    return LRUCache;\r\n}(LinkedMap));\r\nexport { LRUCache };\r\n"]},"metadata":{},"sourceType":"module"}