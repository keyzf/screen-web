{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport * as jsonService from './_deps/vscode-json-languageservice/jsonLanguageService.js';\nvar Uri = monaco.Uri;\nvar Range = monaco.Range; // --- diagnostics --- ---\n\nvar DiagnosticsAdapter =\n/** @class */\nfunction () {\n  function DiagnosticsAdapter(_languageId, _worker, defaults) {\n    var _this = this;\n\n    this._languageId = _languageId;\n    this._worker = _worker;\n    this._disposables = [];\n    this._listener = Object.create(null);\n\n    var onModelAdd = function (model) {\n      var modeId = model.getModeId();\n\n      if (modeId !== _this._languageId) {\n        return;\n      }\n\n      var handle;\n      _this._listener[model.uri.toString()] = model.onDidChangeContent(function () {\n        clearTimeout(handle);\n        handle = setTimeout(function () {\n          return _this._doValidate(model.uri, modeId);\n        }, 500);\n      });\n\n      _this._doValidate(model.uri, modeId);\n    };\n\n    var onModelRemoved = function (model) {\n      monaco.editor.setModelMarkers(model, _this._languageId, []);\n      var uriStr = model.uri.toString();\n      var listener = _this._listener[uriStr];\n\n      if (listener) {\n        listener.dispose();\n        delete _this._listener[uriStr];\n      }\n    };\n\n    this._disposables.push(monaco.editor.onDidCreateModel(onModelAdd));\n\n    this._disposables.push(monaco.editor.onWillDisposeModel(function (model) {\n      onModelRemoved(model);\n\n      _this._resetSchema(model.uri);\n    }));\n\n    this._disposables.push(monaco.editor.onDidChangeModelLanguage(function (event) {\n      onModelRemoved(event.model);\n      onModelAdd(event.model);\n\n      _this._resetSchema(event.model.uri);\n    }));\n\n    this._disposables.push(defaults.onDidChange(function (_) {\n      monaco.editor.getModels().forEach(function (model) {\n        if (model.getModeId() === _this._languageId) {\n          onModelRemoved(model);\n          onModelAdd(model);\n        }\n      });\n    }));\n\n    this._disposables.push({\n      dispose: function () {\n        monaco.editor.getModels().forEach(onModelRemoved);\n\n        for (var key in _this._listener) {\n          _this._listener[key].dispose();\n        }\n      }\n    });\n\n    monaco.editor.getModels().forEach(onModelAdd);\n  }\n\n  DiagnosticsAdapter.prototype.dispose = function () {\n    this._disposables.forEach(function (d) {\n      return d && d.dispose();\n    });\n\n    this._disposables = [];\n  };\n\n  DiagnosticsAdapter.prototype._resetSchema = function (resource) {\n    this._worker().then(function (worker) {\n      worker.resetSchema(resource.toString());\n    });\n  };\n\n  DiagnosticsAdapter.prototype._doValidate = function (resource, languageId) {\n    this._worker(resource).then(function (worker) {\n      return worker.doValidation(resource.toString()).then(function (diagnostics) {\n        var markers = diagnostics.map(function (d) {\n          return toDiagnostics(resource, d);\n        });\n        var model = monaco.editor.getModel(resource);\n\n        if (model && model.getModeId() === languageId) {\n          monaco.editor.setModelMarkers(model, languageId, markers);\n        }\n      });\n    }).then(undefined, function (err) {\n      console.error(err);\n    });\n  };\n\n  return DiagnosticsAdapter;\n}();\n\nexport { DiagnosticsAdapter };\n\nfunction toSeverity(lsSeverity) {\n  switch (lsSeverity) {\n    case jsonService.DiagnosticSeverity.Error:\n      return monaco.MarkerSeverity.Error;\n\n    case jsonService.DiagnosticSeverity.Warning:\n      return monaco.MarkerSeverity.Warning;\n\n    case jsonService.DiagnosticSeverity.Information:\n      return monaco.MarkerSeverity.Info;\n\n    case jsonService.DiagnosticSeverity.Hint:\n      return monaco.MarkerSeverity.Hint;\n\n    default:\n      return monaco.MarkerSeverity.Info;\n  }\n}\n\nfunction toDiagnostics(resource, diag) {\n  var code = typeof diag.code === 'number' ? String(diag.code) : diag.code;\n  return {\n    severity: toSeverity(diag.severity),\n    startLineNumber: diag.range.start.line + 1,\n    startColumn: diag.range.start.character + 1,\n    endLineNumber: diag.range.end.line + 1,\n    endColumn: diag.range.end.character + 1,\n    message: diag.message,\n    code: code,\n    source: diag.source\n  };\n} // --- completion ------\n\n\nfunction fromPosition(position) {\n  if (!position) {\n    return void 0;\n  }\n\n  return {\n    character: position.column - 1,\n    line: position.lineNumber - 1\n  };\n}\n\nfunction fromRange(range) {\n  if (!range) {\n    return void 0;\n  }\n\n  return {\n    start: {\n      line: range.startLineNumber - 1,\n      character: range.startColumn - 1\n    },\n    end: {\n      line: range.endLineNumber - 1,\n      character: range.endColumn - 1\n    }\n  };\n}\n\nfunction toRange(range) {\n  if (!range) {\n    return void 0;\n  }\n\n  return new Range(range.start.line + 1, range.start.character + 1, range.end.line + 1, range.end.character + 1);\n}\n\nfunction toCompletionItemKind(kind) {\n  var mItemKind = monaco.languages.CompletionItemKind;\n\n  switch (kind) {\n    case jsonService.CompletionItemKind.Text:\n      return mItemKind.Text;\n\n    case jsonService.CompletionItemKind.Method:\n      return mItemKind.Method;\n\n    case jsonService.CompletionItemKind.Function:\n      return mItemKind.Function;\n\n    case jsonService.CompletionItemKind.Constructor:\n      return mItemKind.Constructor;\n\n    case jsonService.CompletionItemKind.Field:\n      return mItemKind.Field;\n\n    case jsonService.CompletionItemKind.Variable:\n      return mItemKind.Variable;\n\n    case jsonService.CompletionItemKind.Class:\n      return mItemKind.Class;\n\n    case jsonService.CompletionItemKind.Interface:\n      return mItemKind.Interface;\n\n    case jsonService.CompletionItemKind.Module:\n      return mItemKind.Module;\n\n    case jsonService.CompletionItemKind.Property:\n      return mItemKind.Property;\n\n    case jsonService.CompletionItemKind.Unit:\n      return mItemKind.Unit;\n\n    case jsonService.CompletionItemKind.Value:\n      return mItemKind.Value;\n\n    case jsonService.CompletionItemKind.Enum:\n      return mItemKind.Enum;\n\n    case jsonService.CompletionItemKind.Keyword:\n      return mItemKind.Keyword;\n\n    case jsonService.CompletionItemKind.Snippet:\n      return mItemKind.Snippet;\n\n    case jsonService.CompletionItemKind.Color:\n      return mItemKind.Color;\n\n    case jsonService.CompletionItemKind.File:\n      return mItemKind.File;\n\n    case jsonService.CompletionItemKind.Reference:\n      return mItemKind.Reference;\n  }\n\n  return mItemKind.Property;\n}\n\nfunction fromCompletionItemKind(kind) {\n  var mItemKind = monaco.languages.CompletionItemKind;\n\n  switch (kind) {\n    case mItemKind.Text:\n      return jsonService.CompletionItemKind.Text;\n\n    case mItemKind.Method:\n      return jsonService.CompletionItemKind.Method;\n\n    case mItemKind.Function:\n      return jsonService.CompletionItemKind.Function;\n\n    case mItemKind.Constructor:\n      return jsonService.CompletionItemKind.Constructor;\n\n    case mItemKind.Field:\n      return jsonService.CompletionItemKind.Field;\n\n    case mItemKind.Variable:\n      return jsonService.CompletionItemKind.Variable;\n\n    case mItemKind.Class:\n      return jsonService.CompletionItemKind.Class;\n\n    case mItemKind.Interface:\n      return jsonService.CompletionItemKind.Interface;\n\n    case mItemKind.Module:\n      return jsonService.CompletionItemKind.Module;\n\n    case mItemKind.Property:\n      return jsonService.CompletionItemKind.Property;\n\n    case mItemKind.Unit:\n      return jsonService.CompletionItemKind.Unit;\n\n    case mItemKind.Value:\n      return jsonService.CompletionItemKind.Value;\n\n    case mItemKind.Enum:\n      return jsonService.CompletionItemKind.Enum;\n\n    case mItemKind.Keyword:\n      return jsonService.CompletionItemKind.Keyword;\n\n    case mItemKind.Snippet:\n      return jsonService.CompletionItemKind.Snippet;\n\n    case mItemKind.Color:\n      return jsonService.CompletionItemKind.Color;\n\n    case mItemKind.File:\n      return jsonService.CompletionItemKind.File;\n\n    case mItemKind.Reference:\n      return jsonService.CompletionItemKind.Reference;\n  }\n\n  return jsonService.CompletionItemKind.Property;\n}\n\nfunction toTextEdit(textEdit) {\n  if (!textEdit) {\n    return void 0;\n  }\n\n  return {\n    range: toRange(textEdit.range),\n    text: textEdit.newText\n  };\n}\n\nvar CompletionAdapter =\n/** @class */\nfunction () {\n  function CompletionAdapter(_worker) {\n    this._worker = _worker;\n  }\n\n  Object.defineProperty(CompletionAdapter.prototype, \"triggerCharacters\", {\n    get: function () {\n      return [' ', ':'];\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  CompletionAdapter.prototype.provideCompletionItems = function (model, position, context, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.doComplete(resource.toString(), fromPosition(position));\n    }).then(function (info) {\n      if (!info) {\n        return;\n      }\n\n      var wordInfo = model.getWordUntilPosition(position);\n      var wordRange = new Range(position.lineNumber, wordInfo.startColumn, position.lineNumber, wordInfo.endColumn);\n      var items = info.items.map(function (entry) {\n        var item = {\n          label: entry.label,\n          insertText: entry.insertText || entry.label,\n          sortText: entry.sortText,\n          filterText: entry.filterText,\n          documentation: entry.documentation,\n          detail: entry.detail,\n          range: wordRange,\n          kind: toCompletionItemKind(entry.kind)\n        };\n\n        if (entry.textEdit) {\n          item.range = toRange(entry.textEdit.range);\n          item.insertText = entry.textEdit.newText;\n        }\n\n        if (entry.additionalTextEdits) {\n          item.additionalTextEdits = entry.additionalTextEdits.map(toTextEdit);\n        }\n\n        if (entry.insertTextFormat === jsonService.InsertTextFormat.Snippet) {\n          item.insertTextRules = monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet;\n        }\n\n        return item;\n      });\n      return {\n        isIncomplete: info.isIncomplete,\n        suggestions: items\n      };\n    });\n  };\n\n  return CompletionAdapter;\n}();\n\nexport { CompletionAdapter };\n\nfunction isMarkupContent(thing) {\n  return thing && typeof thing === 'object' && typeof thing.kind === 'string';\n}\n\nfunction toMarkdownString(entry) {\n  if (typeof entry === 'string') {\n    return {\n      value: entry\n    };\n  }\n\n  if (isMarkupContent(entry)) {\n    if (entry.kind === 'plaintext') {\n      return {\n        value: entry.value.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&')\n      };\n    }\n\n    return {\n      value: entry.value\n    };\n  }\n\n  return {\n    value: '```' + entry.language + '\\n' + entry.value + '\\n```\\n'\n  };\n}\n\nfunction toMarkedStringArray(contents) {\n  if (!contents) {\n    return void 0;\n  }\n\n  if (Array.isArray(contents)) {\n    return contents.map(toMarkdownString);\n  }\n\n  return [toMarkdownString(contents)];\n} // --- hover ------\n\n\nvar HoverAdapter =\n/** @class */\nfunction () {\n  function HoverAdapter(_worker) {\n    this._worker = _worker;\n  }\n\n  HoverAdapter.prototype.provideHover = function (model, position, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.doHover(resource.toString(), fromPosition(position));\n    }).then(function (info) {\n      if (!info) {\n        return;\n      }\n\n      return {\n        range: toRange(info.range),\n        contents: toMarkedStringArray(info.contents)\n      };\n    });\n  };\n\n  return HoverAdapter;\n}();\n\nexport { HoverAdapter }; // --- definition ------\n\nfunction toLocation(location) {\n  return {\n    uri: Uri.parse(location.uri),\n    range: toRange(location.range)\n  };\n} // --- document symbols ------\n\n\nfunction toSymbolKind(kind) {\n  var mKind = monaco.languages.SymbolKind;\n\n  switch (kind) {\n    case jsonService.SymbolKind.File:\n      return mKind.Array;\n\n    case jsonService.SymbolKind.Module:\n      return mKind.Module;\n\n    case jsonService.SymbolKind.Namespace:\n      return mKind.Namespace;\n\n    case jsonService.SymbolKind.Package:\n      return mKind.Package;\n\n    case jsonService.SymbolKind.Class:\n      return mKind.Class;\n\n    case jsonService.SymbolKind.Method:\n      return mKind.Method;\n\n    case jsonService.SymbolKind.Property:\n      return mKind.Property;\n\n    case jsonService.SymbolKind.Field:\n      return mKind.Field;\n\n    case jsonService.SymbolKind.Constructor:\n      return mKind.Constructor;\n\n    case jsonService.SymbolKind.Enum:\n      return mKind.Enum;\n\n    case jsonService.SymbolKind.Interface:\n      return mKind.Interface;\n\n    case jsonService.SymbolKind.Function:\n      return mKind.Function;\n\n    case jsonService.SymbolKind.Variable:\n      return mKind.Variable;\n\n    case jsonService.SymbolKind.Constant:\n      return mKind.Constant;\n\n    case jsonService.SymbolKind.String:\n      return mKind.String;\n\n    case jsonService.SymbolKind.Number:\n      return mKind.Number;\n\n    case jsonService.SymbolKind.Boolean:\n      return mKind.Boolean;\n\n    case jsonService.SymbolKind.Array:\n      return mKind.Array;\n  }\n\n  return mKind.Function;\n}\n\nvar DocumentSymbolAdapter =\n/** @class */\nfunction () {\n  function DocumentSymbolAdapter(_worker) {\n    this._worker = _worker;\n  }\n\n  DocumentSymbolAdapter.prototype.provideDocumentSymbols = function (model, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.findDocumentSymbols(resource.toString());\n    }).then(function (items) {\n      if (!items) {\n        return;\n      }\n\n      return items.map(function (item) {\n        return {\n          name: item.name,\n          detail: '',\n          containerName: item.containerName,\n          kind: toSymbolKind(item.kind),\n          range: toRange(item.location.range),\n          selectionRange: toRange(item.location.range),\n          tags: []\n        };\n      });\n    });\n  };\n\n  return DocumentSymbolAdapter;\n}();\n\nexport { DocumentSymbolAdapter };\n\nfunction fromFormattingOptions(options) {\n  return {\n    tabSize: options.tabSize,\n    insertSpaces: options.insertSpaces\n  };\n}\n\nvar DocumentFormattingEditProvider =\n/** @class */\nfunction () {\n  function DocumentFormattingEditProvider(_worker) {\n    this._worker = _worker;\n  }\n\n  DocumentFormattingEditProvider.prototype.provideDocumentFormattingEdits = function (model, options, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.format(resource.toString(), null, fromFormattingOptions(options)).then(function (edits) {\n        if (!edits || edits.length === 0) {\n          return;\n        }\n\n        return edits.map(toTextEdit);\n      });\n    });\n  };\n\n  return DocumentFormattingEditProvider;\n}();\n\nexport { DocumentFormattingEditProvider };\n\nvar DocumentRangeFormattingEditProvider =\n/** @class */\nfunction () {\n  function DocumentRangeFormattingEditProvider(_worker) {\n    this._worker = _worker;\n  }\n\n  DocumentRangeFormattingEditProvider.prototype.provideDocumentRangeFormattingEdits = function (model, range, options, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.format(resource.toString(), fromRange(range), fromFormattingOptions(options)).then(function (edits) {\n        if (!edits || edits.length === 0) {\n          return;\n        }\n\n        return edits.map(toTextEdit);\n      });\n    });\n  };\n\n  return DocumentRangeFormattingEditProvider;\n}();\n\nexport { DocumentRangeFormattingEditProvider };\n\nvar DocumentColorAdapter =\n/** @class */\nfunction () {\n  function DocumentColorAdapter(_worker) {\n    this._worker = _worker;\n  }\n\n  DocumentColorAdapter.prototype.provideDocumentColors = function (model, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.findDocumentColors(resource.toString());\n    }).then(function (infos) {\n      if (!infos) {\n        return;\n      }\n\n      return infos.map(function (item) {\n        return {\n          color: item.color,\n          range: toRange(item.range)\n        };\n      });\n    });\n  };\n\n  DocumentColorAdapter.prototype.provideColorPresentations = function (model, info, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.getColorPresentations(resource.toString(), info.color, fromRange(info.range));\n    }).then(function (presentations) {\n      if (!presentations) {\n        return;\n      }\n\n      return presentations.map(function (presentation) {\n        var item = {\n          label: presentation.label\n        };\n\n        if (presentation.textEdit) {\n          item.textEdit = toTextEdit(presentation.textEdit);\n        }\n\n        if (presentation.additionalTextEdits) {\n          item.additionalTextEdits = presentation.additionalTextEdits.map(toTextEdit);\n        }\n\n        return item;\n      });\n    });\n  };\n\n  return DocumentColorAdapter;\n}();\n\nexport { DocumentColorAdapter };\n\nvar FoldingRangeAdapter =\n/** @class */\nfunction () {\n  function FoldingRangeAdapter(_worker) {\n    this._worker = _worker;\n  }\n\n  FoldingRangeAdapter.prototype.provideFoldingRanges = function (model, context, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.getFoldingRanges(resource.toString(), context);\n    }).then(function (ranges) {\n      if (!ranges) {\n        return;\n      }\n\n      return ranges.map(function (range) {\n        var result = {\n          start: range.startLine + 1,\n          end: range.endLine + 1\n        };\n\n        if (typeof range.kind !== 'undefined') {\n          result.kind = toFoldingRangeKind(range.kind);\n        }\n\n        return result;\n      });\n    });\n  };\n\n  return FoldingRangeAdapter;\n}();\n\nexport { FoldingRangeAdapter };\n\nfunction toFoldingRangeKind(kind) {\n  switch (kind) {\n    case jsonService.FoldingRangeKind.Comment:\n      return monaco.languages.FoldingRangeKind.Comment;\n\n    case jsonService.FoldingRangeKind.Imports:\n      return monaco.languages.FoldingRangeKind.Imports;\n\n    case jsonService.FoldingRangeKind.Region:\n      return monaco.languages.FoldingRangeKind.Region;\n  }\n\n  return void 0;\n}\n\nvar SelectionRangeAdapter =\n/** @class */\nfunction () {\n  function SelectionRangeAdapter(_worker) {\n    this._worker = _worker;\n  }\n\n  SelectionRangeAdapter.prototype.provideSelectionRanges = function (model, positions, token) {\n    var resource = model.uri;\n    return this._worker(resource).then(function (worker) {\n      return worker.getSelectionRanges(resource.toString(), positions.map(fromPosition));\n    }).then(function (selectionRanges) {\n      if (!selectionRanges) {\n        return;\n      }\n\n      return selectionRanges.map(function (selectionRange) {\n        var result = [];\n\n        while (selectionRange) {\n          result.push({\n            range: toRange(selectionRange.range)\n          });\n          selectionRange = selectionRange.parent;\n        }\n\n        return result;\n      });\n    });\n  };\n\n  return SelectionRangeAdapter;\n}();\n\nexport { SelectionRangeAdapter };","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/language/json/languageFeatures.js"],"names":["jsonService","Uri","monaco","Range","DiagnosticsAdapter","_languageId","_worker","defaults","_this","_disposables","_listener","Object","create","onModelAdd","model","modeId","getModeId","handle","uri","toString","onDidChangeContent","clearTimeout","setTimeout","_doValidate","onModelRemoved","editor","setModelMarkers","uriStr","listener","dispose","push","onDidCreateModel","onWillDisposeModel","_resetSchema","onDidChangeModelLanguage","event","onDidChange","_","getModels","forEach","key","prototype","d","resource","then","worker","resetSchema","languageId","doValidation","diagnostics","markers","map","toDiagnostics","getModel","undefined","err","console","error","toSeverity","lsSeverity","DiagnosticSeverity","Error","MarkerSeverity","Warning","Information","Info","Hint","diag","code","String","severity","startLineNumber","range","start","line","startColumn","character","endLineNumber","end","endColumn","message","source","fromPosition","position","column","lineNumber","fromRange","toRange","toCompletionItemKind","kind","mItemKind","languages","CompletionItemKind","Text","Method","Function","Constructor","Field","Variable","Class","Interface","Module","Property","Unit","Value","Enum","Keyword","Snippet","Color","File","Reference","fromCompletionItemKind","toTextEdit","textEdit","text","newText","CompletionAdapter","defineProperty","get","enumerable","configurable","provideCompletionItems","context","token","doComplete","info","wordInfo","getWordUntilPosition","wordRange","items","entry","item","label","insertText","sortText","filterText","documentation","detail","additionalTextEdits","insertTextFormat","InsertTextFormat","insertTextRules","CompletionItemInsertTextRule","InsertAsSnippet","isIncomplete","suggestions","isMarkupContent","thing","toMarkdownString","value","replace","language","toMarkedStringArray","contents","Array","isArray","HoverAdapter","provideHover","doHover","toLocation","location","parse","toSymbolKind","mKind","SymbolKind","Namespace","Package","Constant","Number","Boolean","DocumentSymbolAdapter","provideDocumentSymbols","findDocumentSymbols","name","containerName","selectionRange","tags","fromFormattingOptions","options","tabSize","insertSpaces","DocumentFormattingEditProvider","provideDocumentFormattingEdits","format","edits","length","DocumentRangeFormattingEditProvider","provideDocumentRangeFormattingEdits","DocumentColorAdapter","provideDocumentColors","findDocumentColors","infos","color","provideColorPresentations","getColorPresentations","presentations","presentation","FoldingRangeAdapter","provideFoldingRanges","getFoldingRanges","ranges","result","startLine","endLine","toFoldingRangeKind","FoldingRangeKind","Comment","Imports","Region","SelectionRangeAdapter","provideSelectionRanges","positions","getSelectionRanges","selectionRanges","parent"],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport * as jsonService from './_deps/vscode-json-languageservice/jsonLanguageService.js';\r\nvar Uri = monaco.Uri;\r\nvar Range = monaco.Range;\r\n// --- diagnostics --- ---\r\nvar DiagnosticsAdapter = /** @class */ (function () {\r\n    function DiagnosticsAdapter(_languageId, _worker, defaults) {\r\n        var _this = this;\r\n        this._languageId = _languageId;\r\n        this._worker = _worker;\r\n        this._disposables = [];\r\n        this._listener = Object.create(null);\r\n        var onModelAdd = function (model) {\r\n            var modeId = model.getModeId();\r\n            if (modeId !== _this._languageId) {\r\n                return;\r\n            }\r\n            var handle;\r\n            _this._listener[model.uri.toString()] = model.onDidChangeContent(function () {\r\n                clearTimeout(handle);\r\n                handle = setTimeout(function () { return _this._doValidate(model.uri, modeId); }, 500);\r\n            });\r\n            _this._doValidate(model.uri, modeId);\r\n        };\r\n        var onModelRemoved = function (model) {\r\n            monaco.editor.setModelMarkers(model, _this._languageId, []);\r\n            var uriStr = model.uri.toString();\r\n            var listener = _this._listener[uriStr];\r\n            if (listener) {\r\n                listener.dispose();\r\n                delete _this._listener[uriStr];\r\n            }\r\n        };\r\n        this._disposables.push(monaco.editor.onDidCreateModel(onModelAdd));\r\n        this._disposables.push(monaco.editor.onWillDisposeModel(function (model) {\r\n            onModelRemoved(model);\r\n            _this._resetSchema(model.uri);\r\n        }));\r\n        this._disposables.push(monaco.editor.onDidChangeModelLanguage(function (event) {\r\n            onModelRemoved(event.model);\r\n            onModelAdd(event.model);\r\n            _this._resetSchema(event.model.uri);\r\n        }));\r\n        this._disposables.push(defaults.onDidChange(function (_) {\r\n            monaco.editor.getModels().forEach(function (model) {\r\n                if (model.getModeId() === _this._languageId) {\r\n                    onModelRemoved(model);\r\n                    onModelAdd(model);\r\n                }\r\n            });\r\n        }));\r\n        this._disposables.push({\r\n            dispose: function () {\r\n                monaco.editor.getModels().forEach(onModelRemoved);\r\n                for (var key in _this._listener) {\r\n                    _this._listener[key].dispose();\r\n                }\r\n            }\r\n        });\r\n        monaco.editor.getModels().forEach(onModelAdd);\r\n    }\r\n    DiagnosticsAdapter.prototype.dispose = function () {\r\n        this._disposables.forEach(function (d) { return d && d.dispose(); });\r\n        this._disposables = [];\r\n    };\r\n    DiagnosticsAdapter.prototype._resetSchema = function (resource) {\r\n        this._worker().then(function (worker) {\r\n            worker.resetSchema(resource.toString());\r\n        });\r\n    };\r\n    DiagnosticsAdapter.prototype._doValidate = function (resource, languageId) {\r\n        this._worker(resource).then(function (worker) {\r\n            return worker.doValidation(resource.toString()).then(function (diagnostics) {\r\n                var markers = diagnostics.map(function (d) { return toDiagnostics(resource, d); });\r\n                var model = monaco.editor.getModel(resource);\r\n                if (model && model.getModeId() === languageId) {\r\n                    monaco.editor.setModelMarkers(model, languageId, markers);\r\n                }\r\n            });\r\n        }).then(undefined, function (err) {\r\n            console.error(err);\r\n        });\r\n    };\r\n    return DiagnosticsAdapter;\r\n}());\r\nexport { DiagnosticsAdapter };\r\nfunction toSeverity(lsSeverity) {\r\n    switch (lsSeverity) {\r\n        case jsonService.DiagnosticSeverity.Error: return monaco.MarkerSeverity.Error;\r\n        case jsonService.DiagnosticSeverity.Warning: return monaco.MarkerSeverity.Warning;\r\n        case jsonService.DiagnosticSeverity.Information: return monaco.MarkerSeverity.Info;\r\n        case jsonService.DiagnosticSeverity.Hint: return monaco.MarkerSeverity.Hint;\r\n        default:\r\n            return monaco.MarkerSeverity.Info;\r\n    }\r\n}\r\nfunction toDiagnostics(resource, diag) {\r\n    var code = typeof diag.code === 'number' ? String(diag.code) : diag.code;\r\n    return {\r\n        severity: toSeverity(diag.severity),\r\n        startLineNumber: diag.range.start.line + 1,\r\n        startColumn: diag.range.start.character + 1,\r\n        endLineNumber: diag.range.end.line + 1,\r\n        endColumn: diag.range.end.character + 1,\r\n        message: diag.message,\r\n        code: code,\r\n        source: diag.source\r\n    };\r\n}\r\n// --- completion ------\r\nfunction fromPosition(position) {\r\n    if (!position) {\r\n        return void 0;\r\n    }\r\n    return { character: position.column - 1, line: position.lineNumber - 1 };\r\n}\r\nfunction fromRange(range) {\r\n    if (!range) {\r\n        return void 0;\r\n    }\r\n    return { start: { line: range.startLineNumber - 1, character: range.startColumn - 1 }, end: { line: range.endLineNumber - 1, character: range.endColumn - 1 } };\r\n}\r\nfunction toRange(range) {\r\n    if (!range) {\r\n        return void 0;\r\n    }\r\n    return new Range(range.start.line + 1, range.start.character + 1, range.end.line + 1, range.end.character + 1);\r\n}\r\nfunction toCompletionItemKind(kind) {\r\n    var mItemKind = monaco.languages.CompletionItemKind;\r\n    switch (kind) {\r\n        case jsonService.CompletionItemKind.Text: return mItemKind.Text;\r\n        case jsonService.CompletionItemKind.Method: return mItemKind.Method;\r\n        case jsonService.CompletionItemKind.Function: return mItemKind.Function;\r\n        case jsonService.CompletionItemKind.Constructor: return mItemKind.Constructor;\r\n        case jsonService.CompletionItemKind.Field: return mItemKind.Field;\r\n        case jsonService.CompletionItemKind.Variable: return mItemKind.Variable;\r\n        case jsonService.CompletionItemKind.Class: return mItemKind.Class;\r\n        case jsonService.CompletionItemKind.Interface: return mItemKind.Interface;\r\n        case jsonService.CompletionItemKind.Module: return mItemKind.Module;\r\n        case jsonService.CompletionItemKind.Property: return mItemKind.Property;\r\n        case jsonService.CompletionItemKind.Unit: return mItemKind.Unit;\r\n        case jsonService.CompletionItemKind.Value: return mItemKind.Value;\r\n        case jsonService.CompletionItemKind.Enum: return mItemKind.Enum;\r\n        case jsonService.CompletionItemKind.Keyword: return mItemKind.Keyword;\r\n        case jsonService.CompletionItemKind.Snippet: return mItemKind.Snippet;\r\n        case jsonService.CompletionItemKind.Color: return mItemKind.Color;\r\n        case jsonService.CompletionItemKind.File: return mItemKind.File;\r\n        case jsonService.CompletionItemKind.Reference: return mItemKind.Reference;\r\n    }\r\n    return mItemKind.Property;\r\n}\r\nfunction fromCompletionItemKind(kind) {\r\n    var mItemKind = monaco.languages.CompletionItemKind;\r\n    switch (kind) {\r\n        case mItemKind.Text: return jsonService.CompletionItemKind.Text;\r\n        case mItemKind.Method: return jsonService.CompletionItemKind.Method;\r\n        case mItemKind.Function: return jsonService.CompletionItemKind.Function;\r\n        case mItemKind.Constructor: return jsonService.CompletionItemKind.Constructor;\r\n        case mItemKind.Field: return jsonService.CompletionItemKind.Field;\r\n        case mItemKind.Variable: return jsonService.CompletionItemKind.Variable;\r\n        case mItemKind.Class: return jsonService.CompletionItemKind.Class;\r\n        case mItemKind.Interface: return jsonService.CompletionItemKind.Interface;\r\n        case mItemKind.Module: return jsonService.CompletionItemKind.Module;\r\n        case mItemKind.Property: return jsonService.CompletionItemKind.Property;\r\n        case mItemKind.Unit: return jsonService.CompletionItemKind.Unit;\r\n        case mItemKind.Value: return jsonService.CompletionItemKind.Value;\r\n        case mItemKind.Enum: return jsonService.CompletionItemKind.Enum;\r\n        case mItemKind.Keyword: return jsonService.CompletionItemKind.Keyword;\r\n        case mItemKind.Snippet: return jsonService.CompletionItemKind.Snippet;\r\n        case mItemKind.Color: return jsonService.CompletionItemKind.Color;\r\n        case mItemKind.File: return jsonService.CompletionItemKind.File;\r\n        case mItemKind.Reference: return jsonService.CompletionItemKind.Reference;\r\n    }\r\n    return jsonService.CompletionItemKind.Property;\r\n}\r\nfunction toTextEdit(textEdit) {\r\n    if (!textEdit) {\r\n        return void 0;\r\n    }\r\n    return {\r\n        range: toRange(textEdit.range),\r\n        text: textEdit.newText\r\n    };\r\n}\r\nvar CompletionAdapter = /** @class */ (function () {\r\n    function CompletionAdapter(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    Object.defineProperty(CompletionAdapter.prototype, \"triggerCharacters\", {\r\n        get: function () {\r\n            return [' ', ':'];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CompletionAdapter.prototype.provideCompletionItems = function (model, position, context, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) {\r\n            return worker.doComplete(resource.toString(), fromPosition(position));\r\n        }).then(function (info) {\r\n            if (!info) {\r\n                return;\r\n            }\r\n            var wordInfo = model.getWordUntilPosition(position);\r\n            var wordRange = new Range(position.lineNumber, wordInfo.startColumn, position.lineNumber, wordInfo.endColumn);\r\n            var items = info.items.map(function (entry) {\r\n                var item = {\r\n                    label: entry.label,\r\n                    insertText: entry.insertText || entry.label,\r\n                    sortText: entry.sortText,\r\n                    filterText: entry.filterText,\r\n                    documentation: entry.documentation,\r\n                    detail: entry.detail,\r\n                    range: wordRange,\r\n                    kind: toCompletionItemKind(entry.kind),\r\n                };\r\n                if (entry.textEdit) {\r\n                    item.range = toRange(entry.textEdit.range);\r\n                    item.insertText = entry.textEdit.newText;\r\n                }\r\n                if (entry.additionalTextEdits) {\r\n                    item.additionalTextEdits = entry.additionalTextEdits.map(toTextEdit);\r\n                }\r\n                if (entry.insertTextFormat === jsonService.InsertTextFormat.Snippet) {\r\n                    item.insertTextRules = monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet;\r\n                }\r\n                return item;\r\n            });\r\n            return {\r\n                isIncomplete: info.isIncomplete,\r\n                suggestions: items\r\n            };\r\n        });\r\n    };\r\n    return CompletionAdapter;\r\n}());\r\nexport { CompletionAdapter };\r\nfunction isMarkupContent(thing) {\r\n    return thing && typeof thing === 'object' && typeof thing.kind === 'string';\r\n}\r\nfunction toMarkdownString(entry) {\r\n    if (typeof entry === 'string') {\r\n        return {\r\n            value: entry\r\n        };\r\n    }\r\n    if (isMarkupContent(entry)) {\r\n        if (entry.kind === 'plaintext') {\r\n            return {\r\n                value: entry.value.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&')\r\n            };\r\n        }\r\n        return {\r\n            value: entry.value\r\n        };\r\n    }\r\n    return { value: '```' + entry.language + '\\n' + entry.value + '\\n```\\n' };\r\n}\r\nfunction toMarkedStringArray(contents) {\r\n    if (!contents) {\r\n        return void 0;\r\n    }\r\n    if (Array.isArray(contents)) {\r\n        return contents.map(toMarkdownString);\r\n    }\r\n    return [toMarkdownString(contents)];\r\n}\r\n// --- hover ------\r\nvar HoverAdapter = /** @class */ (function () {\r\n    function HoverAdapter(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    HoverAdapter.prototype.provideHover = function (model, position, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) {\r\n            return worker.doHover(resource.toString(), fromPosition(position));\r\n        }).then(function (info) {\r\n            if (!info) {\r\n                return;\r\n            }\r\n            return {\r\n                range: toRange(info.range),\r\n                contents: toMarkedStringArray(info.contents)\r\n            };\r\n        });\r\n    };\r\n    return HoverAdapter;\r\n}());\r\nexport { HoverAdapter };\r\n// --- definition ------\r\nfunction toLocation(location) {\r\n    return {\r\n        uri: Uri.parse(location.uri),\r\n        range: toRange(location.range)\r\n    };\r\n}\r\n// --- document symbols ------\r\nfunction toSymbolKind(kind) {\r\n    var mKind = monaco.languages.SymbolKind;\r\n    switch (kind) {\r\n        case jsonService.SymbolKind.File: return mKind.Array;\r\n        case jsonService.SymbolKind.Module: return mKind.Module;\r\n        case jsonService.SymbolKind.Namespace: return mKind.Namespace;\r\n        case jsonService.SymbolKind.Package: return mKind.Package;\r\n        case jsonService.SymbolKind.Class: return mKind.Class;\r\n        case jsonService.SymbolKind.Method: return mKind.Method;\r\n        case jsonService.SymbolKind.Property: return mKind.Property;\r\n        case jsonService.SymbolKind.Field: return mKind.Field;\r\n        case jsonService.SymbolKind.Constructor: return mKind.Constructor;\r\n        case jsonService.SymbolKind.Enum: return mKind.Enum;\r\n        case jsonService.SymbolKind.Interface: return mKind.Interface;\r\n        case jsonService.SymbolKind.Function: return mKind.Function;\r\n        case jsonService.SymbolKind.Variable: return mKind.Variable;\r\n        case jsonService.SymbolKind.Constant: return mKind.Constant;\r\n        case jsonService.SymbolKind.String: return mKind.String;\r\n        case jsonService.SymbolKind.Number: return mKind.Number;\r\n        case jsonService.SymbolKind.Boolean: return mKind.Boolean;\r\n        case jsonService.SymbolKind.Array: return mKind.Array;\r\n    }\r\n    return mKind.Function;\r\n}\r\nvar DocumentSymbolAdapter = /** @class */ (function () {\r\n    function DocumentSymbolAdapter(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    DocumentSymbolAdapter.prototype.provideDocumentSymbols = function (model, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) { return worker.findDocumentSymbols(resource.toString()); }).then(function (items) {\r\n            if (!items) {\r\n                return;\r\n            }\r\n            return items.map(function (item) { return ({\r\n                name: item.name,\r\n                detail: '',\r\n                containerName: item.containerName,\r\n                kind: toSymbolKind(item.kind),\r\n                range: toRange(item.location.range),\r\n                selectionRange: toRange(item.location.range),\r\n                tags: []\r\n            }); });\r\n        });\r\n    };\r\n    return DocumentSymbolAdapter;\r\n}());\r\nexport { DocumentSymbolAdapter };\r\nfunction fromFormattingOptions(options) {\r\n    return {\r\n        tabSize: options.tabSize,\r\n        insertSpaces: options.insertSpaces\r\n    };\r\n}\r\nvar DocumentFormattingEditProvider = /** @class */ (function () {\r\n    function DocumentFormattingEditProvider(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    DocumentFormattingEditProvider.prototype.provideDocumentFormattingEdits = function (model, options, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) {\r\n            return worker.format(resource.toString(), null, fromFormattingOptions(options)).then(function (edits) {\r\n                if (!edits || edits.length === 0) {\r\n                    return;\r\n                }\r\n                return edits.map(toTextEdit);\r\n            });\r\n        });\r\n    };\r\n    return DocumentFormattingEditProvider;\r\n}());\r\nexport { DocumentFormattingEditProvider };\r\nvar DocumentRangeFormattingEditProvider = /** @class */ (function () {\r\n    function DocumentRangeFormattingEditProvider(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    DocumentRangeFormattingEditProvider.prototype.provideDocumentRangeFormattingEdits = function (model, range, options, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) {\r\n            return worker.format(resource.toString(), fromRange(range), fromFormattingOptions(options)).then(function (edits) {\r\n                if (!edits || edits.length === 0) {\r\n                    return;\r\n                }\r\n                return edits.map(toTextEdit);\r\n            });\r\n        });\r\n    };\r\n    return DocumentRangeFormattingEditProvider;\r\n}());\r\nexport { DocumentRangeFormattingEditProvider };\r\nvar DocumentColorAdapter = /** @class */ (function () {\r\n    function DocumentColorAdapter(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    DocumentColorAdapter.prototype.provideDocumentColors = function (model, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) { return worker.findDocumentColors(resource.toString()); }).then(function (infos) {\r\n            if (!infos) {\r\n                return;\r\n            }\r\n            return infos.map(function (item) { return ({\r\n                color: item.color,\r\n                range: toRange(item.range)\r\n            }); });\r\n        });\r\n    };\r\n    DocumentColorAdapter.prototype.provideColorPresentations = function (model, info, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) { return worker.getColorPresentations(resource.toString(), info.color, fromRange(info.range)); }).then(function (presentations) {\r\n            if (!presentations) {\r\n                return;\r\n            }\r\n            return presentations.map(function (presentation) {\r\n                var item = {\r\n                    label: presentation.label,\r\n                };\r\n                if (presentation.textEdit) {\r\n                    item.textEdit = toTextEdit(presentation.textEdit);\r\n                }\r\n                if (presentation.additionalTextEdits) {\r\n                    item.additionalTextEdits = presentation.additionalTextEdits.map(toTextEdit);\r\n                }\r\n                return item;\r\n            });\r\n        });\r\n    };\r\n    return DocumentColorAdapter;\r\n}());\r\nexport { DocumentColorAdapter };\r\nvar FoldingRangeAdapter = /** @class */ (function () {\r\n    function FoldingRangeAdapter(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    FoldingRangeAdapter.prototype.provideFoldingRanges = function (model, context, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) { return worker.getFoldingRanges(resource.toString(), context); }).then(function (ranges) {\r\n            if (!ranges) {\r\n                return;\r\n            }\r\n            return ranges.map(function (range) {\r\n                var result = {\r\n                    start: range.startLine + 1,\r\n                    end: range.endLine + 1\r\n                };\r\n                if (typeof range.kind !== 'undefined') {\r\n                    result.kind = toFoldingRangeKind(range.kind);\r\n                }\r\n                return result;\r\n            });\r\n        });\r\n    };\r\n    return FoldingRangeAdapter;\r\n}());\r\nexport { FoldingRangeAdapter };\r\nfunction toFoldingRangeKind(kind) {\r\n    switch (kind) {\r\n        case jsonService.FoldingRangeKind.Comment: return monaco.languages.FoldingRangeKind.Comment;\r\n        case jsonService.FoldingRangeKind.Imports: return monaco.languages.FoldingRangeKind.Imports;\r\n        case jsonService.FoldingRangeKind.Region: return monaco.languages.FoldingRangeKind.Region;\r\n    }\r\n    return void 0;\r\n}\r\nvar SelectionRangeAdapter = /** @class */ (function () {\r\n    function SelectionRangeAdapter(_worker) {\r\n        this._worker = _worker;\r\n    }\r\n    SelectionRangeAdapter.prototype.provideSelectionRanges = function (model, positions, token) {\r\n        var resource = model.uri;\r\n        return this._worker(resource).then(function (worker) { return worker.getSelectionRanges(resource.toString(), positions.map(fromPosition)); }).then(function (selectionRanges) {\r\n            if (!selectionRanges) {\r\n                return;\r\n            }\r\n            return selectionRanges.map(function (selectionRange) {\r\n                var result = [];\r\n                while (selectionRange) {\r\n                    result.push({ range: toRange(selectionRange.range) });\r\n                    selectionRange = selectionRange.parent;\r\n                }\r\n                return result;\r\n            });\r\n        });\r\n    };\r\n    return SelectionRangeAdapter;\r\n}());\r\nexport { SelectionRangeAdapter };\r\n"]},"metadata":{},"sourceType":"module"}