{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport './viewCursors.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { ViewCursor } from './viewCursor.js';\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/view/editorColorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\n\nvar ViewCursors =\n/** @class */\nfunction (_super) {\n  __extends(ViewCursors, _super);\n\n  function ViewCursors(context) {\n    var _this = _super.call(this, context) || this;\n\n    var options = _this._context.configuration.options;\n    _this._readOnly = options.get(68\n    /* readOnly */\n    );\n    _this._cursorBlinking = options.get(16\n    /* cursorBlinking */\n    );\n    _this._cursorStyle = options.get(18\n    /* cursorStyle */\n    );\n    _this._cursorSmoothCaretAnimation = options.get(17\n    /* cursorSmoothCaretAnimation */\n    );\n    _this._selectionIsEmpty = true;\n    _this._isVisible = false;\n    _this._primaryCursor = new ViewCursor(_this._context);\n    _this._secondaryCursors = [];\n    _this._renderData = [];\n    _this._domNode = createFastDomNode(document.createElement('div'));\n\n    _this._domNode.setAttribute('role', 'presentation');\n\n    _this._domNode.setAttribute('aria-hidden', 'true');\n\n    _this._updateDomClassName();\n\n    _this._domNode.appendChild(_this._primaryCursor.getDomNode());\n\n    _this._startCursorBlinkAnimation = new TimeoutTimer();\n    _this._cursorFlatBlinkInterval = new IntervalTimer();\n    _this._blinkingEnabled = false;\n    _this._editorHasFocus = false;\n\n    _this._updateBlinking();\n\n    return _this;\n  }\n\n  ViewCursors.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this._startCursorBlinkAnimation.dispose();\n\n    this._cursorFlatBlinkInterval.dispose();\n  };\n\n  ViewCursors.prototype.getDomNode = function () {\n    return this._domNode;\n  }; // --- begin event handlers\n\n\n  ViewCursors.prototype.onConfigurationChanged = function (e) {\n    var options = this._context.configuration.options;\n    this._readOnly = options.get(68\n    /* readOnly */\n    );\n    this._cursorBlinking = options.get(16\n    /* cursorBlinking */\n    );\n    this._cursorStyle = options.get(18\n    /* cursorStyle */\n    );\n    this._cursorSmoothCaretAnimation = options.get(17\n    /* cursorSmoothCaretAnimation */\n    );\n\n    this._updateBlinking();\n\n    this._updateDomClassName();\n\n    this._primaryCursor.onConfigurationChanged(e);\n\n    for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n      this._secondaryCursors[i].onConfigurationChanged(e);\n    }\n\n    return true;\n  };\n\n  ViewCursors.prototype._onCursorPositionChanged = function (position, secondaryPositions) {\n    this._primaryCursor.onCursorPositionChanged(position);\n\n    this._updateBlinking();\n\n    if (this._secondaryCursors.length < secondaryPositions.length) {\n      // Create new cursors\n      var addCnt = secondaryPositions.length - this._secondaryCursors.length;\n\n      for (var i = 0; i < addCnt; i++) {\n        var newCursor = new ViewCursor(this._context);\n\n        this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\n\n        this._secondaryCursors.push(newCursor);\n      }\n    } else if (this._secondaryCursors.length > secondaryPositions.length) {\n      // Remove some cursors\n      var removeCnt = this._secondaryCursors.length - secondaryPositions.length;\n\n      for (var i = 0; i < removeCnt; i++) {\n        this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\n\n        this._secondaryCursors.splice(0, 1);\n      }\n    }\n\n    for (var i = 0; i < secondaryPositions.length; i++) {\n      this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i]);\n    }\n  };\n\n  ViewCursors.prototype.onCursorStateChanged = function (e) {\n    var positions = [];\n\n    for (var i = 0, len = e.selections.length; i < len; i++) {\n      positions[i] = e.selections[i].getPosition();\n    }\n\n    this._onCursorPositionChanged(positions[0], positions.slice(1));\n\n    var selectionIsEmpty = e.selections[0].isEmpty();\n\n    if (this._selectionIsEmpty !== selectionIsEmpty) {\n      this._selectionIsEmpty = selectionIsEmpty;\n\n      this._updateDomClassName();\n    }\n\n    return true;\n  };\n\n  ViewCursors.prototype.onDecorationsChanged = function (e) {\n    // true for inline decorations that can end up relayouting text\n    return true;\n  };\n\n  ViewCursors.prototype.onFlushed = function (e) {\n    return true;\n  };\n\n  ViewCursors.prototype.onFocusChanged = function (e) {\n    this._editorHasFocus = e.isFocused;\n\n    this._updateBlinking();\n\n    return false;\n  };\n\n  ViewCursors.prototype.onLinesChanged = function (e) {\n    return true;\n  };\n\n  ViewCursors.prototype.onLinesDeleted = function (e) {\n    return true;\n  };\n\n  ViewCursors.prototype.onLinesInserted = function (e) {\n    return true;\n  };\n\n  ViewCursors.prototype.onScrollChanged = function (e) {\n    return true;\n  };\n\n  ViewCursors.prototype.onTokensChanged = function (e) {\n    var shouldRender = function (position) {\n      for (var i = 0, len = e.ranges.length; i < len; i++) {\n        if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    if (shouldRender(this._primaryCursor.getPosition())) {\n      return true;\n    }\n\n    for (var _i = 0, _a = this._secondaryCursors; _i < _a.length; _i++) {\n      var secondaryCursor = _a[_i];\n\n      if (shouldRender(secondaryCursor.getPosition())) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  ViewCursors.prototype.onZonesChanged = function (e) {\n    return true;\n  }; // --- end event handlers\n  // ---- blinking logic\n\n\n  ViewCursors.prototype._getCursorBlinking = function () {\n    if (!this._editorHasFocus) {\n      return 0\n      /* Hidden */\n      ;\n    }\n\n    if (this._readOnly) {\n      return 5\n      /* Solid */\n      ;\n    }\n\n    return this._cursorBlinking;\n  };\n\n  ViewCursors.prototype._updateBlinking = function () {\n    var _this = this;\n\n    this._startCursorBlinkAnimation.cancel();\n\n    this._cursorFlatBlinkInterval.cancel();\n\n    var blinkingStyle = this._getCursorBlinking(); // hidden and solid are special as they involve no animations\n\n\n    var isHidden = blinkingStyle === 0\n    /* Hidden */\n    ;\n    var isSolid = blinkingStyle === 5\n    /* Solid */\n    ;\n\n    if (isHidden) {\n      this._hide();\n    } else {\n      this._show();\n    }\n\n    this._blinkingEnabled = false;\n\n    this._updateDomClassName();\n\n    if (!isHidden && !isSolid) {\n      if (blinkingStyle === 1\n      /* Blink */\n      ) {\n          // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\n          this._cursorFlatBlinkInterval.cancelAndSet(function () {\n            if (_this._isVisible) {\n              _this._hide();\n            } else {\n              _this._show();\n            }\n          }, ViewCursors.BLINK_INTERVAL);\n        } else {\n        this._startCursorBlinkAnimation.setIfNotSet(function () {\n          _this._blinkingEnabled = true;\n\n          _this._updateDomClassName();\n        }, ViewCursors.BLINK_INTERVAL);\n      }\n    }\n  }; // --- end blinking logic\n\n\n  ViewCursors.prototype._updateDomClassName = function () {\n    this._domNode.setClassName(this._getClassName());\n  };\n\n  ViewCursors.prototype._getClassName = function () {\n    var result = 'cursors-layer';\n\n    if (!this._selectionIsEmpty) {\n      result += ' has-selection';\n    }\n\n    switch (this._cursorStyle) {\n      case TextEditorCursorStyle.Line:\n        result += ' cursor-line-style';\n        break;\n\n      case TextEditorCursorStyle.Block:\n        result += ' cursor-block-style';\n        break;\n\n      case TextEditorCursorStyle.Underline:\n        result += ' cursor-underline-style';\n        break;\n\n      case TextEditorCursorStyle.LineThin:\n        result += ' cursor-line-thin-style';\n        break;\n\n      case TextEditorCursorStyle.BlockOutline:\n        result += ' cursor-block-outline-style';\n        break;\n\n      case TextEditorCursorStyle.UnderlineThin:\n        result += ' cursor-underline-thin-style';\n        break;\n\n      default:\n        result += ' cursor-line-style';\n    }\n\n    if (this._blinkingEnabled) {\n      switch (this._getCursorBlinking()) {\n        case 1\n        /* Blink */\n        :\n          result += ' cursor-blink';\n          break;\n\n        case 2\n        /* Smooth */\n        :\n          result += ' cursor-smooth';\n          break;\n\n        case 3\n        /* Phase */\n        :\n          result += ' cursor-phase';\n          break;\n\n        case 4\n        /* Expand */\n        :\n          result += ' cursor-expand';\n          break;\n\n        case 5\n        /* Solid */\n        :\n          result += ' cursor-solid';\n          break;\n\n        default:\n          result += ' cursor-solid';\n      }\n    } else {\n      result += ' cursor-solid';\n    }\n\n    if (this._cursorSmoothCaretAnimation) {\n      result += ' cursor-smooth-caret-animation';\n    }\n\n    return result;\n  };\n\n  ViewCursors.prototype._show = function () {\n    this._primaryCursor.show();\n\n    for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n      this._secondaryCursors[i].show();\n    }\n\n    this._isVisible = true;\n  };\n\n  ViewCursors.prototype._hide = function () {\n    this._primaryCursor.hide();\n\n    for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n      this._secondaryCursors[i].hide();\n    }\n\n    this._isVisible = false;\n  }; // ---- IViewPart implementation\n\n\n  ViewCursors.prototype.prepareRender = function (ctx) {\n    this._primaryCursor.prepareRender(ctx);\n\n    for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n      this._secondaryCursors[i].prepareRender(ctx);\n    }\n  };\n\n  ViewCursors.prototype.render = function (ctx) {\n    var renderData = [],\n        renderDataLen = 0;\n\n    var primaryRenderData = this._primaryCursor.render(ctx);\n\n    if (primaryRenderData) {\n      renderData[renderDataLen++] = primaryRenderData;\n    }\n\n    for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\n      var secondaryRenderData = this._secondaryCursors[i].render(ctx);\n\n      if (secondaryRenderData) {\n        renderData[renderDataLen++] = secondaryRenderData;\n      }\n    }\n\n    this._renderData = renderData;\n  };\n\n  ViewCursors.prototype.getLastRenderData = function () {\n    return this._renderData;\n  };\n\n  ViewCursors.BLINK_INTERVAL = 500;\n  return ViewCursors;\n}(ViewPart);\n\nexport { ViewCursors };\nregisterThemingParticipant(function (theme, collector) {\n  var caret = theme.getColor(editorCursorForeground);\n\n  if (caret) {\n    var caretBackground = theme.getColor(editorCursorBackground);\n\n    if (!caretBackground) {\n      caretBackground = caret.opposite();\n    }\n\n    collector.addRule(\".monaco-editor .cursor { background-color: \" + caret + \"; border-color: \" + caret + \"; color: \" + caretBackground + \"; }\");\n\n    if (theme.type === 'hc') {\n      collector.addRule(\".monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid \" + caretBackground + \"; border-right: 1px solid \" + caretBackground + \"; }\");\n    }\n  }\n});","map":{"version":3,"sources":["/Users/ifudata/eclipse-workspace/screen-web/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createFastDomNode","IntervalTimer","TimeoutTimer","ViewPart","ViewCursor","TextEditorCursorStyle","editorCursorBackground","editorCursorForeground","registerThemingParticipant","ViewCursors","_super","context","_this","call","options","_context","configuration","_readOnly","get","_cursorBlinking","_cursorStyle","_cursorSmoothCaretAnimation","_selectionIsEmpty","_isVisible","_primaryCursor","_secondaryCursors","_renderData","_domNode","document","createElement","setAttribute","_updateDomClassName","appendChild","getDomNode","_startCursorBlinkAnimation","_cursorFlatBlinkInterval","_blinkingEnabled","_editorHasFocus","_updateBlinking","dispose","onConfigurationChanged","e","i","len","length","_onCursorPositionChanged","position","secondaryPositions","onCursorPositionChanged","addCnt","newCursor","domNode","insertBefore","nextSibling","push","removeCnt","removeChild","splice","onCursorStateChanged","positions","selections","getPosition","slice","selectionIsEmpty","isEmpty","onDecorationsChanged","onFlushed","onFocusChanged","isFocused","onLinesChanged","onLinesDeleted","onLinesInserted","onScrollChanged","onTokensChanged","shouldRender","ranges","fromLineNumber","lineNumber","toLineNumber","_i","_a","secondaryCursor","onZonesChanged","_getCursorBlinking","cancel","blinkingStyle","isHidden","isSolid","_hide","_show","cancelAndSet","BLINK_INTERVAL","setIfNotSet","setClassName","_getClassName","result","Line","Block","Underline","LineThin","BlockOutline","UnderlineThin","show","hide","prepareRender","ctx","render","renderData","renderDataLen","primaryRenderData","secondaryRenderData","getLastRenderData","theme","collector","caret","getColor","caretBackground","opposite","addRule","type"],"mappings":"AAAA;;;;AAIA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAAc,KAF9E;;AAGA,WAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnBF,IAAAA,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASO,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBT,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;AACH,GAJD;AAKH,CAZ2C,EAA5C;;AAaA,OAAO,mBAAP;AACA,SAASI,iBAAT,QAAkC,yCAAlC;AACA,SAASC,aAAT,EAAwBC,YAAxB,QAA4C,kCAA5C;AACA,SAASC,QAAT,QAAyB,wBAAzB;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,qBAAT,QAAsC,yCAAtC;AACA,SAASC,sBAAT,EAAiCC,sBAAjC,QAA+D,6CAA/D;AACA,SAASC,0BAAT,QAA2C,mDAA3C;;AACA,IAAIC,WAAW;AAAG;AAAe,UAAUC,MAAV,EAAkB;AAC/CxB,EAAAA,SAAS,CAACuB,WAAD,EAAcC,MAAd,CAAT;;AACA,WAASD,WAAT,CAAqBE,OAArB,EAA8B;AAC1B,QAAIC,KAAK,GAAGF,MAAM,CAACG,IAAP,CAAY,IAAZ,EAAkBF,OAAlB,KAA8B,IAA1C;;AACA,QAAIG,OAAO,GAAGF,KAAK,CAACG,QAAN,CAAeC,aAAf,CAA6BF,OAA3C;AACAF,IAAAA,KAAK,CAACK,SAAN,GAAkBH,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAAlB;AACAN,IAAAA,KAAK,CAACO,eAAN,GAAwBL,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAAxB;AACAN,IAAAA,KAAK,CAACQ,YAAN,GAAqBN,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAArB;AACAN,IAAAA,KAAK,CAACS,2BAAN,GAAoCP,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAApC;AACAN,IAAAA,KAAK,CAACU,iBAAN,GAA0B,IAA1B;AACAV,IAAAA,KAAK,CAACW,UAAN,GAAmB,KAAnB;AACAX,IAAAA,KAAK,CAACY,cAAN,GAAuB,IAAIpB,UAAJ,CAAeQ,KAAK,CAACG,QAArB,CAAvB;AACAH,IAAAA,KAAK,CAACa,iBAAN,GAA0B,EAA1B;AACAb,IAAAA,KAAK,CAACc,WAAN,GAAoB,EAApB;AACAd,IAAAA,KAAK,CAACe,QAAN,GAAiB3B,iBAAiB,CAAC4B,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAD,CAAlC;;AACAjB,IAAAA,KAAK,CAACe,QAAN,CAAeG,YAAf,CAA4B,MAA5B,EAAoC,cAApC;;AACAlB,IAAAA,KAAK,CAACe,QAAN,CAAeG,YAAf,CAA4B,aAA5B,EAA2C,MAA3C;;AACAlB,IAAAA,KAAK,CAACmB,mBAAN;;AACAnB,IAAAA,KAAK,CAACe,QAAN,CAAeK,WAAf,CAA2BpB,KAAK,CAACY,cAAN,CAAqBS,UAArB,EAA3B;;AACArB,IAAAA,KAAK,CAACsB,0BAAN,GAAmC,IAAIhC,YAAJ,EAAnC;AACAU,IAAAA,KAAK,CAACuB,wBAAN,GAAiC,IAAIlC,aAAJ,EAAjC;AACAW,IAAAA,KAAK,CAACwB,gBAAN,GAAyB,KAAzB;AACAxB,IAAAA,KAAK,CAACyB,eAAN,GAAwB,KAAxB;;AACAzB,IAAAA,KAAK,CAAC0B,eAAN;;AACA,WAAO1B,KAAP;AACH;;AACDH,EAAAA,WAAW,CAACX,SAAZ,CAAsByC,OAAtB,GAAgC,YAAY;AACxC7B,IAAAA,MAAM,CAACZ,SAAP,CAAiByC,OAAjB,CAAyB1B,IAAzB,CAA8B,IAA9B;;AACA,SAAKqB,0BAAL,CAAgCK,OAAhC;;AACA,SAAKJ,wBAAL,CAA8BI,OAA9B;AACH,GAJD;;AAKA9B,EAAAA,WAAW,CAACX,SAAZ,CAAsBmC,UAAtB,GAAmC,YAAY;AAC3C,WAAO,KAAKN,QAAZ;AACH,GAFD,CA/B+C,CAkC/C;;;AACAlB,EAAAA,WAAW,CAACX,SAAZ,CAAsB0C,sBAAtB,GAA+C,UAAUC,CAAV,EAAa;AACxD,QAAI3B,OAAO,GAAG,KAAKC,QAAL,CAAcC,aAAd,CAA4BF,OAA1C;AACA,SAAKG,SAAL,GAAiBH,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAAjB;AACA,SAAKC,eAAL,GAAuBL,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAAvB;AACA,SAAKE,YAAL,GAAoBN,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAApB;AACA,SAAKG,2BAAL,GAAmCP,OAAO,CAACI,GAAR,CAAY;AAAG;AAAf,KAAnC;;AACA,SAAKoB,eAAL;;AACA,SAAKP,mBAAL;;AACA,SAAKP,cAAL,CAAoBgB,sBAApB,CAA2CC,CAA3C;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAG,KAAKlB,iBAAL,CAAuBmB,MAA7C,EAAqDF,CAAC,GAAGC,GAAzD,EAA8DD,CAAC,EAA/D,EAAmE;AAC/D,WAAKjB,iBAAL,CAAuBiB,CAAvB,EAA0BF,sBAA1B,CAAiDC,CAAjD;AACH;;AACD,WAAO,IAAP;AACH,GAbD;;AAcAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsB+C,wBAAtB,GAAiD,UAAUC,QAAV,EAAoBC,kBAApB,EAAwC;AACrF,SAAKvB,cAAL,CAAoBwB,uBAApB,CAA4CF,QAA5C;;AACA,SAAKR,eAAL;;AACA,QAAI,KAAKb,iBAAL,CAAuBmB,MAAvB,GAAgCG,kBAAkB,CAACH,MAAvD,EAA+D;AAC3D;AACA,UAAIK,MAAM,GAAGF,kBAAkB,CAACH,MAAnB,GAA4B,KAAKnB,iBAAL,CAAuBmB,MAAhE;;AACA,WAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGO,MAApB,EAA4BP,CAAC,EAA7B,EAAiC;AAC7B,YAAIQ,SAAS,GAAG,IAAI9C,UAAJ,CAAe,KAAKW,QAApB,CAAhB;;AACA,aAAKY,QAAL,CAAcwB,OAAd,CAAsBC,YAAtB,CAAmCF,SAAS,CAACjB,UAAV,GAAuBkB,OAA1D,EAAmE,KAAK3B,cAAL,CAAoBS,UAApB,GAAiCkB,OAAjC,CAAyCE,WAA5G;;AACA,aAAK5B,iBAAL,CAAuB6B,IAAvB,CAA4BJ,SAA5B;AACH;AACJ,KARD,MASK,IAAI,KAAKzB,iBAAL,CAAuBmB,MAAvB,GAAgCG,kBAAkB,CAACH,MAAvD,EAA+D;AAChE;AACA,UAAIW,SAAS,GAAG,KAAK9B,iBAAL,CAAuBmB,MAAvB,GAAgCG,kBAAkB,CAACH,MAAnE;;AACA,WAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGa,SAApB,EAA+Bb,CAAC,EAAhC,EAAoC;AAChC,aAAKf,QAAL,CAAc6B,WAAd,CAA0B,KAAK/B,iBAAL,CAAuB,CAAvB,EAA0BQ,UAA1B,EAA1B;;AACA,aAAKR,iBAAL,CAAuBgC,MAAvB,CAA8B,CAA9B,EAAiC,CAAjC;AACH;AACJ;;AACD,SAAK,IAAIf,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGK,kBAAkB,CAACH,MAAvC,EAA+CF,CAAC,EAAhD,EAAoD;AAChD,WAAKjB,iBAAL,CAAuBiB,CAAvB,EAA0BM,uBAA1B,CAAkDD,kBAAkB,CAACL,CAAD,CAApE;AACH;AACJ,GAvBD;;AAwBAjC,EAAAA,WAAW,CAACX,SAAZ,CAAsB4D,oBAAtB,GAA6C,UAAUjB,CAAV,EAAa;AACtD,QAAIkB,SAAS,GAAG,EAAhB;;AACA,SAAK,IAAIjB,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGF,CAAC,CAACmB,UAAF,CAAahB,MAAnC,EAA2CF,CAAC,GAAGC,GAA/C,EAAoDD,CAAC,EAArD,EAAyD;AACrDiB,MAAAA,SAAS,CAACjB,CAAD,CAAT,GAAeD,CAAC,CAACmB,UAAF,CAAalB,CAAb,EAAgBmB,WAAhB,EAAf;AACH;;AACD,SAAKhB,wBAAL,CAA8Bc,SAAS,CAAC,CAAD,CAAvC,EAA4CA,SAAS,CAACG,KAAV,CAAgB,CAAhB,CAA5C;;AACA,QAAIC,gBAAgB,GAAGtB,CAAC,CAACmB,UAAF,CAAa,CAAb,EAAgBI,OAAhB,EAAvB;;AACA,QAAI,KAAK1C,iBAAL,KAA2ByC,gBAA/B,EAAiD;AAC7C,WAAKzC,iBAAL,GAAyByC,gBAAzB;;AACA,WAAKhC,mBAAL;AACH;;AACD,WAAO,IAAP;AACH,GAZD;;AAaAtB,EAAAA,WAAW,CAACX,SAAZ,CAAsBmE,oBAAtB,GAA6C,UAAUxB,CAAV,EAAa;AACtD;AACA,WAAO,IAAP;AACH,GAHD;;AAIAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsBoE,SAAtB,GAAkC,UAAUzB,CAAV,EAAa;AAC3C,WAAO,IAAP;AACH,GAFD;;AAGAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsBqE,cAAtB,GAAuC,UAAU1B,CAAV,EAAa;AAChD,SAAKJ,eAAL,GAAuBI,CAAC,CAAC2B,SAAzB;;AACA,SAAK9B,eAAL;;AACA,WAAO,KAAP;AACH,GAJD;;AAKA7B,EAAAA,WAAW,CAACX,SAAZ,CAAsBuE,cAAtB,GAAuC,UAAU5B,CAAV,EAAa;AAChD,WAAO,IAAP;AACH,GAFD;;AAGAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsBwE,cAAtB,GAAuC,UAAU7B,CAAV,EAAa;AAChD,WAAO,IAAP;AACH,GAFD;;AAGAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsByE,eAAtB,GAAwC,UAAU9B,CAAV,EAAa;AACjD,WAAO,IAAP;AACH,GAFD;;AAGAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsB0E,eAAtB,GAAwC,UAAU/B,CAAV,EAAa;AACjD,WAAO,IAAP;AACH,GAFD;;AAGAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsB2E,eAAtB,GAAwC,UAAUhC,CAAV,EAAa;AACjD,QAAIiC,YAAY,GAAG,UAAU5B,QAAV,EAAoB;AACnC,WAAK,IAAIJ,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGF,CAAC,CAACkC,MAAF,CAAS/B,MAA/B,EAAuCF,CAAC,GAAGC,GAA3C,EAAgDD,CAAC,EAAjD,EAAqD;AACjD,YAAID,CAAC,CAACkC,MAAF,CAASjC,CAAT,EAAYkC,cAAZ,IAA8B9B,QAAQ,CAAC+B,UAAvC,IAAqD/B,QAAQ,CAAC+B,UAAT,IAAuBpC,CAAC,CAACkC,MAAF,CAASjC,CAAT,EAAYoC,YAA5F,EAA0G;AACtG,iBAAO,IAAP;AACH;AACJ;;AACD,aAAO,KAAP;AACH,KAPD;;AAQA,QAAIJ,YAAY,CAAC,KAAKlD,cAAL,CAAoBqC,WAApB,EAAD,CAAhB,EAAqD;AACjD,aAAO,IAAP;AACH;;AACD,SAAK,IAAIkB,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAG,KAAKvD,iBAA3B,EAA8CsD,EAAE,GAAGC,EAAE,CAACpC,MAAtD,EAA8DmC,EAAE,EAAhE,EAAoE;AAChE,UAAIE,eAAe,GAAGD,EAAE,CAACD,EAAD,CAAxB;;AACA,UAAIL,YAAY,CAACO,eAAe,CAACpB,WAAhB,EAAD,CAAhB,EAAiD;AAC7C,eAAO,IAAP;AACH;AACJ;;AACD,WAAO,KAAP;AACH,GAnBD;;AAoBApD,EAAAA,WAAW,CAACX,SAAZ,CAAsBoF,cAAtB,GAAuC,UAAUzC,CAAV,EAAa;AAChD,WAAO,IAAP;AACH,GAFD,CAlI+C,CAqI/C;AACA;;;AACAhC,EAAAA,WAAW,CAACX,SAAZ,CAAsBqF,kBAAtB,GAA2C,YAAY;AACnD,QAAI,CAAC,KAAK9C,eAAV,EAA2B;AACvB,aAAO;AAAE;AAAT;AACH;;AACD,QAAI,KAAKpB,SAAT,EAAoB;AAChB,aAAO;AAAE;AAAT;AACH;;AACD,WAAO,KAAKE,eAAZ;AACH,GARD;;AASAV,EAAAA,WAAW,CAACX,SAAZ,CAAsBwC,eAAtB,GAAwC,YAAY;AAChD,QAAI1B,KAAK,GAAG,IAAZ;;AACA,SAAKsB,0BAAL,CAAgCkD,MAAhC;;AACA,SAAKjD,wBAAL,CAA8BiD,MAA9B;;AACA,QAAIC,aAAa,GAAG,KAAKF,kBAAL,EAApB,CAJgD,CAKhD;;;AACA,QAAIG,QAAQ,GAAID,aAAa,KAAK;AAAE;AAApC;AACA,QAAIE,OAAO,GAAIF,aAAa,KAAK;AAAE;AAAnC;;AACA,QAAIC,QAAJ,EAAc;AACV,WAAKE,KAAL;AACH,KAFD,MAGK;AACD,WAAKC,KAAL;AACH;;AACD,SAAKrD,gBAAL,GAAwB,KAAxB;;AACA,SAAKL,mBAAL;;AACA,QAAI,CAACuD,QAAD,IAAa,CAACC,OAAlB,EAA2B;AACvB,UAAIF,aAAa,KAAK;AAAE;AAAxB,QAAqC;AACjC;AACA,eAAKlD,wBAAL,CAA8BuD,YAA9B,CAA2C,YAAY;AACnD,gBAAI9E,KAAK,CAACW,UAAV,EAAsB;AAClBX,cAAAA,KAAK,CAAC4E,KAAN;AACH,aAFD,MAGK;AACD5E,cAAAA,KAAK,CAAC6E,KAAN;AACH;AACJ,WAPD,EAOGhF,WAAW,CAACkF,cAPf;AAQH,SAVD,MAWK;AACD,aAAKzD,0BAAL,CAAgC0D,WAAhC,CAA4C,YAAY;AACpDhF,UAAAA,KAAK,CAACwB,gBAAN,GAAyB,IAAzB;;AACAxB,UAAAA,KAAK,CAACmB,mBAAN;AACH,SAHD,EAGGtB,WAAW,CAACkF,cAHf;AAIH;AACJ;AACJ,GAnCD,CAhJ+C,CAoL/C;;;AACAlF,EAAAA,WAAW,CAACX,SAAZ,CAAsBiC,mBAAtB,GAA4C,YAAY;AACpD,SAAKJ,QAAL,CAAckE,YAAd,CAA2B,KAAKC,aAAL,EAA3B;AACH,GAFD;;AAGArF,EAAAA,WAAW,CAACX,SAAZ,CAAsBgG,aAAtB,GAAsC,YAAY;AAC9C,QAAIC,MAAM,GAAG,eAAb;;AACA,QAAI,CAAC,KAAKzE,iBAAV,EAA6B;AACzByE,MAAAA,MAAM,IAAI,gBAAV;AACH;;AACD,YAAQ,KAAK3E,YAAb;AACI,WAAKf,qBAAqB,CAAC2F,IAA3B;AACID,QAAAA,MAAM,IAAI,oBAAV;AACA;;AACJ,WAAK1F,qBAAqB,CAAC4F,KAA3B;AACIF,QAAAA,MAAM,IAAI,qBAAV;AACA;;AACJ,WAAK1F,qBAAqB,CAAC6F,SAA3B;AACIH,QAAAA,MAAM,IAAI,yBAAV;AACA;;AACJ,WAAK1F,qBAAqB,CAAC8F,QAA3B;AACIJ,QAAAA,MAAM,IAAI,yBAAV;AACA;;AACJ,WAAK1F,qBAAqB,CAAC+F,YAA3B;AACIL,QAAAA,MAAM,IAAI,6BAAV;AACA;;AACJ,WAAK1F,qBAAqB,CAACgG,aAA3B;AACIN,QAAAA,MAAM,IAAI,8BAAV;AACA;;AACJ;AACIA,QAAAA,MAAM,IAAI,oBAAV;AApBR;;AAsBA,QAAI,KAAK3D,gBAAT,EAA2B;AACvB,cAAQ,KAAK+C,kBAAL,EAAR;AACI,aAAK;AAAE;AAAP;AACIY,UAAAA,MAAM,IAAI,eAAV;AACA;;AACJ,aAAK;AAAE;AAAP;AACIA,UAAAA,MAAM,IAAI,gBAAV;AACA;;AACJ,aAAK;AAAE;AAAP;AACIA,UAAAA,MAAM,IAAI,eAAV;AACA;;AACJ,aAAK;AAAE;AAAP;AACIA,UAAAA,MAAM,IAAI,gBAAV;AACA;;AACJ,aAAK;AAAE;AAAP;AACIA,UAAAA,MAAM,IAAI,eAAV;AACA;;AACJ;AACIA,UAAAA,MAAM,IAAI,eAAV;AAjBR;AAmBH,KApBD,MAqBK;AACDA,MAAAA,MAAM,IAAI,eAAV;AACH;;AACD,QAAI,KAAK1E,2BAAT,EAAsC;AAClC0E,MAAAA,MAAM,IAAI,gCAAV;AACH;;AACD,WAAOA,MAAP;AACH,GAvDD;;AAwDAtF,EAAAA,WAAW,CAACX,SAAZ,CAAsB2F,KAAtB,GAA8B,YAAY;AACtC,SAAKjE,cAAL,CAAoB8E,IAApB;;AACA,SAAK,IAAI5D,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAG,KAAKlB,iBAAL,CAAuBmB,MAA7C,EAAqDF,CAAC,GAAGC,GAAzD,EAA8DD,CAAC,EAA/D,EAAmE;AAC/D,WAAKjB,iBAAL,CAAuBiB,CAAvB,EAA0B4D,IAA1B;AACH;;AACD,SAAK/E,UAAL,GAAkB,IAAlB;AACH,GAND;;AAOAd,EAAAA,WAAW,CAACX,SAAZ,CAAsB0F,KAAtB,GAA8B,YAAY;AACtC,SAAKhE,cAAL,CAAoB+E,IAApB;;AACA,SAAK,IAAI7D,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAG,KAAKlB,iBAAL,CAAuBmB,MAA7C,EAAqDF,CAAC,GAAGC,GAAzD,EAA8DD,CAAC,EAA/D,EAAmE;AAC/D,WAAKjB,iBAAL,CAAuBiB,CAAvB,EAA0B6D,IAA1B;AACH;;AACD,SAAKhF,UAAL,GAAkB,KAAlB;AACH,GAND,CAvP+C,CA8P/C;;;AACAd,EAAAA,WAAW,CAACX,SAAZ,CAAsB0G,aAAtB,GAAsC,UAAUC,GAAV,EAAe;AACjD,SAAKjF,cAAL,CAAoBgF,aAApB,CAAkCC,GAAlC;;AACA,SAAK,IAAI/D,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAG,KAAKlB,iBAAL,CAAuBmB,MAA7C,EAAqDF,CAAC,GAAGC,GAAzD,EAA8DD,CAAC,EAA/D,EAAmE;AAC/D,WAAKjB,iBAAL,CAAuBiB,CAAvB,EAA0B8D,aAA1B,CAAwCC,GAAxC;AACH;AACJ,GALD;;AAMAhG,EAAAA,WAAW,CAACX,SAAZ,CAAsB4G,MAAtB,GAA+B,UAAUD,GAAV,EAAe;AAC1C,QAAIE,UAAU,GAAG,EAAjB;AAAA,QAAqBC,aAAa,GAAG,CAArC;;AACA,QAAIC,iBAAiB,GAAG,KAAKrF,cAAL,CAAoBkF,MAApB,CAA2BD,GAA3B,CAAxB;;AACA,QAAII,iBAAJ,EAAuB;AACnBF,MAAAA,UAAU,CAACC,aAAa,EAAd,CAAV,GAA8BC,iBAA9B;AACH;;AACD,SAAK,IAAInE,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAG,KAAKlB,iBAAL,CAAuBmB,MAA7C,EAAqDF,CAAC,GAAGC,GAAzD,EAA8DD,CAAC,EAA/D,EAAmE;AAC/D,UAAIoE,mBAAmB,GAAG,KAAKrF,iBAAL,CAAuBiB,CAAvB,EAA0BgE,MAA1B,CAAiCD,GAAjC,CAA1B;;AACA,UAAIK,mBAAJ,EAAyB;AACrBH,QAAAA,UAAU,CAACC,aAAa,EAAd,CAAV,GAA8BE,mBAA9B;AACH;AACJ;;AACD,SAAKpF,WAAL,GAAmBiF,UAAnB;AACH,GAbD;;AAcAlG,EAAAA,WAAW,CAACX,SAAZ,CAAsBiH,iBAAtB,GAA0C,YAAY;AAClD,WAAO,KAAKrF,WAAZ;AACH,GAFD;;AAGAjB,EAAAA,WAAW,CAACkF,cAAZ,GAA6B,GAA7B;AACA,SAAOlF,WAAP;AACH,CAxRgC,CAwR/BN,QAxR+B,CAAjC;;AAyRA,SAASM,WAAT;AACAD,0BAA0B,CAAC,UAAUwG,KAAV,EAAiBC,SAAjB,EAA4B;AACnD,MAAIC,KAAK,GAAGF,KAAK,CAACG,QAAN,CAAe5G,sBAAf,CAAZ;;AACA,MAAI2G,KAAJ,EAAW;AACP,QAAIE,eAAe,GAAGJ,KAAK,CAACG,QAAN,CAAe7G,sBAAf,CAAtB;;AACA,QAAI,CAAC8G,eAAL,EAAsB;AAClBA,MAAAA,eAAe,GAAGF,KAAK,CAACG,QAAN,EAAlB;AACH;;AACDJ,IAAAA,SAAS,CAACK,OAAV,CAAkB,gDAAgDJ,KAAhD,GAAwD,kBAAxD,GAA6EA,KAA7E,GAAqF,WAArF,GAAmGE,eAAnG,GAAqH,KAAvI;;AACA,QAAIJ,KAAK,CAACO,IAAN,KAAe,IAAnB,EAAyB;AACrBN,MAAAA,SAAS,CAACK,OAAV,CAAkB,kFAAkFF,eAAlF,GAAoG,4BAApG,GAAmIA,eAAnI,GAAqJ,KAAvK;AACH;AACJ;AACJ,CAZyB,CAA1B","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './viewCursors.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { ViewCursor } from './viewCursor.js';\r\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\r\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar ViewCursors = /** @class */ (function (_super) {\r\n    __extends(ViewCursors, _super);\r\n    function ViewCursors(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        _this._readOnly = options.get(68 /* readOnly */);\r\n        _this._cursorBlinking = options.get(16 /* cursorBlinking */);\r\n        _this._cursorStyle = options.get(18 /* cursorStyle */);\r\n        _this._cursorSmoothCaretAnimation = options.get(17 /* cursorSmoothCaretAnimation */);\r\n        _this._selectionIsEmpty = true;\r\n        _this._isVisible = false;\r\n        _this._primaryCursor = new ViewCursor(_this._context);\r\n        _this._secondaryCursors = [];\r\n        _this._renderData = [];\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._updateDomClassName();\r\n        _this._domNode.appendChild(_this._primaryCursor.getDomNode());\r\n        _this._startCursorBlinkAnimation = new TimeoutTimer();\r\n        _this._cursorFlatBlinkInterval = new IntervalTimer();\r\n        _this._blinkingEnabled = false;\r\n        _this._editorHasFocus = false;\r\n        _this._updateBlinking();\r\n        return _this;\r\n    }\r\n    ViewCursors.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._startCursorBlinkAnimation.dispose();\r\n        this._cursorFlatBlinkInterval.dispose();\r\n    };\r\n    ViewCursors.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    // --- begin event handlers\r\n    ViewCursors.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        this._readOnly = options.get(68 /* readOnly */);\r\n        this._cursorBlinking = options.get(16 /* cursorBlinking */);\r\n        this._cursorStyle = options.get(18 /* cursorStyle */);\r\n        this._cursorSmoothCaretAnimation = options.get(17 /* cursorSmoothCaretAnimation */);\r\n        this._updateBlinking();\r\n        this._updateDomClassName();\r\n        this._primaryCursor.onConfigurationChanged(e);\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewCursors.prototype._onCursorPositionChanged = function (position, secondaryPositions) {\r\n        this._primaryCursor.onCursorPositionChanged(position);\r\n        this._updateBlinking();\r\n        if (this._secondaryCursors.length < secondaryPositions.length) {\r\n            // Create new cursors\r\n            var addCnt = secondaryPositions.length - this._secondaryCursors.length;\r\n            for (var i = 0; i < addCnt; i++) {\r\n                var newCursor = new ViewCursor(this._context);\r\n                this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\r\n                this._secondaryCursors.push(newCursor);\r\n            }\r\n        }\r\n        else if (this._secondaryCursors.length > secondaryPositions.length) {\r\n            // Remove some cursors\r\n            var removeCnt = this._secondaryCursors.length - secondaryPositions.length;\r\n            for (var i = 0; i < removeCnt; i++) {\r\n                this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\r\n                this._secondaryCursors.splice(0, 1);\r\n            }\r\n        }\r\n        for (var i = 0; i < secondaryPositions.length; i++) {\r\n            this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i]);\r\n        }\r\n    };\r\n    ViewCursors.prototype.onCursorStateChanged = function (e) {\r\n        var positions = [];\r\n        for (var i = 0, len = e.selections.length; i < len; i++) {\r\n            positions[i] = e.selections[i].getPosition();\r\n        }\r\n        this._onCursorPositionChanged(positions[0], positions.slice(1));\r\n        var selectionIsEmpty = e.selections[0].isEmpty();\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            this._updateDomClassName();\r\n        }\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onFocusChanged = function (e) {\r\n        this._editorHasFocus = e.isFocused;\r\n        this._updateBlinking();\r\n        return false;\r\n    };\r\n    ViewCursors.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onTokensChanged = function (e) {\r\n        var shouldRender = function (position) {\r\n            for (var i = 0, len = e.ranges.length; i < len; i++) {\r\n                if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        if (shouldRender(this._primaryCursor.getPosition())) {\r\n            return true;\r\n        }\r\n        for (var _i = 0, _a = this._secondaryCursors; _i < _a.length; _i++) {\r\n            var secondaryCursor = _a[_i];\r\n            if (shouldRender(secondaryCursor.getPosition())) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    ViewCursors.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    // ---- blinking logic\r\n    ViewCursors.prototype._getCursorBlinking = function () {\r\n        if (!this._editorHasFocus) {\r\n            return 0 /* Hidden */;\r\n        }\r\n        if (this._readOnly) {\r\n            return 5 /* Solid */;\r\n        }\r\n        return this._cursorBlinking;\r\n    };\r\n    ViewCursors.prototype._updateBlinking = function () {\r\n        var _this = this;\r\n        this._startCursorBlinkAnimation.cancel();\r\n        this._cursorFlatBlinkInterval.cancel();\r\n        var blinkingStyle = this._getCursorBlinking();\r\n        // hidden and solid are special as they involve no animations\r\n        var isHidden = (blinkingStyle === 0 /* Hidden */);\r\n        var isSolid = (blinkingStyle === 5 /* Solid */);\r\n        if (isHidden) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n        this._blinkingEnabled = false;\r\n        this._updateDomClassName();\r\n        if (!isHidden && !isSolid) {\r\n            if (blinkingStyle === 1 /* Blink */) {\r\n                // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\r\n                this._cursorFlatBlinkInterval.cancelAndSet(function () {\r\n                    if (_this._isVisible) {\r\n                        _this._hide();\r\n                    }\r\n                    else {\r\n                        _this._show();\r\n                    }\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n            else {\r\n                this._startCursorBlinkAnimation.setIfNotSet(function () {\r\n                    _this._blinkingEnabled = true;\r\n                    _this._updateDomClassName();\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n        }\r\n    };\r\n    // --- end blinking logic\r\n    ViewCursors.prototype._updateDomClassName = function () {\r\n        this._domNode.setClassName(this._getClassName());\r\n    };\r\n    ViewCursors.prototype._getClassName = function () {\r\n        var result = 'cursors-layer';\r\n        if (!this._selectionIsEmpty) {\r\n            result += ' has-selection';\r\n        }\r\n        switch (this._cursorStyle) {\r\n            case TextEditorCursorStyle.Line:\r\n                result += ' cursor-line-style';\r\n                break;\r\n            case TextEditorCursorStyle.Block:\r\n                result += ' cursor-block-style';\r\n                break;\r\n            case TextEditorCursorStyle.Underline:\r\n                result += ' cursor-underline-style';\r\n                break;\r\n            case TextEditorCursorStyle.LineThin:\r\n                result += ' cursor-line-thin-style';\r\n                break;\r\n            case TextEditorCursorStyle.BlockOutline:\r\n                result += ' cursor-block-outline-style';\r\n                break;\r\n            case TextEditorCursorStyle.UnderlineThin:\r\n                result += ' cursor-underline-thin-style';\r\n                break;\r\n            default:\r\n                result += ' cursor-line-style';\r\n        }\r\n        if (this._blinkingEnabled) {\r\n            switch (this._getCursorBlinking()) {\r\n                case 1 /* Blink */:\r\n                    result += ' cursor-blink';\r\n                    break;\r\n                case 2 /* Smooth */:\r\n                    result += ' cursor-smooth';\r\n                    break;\r\n                case 3 /* Phase */:\r\n                    result += ' cursor-phase';\r\n                    break;\r\n                case 4 /* Expand */:\r\n                    result += ' cursor-expand';\r\n                    break;\r\n                case 5 /* Solid */:\r\n                    result += ' cursor-solid';\r\n                    break;\r\n                default:\r\n                    result += ' cursor-solid';\r\n            }\r\n        }\r\n        else {\r\n            result += ' cursor-solid';\r\n        }\r\n        if (this._cursorSmoothCaretAnimation) {\r\n            result += ' cursor-smooth-caret-animation';\r\n        }\r\n        return result;\r\n    };\r\n    ViewCursors.prototype._show = function () {\r\n        this._primaryCursor.show();\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].show();\r\n        }\r\n        this._isVisible = true;\r\n    };\r\n    ViewCursors.prototype._hide = function () {\r\n        this._primaryCursor.hide();\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].hide();\r\n        }\r\n        this._isVisible = false;\r\n    };\r\n    // ---- IViewPart implementation\r\n    ViewCursors.prototype.prepareRender = function (ctx) {\r\n        this._primaryCursor.prepareRender(ctx);\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].prepareRender(ctx);\r\n        }\r\n    };\r\n    ViewCursors.prototype.render = function (ctx) {\r\n        var renderData = [], renderDataLen = 0;\r\n        var primaryRenderData = this._primaryCursor.render(ctx);\r\n        if (primaryRenderData) {\r\n            renderData[renderDataLen++] = primaryRenderData;\r\n        }\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            var secondaryRenderData = this._secondaryCursors[i].render(ctx);\r\n            if (secondaryRenderData) {\r\n                renderData[renderDataLen++] = secondaryRenderData;\r\n            }\r\n        }\r\n        this._renderData = renderData;\r\n    };\r\n    ViewCursors.prototype.getLastRenderData = function () {\r\n        return this._renderData;\r\n    };\r\n    ViewCursors.BLINK_INTERVAL = 500;\r\n    return ViewCursors;\r\n}(ViewPart));\r\nexport { ViewCursors };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var caret = theme.getColor(editorCursorForeground);\r\n    if (caret) {\r\n        var caretBackground = theme.getColor(editorCursorBackground);\r\n        if (!caretBackground) {\r\n            caretBackground = caret.opposite();\r\n        }\r\n        collector.addRule(\".monaco-editor .cursor { background-color: \" + caret + \"; border-color: \" + caret + \"; color: \" + caretBackground + \"; }\");\r\n        if (theme.type === 'hc') {\r\n            collector.addRule(\".monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid \" + caretBackground + \"; border-right: 1px solid \" + caretBackground + \"; }\");\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}